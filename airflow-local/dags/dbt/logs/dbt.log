[0m11:00:28.198300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd91caad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd91ff2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd91cab810>]}


============================== 11:00:28.203593 | 1f0aca09-cf49-46d5-bca9-f7780c6e8a16 ==============================
[0m11:00:28.203593 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:00:28.204118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:00:28.213732 [info ] [MainThread]: dbt version: 1.9.4
[0m11:00:28.214125 [info ] [MainThread]: python version: 3.11.12
[0m11:00:28.214645 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m11:00:28.215084 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m11:00:28.263371 [info ] [MainThread]: Using profiles dir at /dbt
[0m11:00:28.263774 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m11:00:28.264080 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m11:00:28.264690 [info ] [MainThread]: adapter type: postgres
[0m11:00:28.265087 [info ] [MainThread]: adapter version: 1.9.0
[0m11:00:28.361710 [info ] [MainThread]: Configuration:
[0m11:00:28.362099 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:00:28.362391 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:00:28.362727 [info ] [MainThread]: Required dependencies:
[0m11:00:28.363073 [debug] [MainThread]: Executing "git --help"
[0m11:00:28.364202 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m11:00:28.364598 [info ] [MainThread]: Connection:
[0m11:00:28.364966 [info ] [MainThread]:   host: dwh
[0m11:00:28.365318 [info ] [MainThread]:   port: 5432
[0m11:00:28.365817 [info ] [MainThread]:   user: airflow
[0m11:00:28.366293 [info ] [MainThread]:   database: dwh
[0m11:00:28.367227 [info ] [MainThread]:   schema: public
[0m11:00:28.367974 [info ] [MainThread]:   connect_timeout: 10
[0m11:00:28.368546 [info ] [MainThread]:   role: None
[0m11:00:28.368981 [info ] [MainThread]:   search_path: None
[0m11:00:28.369484 [info ] [MainThread]:   keepalives_idle: 0
[0m11:00:28.369976 [info ] [MainThread]:   sslmode: None
[0m11:00:28.370546 [info ] [MainThread]:   sslcert: None
[0m11:00:28.371025 [info ] [MainThread]:   sslkey: None
[0m11:00:28.371599 [info ] [MainThread]:   sslrootcert: None
[0m11:00:28.371935 [info ] [MainThread]:   application_name: dbt
[0m11:00:28.372204 [info ] [MainThread]:   retries: 1
[0m11:00:28.372670 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:00:28.441851 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:00:28.466808 [debug] [MainThread]: Using postgres connection "debug"
[0m11:00:28.467162 [debug] [MainThread]: On debug: select 1 as id
[0m11:00:28.467399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:28.474616 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m11:00:28.475531 [debug] [MainThread]: On debug: Close
[0m11:00:28.475855 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:00:28.476166 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:00:28.476438 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m11:00:28.477591 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.33061418, "process_in_blocks": "104", "process_kernel_time": 0.149147, "process_mem_max_rss": "111840", "process_out_blocks": "1712", "process_user_time": 1.521308}
[0m11:00:28.478068 [debug] [MainThread]: Command `dbt debug` failed at 11:00:28.477972 after 0.33 seconds
[0m11:00:28.478349 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:00:28.478702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd929b4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd937eb5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd91cf9050>]}
[0m11:00:28.479065 [debug] [MainThread]: Flushing usage events
[0m11:00:29.128464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:16.361014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54b86a36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54b86ebb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54b86eb3d0>]}


============================== 11:09:16.366525 | ee224bb2-e21a-4d73-ae27-e505664dde92 ==============================
[0m11:09:16.366525 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:09:16.367166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:09:16.374578 [info ] [MainThread]: dbt version: 1.9.4
[0m11:09:16.375096 [info ] [MainThread]: python version: 3.11.12
[0m11:09:16.375502 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m11:09:16.375986 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m11:09:16.421434 [info ] [MainThread]: Using profiles dir at /dbt
[0m11:09:16.421824 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m11:09:16.422114 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m11:09:16.422557 [info ] [MainThread]: adapter type: postgres
[0m11:09:16.423087 [info ] [MainThread]: adapter version: 1.9.0
[0m11:09:16.522942 [info ] [MainThread]: Configuration:
[0m11:09:16.523329 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:09:16.523607 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:09:16.523972 [info ] [MainThread]: Required dependencies:
[0m11:09:16.524335 [debug] [MainThread]: Executing "git --help"
[0m11:09:16.526268 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:09:16.526850 [debug] [MainThread]: STDERR: "b''"
[0m11:09:16.527122 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:09:16.527490 [info ] [MainThread]: Connection:
[0m11:09:16.527974 [info ] [MainThread]:   host: dwh
[0m11:09:16.528508 [info ] [MainThread]:   port: 5432
[0m11:09:16.528980 [info ] [MainThread]:   user: airflow
[0m11:09:16.529355 [info ] [MainThread]:   database: dwh
[0m11:09:16.529741 [info ] [MainThread]:   schema: public
[0m11:09:16.530077 [info ] [MainThread]:   connect_timeout: 10
[0m11:09:16.530603 [info ] [MainThread]:   role: None
[0m11:09:16.531095 [info ] [MainThread]:   search_path: None
[0m11:09:16.531493 [info ] [MainThread]:   keepalives_idle: 0
[0m11:09:16.531828 [info ] [MainThread]:   sslmode: None
[0m11:09:16.532163 [info ] [MainThread]:   sslcert: None
[0m11:09:16.532632 [info ] [MainThread]:   sslkey: None
[0m11:09:16.533187 [info ] [MainThread]:   sslrootcert: None
[0m11:09:16.533714 [info ] [MainThread]:   application_name: dbt
[0m11:09:16.534040 [info ] [MainThread]:   retries: 1
[0m11:09:16.534680 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:09:16.602426 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:09:16.628402 [debug] [MainThread]: Using postgres connection "debug"
[0m11:09:16.628768 [debug] [MainThread]: On debug: select 1 as id
[0m11:09:16.629012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:09:16.636319 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m11:09:16.637190 [debug] [MainThread]: On debug: Close
[0m11:09:16.637513 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:09:16.637820 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:09:16.638613 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.33387205, "process_in_blocks": "0", "process_kernel_time": 0.139687, "process_mem_max_rss": "111756", "process_out_blocks": "1704", "process_user_time": 1.526589}
[0m11:09:16.639053 [debug] [MainThread]: Command `dbt debug` succeeded at 11:09:16.638956 after 0.33 seconds
[0m11:09:16.639346 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:09:16.639672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54b86f0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54b86f1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54b93bccd0>]}
[0m11:09:16.640082 [debug] [MainThread]: Flushing usage events
[0m11:09:17.301206 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:17:34.363457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5061eb8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5062081f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5061ed2b90>]}


============================== 11:17:34.366058 | 3f1d627d-80ed-4b7d-8e1e-472341362299 ==============================
[0m11:17:34.366058 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:17:34.366670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select bronze.housing_prices', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:17:34.514012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f1d627d-80ed-4b7d-8e1e-472341362299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50617b3dd0>]}
[0m11:17:34.569999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f1d627d-80ed-4b7d-8e1e-472341362299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50648f2c50>]}
[0m11:17:34.570680 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:17:34.645227 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:17:34.645818 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:17:34.646145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f1d627d-80ed-4b7d-8e1e-472341362299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5063117850>]}
[0m11:17:35.935619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt_training.marts
[0m11:17:35.952089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f1d627d-80ed-4b7d-8e1e-472341362299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5060b067d0>]}
[0m11:17:36.039910 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m11:17:36.042206 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m11:17:36.056710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f1d627d-80ed-4b7d-8e1e-472341362299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50603db390>]}
[0m11:17:36.057178 [info ] [MainThread]: Found 2 models, 9 data tests, 2 sources, 433 macros
[0m11:17:36.057512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f1d627d-80ed-4b7d-8e1e-472341362299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50617ce250>]}
[0m11:17:36.059693 [info ] [MainThread]: 
[0m11:17:36.060158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:17:36.060577 [info ] [MainThread]: 
[0m11:17:36.061389 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:17:36.063219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m11:17:36.102568 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m11:17:36.102929 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m11:17:36.103195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:36.110775 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m11:17:36.111908 [debug] [ThreadPool]: On list_dwh: Close
[0m11:17:36.116215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m11:17:36.122247 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m11:17:36.122516 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m11:17:36.122744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:36.129117 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m11:17:36.129540 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m11:17:36.130004 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:17:36.132967 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m11:17:36.134260 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m11:17:36.134694 [debug] [ThreadPool]: On list_dwh_public: Close
[0m11:17:36.139789 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:36.140061 [debug] [MainThread]: On master: BEGIN
[0m11:17:36.140307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:17:36.146788 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m11:17:36.147099 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:36.147577 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:17:36.151075 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m11:17:36.152202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f1d627d-80ed-4b7d-8e1e-472341362299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5060342ed0>]}
[0m11:17:36.152616 [debug] [MainThread]: On master: ROLLBACK
[0m11:17:36.153071 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:36.153350 [debug] [MainThread]: On master: BEGIN
[0m11:17:36.153944 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:17:36.154208 [debug] [MainThread]: On master: COMMIT
[0m11:17:36.154474 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:36.154712 [debug] [MainThread]: On master: COMMIT
[0m11:17:36.155132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:17:36.155405 [debug] [MainThread]: On master: Close
[0m11:17:36.160376 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m11:17:36.160964 [info ] [Thread-1 (]: 1 of 1 START sql view model public.housing_prices .............................. [RUN]
[0m11:17:36.161421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m11:17:36.161763 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m11:17:36.170275 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m11:17:36.172191 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m11:17:36.210122 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m11:17:36.211703 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m11:17:36.212048 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m11:17:36.212349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:36.218869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m11:17:36.219295 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m11:17:36.219683 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m11:17:36.221196 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:17:36.227661 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m11:17:36.228022 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m11:17:36.228724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:17:36.244295 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m11:17:36.244727 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m11:17:36.245040 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m11:17:36.384173 [debug] [Thread-1 (]: SQL status: COMMIT in 0.138 seconds
[0m11:17:36.410147 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m11:17:36.415322 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m11:17:36.415696 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m11:17:36.416297 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:17:36.418533 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m11:17:36.420009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f1d627d-80ed-4b7d-8e1e-472341362299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f505d977e50>]}
[0m11:17:36.420570 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.26s]
[0m11:17:36.421160 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m11:17:36.423863 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:36.424250 [debug] [MainThread]: On master: BEGIN
[0m11:17:36.424798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:17:36.432952 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:17:36.433661 [debug] [MainThread]: On master: COMMIT
[0m11:17:36.434770 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:36.435313 [debug] [MainThread]: On master: COMMIT
[0m11:17:36.435933 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:17:36.436269 [debug] [MainThread]: On master: Close
[0m11:17:36.436712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:36.436962 [debug] [MainThread]: Connection 'model.airflow_dbt_training.housing_prices' was properly closed.
[0m11:17:36.437256 [info ] [MainThread]: 
[0m11:17:36.437615 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m11:17:36.438620 [debug] [MainThread]: Command end result
[0m11:17:36.464607 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m11:17:36.465956 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m11:17:36.471786 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m11:17:36.472098 [info ] [MainThread]: 
[0m11:17:36.472532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:17:36.472887 [info ] [MainThread]: 
[0m11:17:36.473302 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:17:36.474440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1603537, "process_in_blocks": "56", "process_kernel_time": 0.150653, "process_mem_max_rss": "125664", "process_out_blocks": "2808", "process_user_time": 3.103457}
[0m11:17:36.474958 [debug] [MainThread]: Command `dbt run` succeeded at 11:17:36.474847 after 2.16 seconds
[0m11:17:36.475343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5061ed8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5061ed9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50621bca10>]}
[0m11:17:36.475686 [debug] [MainThread]: Flushing usage events
[0m11:17:37.146048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:23:17.525244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf551e2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf55d18510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf551e2d50>]}


============================== 11:23:17.528253 | fcef9bfc-683f-44fa-8ae1-88ec44c086e3 ==============================
[0m11:23:17.528253 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:23:17.529022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:23:17.681411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcef9bfc-683f-44fa-8ae1-88ec44c086e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf55057150>]}
[0m11:23:17.737593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcef9bfc-683f-44fa-8ae1-88ec44c086e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf57a51990>]}
[0m11:23:17.738283 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:23:17.813423 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:23:17.928751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:23:17.929251 [debug] [MainThread]: Partial parsing: added file: airflow_dbt_training://models/bronze/location_data.sql
[0m11:23:18.182629 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt_training.marts
[0m11:23:18.202147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcef9bfc-683f-44fa-8ae1-88ec44c086e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf535d8e50>]}
[0m11:23:18.292953 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m11:23:18.295324 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m11:23:18.305359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcef9bfc-683f-44fa-8ae1-88ec44c086e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf5156bc10>]}
[0m11:23:18.305829 [info ] [MainThread]: Found 3 models, 9 data tests, 2 sources, 433 macros
[0m11:23:18.306145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcef9bfc-683f-44fa-8ae1-88ec44c086e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf53d7dc50>]}
[0m11:23:18.307886 [info ] [MainThread]: 
[0m11:23:18.308330 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:23:18.308818 [info ] [MainThread]: 
[0m11:23:18.309471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:23:18.314251 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m11:23:18.351646 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m11:23:18.352003 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m11:23:18.352260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:18.359734 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m11:23:18.361045 [debug] [ThreadPool]: On list_dwh: Close
[0m11:23:18.362376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m11:23:18.368741 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m11:23:18.369030 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m11:23:18.369263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:18.375837 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m11:23:18.376155 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m11:23:18.376522 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:23:18.379072 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m11:23:18.380355 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m11:23:18.380808 [debug] [ThreadPool]: On list_dwh_public: Close
[0m11:23:18.386191 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:18.386488 [debug] [MainThread]: On master: BEGIN
[0m11:23:18.386719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:18.393318 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:23:18.393683 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:18.394147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:23:18.397577 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m11:23:18.398935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcef9bfc-683f-44fa-8ae1-88ec44c086e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf53d35f50>]}
[0m11:23:18.399375 [debug] [MainThread]: On master: ROLLBACK
[0m11:23:18.399970 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:18.400253 [debug] [MainThread]: On master: BEGIN
[0m11:23:18.400887 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:23:18.401187 [debug] [MainThread]: On master: COMMIT
[0m11:23:18.401434 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:18.401665 [debug] [MainThread]: On master: COMMIT
[0m11:23:18.402090 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:23:18.402456 [debug] [MainThread]: On master: Close
[0m11:23:18.405960 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m11:23:18.406407 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m11:23:18.406862 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m11:23:18.407434 [info ] [Thread-1 (]: 1 of 3 START sql view model public.housing_prices .............................. [RUN]
[0m11:23:18.408098 [info ] [Thread-2 (]: 2 of 3 START sql view model public.location_data ............................... [RUN]
[0m11:23:18.408659 [info ] [Thread-3 (]: 3 of 3 START sql view model public.stg_example ................................. [RUN]
[0m11:23:18.409340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m11:23:18.410037 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m11:23:18.410606 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m11:23:18.411055 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m11:23:18.411818 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m11:23:18.412481 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m11:23:18.422100 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m11:23:18.424187 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m11:23:18.426491 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m11:23:18.427335 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m11:23:18.427808 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m11:23:18.459783 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m11:23:18.545410 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m11:23:18.546569 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m11:23:18.549603 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m11:23:18.550400 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m11:23:18.551252 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m11:23:18.551659 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m11:23:18.552128 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m11:23:18.552509 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m11:23:18.552919 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:23:18.553318 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m11:23:18.553715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:18.554317 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:23:18.560799 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m11:23:18.561539 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m11:23:18.562351 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m11:23:18.563041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:23:18.563803 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m11:23:18.564670 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m11:23:18.565128 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m11:23:18.565558 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m11:23:18.566146 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m11:23:18.567260 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:23:18.567888 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:23:18.573489 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m11:23:18.575001 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m11:23:18.578505 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m11:23:18.581819 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m11:23:18.582269 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m11:23:18.582720 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m11:23:18.583150 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m11:23:18.583937 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:23:18.589632 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m11:23:18.595484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m11:23:18.609738 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m11:23:18.613069 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m11:23:18.615338 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m11:23:18.615724 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m11:23:18.616141 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m11:23:18.616575 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m11:23:18.616982 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m11:23:18.617472 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m11:23:18.618103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:23:18.621390 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m11:23:18.621731 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m11:23:18.622030 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m11:23:18.772924 [debug] [Thread-2 (]: SQL status: COMMIT in 0.154 seconds
[0m11:23:18.782231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.159 seconds
[0m11:23:18.789650 [debug] [Thread-3 (]: SQL status: COMMIT in 0.171 seconds
[0m11:23:18.814076 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m11:23:18.815900 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m11:23:18.821624 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m11:23:18.831780 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m11:23:18.832810 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m11:23:18.833871 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m11:23:18.834527 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m11:23:18.835192 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m11:23:18.835781 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m11:23:18.836755 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:23:18.837300 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:23:18.840320 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m11:23:18.841784 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m11:23:18.844203 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcef9bfc-683f-44fa-8ae1-88ec44c086e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf539653d0>]}
[0m11:23:18.845205 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.43s]
[0m11:23:18.845812 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcef9bfc-683f-44fa-8ae1-88ec44c086e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf535c0150>]}
[0m11:23:18.846581 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m11:23:18.847028 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m11:23:18.847765 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.43s]
[0m11:23:18.849976 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m11:23:18.850884 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m11:23:18.851855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcef9bfc-683f-44fa-8ae1-88ec44c086e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf54583090>]}
[0m11:23:18.852661 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.44s]
[0m11:23:18.853501 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m11:23:18.856367 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:18.856940 [debug] [MainThread]: On master: BEGIN
[0m11:23:18.857436 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:18.867270 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m11:23:18.868720 [debug] [MainThread]: On master: COMMIT
[0m11:23:18.869225 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:18.869584 [debug] [MainThread]: On master: COMMIT
[0m11:23:18.870237 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:23:18.870640 [debug] [MainThread]: On master: Close
[0m11:23:18.871128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:18.871476 [debug] [MainThread]: Connection 'model.airflow_dbt_training.housing_prices' was properly closed.
[0m11:23:18.871703 [debug] [MainThread]: Connection 'model.airflow_dbt_training.location_data' was properly closed.
[0m11:23:18.871914 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_example' was properly closed.
[0m11:23:18.872233 [info ] [MainThread]: 
[0m11:23:18.872760 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m11:23:18.874419 [debug] [MainThread]: Command end result
[0m11:23:18.905657 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m11:23:18.907059 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m11:23:18.912744 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m11:23:18.913015 [info ] [MainThread]: 
[0m11:23:18.913365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:18.913729 [info ] [MainThread]: 
[0m11:23:18.914220 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:23:18.915648 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4406519, "process_in_blocks": "16", "process_kernel_time": 0.159689, "process_mem_max_rss": "126916", "process_out_blocks": "2752", "process_user_time": 2.375385}
[0m11:23:18.916438 [debug] [MainThread]: Command `dbt run` succeeded at 11:23:18.916189 after 1.44 seconds
[0m11:23:18.916917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf593a4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf593a4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf51508210>]}
[0m11:23:18.917365 [debug] [MainThread]: Flushing usage events
[0m11:23:19.619708 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:12.726252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d24b3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d2ff4510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d24b3710>]}


============================== 11:35:12.728916 | 24c80edd-58bc-42eb-baa9-fb34b43d70c5 ==============================
[0m11:35:12.728916 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:35:12.729435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:35:12.880359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24c80edd-58bc-42eb-baa9-fb34b43d70c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d1b8af90>]}
[0m11:35:12.937702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24c80edd-58bc-42eb-baa9-fb34b43d70c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d4d2d990>]}
[0m11:35:12.938409 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:35:13.015296 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:35:13.156884 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:35:13.157547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24c80edd-58bc-42eb-baa9-fb34b43d70c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d29db590>]}
[0m11:35:14.114751 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "location_data".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("location_data").
  
  To fix this, change the name of one of these resources:
  - model.airflow_dbt_training.location_data (models/silver/location_data.sql)
  - model.airflow_dbt_training.location_data (models/bronze/location_data.sql)
[0m11:35:14.115865 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4406168, "process_in_blocks": "0", "process_kernel_time": 0.150103, "process_mem_max_rss": "112332", "process_out_blocks": "8", "process_user_time": 2.591792}
[0m11:35:14.116382 [debug] [MainThread]: Command `dbt run` failed at 11:35:14.116270 after 1.44 seconds
[0m11:35:14.116933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d2315850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d230f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d0b50950>]}
[0m11:35:14.117483 [debug] [MainThread]: Flushing usage events
[0m11:35:14.823269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:01:05.538384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323615e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3236392d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32364b1790>]}


============================== 12:01:05.541272 | e7395658-83b7-43c2-85ec-283fd0cf067a ==============================
[0m12:01:05.541272 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:01:05.541938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:01:05.748101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7395658-83b7-43c2-85ec-283fd0cf067a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323599d350>]}
[0m12:01:05.821527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7395658-83b7-43c2-85ec-283fd0cf067a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3238b956d0>]}
[0m12:01:05.822509 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:01:05.920157 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:01:06.025577 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:01:06.026005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7395658-83b7-43c2-85ec-283fd0cf067a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3236877690>]}
[0m12:01:07.382711 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt_training.gold
[0m12:01:07.398878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7395658-83b7-43c2-85ec-283fd0cf067a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3234156b90>]}
[0m12:01:07.501085 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:01:07.503713 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:01:07.515713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7395658-83b7-43c2-85ec-283fd0cf067a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323278fe10>]}
[0m12:01:07.516185 [info ] [MainThread]: Found 5 models, 23 data tests, 2 sources, 433 macros
[0m12:01:07.516504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7395658-83b7-43c2-85ec-283fd0cf067a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3232749910>]}
[0m12:01:07.518911 [info ] [MainThread]: 
[0m12:01:07.519443 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:01:07.520457 [info ] [MainThread]: 
[0m12:01:07.521285 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:01:07.526619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:01:07.532720 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:01:07.533713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:01:07.573615 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:01:07.574055 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:01:07.574433 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:01:07.574818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:07.575141 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:01:07.575492 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:01:07.576107 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:01:07.576485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:07.576868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:07.583334 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m12:01:07.584899 [debug] [ThreadPool]: On list_dwh: Close
[0m12:01:07.585383 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m12:01:07.585832 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m12:01:07.587320 [debug] [ThreadPool]: On list_dwh: Close
[0m12:01:07.588393 [debug] [ThreadPool]: On list_dwh: Close
[0m12:01:07.589518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now create_dwh_public_bronze)
[0m12:01:07.589952 [debug] [ThreadPool]: Creating schema "database: "dwh"
schema: "public_bronze"
"
[0m12:01:07.595539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now create_dwh_public_silver)
[0m12:01:07.596291 [debug] [ThreadPool]: Using postgres connection "create_dwh_public_bronze"
[0m12:01:07.596729 [debug] [ThreadPool]: Creating schema "database: "dwh"
schema: "public_silver"
"
[0m12:01:07.597137 [debug] [ThreadPool]: On create_dwh_public_bronze: BEGIN
[0m12:01:07.599306 [debug] [ThreadPool]: Using postgres connection "create_dwh_public_silver"
[0m12:01:07.599656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:07.600075 [debug] [ThreadPool]: On create_dwh_public_silver: BEGIN
[0m12:01:07.600752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:07.607040 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:01:07.607544 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:01:07.607994 [debug] [ThreadPool]: Using postgres connection "create_dwh_public_silver"
[0m12:01:07.608515 [debug] [ThreadPool]: Using postgres connection "create_dwh_public_bronze"
[0m12:01:07.609053 [debug] [ThreadPool]: On create_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "create_dwh_public_silver"} */
create schema if not exists "public_silver"
[0m12:01:07.609516 [debug] [ThreadPool]: On create_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "create_dwh_public_bronze"} */
create schema if not exists "public_bronze"
[0m12:01:07.610525 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:01:07.611468 [debug] [ThreadPool]: On create_dwh_public_silver: COMMIT
[0m12:01:07.611782 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m12:01:07.612116 [debug] [ThreadPool]: Using postgres connection "create_dwh_public_silver"
[0m12:01:07.612934 [debug] [ThreadPool]: On create_dwh_public_bronze: COMMIT
[0m12:01:07.613290 [debug] [ThreadPool]: On create_dwh_public_silver: COMMIT
[0m12:01:07.613658 [debug] [ThreadPool]: Using postgres connection "create_dwh_public_bronze"
[0m12:01:07.614066 [debug] [ThreadPool]: On create_dwh_public_bronze: COMMIT
[0m12:01:07.617372 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m12:01:07.617735 [debug] [ThreadPool]: On create_dwh_public_silver: Close
[0m12:01:07.621184 [debug] [ThreadPool]: SQL status: COMMIT in 0.007 seconds
[0m12:01:07.621466 [debug] [ThreadPool]: On create_dwh_public_bronze: Close
[0m12:01:07.623101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dwh_public_bronze, now list_dwh_public_bronze)
[0m12:01:07.623681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dwh_public_silver, now list_dwh_public_silver)
[0m12:01:07.629922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m12:01:07.631602 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:01:07.633906 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:01:07.636338 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:01:07.636736 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m12:01:07.637092 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m12:01:07.637418 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m12:01:07.637747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:07.638091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:07.638424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:07.645598 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:01:07.646087 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:01:07.646423 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:01:07.646788 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:01:07.647260 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:01:07.647820 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m12:01:07.648428 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:01:07.649050 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:01:07.649718 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:01:07.652132 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:01:07.652497 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m12:01:07.653765 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m12:01:07.654153 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m12:01:07.655451 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m12:01:07.656625 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m12:01:07.657093 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m12:01:07.657522 [debug] [ThreadPool]: On list_dwh_public: Close
[0m12:01:07.658214 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m12:01:07.665981 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:07.666325 [debug] [MainThread]: On master: BEGIN
[0m12:01:07.666554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:01:07.673237 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:01:07.673598 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:07.674140 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:01:07.678109 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m12:01:07.679831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7395658-83b7-43c2-85ec-283fd0cf067a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3235938350>]}
[0m12:01:07.680317 [debug] [MainThread]: On master: ROLLBACK
[0m12:01:07.680772 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:07.681038 [debug] [MainThread]: On master: BEGIN
[0m12:01:07.681622 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:01:07.681901 [debug] [MainThread]: On master: COMMIT
[0m12:01:07.682156 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:07.682436 [debug] [MainThread]: On master: COMMIT
[0m12:01:07.682847 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:01:07.683105 [debug] [MainThread]: On master: Close
[0m12:01:07.685850 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m12:01:07.686451 [info ] [Thread-1 (]: 1 of 5 START sql view model public_bronze.housing_prices ....................... [RUN]
[0m12:01:07.686953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now model.airflow_dbt_training.housing_prices)
[0m12:01:07.687328 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m12:01:07.692918 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m12:01:07.697377 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m12:01:07.698006 [info ] [Thread-2 (]: 2 of 5 START sql view model public_bronze.location_data ........................ [RUN]
[0m12:01:07.698528 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m12:01:07.699344 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.location_data)
[0m12:01:07.699835 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m12:01:07.700667 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_example ................................. [RUN]
[0m12:01:07.701402 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m12:01:07.702194 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m12:01:07.702856 [info ] [Thread-4 (]: 4 of 5 START sql view model public_silver.stg_location_data .................... [RUN]
[0m12:01:07.703542 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now model.airflow_dbt_training.stg_example)
[0m12:01:07.716589 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m12:01:07.725153 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m12:01:07.735522 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m12:01:07.749104 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m12:01:07.749827 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m12:01:07.752230 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m12:01:07.752868 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m12:01:07.756238 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m12:01:07.756744 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:01:07.760564 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m12:01:07.761265 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m12:01:07.761715 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m12:01:07.762339 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m12:01:07.762846 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:01:07.766699 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m12:01:07.767111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:07.771412 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m12:01:07.771934 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m12:01:07.773190 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:01:07.773842 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:01:07.774402 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:01:07.774914 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m12:01:07.775563 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m12:01:07.776089 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:01:07.776580 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:01:07.779618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:01:07.780175 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:01:07.780647 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public_bronze"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m12:01:07.782447 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:01:07.791882 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:01:07.792884 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m12:01:07.793346 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m12:01:07.793827 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m12:01:07.794258 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m12:01:07.794767 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:01:07.795193 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:01:07.795571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:01:07.795990 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:01:07.796413 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m12:01:07.796887 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public_silver"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m12:01:07.807824 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public_bronze"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m12:01:07.814594 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m12:01:07.815362 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:01:07.815730 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m12:01:07.816242 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:01:07.819777 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:01:07.820216 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:01:07.820690 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data__dbt_tmp" rename to "location_data"
[0m12:01:07.821088 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:01:07.821455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:01:07.824727 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:01:07.828027 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:01:07.834910 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public_bronze"."housing_prices__dbt_backup"
[0m12:01:07.835363 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m12:01:07.835782 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m12:01:07.836239 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m12:01:07.841801 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:01:07.843227 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m12:01:07.843928 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public_bronze"."housing_prices__dbt_backup" cascade
[0m12:01:07.844489 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:01:07.844889 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:01:07.845326 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:01:07.848846 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:01:07.849334 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:01:07.849907 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m12:01:07.851301 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m12:01:07.851699 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m12:01:07.854229 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m12:01:07.854843 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:01:07.856634 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:01:07.857153 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m12:01:07.860831 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m12:01:07.861267 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m12:01:07.861638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7395658-83b7-43c2-85ec-283fd0cf067a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3230b3b990>]}
[0m12:01:07.862212 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:01:07.865039 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public_bronze"."location_data__dbt_backup"
[0m12:01:07.865860 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_bronze.housing_prices .................. [[32mCREATE VIEW[0m in 0.17s]
[0m12:01:07.866355 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m12:01:07.866797 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m12:01:07.867579 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:01:07.868223 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m12:01:07.871476 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_silver"."stg_location_data__dbt_backup"
[0m12:01:07.872158 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public_bronze"."location_data__dbt_backup" cascade
[0m12:01:07.873608 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:01:07.874062 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m12:01:07.874599 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public_silver"."stg_location_data__dbt_backup" cascade
[0m12:01:07.875638 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m12:01:07.876144 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:01:07.875215 [info ] [Thread-1 (]: 5 of 5 START sql view model public_silver.stg_housing_prices ................... [RUN]
[0m12:01:07.880404 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m12:01:07.881113 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:01:07.882570 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m12:01:07.883056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m12:01:07.883865 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:01:07.885503 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m12:01:07.886069 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m12:01:07.886611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7395658-83b7-43c2-85ec-283fd0cf067a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323416fa50>]}
[0m12:01:07.887082 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m12:01:07.890445 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:01:07.891013 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7395658-83b7-43c2-85ec-283fd0cf067a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3230b2f050>]}
[0m12:01:07.891728 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_bronze.location_data ................... [[32mCREATE VIEW[0m in 0.19s]
[0m12:01:07.894212 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m12:01:07.894888 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m12:01:07.892993 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public_silver.stg_location_data ............... [[32mCREATE VIEW[0m in 0.17s]
[0m12:01:07.902726 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:01:07.903655 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m12:01:07.904077 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.012 seconds
[0m12:01:07.905908 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m12:01:07.906366 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:01:07.906713 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m12:01:07.907032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:07.907742 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7395658-83b7-43c2-85ec-283fd0cf067a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3230ad4110>]}
[0m12:01:07.908718 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m12:01:07.909454 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m12:01:07.914955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:01:07.915744 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:01:07.916575 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public_silver"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public_bronze"."housing_prices"
)

SELECT
    id,
    date,
    region,
    price,
    EXTRACT(YEAR FROM date) as year,
    EXTRACT(MONTH FROM date) as month,
    EXTRACT(DOW FROM date) as day_of_week
FROM source
  );
[0m12:01:07.918004 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function pg_catalog.extract(unknown, text) does not exist
LINE 16:     EXTRACT(YEAR FROM date) as year,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m12:01:07.918530 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: ROLLBACK
[0m12:01:07.919119 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m12:01:07.925690 [debug] [Thread-1 (]: Database Error in model stg_housing_prices (models/silver/stg_housing_prices.sql)
  function pg_catalog.extract(unknown, text) does not exist
  LINE 16:     EXTRACT(YEAR FROM date) as year,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/airflow_dbt_training/models/silver/stg_housing_prices.sql
[0m12:01:07.926582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7395658-83b7-43c2-85ec-283fd0cf067a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3230acff10>]}
[0m12:01:07.927539 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model public_silver.stg_housing_prices .......... [[31mERROR[0m in 0.04s]
[0m12:01:07.928509 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m12:01:07.929386 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.stg_housing_prices' to be skipped because of status 'error'.  Reason: Database Error in model stg_housing_prices (models/silver/stg_housing_prices.sql)
  function pg_catalog.extract(unknown, text) does not exist
  LINE 16:     EXTRACT(YEAR FROM date) as year,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/airflow_dbt_training/models/silver/stg_housing_prices.sql.
[0m12:01:07.932611 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:07.933261 [debug] [MainThread]: On master: BEGIN
[0m12:01:07.933842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:01:07.942485 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:01:07.942948 [debug] [MainThread]: On master: COMMIT
[0m12:01:07.943503 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:07.944017 [debug] [MainThread]: On master: COMMIT
[0m12:01:07.944648 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:01:07.945103 [debug] [MainThread]: On master: Close
[0m12:01:07.945641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:07.945915 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m12:01:07.946171 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_example' was properly closed.
[0m12:01:07.946389 [debug] [MainThread]: Connection 'model.airflow_dbt_training.location_data' was properly closed.
[0m12:01:07.946663 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_location_data' was properly closed.
[0m12:01:07.947087 [info ] [MainThread]: 
[0m12:01:07.947390 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m12:01:07.949078 [debug] [MainThread]: Command end result
[0m12:01:07.979879 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:01:07.981450 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:01:07.987342 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:01:07.987671 [info ] [MainThread]: 
[0m12:01:07.987989 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:01:07.988301 [info ] [MainThread]: 
[0m12:01:07.988729 [error] [MainThread]:   Database Error in model stg_housing_prices (models/silver/stg_housing_prices.sql)
  function pg_catalog.extract(unknown, text) does not exist
  LINE 16:     EXTRACT(YEAR FROM date) as year,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/airflow_dbt_training/models/silver/stg_housing_prices.sql
[0m12:01:07.989189 [info ] [MainThread]: 
[0m12:01:07.989770 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:01:07.991020 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5041275, "process_in_blocks": "8", "process_kernel_time": 0.159395, "process_mem_max_rss": "129800", "process_out_blocks": "3056", "process_user_time": 3.646174}
[0m12:01:07.991503 [debug] [MainThread]: Command `dbt run` failed at 12:01:07.991402 after 2.50 seconds
[0m12:01:07.991875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323615d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3230afc790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323615da50>]}
[0m12:01:07.992205 [debug] [MainThread]: Flushing usage events
[0m12:01:08.708754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:01:45.424082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9996e6e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9996e6dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9996e6e490>]}


============================== 12:01:45.426704 | 9ad84f7a-3b25-4144-b428-871b6c95599b ==============================
[0m12:01:45.426704 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:01:45.427213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:01:45.578654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ad84f7a-3b25-4144-b428-871b6c95599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9996d47c90>]}
[0m12:01:45.638762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ad84f7a-3b25-4144-b428-871b6c95599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99996df610>]}
[0m12:01:45.639497 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:01:45.713084 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:01:45.837090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:01:45.837824 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/silver/stg_housing_prices.sql
[0m12:01:46.283800 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt_training.gold
[0m12:01:46.298982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ad84f7a-3b25-4144-b428-871b6c95599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99951ef390>]}
[0m12:01:46.392123 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:01:46.394515 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:01:46.406024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ad84f7a-3b25-4144-b428-871b6c95599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99951ca210>]}
[0m12:01:46.406548 [info ] [MainThread]: Found 5 models, 23 data tests, 2 sources, 433 macros
[0m12:01:46.406906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad84f7a-3b25-4144-b428-871b6c95599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9994d08290>]}
[0m12:01:46.409259 [info ] [MainThread]: 
[0m12:01:46.409703 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:01:46.410085 [info ] [MainThread]: 
[0m12:01:46.411167 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:01:46.416760 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:01:46.417582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:01:46.418362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:01:46.505841 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:01:46.506241 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:01:46.506579 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:01:46.506916 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:01:46.507278 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:01:46.507659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:46.508036 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:01:46.508381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:46.508982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:46.516025 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m12:01:46.517435 [debug] [ThreadPool]: On list_dwh: Close
[0m12:01:46.517860 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m12:01:46.518316 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m12:01:46.519405 [debug] [ThreadPool]: On list_dwh: Close
[0m12:01:46.520740 [debug] [ThreadPool]: On list_dwh: Close
[0m12:01:46.522683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_silver)
[0m12:01:46.528488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_bronze)
[0m12:01:46.533314 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:01:46.534070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m12:01:46.535721 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:01:46.536052 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m12:01:46.538331 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:01:46.538680 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m12:01:46.539023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:46.539355 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m12:01:46.539675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:46.540269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:46.547117 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:01:46.547749 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:01:46.548084 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:01:46.548437 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:01:46.548886 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:01:46.549380 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:01:46.550022 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:01:46.550437 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:01:46.550973 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m12:01:46.553376 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:01:46.554602 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m12:01:46.555148 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m12:01:46.556355 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m12:01:46.556873 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m12:01:46.557410 [debug] [ThreadPool]: On list_dwh_public: Close
[0m12:01:46.557897 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m12:01:46.560822 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m12:01:46.561324 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m12:01:46.566910 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:46.567203 [debug] [MainThread]: On master: BEGIN
[0m12:01:46.567434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:01:46.574035 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:01:46.574436 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:46.575237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:01:46.579822 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m12:01:46.582056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad84f7a-3b25-4144-b428-871b6c95599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998d70f190>]}
[0m12:01:46.582433 [debug] [MainThread]: On master: ROLLBACK
[0m12:01:46.583432 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:46.583733 [debug] [MainThread]: On master: BEGIN
[0m12:01:46.584324 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:01:46.584850 [debug] [MainThread]: On master: COMMIT
[0m12:01:46.585451 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:46.586108 [debug] [MainThread]: On master: COMMIT
[0m12:01:46.586616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:01:46.586955 [debug] [MainThread]: On master: Close
[0m12:01:46.590651 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m12:01:46.591094 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m12:01:46.591668 [info ] [Thread-1 (]: 1 of 5 START sql view model public_bronze.housing_prices ....................... [RUN]
[0m12:01:46.592249 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m12:01:46.593410 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m12:01:46.594678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now model.airflow_dbt_training.housing_prices)
[0m12:01:46.592743 [info ] [Thread-2 (]: 2 of 5 START sql view model public_bronze.location_data ........................ [RUN]
[0m12:01:46.595852 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_example ................................. [RUN]
[0m12:01:46.596703 [info ] [Thread-4 (]: 4 of 5 START sql view model public_silver.stg_location_data .................... [RUN]
[0m12:01:46.597667 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m12:01:46.598560 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now model.airflow_dbt_training.location_data)
[0m12:01:46.599251 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.stg_example)
[0m12:01:46.600154 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m12:01:46.606156 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m12:01:46.611919 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m12:01:46.612422 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m12:01:46.612857 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m12:01:46.615951 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m12:01:46.618367 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m12:01:46.618829 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m12:01:46.622443 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m12:01:46.639241 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m12:01:46.639831 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m12:01:46.666152 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m12:01:46.669969 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m12:01:46.670473 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m12:01:46.674333 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m12:01:46.675372 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:01:46.679249 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m12:01:46.679758 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:01:46.680446 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m12:01:46.680868 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:01:46.681458 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m12:01:46.681848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:46.682387 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m12:01:46.682799 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:01:46.683210 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:01:46.683789 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:01:46.684331 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m12:01:46.685163 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:01:46.691325 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m12:01:46.692205 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m12:01:46.693246 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:01:46.693883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:01:46.694485 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:01:46.695160 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m12:01:46.695658 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:01:46.696328 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m12:01:46.697099 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public_silver"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m12:01:46.697713 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public_bronze"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m12:01:46.698433 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:01:46.698953 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:01:46.699472 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public_bronze"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m12:01:46.699924 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:01:46.705733 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:01:46.707773 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:01:46.708276 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:01:46.711965 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:01:46.715653 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:01:46.716132 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m12:01:46.719774 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:01:46.720221 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m12:01:46.720681 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices" rename to "housing_prices__dbt_backup"
[0m12:01:46.721231 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data" rename to "location_data__dbt_backup"
[0m12:01:46.721752 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:01:46.722182 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:01:46.725771 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:01:46.726337 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:01:46.729626 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:01:46.730083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:01:46.730530 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m12:01:46.733702 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:01:46.734159 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m12:01:46.738784 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:01:46.739394 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data__dbt_tmp" rename to "location_data"
[0m12:01:46.739931 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:01:46.740309 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:01:46.740723 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m12:01:46.751647 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m12:01:46.760184 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m12:01:46.761720 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m12:01:46.763257 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m12:01:46.763719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:01:46.764098 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:01:46.764521 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:01:46.764960 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:01:46.766422 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m12:01:46.766829 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m12:01:46.767231 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m12:01:46.767632 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m12:01:46.768030 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:01:46.768663 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m12:01:46.771088 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m12:01:46.778268 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m12:01:46.778682 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m12:01:46.778963 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m12:01:46.779421 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m12:01:46.782091 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public_bronze"."location_data__dbt_backup"
[0m12:01:46.784807 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public_bronze"."housing_prices__dbt_backup"
[0m12:01:46.790517 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:01:46.793268 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_silver"."stg_location_data__dbt_backup"
[0m12:01:46.794029 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:01:46.794709 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:01:46.795130 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m12:01:46.795956 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:01:46.796389 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public_bronze"."location_data__dbt_backup" cascade
[0m12:01:46.796803 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public_bronze"."housing_prices__dbt_backup" cascade
[0m12:01:46.797380 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public_silver"."stg_location_data__dbt_backup" cascade
[0m12:01:46.800121 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:01:46.802682 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m12:01:46.803267 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:01:46.803620 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m12:01:46.804092 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m12:01:46.806704 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m12:01:46.807205 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad84f7a-3b25-4144-b428-871b6c95599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9994d5d1d0>]}
[0m12:01:46.808661 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m12:01:46.810085 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m12:01:46.810861 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.21s]
[0m12:01:46.811463 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad84f7a-3b25-4144-b428-871b6c95599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9994d0c090>]}
[0m12:01:46.812239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad84f7a-3b25-4144-b428-871b6c95599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9994dd1290>]}
[0m12:01:46.812886 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad84f7a-3b25-4144-b428-871b6c95599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998d8bcb10>]}
[0m12:01:46.813729 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m12:01:46.814543 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_bronze.location_data ................... [[32mCREATE VIEW[0m in 0.21s]
[0m12:01:46.815409 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_bronze.housing_prices .................. [[32mCREATE VIEW[0m in 0.22s]
[0m12:01:46.816370 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public_silver.stg_location_data ............... [[32mCREATE VIEW[0m in 0.21s]
[0m12:01:46.817858 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m12:01:46.818533 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m12:01:46.819153 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m12:01:46.820498 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m12:01:46.821147 [info ] [Thread-4 (]: 5 of 5 START sql view model public_silver.stg_housing_prices ................... [RUN]
[0m12:01:46.821767 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m12:01:46.822178 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m12:01:46.825744 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:01:46.826439 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m12:01:46.830837 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:01:46.831518 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:01:46.831933 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m12:01:46.832290 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:01:46.839265 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m12:01:46.839916 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:01:46.840463 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public_silver"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public_bronze"."housing_prices"
)

SELECT
    id,
    date,
    region,
    price,
    DATE_PART('year', date) as year,
    DATE_PART('month', date) as month,
    DATE_PART('dow', date) as day_of_week
FROM source
  );
[0m12:01:46.841863 [debug] [Thread-4 (]: Postgres adapter: Postgres error: function date_part(unknown, text) does not exist
LINE 16:     DATE_PART('year', date) as year,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m12:01:46.842340 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: ROLLBACK
[0m12:01:46.842990 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m12:01:46.847979 [debug] [Thread-4 (]: Database Error in model stg_housing_prices (models/silver/stg_housing_prices.sql)
  function date_part(unknown, text) does not exist
  LINE 16:     DATE_PART('year', date) as year,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/airflow_dbt_training/models/silver/stg_housing_prices.sql
[0m12:01:46.848664 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad84f7a-3b25-4144-b428-871b6c95599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998f116450>]}
[0m12:01:46.849276 [error] [Thread-4 (]: 5 of 5 ERROR creating sql view model public_silver.stg_housing_prices .......... [[31mERROR[0m in 0.03s]
[0m12:01:46.850322 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m12:01:46.851380 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.stg_housing_prices' to be skipped because of status 'error'.  Reason: Database Error in model stg_housing_prices (models/silver/stg_housing_prices.sql)
  function date_part(unknown, text) does not exist
  LINE 16:     DATE_PART('year', date) as year,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/airflow_dbt_training/models/silver/stg_housing_prices.sql.
[0m12:01:46.854189 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:46.854583 [debug] [MainThread]: On master: BEGIN
[0m12:01:46.854921 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:01:46.863641 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:01:46.864241 [debug] [MainThread]: On master: COMMIT
[0m12:01:46.864725 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:46.865204 [debug] [MainThread]: On master: COMMIT
[0m12:01:46.865967 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:01:46.866322 [debug] [MainThread]: On master: Close
[0m12:01:46.866953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:46.867523 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_example' was properly closed.
[0m12:01:46.868049 [debug] [MainThread]: Connection 'model.airflow_dbt_training.housing_prices' was properly closed.
[0m12:01:46.868958 [debug] [MainThread]: Connection 'model.airflow_dbt_training.location_data' was properly closed.
[0m12:01:46.869344 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m12:01:46.869927 [info ] [MainThread]: 
[0m12:01:46.870518 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m12:01:46.872968 [debug] [MainThread]: Command end result
[0m12:01:46.905737 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:01:46.907179 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:01:46.912948 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:01:46.913233 [info ] [MainThread]: 
[0m12:01:46.913577 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:01:46.913869 [info ] [MainThread]: 
[0m12:01:46.914361 [error] [MainThread]:   Database Error in model stg_housing_prices (models/silver/stg_housing_prices.sql)
  function date_part(unknown, text) does not exist
  LINE 16:     DATE_PART('year', date) as year,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/airflow_dbt_training/models/silver/stg_housing_prices.sql
[0m12:01:46.914784 [info ] [MainThread]: 
[0m12:01:46.915202 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:01:46.916166 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5423933, "process_in_blocks": "0", "process_kernel_time": 0.159301, "process_mem_max_rss": "130272", "process_out_blocks": "3064", "process_user_time": 2.668296}
[0m12:01:46.916712 [debug] [MainThread]: Command `dbt run` failed at 12:01:46.916607 after 1.54 seconds
[0m12:01:46.917105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9996cbf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9996ea7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9996ea70d0>]}
[0m12:01:46.917525 [debug] [MainThread]: Flushing usage events
[0m12:01:47.606320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:20.487953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498334ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4984070790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498347fc90>]}


============================== 12:02:20.490636 | c4f784c0-d332-42f0-86fc-d1a047707d56 ==============================
[0m12:02:20.490636 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:02:20.491145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:02:20.640902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4f784c0-d332-42f0-86fc-d1a047707d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4982b77b50>]}
[0m12:02:20.699276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4f784c0-d332-42f0-86fc-d1a047707d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4985d8f0d0>]}
[0m12:02:20.699968 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:02:20.775415 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:02:20.900015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:02:20.900715 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/silver/stg_housing_prices.sql
[0m12:02:21.346482 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt_training.gold
[0m12:02:21.362414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4f784c0-d332-42f0-86fc-d1a047707d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4985d8fdd0>]}
[0m12:02:21.456190 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:02:21.458643 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:02:21.470081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4f784c0-d332-42f0-86fc-d1a047707d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498017c910>]}
[0m12:02:21.470561 [info ] [MainThread]: Found 5 models, 23 data tests, 2 sources, 433 macros
[0m12:02:21.470886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4f784c0-d332-42f0-86fc-d1a047707d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498133cb50>]}
[0m12:02:21.473321 [info ] [MainThread]: 
[0m12:02:21.473796 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:02:21.474121 [info ] [MainThread]: 
[0m12:02:21.474860 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:02:21.480361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:02:21.481205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:02:21.492464 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:02:21.573174 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:02:21.573584 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:02:21.573916 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:02:21.574242 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:02:21.574647 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:02:21.574992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:21.575348 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:02:21.575709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:21.576284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:21.583450 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m12:02:21.584879 [debug] [ThreadPool]: On list_dwh: Close
[0m12:02:21.585376 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m12:02:21.586592 [debug] [ThreadPool]: On list_dwh: Close
[0m12:02:21.587132 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m12:02:21.588296 [debug] [ThreadPool]: On list_dwh: Close
[0m12:02:21.590139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_bronze)
[0m12:02:21.590676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m12:02:21.597265 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:02:21.599336 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:02:21.599945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_silver)
[0m12:02:21.600437 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m12:02:21.600798 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m12:02:21.603008 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:02:21.603427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:21.603759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:21.604137 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m12:02:21.604895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:21.610814 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:02:21.611353 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:02:21.611696 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:02:21.612161 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:02:21.612554 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:02:21.612910 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:02:21.613389 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:02:21.614014 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:02:21.614494 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m12:02:21.617075 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:02:21.617622 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:02:21.618859 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m12:02:21.619215 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m12:02:21.620347 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m12:02:21.621583 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m12:02:21.621945 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m12:02:21.622426 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m12:02:21.623202 [debug] [ThreadPool]: On list_dwh_public: Close
[0m12:02:21.630304 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:21.630590 [debug] [MainThread]: On master: BEGIN
[0m12:02:21.630825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:21.637753 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:02:21.638112 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:21.638605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:02:21.642885 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m12:02:21.645172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4f784c0-d332-42f0-86fc-d1a047707d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4979ba93d0>]}
[0m12:02:21.645553 [debug] [MainThread]: On master: ROLLBACK
[0m12:02:21.645999 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:21.646246 [debug] [MainThread]: On master: BEGIN
[0m12:02:21.646818 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:02:21.647110 [debug] [MainThread]: On master: COMMIT
[0m12:02:21.647451 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:21.647734 [debug] [MainThread]: On master: COMMIT
[0m12:02:21.648136 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:02:21.648409 [debug] [MainThread]: On master: Close
[0m12:02:21.651791 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m12:02:21.652242 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m12:02:21.652734 [info ] [Thread-1 (]: 1 of 5 START sql view model public_bronze.housing_prices ....................... [RUN]
[0m12:02:21.653783 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m12:02:21.654513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m12:02:21.654945 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m12:02:21.653402 [info ] [Thread-2 (]: 2 of 5 START sql view model public_bronze.location_data ........................ [RUN]
[0m12:02:21.656047 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m12:02:21.655603 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_example ................................. [RUN]
[0m12:02:21.656712 [info ] [Thread-4 (]: 4 of 5 START sql view model public_silver.stg_location_data .................... [RUN]
[0m12:02:21.657351 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now model.airflow_dbt_training.location_data)
[0m12:02:21.666910 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m12:02:21.667476 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now model.airflow_dbt_training.stg_example)
[0m12:02:21.668331 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m12:02:21.668771 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m12:02:21.669312 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m12:02:21.669743 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m12:02:21.670168 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m12:02:21.672632 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m12:02:21.675001 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m12:02:21.688578 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m12:02:21.701783 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m12:02:21.708029 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m12:02:21.732710 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m12:02:21.733177 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m12:02:21.734683 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m12:02:21.737622 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m12:02:21.741460 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m12:02:21.742024 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:02:21.742776 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:02:21.743295 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:02:21.743852 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m12:02:21.744308 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:02:21.744736 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m12:02:21.745156 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m12:02:21.745558 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:02:21.745969 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m12:02:21.746364 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:02:21.746761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:21.747386 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:02:21.753463 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m12:02:21.754678 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:02:21.755653 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m12:02:21.756308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m12:02:21.756870 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m12:02:21.757416 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:02:21.757919 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m12:02:21.758564 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:02:21.759121 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:02:21.759554 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public_bronze"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m12:02:21.759975 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:02:21.760441 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public_bronze"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m12:02:21.767775 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:02:21.768421 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public_silver"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m12:02:21.768857 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:02:21.769413 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m12:02:21.773239 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:02:21.773848 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:02:21.774321 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:02:21.774854 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices" rename to "housing_prices__dbt_backup"
[0m12:02:21.775248 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:02:21.778924 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:02:21.782496 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:02:21.785892 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:02:21.786390 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data" rename to "location_data__dbt_backup"
[0m12:02:21.786885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:02:21.787603 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m12:02:21.788192 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m12:02:21.791414 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:02:21.791921 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:02:21.792387 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:02:21.792814 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m12:02:21.793229 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:02:21.796602 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:02:21.801105 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:02:21.812241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m12:02:21.820544 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m12:02:21.821038 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data__dbt_tmp" rename to "location_data"
[0m12:02:21.821546 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m12:02:21.823041 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m12:02:21.823515 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:02:21.824120 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:02:21.824697 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m12:02:21.825082 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:02:21.825589 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m12:02:21.825979 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:02:21.827593 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m12:02:21.829253 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m12:02:21.829719 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m12:02:21.830142 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:02:21.830567 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:02:21.836257 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m12:02:21.838170 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m12:02:21.838617 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m12:02:21.839029 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m12:02:21.841753 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public_bronze"."housing_prices__dbt_backup"
[0m12:02:21.847458 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:02:21.848416 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:02:21.848864 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m12:02:21.849323 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public_bronze"."housing_prices__dbt_backup" cascade
[0m12:02:21.850580 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m12:02:21.853358 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public_bronze"."location_data__dbt_backup"
[0m12:02:21.853840 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:02:21.854231 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:02:21.854609 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:02:21.855292 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:02:21.857799 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m12:02:21.860589 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_silver"."stg_location_data__dbt_backup"
[0m12:02:21.861947 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m12:02:21.862366 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public_bronze"."location_data__dbt_backup" cascade
[0m12:02:21.863197 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:02:21.864931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4f784c0-d332-42f0-86fc-d1a047707d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4979b49710>]}
[0m12:02:21.865576 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4f784c0-d332-42f0-86fc-d1a047707d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4979b015d0>]}
[0m12:02:21.866108 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public_silver"."stg_location_data__dbt_backup" cascade
[0m12:02:21.866863 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_bronze.housing_prices .................. [[32mCREATE VIEW[0m in 0.21s]
[0m12:02:21.867588 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m12:02:21.868604 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m12:02:21.869446 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m12:02:21.869954 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:02:21.872601 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m12:02:21.873378 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:02:21.873874 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m12:02:21.874665 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4f784c0-d332-42f0-86fc-d1a047707d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4979b02c10>]}
[0m12:02:21.876307 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m12:02:21.876988 [info ] [Thread-1 (]: 5 of 5 START sql view model public_silver.stg_housing_prices ................... [RUN]
[0m12:02:21.879069 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4f784c0-d332-42f0-86fc-d1a047707d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4979b6e290>]}
[0m12:02:21.877805 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_bronze.location_data ................... [[32mCREATE VIEW[0m in 0.22s]
[0m12:02:21.879949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m12:02:21.881072 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public_silver.stg_location_data ............... [[32mCREATE VIEW[0m in 0.21s]
[0m12:02:21.881965 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m12:02:21.882444 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m12:02:21.883064 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m12:02:21.887064 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:02:21.888058 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m12:02:21.892218 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:02:21.892842 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:02:21.893196 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m12:02:21.893496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:21.900242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m12:02:21.900709 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:02:21.901191 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public_silver"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public_bronze"."housing_prices"
)

SELECT
    id,
    date,
    region,
    price,
    EXTRACT(YEAR FROM date) as year,
    EXTRACT(MONTH FROM date) as month,
    EXTRACT(DOW FROM date) as day_of_week
FROM source
  );
[0m12:02:21.902513 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function pg_catalog.extract(unknown, text) does not exist
LINE 16:     EXTRACT(YEAR FROM date) as year,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m12:02:21.903324 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: ROLLBACK
[0m12:02:21.904322 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m12:02:21.911359 [debug] [Thread-1 (]: Database Error in model stg_housing_prices (models/silver/stg_housing_prices.sql)
  function pg_catalog.extract(unknown, text) does not exist
  LINE 16:     EXTRACT(YEAR FROM date) as year,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/airflow_dbt_training/models/silver/stg_housing_prices.sql
[0m12:02:21.912074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4f784c0-d332-42f0-86fc-d1a047707d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4979a85b50>]}
[0m12:02:21.912787 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model public_silver.stg_housing_prices .......... [[31mERROR[0m in 0.03s]
[0m12:02:21.913602 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m12:02:21.915074 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.stg_housing_prices' to be skipped because of status 'error'.  Reason: Database Error in model stg_housing_prices (models/silver/stg_housing_prices.sql)
  function pg_catalog.extract(unknown, text) does not exist
  LINE 16:     EXTRACT(YEAR FROM date) as year,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/airflow_dbt_training/models/silver/stg_housing_prices.sql.
[0m12:02:21.918513 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:21.918839 [debug] [MainThread]: On master: BEGIN
[0m12:02:21.919148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:02:21.928188 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:02:21.929067 [debug] [MainThread]: On master: COMMIT
[0m12:02:21.929711 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:21.930152 [debug] [MainThread]: On master: COMMIT
[0m12:02:21.930829 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:02:21.931271 [debug] [MainThread]: On master: Close
[0m12:02:21.931881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:21.932310 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_example' was properly closed.
[0m12:02:21.932728 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m12:02:21.933145 [debug] [MainThread]: Connection 'model.airflow_dbt_training.location_data' was properly closed.
[0m12:02:21.933526 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_location_data' was properly closed.
[0m12:02:21.934157 [info ] [MainThread]: 
[0m12:02:21.934739 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m12:02:21.937153 [debug] [MainThread]: Command end result
[0m12:02:21.970382 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:02:21.971890 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:02:21.977680 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:02:21.978005 [info ] [MainThread]: 
[0m12:02:21.978346 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:02:21.978646 [info ] [MainThread]: 
[0m12:02:21.979203 [error] [MainThread]:   Database Error in model stg_housing_prices (models/silver/stg_housing_prices.sql)
  function pg_catalog.extract(unknown, text) does not exist
  LINE 16:     EXTRACT(YEAR FROM date) as year,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/airflow_dbt_training/models/silver/stg_housing_prices.sql
[0m12:02:21.979640 [info ] [MainThread]: 
[0m12:02:21.980119 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:02:21.981348 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5462981, "process_in_blocks": "0", "process_kernel_time": 0.189979, "process_mem_max_rss": "130560", "process_out_blocks": "3056", "process_user_time": 2.659712}
[0m12:02:21.981852 [debug] [MainThread]: Command `dbt run` failed at 12:02:21.981746 after 1.55 seconds
[0m12:02:21.982238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498347fc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498338dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498334d7d0>]}
[0m12:02:21.982572 [debug] [MainThread]: Flushing usage events
[0m12:02:22.752469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:03:14.311780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11580794d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f115806dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f115806ddd0>]}


============================== 12:03:14.314570 | a9187568-24c5-4d00-8052-b01f3ccde31e ==============================
[0m12:03:14.314570 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:03:14.315088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:03:14.466337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9187568-24c5-4d00-8052-b01f3ccde31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f115a72d790>]}
[0m12:03:14.522609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9187568-24c5-4d00-8052-b01f3ccde31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f115aab74d0>]}
[0m12:03:14.523287 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:03:14.598161 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:03:14.717798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:03:14.718513 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/silver/stg_housing_prices.sql
[0m12:03:15.178045 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt_training.gold
[0m12:03:15.194976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9187568-24c5-4d00-8052-b01f3ccde31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f115616f210>]}
[0m12:03:15.288394 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:03:15.290902 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:03:15.302123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9187568-24c5-4d00-8052-b01f3ccde31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11545e9310>]}
[0m12:03:15.302630 [info ] [MainThread]: Found 5 models, 23 data tests, 2 sources, 433 macros
[0m12:03:15.302962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9187568-24c5-4d00-8052-b01f3ccde31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11545d1890>]}
[0m12:03:15.305323 [info ] [MainThread]: 
[0m12:03:15.305722 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:03:15.306059 [info ] [MainThread]: 
[0m12:03:15.306751 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:03:15.312352 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:03:15.313129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:03:15.324422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:03:15.400149 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:03:15.400549 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:03:15.400891 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:03:15.401251 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:03:15.401619 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:03:15.401978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:15.402335 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:03:15.402709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:15.403288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:15.410375 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m12:03:15.410890 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m12:03:15.411216 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m12:03:15.412429 [debug] [ThreadPool]: On list_dwh: Close
[0m12:03:15.413583 [debug] [ThreadPool]: On list_dwh: Close
[0m12:03:15.414778 [debug] [ThreadPool]: On list_dwh: Close
[0m12:03:15.417108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_bronze)
[0m12:03:15.417671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_silver)
[0m12:03:15.424439 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:03:15.425185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m12:03:15.427342 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:03:15.427816 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m12:03:15.429830 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:03:15.430221 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m12:03:15.430595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:15.430945 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m12:03:15.431272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:15.431797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:15.438290 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:03:15.438886 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:03:15.439484 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:03:15.440054 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m12:03:15.440962 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:03:15.441435 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:03:15.442129 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:03:15.442755 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:03:15.443735 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:03:15.445351 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:03:15.446636 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m12:03:15.447178 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m12:03:15.448729 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m12:03:15.449161 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m12:03:15.449464 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m12:03:15.450637 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m12:03:15.451953 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m12:03:15.452266 [debug] [ThreadPool]: On list_dwh_public: Close
[0m12:03:15.459004 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:15.459300 [debug] [MainThread]: On master: BEGIN
[0m12:03:15.459530 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:15.466729 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:03:15.467365 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:15.467969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:03:15.472190 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m12:03:15.474498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9187568-24c5-4d00-8052-b01f3ccde31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f115419bcd0>]}
[0m12:03:15.474892 [debug] [MainThread]: On master: ROLLBACK
[0m12:03:15.475378 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:15.475638 [debug] [MainThread]: On master: BEGIN
[0m12:03:15.476240 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:03:15.476502 [debug] [MainThread]: On master: COMMIT
[0m12:03:15.476746 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:15.477092 [debug] [MainThread]: On master: COMMIT
[0m12:03:15.477673 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:03:15.477958 [debug] [MainThread]: On master: Close
[0m12:03:15.481142 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m12:03:15.481581 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m12:03:15.482068 [info ] [Thread-1 (]: 1 of 5 START sql view model public_bronze.housing_prices ....................... [RUN]
[0m12:03:15.482718 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m12:03:15.483877 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m12:03:15.484801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m12:03:15.483257 [info ] [Thread-2 (]: 2 of 5 START sql view model public_bronze.location_data ........................ [RUN]
[0m12:03:15.485958 [info ] [Thread-3 (]: 3 of 5 START sql view model public.stg_example ................................. [RUN]
[0m12:03:15.486811 [info ] [Thread-4 (]: 4 of 5 START sql view model public_silver.stg_location_data .................... [RUN]
[0m12:03:15.487549 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m12:03:15.488513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now model.airflow_dbt_training.location_data)
[0m12:03:15.489157 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now model.airflow_dbt_training.stg_example)
[0m12:03:15.489893 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m12:03:15.499351 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m12:03:15.499807 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m12:03:15.500257 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m12:03:15.500664 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m12:03:15.503498 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m12:03:15.505976 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m12:03:15.506490 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m12:03:15.510547 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m12:03:15.517027 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m12:03:15.523132 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m12:03:15.539654 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m12:03:15.587353 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m12:03:15.591543 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m12:03:15.594985 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m12:03:15.600227 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m12:03:15.601659 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:03:15.602613 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:03:15.603205 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:03:15.603895 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m12:03:15.604327 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:03:15.604956 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m12:03:15.605403 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m12:03:15.605828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:15.606244 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m12:03:15.606638 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:03:15.607054 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:03:15.607662 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:03:15.614232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:03:15.614849 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m12:03:15.615417 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:03:15.615962 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:03:15.616657 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public_bronze"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m12:03:15.617630 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m12:03:15.618498 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m12:03:15.619089 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m12:03:15.619824 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:03:15.620442 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:03:15.621070 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:03:15.621714 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:03:15.622308 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public_silver"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m12:03:15.629712 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:03:15.630285 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public_bronze"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m12:03:15.633664 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:03:15.634235 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices" rename to "housing_prices__dbt_backup"
[0m12:03:15.634867 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m12:03:15.635465 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:03:15.635987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:03:15.639563 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:03:15.639957 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:03:15.640335 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:03:15.643859 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:03:15.644320 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m12:03:15.647286 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:03:15.650646 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:03:15.651110 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m12:03:15.651642 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m12:03:15.652118 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data" rename to "location_data__dbt_backup"
[0m12:03:15.652565 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:03:15.655899 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:03:15.656462 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:03:15.656874 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m12:03:15.657277 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:03:15.662936 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m12:03:15.666201 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:03:15.673816 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m12:03:15.680879 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m12:03:15.682383 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m12:03:15.682867 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data__dbt_tmp" rename to "location_data"
[0m12:03:15.684251 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m12:03:15.684709 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:03:15.685127 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:03:15.685649 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:03:15.686079 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m12:03:15.686482 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:03:15.686885 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m12:03:15.687291 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m12:03:15.688768 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m12:03:15.689358 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:03:15.689701 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m12:03:15.691846 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:03:15.698812 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public_bronze"."housing_prices__dbt_backup"
[0m12:03:15.699407 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m12:03:15.699798 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m12:03:15.705601 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:03:15.708194 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public_bronze"."location_data__dbt_backup"
[0m12:03:15.708604 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m12:03:15.711222 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m12:03:15.711669 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public_bronze"."housing_prices__dbt_backup" cascade
[0m12:03:15.712376 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:03:15.714992 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_silver"."stg_location_data__dbt_backup"
[0m12:03:15.715695 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:03:15.716234 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public_bronze"."location_data__dbt_backup" cascade
[0m12:03:15.716924 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:03:15.717359 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m12:03:15.717919 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public_silver"."stg_location_data__dbt_backup" cascade
[0m12:03:15.719161 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:03:15.721722 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m12:03:15.722266 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:03:15.722681 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:03:15.723069 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:03:15.724508 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m12:03:15.727058 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m12:03:15.727431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9187568-24c5-4d00-8052-b01f3ccde31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1126764190>]}
[0m12:03:15.728685 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m12:03:15.729394 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9187568-24c5-4d00-8052-b01f3ccde31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1126747a10>]}
[0m12:03:15.730126 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_bronze.housing_prices .................. [[32mCREATE VIEW[0m in 0.24s]
[0m12:03:15.730685 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9187568-24c5-4d00-8052-b01f3ccde31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1154188ad0>]}
[0m12:03:15.731420 [info ] [Thread-4 (]: 4 of 5 OK created sql view model public_silver.stg_location_data ............... [[32mCREATE VIEW[0m in 0.24s]
[0m12:03:15.732061 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9187568-24c5-4d00-8052-b01f3ccde31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1154188b10>]}
[0m12:03:15.732846 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m12:03:15.733643 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_bronze.location_data ................... [[32mCREATE VIEW[0m in 0.24s]
[0m12:03:15.734560 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m12:03:15.735676 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.24s]
[0m12:03:15.736777 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m12:03:15.737580 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m12:03:15.738456 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m12:03:15.739393 [info ] [Thread-1 (]: 5 of 5 START sql view model public_silver.stg_housing_prices ................... [RUN]
[0m12:03:15.740297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m12:03:15.740754 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m12:03:15.744267 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:03:15.744925 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m12:03:15.749117 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:03:15.749753 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:03:15.750117 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m12:03:15.750422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:15.757677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m12:03:15.758689 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:03:15.759483 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public_silver"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public_bronze"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m12:03:15.761466 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:03:15.765210 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:03:15.765628 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public_silver"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m12:03:15.766432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:03:15.767716 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m12:03:15.768056 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:03:15.768417 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m12:03:15.771424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:03:15.774195 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public_silver"."stg_housing_prices__dbt_backup"
[0m12:03:15.774782 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:03:15.775134 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public_silver"."stg_housing_prices__dbt_backup" cascade
[0m12:03:15.775751 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:03:15.777129 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m12:03:15.777673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9187568-24c5-4d00-8052-b01f3ccde31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11544190d0>]}
[0m12:03:15.778283 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public_silver.stg_housing_prices .............. [[32mCREATE VIEW[0m in 0.04s]
[0m12:03:15.778836 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m12:03:15.780614 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:15.780909 [debug] [MainThread]: On master: BEGIN
[0m12:03:15.781143 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:15.788108 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:03:15.788813 [debug] [MainThread]: On master: COMMIT
[0m12:03:15.789331 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:15.789736 [debug] [MainThread]: On master: COMMIT
[0m12:03:15.790261 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:03:15.790594 [debug] [MainThread]: On master: Close
[0m12:03:15.791068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:15.791318 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m12:03:15.791546 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_example' was properly closed.
[0m12:03:15.791883 [debug] [MainThread]: Connection 'model.airflow_dbt_training.location_data' was properly closed.
[0m12:03:15.792163 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_location_data' was properly closed.
[0m12:03:15.792534 [info ] [MainThread]: 
[0m12:03:15.792866 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m12:03:15.794318 [debug] [MainThread]: Command end result
[0m12:03:15.825119 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:03:15.826583 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:03:15.832193 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:03:15.832454 [info ] [MainThread]: 
[0m12:03:15.832850 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:15.833133 [info ] [MainThread]: 
[0m12:03:15.833510 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:03:15.834710 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5737915, "process_in_blocks": "0", "process_kernel_time": 0.158464, "process_mem_max_rss": "126644", "process_out_blocks": "3056", "process_user_time": 2.713702}
[0m12:03:15.835212 [debug] [MainThread]: Command `dbt run` succeeded at 12:03:15.835101 after 1.57 seconds
[0m12:03:15.835546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11583d5b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11542f2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11580acbd0>]}
[0m12:03:15.835930 [debug] [MainThread]: Flushing usage events
[0m12:03:16.567707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:36.800581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76fe29ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7700581d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77005b850>]}


============================== 12:11:36.803312 | 8fb2d8a2-e2e5-4633-be8a-6a0ad3222e25 ==============================
[0m12:11:36.803312 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:11:36.803809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:11:36.962167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fb2d8a2-e2e5-4633-be8a-6a0ad3222e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76fe93f50>]}
[0m12:11:37.021790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fb2d8a2-e2e5-4633-be8a-6a0ad3222e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa77287b510>]}
[0m12:11:37.022509 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:11:37.100524 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:11:37.231496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:37.231892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:37.238996 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt_training.gold
[0m12:11:37.289242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fb2d8a2-e2e5-4633-be8a-6a0ad3222e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76e7d3d50>]}
[0m12:11:37.393443 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:11:37.396546 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:11:37.418267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fb2d8a2-e2e5-4633-be8a-6a0ad3222e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76db2be10>]}
[0m12:11:37.418872 [info ] [MainThread]: Found 5 models, 23 data tests, 2 sources, 433 macros
[0m12:11:37.419256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fb2d8a2-e2e5-4633-be8a-6a0ad3222e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76eb93250>]}
[0m12:11:37.422867 [info ] [MainThread]: 
[0m12:11:37.425018 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:11:37.425583 [info ] [MainThread]: 
[0m12:11:37.426392 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:11:37.433288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m12:11:37.433965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_bronze'
[0m12:11:37.434558 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_silver'
[0m12:11:37.480454 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:11:37.480875 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:11:37.481206 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m12:11:37.481522 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:11:37.481873 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m12:11:37.482220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:37.482564 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m12:11:37.482934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:37.483509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:37.490679 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:11:37.491256 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:11:37.491811 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:11:37.492219 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:11:37.492856 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:11:37.493677 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m12:11:37.494261 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:11:37.494975 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:11:37.495556 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:11:37.498124 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:11:37.499598 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m12:11:37.500207 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m12:11:37.500685 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m12:11:37.501893 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m12:11:37.502334 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m12:11:37.503906 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m12:11:37.505400 [debug] [ThreadPool]: On list_dwh_public: Close
[0m12:11:37.505724 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m12:11:37.513069 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:37.513435 [debug] [MainThread]: On master: BEGIN
[0m12:11:37.513673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:37.520533 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:11:37.521257 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:37.522224 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:11:37.527257 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m12:11:37.529889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fb2d8a2-e2e5-4633-be8a-6a0ad3222e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76f3774d0>]}
[0m12:11:37.530347 [debug] [MainThread]: On master: ROLLBACK
[0m12:11:37.530875 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:37.531173 [debug] [MainThread]: On master: BEGIN
[0m12:11:37.531778 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:11:37.532061 [debug] [MainThread]: On master: COMMIT
[0m12:11:37.532560 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:37.533166 [debug] [MainThread]: On master: COMMIT
[0m12:11:37.533656 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:11:37.534208 [debug] [MainThread]: On master: Close
[0m12:11:37.538097 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:11:37.538589 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:11:37.539055 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [RUN]
[0m12:11:37.540266 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:11:37.541221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m12:11:37.539756 [info ] [Thread-2 (]: 2 of 23 START test accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [RUN]
[0m12:11:37.541847 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:11:37.542372 [info ] [Thread-3 (]: 3 of 23 START test not_null_stg_housing_prices_date ............................ [RUN]
[0m12:11:37.543208 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:11:37.543790 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public, now test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e)
[0m12:11:37.544364 [info ] [Thread-4 (]: 4 of 23 START test not_null_stg_housing_prices_day_of_week ..................... [RUN]
[0m12:11:37.545196 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m12:11:37.561543 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:11:37.566262 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m12:11:37.566985 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7'
[0m12:11:37.567469 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:11:37.572373 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m12:11:37.573126 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:11:37.579160 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:11:37.584519 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m12:11:37.590789 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m12:11:37.591247 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:11:37.611674 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m12:11:37.612278 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:11:37.615306 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m12:11:37.618547 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m12:11:37.618994 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:11:37.619735 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m12:11:37.620411 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m12:11:37.623168 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m12:11:37.623664 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m12:11:37.624189 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: BEGIN
[0m12:11:37.624588 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: BEGIN
[0m12:11:37.625188 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: BEGIN
[0m12:11:37.625644 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m12:11:37.626063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:37.626436 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:11:37.626846 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:11:37.627277 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: BEGIN
[0m12:11:37.628192 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:11:37.634443 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m12:11:37.635133 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m12:11:37.635938 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m12:11:37.636530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:11:37.637170 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m12:11:37.637865 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m12:11:37.638435 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "dwh"."public_silver"."stg_housing_prices"
where date is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.639017 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m12:11:37.639482 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m12:11:37.640063 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        month as value_field,
        count(*) as n_records

    from "dwh"."public_silver"."stg_housing_prices"
    group by month

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','7','8','9','10','11','12'
)



  
  
      
    ) dbt_internal_test
[0m12:11:37.640807 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        day_of_week as value_field,
        count(*) as n_records

    from "dwh"."public_silver"."stg_housing_prices"
    group by day_of_week

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m12:11:37.641667 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select day_of_week
from "dwh"."public_silver"."stg_housing_prices"
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.642931 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:11:37.647471 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: ROLLBACK
[0m12:11:37.648138 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:11:37.648800 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:11:37.649345 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:11:37.650984 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: ROLLBACK
[0m12:11:37.651409 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: Close
[0m12:11:37.652869 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: ROLLBACK
[0m12:11:37.654413 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: ROLLBACK
[0m12:11:37.656173 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: Close
[0m12:11:37.655416 [info ] [Thread-3 (]: 3 of 23 PASS not_null_stg_housing_prices_date .................................. [[32mPASS[0m in 0.11s]
[0m12:11:37.657135 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: Close
[0m12:11:37.658303 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: Close
[0m12:11:37.660833 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:11:37.659533 [info ] [Thread-2 (]: 2 of 23 PASS accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [[32mPASS[0m in 0.12s]
[0m12:11:37.662591 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:11:37.663831 [info ] [Thread-4 (]: 4 of 23 PASS not_null_stg_housing_prices_day_of_week ........................... [[32mPASS[0m in 0.10s]
[0m12:11:37.665119 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [[32mPASS[0m in 0.12s]
[0m12:11:37.667024 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:11:37.668618 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:11:37.667680 [info ] [Thread-3 (]: 5 of 23 START test not_null_stg_housing_prices_id .............................. [RUN]
[0m12:11:37.669607 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:11:37.670235 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:11:37.670983 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:11:37.671563 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m12:11:37.672119 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:11:37.673057 [info ] [Thread-2 (]: 6 of 23 START test not_null_stg_housing_prices_month ........................... [RUN]
[0m12:11:37.674008 [info ] [Thread-4 (]: 7 of 23 START test not_null_stg_housing_prices_price ........................... [RUN]
[0m12:11:37.674752 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:11:37.675417 [info ] [Thread-1 (]: 8 of 23 START test not_null_stg_housing_prices_region .......................... [RUN]
[0m12:11:37.676286 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m12:11:37.677015 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m12:11:37.683100 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m12:11:37.683654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m12:11:37.684161 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:11:37.684768 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:11:37.685848 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:11:37.686423 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:11:37.690940 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m12:11:37.695682 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m12:11:37.700511 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m12:11:37.703785 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m12:11:37.704530 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:11:37.705750 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:11:37.706363 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m12:11:37.706751 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:11:37.709803 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m12:11:37.714406 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m12:11:37.714954 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: BEGIN
[0m12:11:37.765336 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m12:11:37.766488 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m12:11:37.767031 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m12:11:37.767423 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:11:37.768038 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: BEGIN
[0m12:11:37.768517 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m12:11:37.768946 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: BEGIN
[0m12:11:37.769661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:37.770265 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: BEGIN
[0m12:11:37.770745 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:11:37.771404 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:11:37.776432 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m12:11:37.777118 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m12:11:37.777730 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dwh"."public_silver"."stg_housing_prices"
where id is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.778770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m12:11:37.779340 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m12:11:37.780013 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public_silver"."stg_housing_prices"
where region is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.780858 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m12:11:37.781666 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:11:37.782653 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m12:11:37.783520 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m12:11:37.785170 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: ROLLBACK
[0m12:11:37.785633 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:11:37.786063 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m12:11:37.786529 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dwh"."public_silver"."stg_housing_prices"
where price is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.788079 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: ROLLBACK
[0m12:11:37.788650 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: Close
[0m12:11:37.789226 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "dwh"."public_silver"."stg_housing_prices"
where month is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.790200 [info ] [Thread-3 (]: 5 of 23 PASS not_null_stg_housing_prices_id .................................... [[32mPASS[0m in 0.12s]
[0m12:11:37.790677 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: Close
[0m12:11:37.791406 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:11:37.791847 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:11:37.792504 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:11:37.793383 [info ] [Thread-1 (]: 8 of 23 PASS not_null_stg_housing_prices_region ................................ [[32mPASS[0m in 0.11s]
[0m12:11:37.794865 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:11:37.796965 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: ROLLBACK
[0m12:11:37.797559 [info ] [Thread-3 (]: 9 of 23 START test not_null_stg_housing_prices_year ............................ [RUN]
[0m12:11:37.798416 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:11:37.800414 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: ROLLBACK
[0m12:11:37.801433 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m12:11:37.802119 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:11:37.802591 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: Close
[0m12:11:37.803350 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:11:37.803904 [info ] [Thread-1 (]: 10 of 23 START test not_null_stg_location_data_postcode ........................ [RUN]
[0m12:11:37.804511 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: Close
[0m12:11:37.810832 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m12:11:37.811363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m12:11:37.812143 [info ] [Thread-4 (]: 7 of 23 PASS not_null_stg_housing_prices_price ................................. [[32mPASS[0m in 0.14s]
[0m12:11:37.813721 [info ] [Thread-2 (]: 6 of 23 PASS not_null_stg_housing_prices_month ................................. [[32mPASS[0m in 0.14s]
[0m12:11:37.814693 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:11:37.815146 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:11:37.815782 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:11:37.816415 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:11:37.821617 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m12:11:37.825552 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m12:11:37.826254 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:11:37.826892 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:11:37.827711 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:11:37.828339 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m12:11:37.828795 [info ] [Thread-4 (]: 11 of 23 START test not_null_stg_location_data_region .......................... [RUN]
[0m12:11:37.829301 [info ] [Thread-2 (]: 12 of 23 START test not_null_stg_location_data_type ............................ [RUN]
[0m12:11:37.833137 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m12:11:37.833756 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: BEGIN
[0m12:11:37.834311 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m12:11:37.834763 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m12:11:37.835418 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:11:37.835928 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m12:11:37.836527 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:11:37.837448 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:11:37.838345 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: BEGIN
[0m12:11:37.844976 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m12:11:37.849832 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m12:11:37.850512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:37.851045 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m12:11:37.852278 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:11:37.852753 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:11:37.853369 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m12:11:37.856940 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m12:11:37.859692 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m12:11:37.860330 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "dwh"."public_silver"."stg_housing_prices"
where year is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.860901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:11:37.862130 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m12:11:37.862787 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m12:11:37.863233 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m12:11:37.863713 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: BEGIN
[0m12:11:37.864138 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: BEGIN
[0m12:11:37.864657 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public_silver"."stg_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.865160 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:11:37.865627 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:11:37.866072 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:11:37.867935 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: ROLLBACK
[0m12:11:37.868599 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:11:37.870300 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: ROLLBACK
[0m12:11:37.870732 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: Close
[0m12:11:37.871493 [info ] [Thread-3 (]: 9 of 23 PASS not_null_stg_housing_prices_year .................................. [[32mPASS[0m in 0.07s]
[0m12:11:37.872266 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:11:37.873046 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:11:37.873625 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: Close
[0m12:11:37.874184 [info ] [Thread-3 (]: 13 of 23 START test source_not_null_public_raw_housing_prices_date ............. [RUN]
[0m12:11:37.876713 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m12:11:37.877908 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:11:37.875560 [info ] [Thread-1 (]: 10 of 23 PASS not_null_stg_location_data_postcode .............................. [[32mPASS[0m in 0.06s]
[0m12:11:37.878710 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m12:11:37.879493 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m12:11:37.886624 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m12:11:37.887451 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:11:37.887919 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m12:11:37.888326 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m12:11:37.888962 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:11:37.889590 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public_silver"."stg_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.890194 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public_silver"."stg_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.890806 [info ] [Thread-1 (]: 14 of 23 START test source_not_null_public_raw_housing_prices_id ............... [RUN]
[0m12:11:37.891376 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:11:37.892314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m12:11:37.896242 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m12:11:37.897186 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:11:37.897924 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:11:37.898568 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:11:37.900347 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: ROLLBACK
[0m12:11:37.901018 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m12:11:37.907971 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m12:11:37.909679 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: ROLLBACK
[0m12:11:37.910437 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: BEGIN
[0m12:11:37.911014 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: Close
[0m12:11:37.911577 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:11:37.912012 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:11:37.912409 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: Close
[0m12:11:37.915684 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m12:11:37.916382 [info ] [Thread-4 (]: 11 of 23 PASS not_null_stg_location_data_region ................................ [[32mPASS[0m in 0.08s]
[0m12:11:37.918707 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:11:37.917959 [info ] [Thread-2 (]: 12 of 23 PASS not_null_stg_location_data_type .................................. [[32mPASS[0m in 0.08s]
[0m12:11:37.919559 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m12:11:37.920209 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:11:37.921457 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:11:37.922220 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: BEGIN
[0m12:11:37.922903 [info ] [Thread-4 (]: 15 of 23 START test source_not_null_public_raw_housing_prices_price ............ [RUN]
[0m12:11:37.923811 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:11:37.924675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:37.925394 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m12:11:37.926122 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m12:11:37.926647 [info ] [Thread-2 (]: 16 of 23 START test source_not_null_public_raw_housing_prices_region ........... [RUN]
[0m12:11:37.927668 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m12:11:37.928601 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:11:37.929382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m12:11:37.930066 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "dwh"."public"."raw_housing_prices"
where date is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.936863 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m12:11:37.937456 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:11:37.938327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m12:11:37.944212 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m12:11:37.944769 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m12:11:37.945369 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:11:37.945922 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m12:11:37.946679 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dwh"."public"."raw_housing_prices"
where id is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.949550 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m12:11:37.949997 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:11:37.951459 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: ROLLBACK
[0m12:11:37.954974 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m12:11:37.955924 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m12:11:37.956356 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:11:37.956866 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: Close
[0m12:11:37.957399 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: BEGIN
[0m12:11:37.958084 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m12:11:37.959704 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: ROLLBACK
[0m12:11:37.960309 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:11:37.960901 [info ] [Thread-3 (]: 13 of 23 PASS source_not_null_public_raw_housing_prices_date ................... [[32mPASS[0m in 0.08s]
[0m12:11:37.961469 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: BEGIN
[0m12:11:37.962563 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:11:37.963026 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: Close
[0m12:11:37.963659 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:11:37.964435 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:11:37.965513 [info ] [Thread-1 (]: 14 of 23 PASS source_not_null_public_raw_housing_prices_id ..................... [[32mPASS[0m in 0.07s]
[0m12:11:37.966628 [info ] [Thread-3 (]: 17 of 23 START test source_not_null_public_raw_location_data_postcode .......... [RUN]
[0m12:11:37.967706 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:11:37.968351 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m12:11:37.968880 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:11:37.969469 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:11:37.970279 [info ] [Thread-1 (]: 18 of 23 START test source_not_null_public_raw_location_data_region ............ [RUN]
[0m12:11:37.971169 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m12:11:37.978244 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m12:11:37.978977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m12:11:37.979584 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m12:11:37.980105 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m12:11:37.980989 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:11:37.981411 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:11:37.982024 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m12:11:37.982867 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dwh"."public"."raw_housing_prices"
where price is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.987314 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m12:11:37.990801 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m12:11:37.991386 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_housing_prices"
where region is null



  
  
      
    ) dbt_internal_test
[0m12:11:37.992871 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m12:11:37.993540 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:11:37.994118 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: BEGIN
[0m12:11:37.994936 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:11:37.995351 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:11:37.998333 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m12:11:37.999007 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:11:38.001464 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: ROLLBACK
[0m12:11:38.003334 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: ROLLBACK
[0m12:11:38.004377 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m12:11:38.004987 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: BEGIN
[0m12:11:38.005456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:38.005859 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: Close
[0m12:11:38.006363 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: Close
[0m12:11:38.007640 [info ] [Thread-4 (]: 15 of 23 PASS source_not_null_public_raw_housing_prices_price .................. [[32mPASS[0m in 0.08s]
[0m12:11:38.008753 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:11:38.009440 [info ] [Thread-2 (]: 16 of 23 PASS source_not_null_public_raw_housing_prices_region ................. [[32mPASS[0m in 0.08s]
[0m12:11:38.010041 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:11:38.010975 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:11:38.011692 [info ] [Thread-4 (]: 19 of 23 START test source_not_null_public_raw_location_data_type .............. [RUN]
[0m12:11:38.013348 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m12:11:38.014508 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:11:38.015419 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m12:11:38.016242 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m12:11:38.017048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m12:11:38.017815 [info ] [Thread-2 (]: 20 of 23 START test source_unique_public_raw_housing_prices_id ................. [RUN]
[0m12:11:38.018663 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:11:38.019828 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."raw_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m12:11:38.020547 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m12:11:38.021202 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68)
[0m12:11:38.027178 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m12:11:38.027958 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m12:11:38.028491 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:11:38.029364 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:11:38.029880 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:11:38.035606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:11:38.038126 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m12:11:38.042990 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m12:11:38.044644 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: ROLLBACK
[0m12:11:38.045927 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: ROLLBACK
[0m12:11:38.046891 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m12:11:38.047489 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:11:38.047922 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: Close
[0m12:11:38.048404 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: BEGIN
[0m12:11:38.048799 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: Close
[0m12:11:38.051816 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m12:11:38.052409 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:11:38.053012 [info ] [Thread-3 (]: 17 of 23 PASS source_not_null_public_raw_location_data_postcode ................ [[32mPASS[0m in 0.08s]
[0m12:11:38.054068 [info ] [Thread-1 (]: 18 of 23 PASS source_not_null_public_raw_location_data_region .................. [[32mPASS[0m in 0.08s]
[0m12:11:38.055910 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:11:38.056749 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m12:11:38.057468 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:11:38.058235 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:11:38.059069 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68: BEGIN
[0m12:11:38.059624 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:11:38.060144 [info ] [Thread-3 (]: 21 of 23 START test source_unique_public_raw_location_data_postcode ............ [RUN]
[0m12:11:38.060916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:11:38.061738 [info ] [Thread-1 (]: 22 of 23 START test unique_stg_housing_prices_id ............................... [RUN]
[0m12:11:38.062858 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c, now test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175)
[0m12:11:38.063992 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m12:11:38.065240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e, now test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905)
[0m12:11:38.065832 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:11:38.066312 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m12:11:38.067038 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:11:38.072561 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m12:11:38.073621 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m12:11:38.074495 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."raw_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m12:11:38.079175 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m12:11:38.080101 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m12:11:38.080832 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:11:38.081432 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:11:38.081949 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dwh"."public"."raw_housing_prices"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:11:38.082402 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:11:38.085469 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m12:11:38.088553 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m12:11:38.090169 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: ROLLBACK
[0m12:11:38.090825 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:11:38.092112 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m12:11:38.092718 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: Close
[0m12:11:38.094188 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68: ROLLBACK
[0m12:11:38.094637 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m12:11:38.095083 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175: BEGIN
[0m12:11:38.096261 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68: Close
[0m12:11:38.096693 [debug] [Thread-1 (]: On test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905: BEGIN
[0m12:11:38.095877 [info ] [Thread-4 (]: 19 of 23 PASS source_not_null_public_raw_location_data_type .................... [[32mPASS[0m in 0.08s]
[0m12:11:38.097507 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:11:38.098238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:38.099094 [info ] [Thread-2 (]: 20 of 23 PASS source_unique_public_raw_housing_prices_id ....................... [[32mPASS[0m in 0.08s]
[0m12:11:38.100086 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:11:38.101689 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:11:38.102272 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:11:38.103101 [info ] [Thread-4 (]: 23 of 23 START test unique_stg_location_data_postcode .......................... [RUN]
[0m12:11:38.104226 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522, now test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2)
[0m12:11:38.105074 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:11:38.111455 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m12:11:38.112759 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:11:38.113386 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m12:11:38.117329 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m12:11:38.117801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m12:11:38.118279 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m12:11:38.118888 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m12:11:38.119438 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m12:11:38.119865 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    postcode as unique_field,
    count(*) as n_records

from "dwh"."public"."raw_location_data"
where postcode is not null
group by postcode
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:11:38.120399 [debug] [Thread-1 (]: On test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dwh"."public_silver"."stg_housing_prices"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:11:38.120825 [debug] [Thread-4 (]: On test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2: BEGIN
[0m12:11:38.121529 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:11:38.123249 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:11:38.123783 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:11:38.125246 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175: ROLLBACK
[0m12:11:38.126545 [debug] [Thread-1 (]: On test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905: ROLLBACK
[0m12:11:38.127244 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175: Close
[0m12:11:38.127679 [debug] [Thread-1 (]: On test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905: Close
[0m12:11:38.128602 [info ] [Thread-3 (]: 21 of 23 PASS source_unique_public_raw_location_data_postcode .................. [[32mPASS[0m in 0.07s]
[0m12:11:38.129402 [info ] [Thread-1 (]: 22 of 23 PASS unique_stg_housing_prices_id ..................................... [[32mPASS[0m in 0.06s]
[0m12:11:38.130516 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:11:38.131238 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m12:11:38.132059 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:11:38.132883 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m12:11:38.134015 [debug] [Thread-4 (]: On test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    postcode as unique_field,
    count(*) as n_records

from "dwh"."public_silver"."stg_location_data"
where postcode is not null
group by postcode
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:11:38.136452 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:11:38.138032 [debug] [Thread-4 (]: On test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2: ROLLBACK
[0m12:11:38.138649 [debug] [Thread-4 (]: On test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2: Close
[0m12:11:38.139358 [info ] [Thread-4 (]: 23 of 23 PASS unique_stg_location_data_postcode ................................ [[32mPASS[0m in 0.04s]
[0m12:11:38.140321 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:11:38.142411 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:38.142832 [debug] [MainThread]: On master: BEGIN
[0m12:11:38.143077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:38.149648 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:11:38.150039 [debug] [MainThread]: On master: COMMIT
[0m12:11:38.150367 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:38.150687 [debug] [MainThread]: On master: COMMIT
[0m12:11:38.151171 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:11:38.151535 [debug] [MainThread]: On master: Close
[0m12:11:38.152184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:38.152690 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68' was properly closed.
[0m12:11:38.152969 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175' was properly closed.
[0m12:11:38.153217 [debug] [MainThread]: Connection 'test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905' was properly closed.
[0m12:11:38.153442 [debug] [MainThread]: Connection 'test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2' was properly closed.
[0m12:11:38.153796 [info ] [MainThread]: 
[0m12:11:38.154114 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m12:11:38.159047 [debug] [MainThread]: Command end result
[0m12:11:38.191875 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:11:38.193456 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:11:38.201372 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:11:38.201741 [info ] [MainThread]: 
[0m12:11:38.202104 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:38.202411 [info ] [MainThread]: 
[0m12:11:38.202771 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 TOTAL=23
[0m12:11:38.203845 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4632193, "process_in_blocks": "32", "process_kernel_time": 0.216915, "process_mem_max_rss": "123256", "process_out_blocks": "2568", "process_user_time": 2.711445}
[0m12:11:38.204317 [debug] [MainThread]: Command `dbt test` succeeded at 12:11:38.204217 after 1.46 seconds
[0m12:11:38.204655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7741b91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7741b8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7741b9350>]}
[0m12:11:38.205081 [debug] [MainThread]: Flushing usage events
[0m12:11:38.798976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:47.104382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90222427d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9022473b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9022242590>]}


============================== 12:25:47.107049 | 28f4caa5-002f-490a-bed5-ea9a9bd96f8d ==============================
[0m12:25:47.107049 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:25:47.107597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:25:47.258211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28f4caa5-002f-490a-bed5-ea9a9bd96f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9022237950>]}
[0m12:25:47.315956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28f4caa5-002f-490a-bed5-ea9a9bd96f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9024c8de50>]}
[0m12:25:47.316667 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:25:47.393452 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:25:47.521930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m12:25:47.522658 [debug] [MainThread]: Partial parsing: added file: airflow_dbt_training://models/gold/schema.yml
[0m12:25:47.523008 [debug] [MainThread]: Partial parsing: added file: airflow_dbt_training://models/gold/mart_housing_prices_breakdown.sql
[0m12:25:47.523304 [debug] [MainThread]: Partial parsing: added file: airflow_dbt_training://models/gold/region_type_composition.sql
[0m12:25:47.987023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28f4caa5-002f-490a-bed5-ea9a9bd96f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f902034b550>]}
[0m12:25:48.085053 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:25:48.087561 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:25:48.099551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28f4caa5-002f-490a-bed5-ea9a9bd96f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901e8bf5d0>]}
[0m12:25:48.100014 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 433 macros
[0m12:25:48.100353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28f4caa5-002f-490a-bed5-ea9a9bd96f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901e775390>]}
[0m12:25:48.102854 [info ] [MainThread]: 
[0m12:25:48.103310 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:25:48.103627 [info ] [MainThread]: 
[0m12:25:48.104254 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:25:48.109416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:25:48.110115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:25:48.121716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:25:48.173273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:25:48.220249 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:25:48.220665 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:25:48.221011 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:25:48.221361 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:25:48.221744 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:25:48.222087 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:25:48.222440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:48.222800 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:25:48.223192 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:25:48.223562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:48.224139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:48.224503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:48.231927 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m12:25:48.232582 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m12:25:48.232900 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m12:25:48.233197 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m12:25:48.234419 [debug] [ThreadPool]: On list_dwh: Close
[0m12:25:48.235523 [debug] [ThreadPool]: On list_dwh: Close
[0m12:25:48.236659 [debug] [ThreadPool]: On list_dwh: Close
[0m12:25:48.237982 [debug] [ThreadPool]: On list_dwh: Close
[0m12:25:48.239640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now create_dwh_public_gold)
[0m12:25:48.240161 [debug] [ThreadPool]: Creating schema "database: "dwh"
schema: "public_gold"
"
[0m12:25:48.245939 [debug] [ThreadPool]: Using postgres connection "create_dwh_public_gold"
[0m12:25:48.246238 [debug] [ThreadPool]: On create_dwh_public_gold: BEGIN
[0m12:25:48.246514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:48.253038 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:25:48.253361 [debug] [ThreadPool]: Using postgres connection "create_dwh_public_gold"
[0m12:25:48.253710 [debug] [ThreadPool]: On create_dwh_public_gold: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "create_dwh_public_gold"} */
create schema if not exists "public_gold"
[0m12:25:48.254657 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m12:25:48.255688 [debug] [ThreadPool]: On create_dwh_public_gold: COMMIT
[0m12:25:48.255998 [debug] [ThreadPool]: Using postgres connection "create_dwh_public_gold"
[0m12:25:48.256252 [debug] [ThreadPool]: On create_dwh_public_gold: COMMIT
[0m12:25:48.259826 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m12:25:48.260137 [debug] [ThreadPool]: On create_dwh_public_gold: Close
[0m12:25:48.262186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dwh_public_gold, now list_dwh_public)
[0m12:25:48.262777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_gold)
[0m12:25:48.269311 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:25:48.271513 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m12:25:48.272119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_silver)
[0m12:25:48.272630 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m12:25:48.273225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_bronze)
[0m12:25:48.273581 [debug] [ThreadPool]: On list_dwh_public_gold: BEGIN
[0m12:25:48.275874 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:25:48.276224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:48.278316 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:25:48.278721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:48.279122 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m12:25:48.279653 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m12:25:48.280187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:48.280563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:48.285856 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:25:48.286251 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m12:25:48.286738 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:25:48.287392 [debug] [ThreadPool]: On list_dwh_public_gold: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_gold"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:25:48.288081 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:25:48.288643 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:25:48.289214 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:25:48.289857 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:25:48.290393 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:25:48.290833 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:25:48.291343 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:25:48.291839 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m12:25:48.292241 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:25:48.293688 [debug] [ThreadPool]: On list_dwh_public_gold: ROLLBACK
[0m12:25:48.294047 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m12:25:48.295322 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m12:25:48.295652 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:25:48.296154 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:25:48.297424 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m12:25:48.297773 [debug] [ThreadPool]: On list_dwh_public_gold: Close
[0m12:25:48.298070 [debug] [ThreadPool]: On list_dwh_public: Close
[0m12:25:48.299182 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m12:25:48.299933 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m12:25:48.301567 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m12:25:48.308919 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:48.309294 [debug] [MainThread]: On master: BEGIN
[0m12:25:48.309533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:48.316057 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:25:48.316416 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:48.316904 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:25:48.321385 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m12:25:48.323865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28f4caa5-002f-490a-bed5-ea9a9bd96f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901c5b8250>]}
[0m12:25:48.324267 [debug] [MainThread]: On master: ROLLBACK
[0m12:25:48.324745 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:48.324999 [debug] [MainThread]: On master: BEGIN
[0m12:25:48.325582 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:25:48.325839 [debug] [MainThread]: On master: COMMIT
[0m12:25:48.326079 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:48.326310 [debug] [MainThread]: On master: COMMIT
[0m12:25:48.326750 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:25:48.327015 [debug] [MainThread]: On master: Close
[0m12:25:48.329979 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m12:25:48.330414 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m12:25:48.330946 [info ] [Thread-1 (]: 1 of 7 START sql view model public_bronze.housing_prices ....................... [RUN]
[0m12:25:48.331560 [info ] [Thread-2 (]: 2 of 7 START sql view model public_bronze.location_data ........................ [RUN]
[0m12:25:48.332196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now model.airflow_dbt_training.housing_prices)
[0m12:25:48.332628 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m12:25:48.333139 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now model.airflow_dbt_training.location_data)
[0m12:25:48.333658 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m12:25:48.334240 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m12:25:48.335117 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m12:25:48.335674 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m12:25:48.336300 [info ] [Thread-4 (]: 4 of 7 START sql view model public_silver.stg_location_data .................... [RUN]
[0m12:25:48.345859 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m12:25:48.346679 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.stg_example)
[0m12:25:48.349236 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m12:25:48.349809 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_dwh_public_gold, now model.airflow_dbt_training.stg_location_data)
[0m12:25:48.350423 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m12:25:48.351051 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m12:25:48.351489 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m12:25:48.351945 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m12:25:48.354773 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m12:25:48.358438 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m12:25:48.420643 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m12:25:48.422126 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m12:25:48.422910 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m12:25:48.423330 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m12:25:48.424144 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:25:48.428137 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m12:25:48.428567 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:25:48.433347 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m12:25:48.433797 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m12:25:48.434424 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m12:25:48.434899 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:25:48.435486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:48.435950 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:25:48.436328 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:25:48.436754 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m12:25:48.437378 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m12:25:48.437965 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:25:48.438396 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:25:48.443362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:25:48.444135 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:25:48.444766 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m12:25:48.445413 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public_bronze"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m12:25:48.446398 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:25:48.447022 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m12:25:48.447464 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m12:25:48.447950 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public_bronze"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m12:25:48.448336 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:25:48.448899 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:25:48.449504 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:25:48.455506 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public_silver"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m12:25:48.457447 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:25:48.457885 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:25:48.458381 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m12:25:48.459014 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices" rename to "housing_prices__dbt_backup"
[0m12:25:48.462859 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:25:48.463332 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:25:48.463981 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data" rename to "location_data__dbt_backup"
[0m12:25:48.467981 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:25:48.468451 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:25:48.468830 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:25:48.469398 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m12:25:48.472582 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:25:48.472966 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:25:48.476216 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:25:48.476741 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m12:25:48.479860 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:25:48.480253 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:25:48.480734 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m12:25:48.481296 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data__dbt_tmp" rename to "location_data"
[0m12:25:48.484507 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:25:48.485082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:25:48.485821 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m12:25:48.486362 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:48.492017 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:25:48.505243 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m12:25:48.505749 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:25:48.509007 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:25:48.510485 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m12:25:48.510944 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:25:48.512313 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m12:25:48.512734 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m12:25:48.513176 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:25:48.513577 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m12:25:48.513986 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:25:48.514496 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m12:25:48.515022 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m12:25:48.515402 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:48.517128 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m12:25:48.517468 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:25:48.517860 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m12:25:48.518229 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:25:48.525047 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m12:25:48.525574 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public_bronze"."housing_prices__dbt_backup"
[0m12:25:48.528253 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public_bronze"."location_data__dbt_backup"
[0m12:25:48.528634 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m12:25:48.529074 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m12:25:48.534205 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:25:48.534889 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:25:48.538992 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m12:25:48.541559 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_silver"."stg_location_data__dbt_backup"
[0m12:25:48.541998 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public_bronze"."housing_prices__dbt_backup" cascade
[0m12:25:48.542720 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public_bronze"."location_data__dbt_backup" cascade
[0m12:25:48.543573 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:25:48.544355 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:25:48.545011 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m12:25:48.545642 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public_silver"."stg_location_data__dbt_backup" cascade
[0m12:25:48.549633 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m12:25:48.552123 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m12:25:48.552713 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m12:25:48.553132 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m12:25:48.553536 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m12:25:48.555050 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m12:25:48.557997 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m12:25:48.558426 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f4caa5-002f-490a-bed5-ea9a9bd96f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901e922a10>]}
[0m12:25:48.559774 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m12:25:48.560469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f4caa5-002f-490a-bed5-ea9a9bd96f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901c49e250>]}
[0m12:25:48.561037 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f4caa5-002f-490a-bed5-ea9a9bd96f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901c4a24d0>]}
[0m12:25:48.561803 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public_bronze.location_data ................... [[32mCREATE VIEW[0m in 0.22s]
[0m12:25:48.563761 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f4caa5-002f-490a-bed5-ea9a9bd96f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901c49e250>]}
[0m12:25:48.562913 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public_bronze.housing_prices .................. [[32mCREATE VIEW[0m in 0.23s]
[0m12:25:48.565065 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.21s]
[0m12:25:48.566057 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m12:25:48.567118 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public_silver.stg_location_data ............... [[32mCREATE VIEW[0m in 0.21s]
[0m12:25:48.568248 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m12:25:48.568991 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m12:25:48.569979 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m12:25:48.571145 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m12:25:48.572935 [info ] [Thread-3 (]: 5 of 7 START sql view model public_silver.stg_housing_prices ................... [RUN]
[0m12:25:48.574018 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m12:25:48.574683 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.stg_housing_prices)
[0m12:25:48.575511 [info ] [Thread-1 (]: 6 of 7 START sql view model public_gold.region_type_composition ................ [RUN]
[0m12:25:48.576264 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m12:25:48.577084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.region_type_composition)
[0m12:25:48.580980 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:25:48.581550 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m12:25:48.585195 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m12:25:48.585919 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m12:25:48.590021 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:25:48.590805 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m12:25:48.594649 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m12:25:48.595551 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:25:48.596118 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m12:25:48.596476 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:25:48.596869 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m12:25:48.597434 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m12:25:48.597834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:48.603838 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m12:25:48.604528 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:25:48.605288 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public_silver"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public_bronze"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m12:25:48.606041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:25:48.606603 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m12:25:48.607044 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public_gold"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public_silver"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m12:25:48.607830 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:25:48.611535 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:25:48.612025 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:25:48.612454 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public_silver"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m12:25:48.615710 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m12:25:48.616241 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public_gold"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m12:25:48.616706 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:48.618040 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m12:25:48.618414 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:25:48.618749 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m12:25:48.619139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:25:48.620362 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m12:25:48.620692 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m12:25:48.620995 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m12:25:48.621802 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m12:25:48.624386 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public_silver"."stg_housing_prices__dbt_backup"
[0m12:25:48.625012 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:25:48.625398 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public_silver"."stg_housing_prices__dbt_backup" cascade
[0m12:25:48.625847 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:25:48.626239 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:25:48.628786 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public_gold"."region_type_composition__dbt_backup"
[0m12:25:48.630095 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m12:25:48.630774 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m12:25:48.631330 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public_gold"."region_type_composition__dbt_backup" cascade
[0m12:25:48.631932 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f4caa5-002f-490a-bed5-ea9a9bd96f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901c486590>]}
[0m12:25:48.632558 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public_silver.stg_housing_prices .............. [[32mCREATE VIEW[0m in 0.06s]
[0m12:25:48.633156 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m12:25:48.633613 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:25:48.634982 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m12:25:48.635741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f4caa5-002f-490a-bed5-ea9a9bd96f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901c5c4e90>]}
[0m12:25:48.636358 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public_gold.region_type_composition ........... [[32mCREATE VIEW[0m in 0.06s]
[0m12:25:48.637260 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m12:25:48.638736 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:25:48.639455 [info ] [Thread-4 (]: 7 of 7 START sql view model public_gold.mart_housing_prices_breakdown .......... [RUN]
[0m12:25:48.640024 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m12:25:48.640474 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:25:48.644650 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:25:48.645236 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:25:48.651754 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:25:48.652370 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:25:48.652761 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m12:25:48.653152 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:25:48.660022 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m12:25:48.660453 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:25:48.660947 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public_silver"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public_gold"."region_type_composition" r
  ON p.region = r.region
  );
[0m12:25:48.663339 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:25:48.666642 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:25:48.667058 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m12:25:48.667953 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:48.669269 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m12:25:48.669620 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:25:48.669951 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m12:25:48.672970 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m12:25:48.675736 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_backup"
[0m12:25:48.676588 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:25:48.677161 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m12:25:48.677949 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:25:48.679489 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m12:25:48.680212 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f4caa5-002f-490a-bed5-ea9a9bd96f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901c30d950>]}
[0m12:25:48.680871 [info ] [Thread-4 (]: 7 of 7 OK created sql view model public_gold.mart_housing_prices_breakdown ..... [[32mCREATE VIEW[0m in 0.04s]
[0m12:25:48.681456 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:25:48.683589 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:48.683965 [debug] [MainThread]: On master: BEGIN
[0m12:25:48.684271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:25:48.691532 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:25:48.692170 [debug] [MainThread]: On master: COMMIT
[0m12:25:48.692591 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:48.692849 [debug] [MainThread]: On master: COMMIT
[0m12:25:48.693380 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:25:48.693700 [debug] [MainThread]: On master: Close
[0m12:25:48.694135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:48.694391 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m12:25:48.694624 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m12:25:48.694845 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m12:25:48.695064 [debug] [MainThread]: Connection 'model.airflow_dbt_training.location_data' was properly closed.
[0m12:25:48.695444 [info ] [MainThread]: 
[0m12:25:48.695755 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m12:25:48.697452 [debug] [MainThread]: Command end result
[0m12:25:48.730595 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:25:48.732163 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:25:48.737918 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:25:48.738215 [info ] [MainThread]: 
[0m12:25:48.738562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:48.738846 [info ] [MainThread]: 
[0m12:25:48.739201 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:25:48.740367 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.686732, "process_in_blocks": "16", "process_kernel_time": 0.325871, "process_mem_max_rss": "129540", "process_out_blocks": "3344", "process_user_time": 2.685975}
[0m12:25:48.740879 [debug] [MainThread]: Command `dbt run` succeeded at 12:25:48.740755 after 1.69 seconds
[0m12:25:48.741205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9022473ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9022473110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9022237fd0>]}
[0m12:25:48.741597 [debug] [MainThread]: Flushing usage events
[0m12:25:49.483980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:03.803113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e263d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e263d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e263c890>]}


============================== 12:27:03.805885 | f8946ccc-eab1-42df-b5c4-8d0876e974f6 ==============================
[0m12:27:03.805885 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:27:03.806411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:27:03.961494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8946ccc-eab1-42df-b5c4-8d0876e974f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e1bea110>]}
[0m12:27:04.020618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8946ccc-eab1-42df-b5c4-8d0876e974f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e50897d0>]}
[0m12:27:04.021409 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:27:04.105563 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:27:04.237964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:27:04.238341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:27:04.292189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8946ccc-eab1-42df-b5c4-8d0876e974f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e0b28510>]}
[0m12:27:04.306175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8946ccc-eab1-42df-b5c4-8d0876e974f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e0747f90>]}
[0m12:27:04.306752 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 433 macros
[0m12:27:04.307091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8946ccc-eab1-42df-b5c4-8d0876e974f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e13c5590>]}
[0m12:27:04.310674 [info ] [MainThread]: 
[0m12:27:04.311192 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:27:04.312591 [info ] [MainThread]: 
[0m12:27:04.313492 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:27:04.319450 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_gold'
[0m12:27:04.328873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_bronze'
[0m12:27:04.340281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_silver'
[0m12:27:04.348500 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m12:27:04.376839 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m12:27:04.377261 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:27:04.377591 [debug] [ThreadPool]: On list_dwh_public_gold: BEGIN
[0m12:27:04.377938 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:27:04.378344 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m12:27:04.378693 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:27:04.379075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:04.379430 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m12:27:04.379817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:04.380176 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m12:27:04.380757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:04.381295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:04.387767 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:27:04.388493 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:27:04.389197 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:27:04.389564 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:27:04.389956 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:27:04.390860 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:27:04.392091 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:27:04.392558 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m12:27:04.392914 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:27:04.393428 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m12:27:04.393872 [debug] [ThreadPool]: On list_dwh_public_gold: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_gold"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:27:04.394340 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:27:04.395529 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m12:27:04.397609 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m12:27:04.398334 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m12:27:04.398824 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m12:27:04.400039 [debug] [ThreadPool]: On list_dwh_public_gold: ROLLBACK
[0m12:27:04.400388 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m12:27:04.400693 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m12:27:04.401791 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m12:27:04.403381 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m12:27:04.403843 [debug] [ThreadPool]: On list_dwh_public_gold: Close
[0m12:27:04.405042 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m12:27:04.406036 [debug] [ThreadPool]: On list_dwh_public: Close
[0m12:27:04.413125 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:04.413468 [debug] [MainThread]: On master: BEGIN
[0m12:27:04.413702 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:04.420941 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:27:04.421436 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:04.421929 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:27:04.427896 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m12:27:04.431043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8946ccc-eab1-42df-b5c4-8d0876e974f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e0752e50>]}
[0m12:27:04.431409 [debug] [MainThread]: On master: ROLLBACK
[0m12:27:04.431832 [debug] [MainThread]: On master: Close
[0m12:27:04.435189 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m12:27:04.435675 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m12:27:04.436149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m12:27:04.436554 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m12:27:04.436980 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m12:27:04.437397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now model.airflow_dbt_training.location_data)
[0m12:27:04.437812 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m12:27:04.438238 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public_gold, now model.airflow_dbt_training.stg_example)
[0m12:27:04.438691 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now model.airflow_dbt_training.stg_location_data)
[0m12:27:04.439177 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m12:27:04.448289 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m12:27:04.448805 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m12:27:04.449219 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m12:27:04.451398 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m12:27:04.454115 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m12:27:04.457270 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m12:27:04.458065 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m12:27:04.458863 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m12:27:04.459530 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m12:27:04.460253 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m12:27:04.460616 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m12:27:04.461289 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m12:27:04.461968 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m12:27:04.462442 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:27:04.463156 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m12:27:04.463976 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:27:04.464690 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:27:04.465188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m12:27:04.465973 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:27:04.466474 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m12:27:04.466980 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m12:27:04.467414 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:27:04.467841 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m12:27:04.468256 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:27:04.468714 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:27:04.474491 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:27:04.483901 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m12:27:04.493564 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m12:27:04.494022 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m12:27:04.498398 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m12:27:04.499551 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:27:04.500314 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:27:04.500840 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:27:04.501410 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:27:04.502225 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:27:04.502930 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:27:04.503588 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:27:04.504287 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:27:04.504768 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:27:04.505224 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:27:04.506009 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:27:04.506639 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:27:04.507273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m12:27:04.507740 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m12:27:04.508183 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m12:27:04.508617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68)
[0m12:27:04.509100 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:27:04.509508 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:27:04.509897 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:27:04.510299 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:27:04.514962 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m12:27:04.519380 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m12:27:04.523701 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m12:27:04.530924 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m12:27:04.532105 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:27:04.532714 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:27:04.533137 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:27:04.534038 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:27:04.534833 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:27:04.535187 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:27:04.535900 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:27:04.536656 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:27:04.537197 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m12:27:04.538045 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:27:04.538488 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m12:27:04.538956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c, now test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175)
[0m12:27:04.539504 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522, now model.airflow_dbt_training.stg_housing_prices)
[0m12:27:04.539964 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:27:04.540399 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e, now model.airflow_dbt_training.region_type_composition)
[0m12:27:04.540900 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:27:04.541303 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m12:27:04.541737 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m12:27:04.542275 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m12:27:04.546541 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m12:27:04.549481 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:27:04.549942 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:27:04.552817 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m12:27:04.553707 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:27:04.554088 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m12:27:04.558101 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m12:27:04.559010 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:27:04.559726 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m12:27:04.560083 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m12:27:04.560660 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:27:04.561386 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:27:04.561741 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:27:04.562867 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m12:27:04.563493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m12:27:04.563928 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m12:27:04.564603 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:27:04.565041 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:27:04.565488 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:27:04.566340 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:27:04.566807 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:27:04.567315 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.region_type_composition, now test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2)
[0m12:27:04.576663 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m12:27:04.577107 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m12:27:04.577588 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m12:27:04.578023 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:27:04.578768 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:27:04.579223 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:27:04.583439 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m12:27:04.583864 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:27:04.584650 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:27:04.593175 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m12:27:04.593685 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:27:04.594422 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:27:04.594906 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:27:04.595573 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:27:04.596250 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:27:04.596698 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:27:04.597169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e)
[0m12:27:04.597960 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:27:04.598406 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:27:04.598939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m12:27:04.599372 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:27:04.599864 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:27:04.600333 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m12:27:04.600847 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:27:04.605368 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m12:27:04.605858 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m12:27:04.606291 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:27:04.610196 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m12:27:04.610797 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:27:04.611275 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:27:04.615202 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m12:27:04.619275 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m12:27:04.619667 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:27:04.620386 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:27:04.621339 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:27:04.621910 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:27:04.622312 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:27:04.622779 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:27:04.623229 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:27:04.624003 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:27:04.624672 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:27:04.625113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m12:27:04.625572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m12:27:04.626037 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:27:04.626480 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:27:04.626989 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:27:04.627398 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:27:04.627838 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m12:27:04.628268 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m12:27:04.632282 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m12:27:04.636228 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m12:27:04.636669 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:27:04.637078 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:27:04.641392 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m12:27:04.641808 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:27:04.642344 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:27:04.646168 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m12:27:04.647036 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:27:04.647489 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:27:04.648170 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:27:04.648740 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:27:04.649585 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:27:04.650215 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:27:04.650581 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:27:04.651081 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905)
[0m12:27:04.651637 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:27:04.652091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m12:27:04.652852 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:27:04.653256 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:27:04.653680 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m12:27:04.654154 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:27:04.654601 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:27:04.660370 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m12:27:04.660766 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:27:04.702085 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m12:27:04.705016 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:27:04.709088 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m12:27:04.709641 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:27:04.710242 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:27:04.710681 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:27:04.714778 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m12:27:04.715612 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:27:04.715985 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:27:04.716668 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:27:04.717304 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:27:04.717745 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:27:04.718516 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:27:04.718953 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:27:04.719404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m12:27:04.720367 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:27:04.720863 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:27:04.721291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.mart_housing_prices_breakdown, now test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a)
[0m12:27:04.721815 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:27:04.722321 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:27:04.722787 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m12:27:04.723276 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:27:04.727180 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m12:27:04.727632 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d)
[0m12:27:04.728070 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:27:04.731916 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a"
[0m12:27:04.732495 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:27:04.736347 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m12:27:04.736759 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:27:04.740588 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m12:27:04.741450 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:27:04.742281 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:27:04.742694 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:27:04.743483 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:27:04.744022 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:27:04.744397 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:27:04.745154 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:27:04.745602 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:27:04.746054 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7)
[0m12:27:04.746819 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:27:04.747253 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:27:04.747696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e)
[0m12:27:04.748188 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:27:04.748637 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:27:04.749088 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m12:27:04.749571 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:27:04.753544 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m12:27:04.753991 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281)
[0m12:27:04.754410 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:27:04.758215 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m12:27:04.758767 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:27:04.762809 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m12:27:04.763218 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:27:04.769422 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m12:27:04.769839 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:27:04.770547 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:27:04.770958 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:27:04.771866 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:27:04.772414 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:27:04.772889 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:27:04.773588 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:27:04.774508 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:27:04.774926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de)
[0m12:27:04.775659 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:27:04.779561 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m12:27:04.779999 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:27:04.780566 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:27:04.781782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:04.782030 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281' was properly closed.
[0m12:27:04.782338 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de' was properly closed.
[0m12:27:04.782561 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c' was properly closed.
[0m12:27:04.782796 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e' was properly closed.
[0m12:27:04.788659 [debug] [MainThread]: Command end result
[0m12:27:04.884130 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:27:04.886801 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:27:04.894835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:27:04.896203 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:27:04.896441 [info ] [MainThread]: Building catalog
[0m12:27:04.909348 [debug] [ThreadPool]: Acquiring new postgres connection 'dwh.information_schema'
[0m12:27:04.917638 [debug] [ThreadPool]: Using postgres connection "dwh.information_schema"
[0m12:27:04.918385 [debug] [ThreadPool]: On dwh.information_schema: BEGIN
[0m12:27:04.918725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:04.925367 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:27:04.925873 [debug] [ThreadPool]: Using postgres connection "dwh.information_schema"
[0m12:27:04.926743 [debug] [ThreadPool]: On dwh.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "dwh.information_schema"} */

    
    

    select
        'dwh' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_bronze') and
           upper(tbl.relname) = upper('location_data')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('stg_location_data')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('mart_housing_prices_breakdown')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('region_type_composition')) or (upper(sch.nspname) = upper('public_bronze') and
           upper(tbl.relname) = upper('housing_prices')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_example')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_housing_prices')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('stg_housing_prices')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_location_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:27:04.930673 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m12:27:04.934147 [debug] [ThreadPool]: On dwh.information_schema: ROLLBACK
[0m12:27:04.934613 [debug] [ThreadPool]: On dwh.information_schema: Close
[0m12:27:04.946846 [debug] [MainThread]: Wrote artifact CatalogArtifact to /dbt/target/catalog.json
[0m12:27:04.978004 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:27:04.979550 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:27:04.979817 [info ] [MainThread]: Catalog written to /dbt/target/catalog.json
[0m12:27:04.980681 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.2309197, "process_in_blocks": "8", "process_kernel_time": 0.207758, "process_mem_max_rss": "119192", "process_out_blocks": "6064", "process_user_time": 2.364484}
[0m12:27:04.981200 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:27:04.981104 after 1.23 seconds
[0m12:27:04.981500 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:27:04.981776 [debug] [MainThread]: Connection 'dwh.information_schema' was properly closed.
[0m12:27:04.982121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e374ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e69c8450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e0b44450>]}
[0m12:27:04.982482 [debug] [MainThread]: Flushing usage events
[0m12:27:05.594148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:13.836530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd8e10ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd8e11bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd8e11b50>]}


============================== 12:27:13.839429 | e5799886-e50f-4b19-abc8-2ccef0933048 ==============================
[0m12:27:13.839429 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:27:13.839949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:27:13.994460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5799886-e50f-4b19-abc8-2ccef0933048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd9043990>]}
[0m12:27:14.059721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5799886-e50f-4b19-abc8-2ccef0933048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfdb827550>]}
[0m12:27:49.962787 [error] [MainThread]: Encountered an error:

[0m12:27:49.967727 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m12:27:49.970481 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 36.18751, "process_in_blocks": "0", "process_kernel_time": 0.131032, "process_mem_max_rss": "106200", "process_out_blocks": "3552", "process_user_time": 1.491753}
[0m12:27:49.972015 [debug] [MainThread]: Command `dbt docs serve` failed at 12:27:49.971742 after 36.19 seconds
[0m12:27:49.972784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd8e41cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd90434d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfd8e05790>]}
[0m12:27:49.973592 [debug] [MainThread]: Flushing usage events
[0m12:27:50.509019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:56.178203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e169f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e14b7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e146bf90>]}


============================== 12:27:56.181018 | 89ada30e-2304-4c58-aee3-c4fcf992e1dc ==============================
[0m12:27:56.181018 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:27:56.181605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --port 8081', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:27:56.332545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89ada30e-2304-4c58-aee3-c4fcf992e1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e09a7350>]}
[0m12:27:56.389174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89ada30e-2304-4c58-aee3-c4fcf992e1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e3ebd1d0>]}
[0m12:29:34.212492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5519a5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5519a5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5519a4c10>]}


============================== 12:29:34.215435 | 4386c75d-b84e-4230-b7fd-093bcb3e5462 ==============================
[0m12:29:34.215435 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:29:34.215988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:34.228553 [info ] [MainThread]: dbt version: 1.9.4
[0m12:29:34.228988 [info ] [MainThread]: python version: 3.11.12
[0m12:29:34.229574 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m12:29:34.230124 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m12:29:34.279921 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:29:34.280395 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:29:34.280681 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:29:34.281203 [info ] [MainThread]: adapter type: postgres
[0m12:29:34.281592 [info ] [MainThread]: adapter version: 1.9.0
[0m12:29:34.393187 [info ] [MainThread]: Configuration:
[0m12:29:34.393581 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:29:34.393873 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:29:34.394220 [info ] [MainThread]: Required dependencies:
[0m12:29:34.394625 [debug] [MainThread]: Executing "git --help"
[0m12:29:34.396607 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:29:34.397143 [debug] [MainThread]: STDERR: "b''"
[0m12:29:34.397408 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:29:34.397707 [info ] [MainThread]: Connection:
[0m12:29:34.398022 [info ] [MainThread]:   host: dwh
[0m12:29:34.398304 [info ] [MainThread]:   port: 5432
[0m12:29:34.398633 [info ] [MainThread]:   user: airflow
[0m12:29:34.399077 [info ] [MainThread]:   database: dwh
[0m12:29:34.399409 [info ] [MainThread]:   schema: public
[0m12:29:34.399949 [info ] [MainThread]:   connect_timeout: 10
[0m12:29:34.400251 [info ] [MainThread]:   role: None
[0m12:29:34.400609 [info ] [MainThread]:   search_path: None
[0m12:29:34.400945 [info ] [MainThread]:   keepalives_idle: 0
[0m12:29:34.401324 [info ] [MainThread]:   sslmode: None
[0m12:29:34.401800 [info ] [MainThread]:   sslcert: None
[0m12:29:34.402084 [info ] [MainThread]:   sslkey: None
[0m12:29:34.402448 [info ] [MainThread]:   sslrootcert: None
[0m12:29:34.402978 [info ] [MainThread]:   application_name: dbt
[0m12:29:34.403288 [info ] [MainThread]:   retries: 1
[0m12:29:34.403946 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:29:34.475381 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:29:34.504822 [debug] [MainThread]: Using postgres connection "debug"
[0m12:29:34.505204 [debug] [MainThread]: On debug: select 1 as id
[0m12:29:34.505455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:34.514831 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m12:29:34.515764 [debug] [MainThread]: On debug: Close
[0m12:29:34.516080 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:29:34.516397 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:29:34.517539 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.35642648, "process_in_blocks": "0", "process_kernel_time": 0.200308, "process_mem_max_rss": "111352", "process_out_blocks": "24", "process_user_time": 1.552393}
[0m12:29:34.518038 [debug] [MainThread]: Command `dbt debug` succeeded at 12:29:34.517901 after 0.36 seconds
[0m12:29:34.518333 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:29:34.518683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5519f2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa551191790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5519f8910>]}
[0m12:29:34.519071 [debug] [MainThread]: Flushing usage events
[0m12:29:35.115401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:37.147151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9783fc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97844b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97844bf90>]}


============================== 12:29:37.149975 | a5a85cec-c0b9-491e-b583-7c1bec0fe6f2 ==============================
[0m12:29:37.149975 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:29:37.150651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:37.304690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5a85cec-c0b9-491e-b583-7c1bec0fe6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff977f41510>]}
[0m12:29:37.364994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5a85cec-c0b9-491e-b583-7c1bec0fe6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff977b6d650>]}
[0m12:29:37.365719 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:29:37.444426 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:29:37.580258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:37.580671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:37.631830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5a85cec-c0b9-491e-b583-7c1bec0fe6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9773fbe50>]}
[0m12:29:37.645010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5a85cec-c0b9-491e-b583-7c1bec0fe6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff976fca3d0>]}
[0m12:29:37.645531 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 433 macros
[0m12:29:37.645858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5a85cec-c0b9-491e-b583-7c1bec0fe6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9777f4610>]}
[0m12:29:37.649467 [info ] [MainThread]: 
[0m12:29:37.649953 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:29:37.650322 [info ] [MainThread]: 
[0m12:29:37.651056 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:29:37.656241 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m12:29:37.657082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_bronze'
[0m12:29:37.657719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_gold'
[0m12:29:37.665683 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_silver'
[0m12:29:37.715040 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:29:37.715463 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m12:29:37.715766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:37.716287 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:29:37.716643 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m12:29:37.717010 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m12:29:37.717328 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:29:37.717707 [debug] [ThreadPool]: On list_dwh_public_gold: BEGIN
[0m12:29:37.718037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:37.718390 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m12:29:37.718734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:37.719258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:37.723507 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:29:37.723870 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:29:37.724174 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m12:29:37.725151 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:29:37.725426 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:29:37.725734 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:29:37.727247 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:29:37.728565 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m12:29:37.729188 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m12:29:37.729514 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:29:37.729935 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:29:37.731129 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m12:29:37.731448 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m12:29:37.731790 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:29:37.732236 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m12:29:37.732841 [debug] [ThreadPool]: On list_dwh_public: Close
[0m12:29:37.733247 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:29:37.734430 [debug] [ThreadPool]: On list_dwh_public_gold: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_gold"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:29:37.738299 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m12:29:37.738700 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:29:37.739956 [debug] [ThreadPool]: On list_dwh_public_gold: ROLLBACK
[0m12:29:37.741080 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m12:29:37.741636 [debug] [ThreadPool]: On list_dwh_public_gold: Close
[0m12:29:37.741931 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m12:29:37.748442 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:37.748839 [debug] [MainThread]: On master: BEGIN
[0m12:29:37.749079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:37.756101 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:29:37.756470 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:37.756926 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:29:37.762551 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m12:29:37.765856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5a85cec-c0b9-491e-b583-7c1bec0fe6f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97738fb10>]}
[0m12:29:37.766255 [debug] [MainThread]: On master: ROLLBACK
[0m12:29:37.766740 [debug] [MainThread]: On master: Close
[0m12:29:37.769930 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m12:29:37.770398 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m12:29:37.770857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now model.airflow_dbt_training.housing_prices)
[0m12:29:37.771250 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m12:29:37.771734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public_gold, now model.airflow_dbt_training.location_data)
[0m12:29:37.772121 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m12:29:37.772527 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m12:29:37.772972 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.stg_example)
[0m12:29:37.773377 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m12:29:37.773815 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now model.airflow_dbt_training.stg_location_data)
[0m12:29:37.779487 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m12:29:37.783059 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m12:29:37.785271 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m12:29:37.785740 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m12:29:37.788044 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m12:29:37.788786 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m12:29:37.789206 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m12:29:37.792288 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m12:29:37.793164 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m12:29:37.793895 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m12:29:37.794558 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m12:29:37.794982 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m12:29:37.795513 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:29:37.796014 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:29:37.796867 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m12:29:37.797647 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m12:29:37.798096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m12:29:37.798538 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m12:29:37.799034 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:29:37.799494 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:29:37.800098 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:29:37.800735 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:29:37.801193 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m12:29:37.801626 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m12:29:37.818054 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:29:37.821561 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m12:29:37.822092 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m12:29:37.822532 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:29:37.826788 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m12:29:37.831363 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m12:29:37.832038 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:29:37.832632 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:29:37.833519 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:29:37.833929 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:29:37.834690 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:29:37.835436 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:29:37.836125 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:29:37.836808 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:29:37.837296 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:29:37.837855 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:29:37.838435 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:29:37.838886 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:29:37.839429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m12:29:37.839875 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m12:29:37.840332 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m12:29:37.840769 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68)
[0m12:29:37.841181 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:29:37.841642 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:29:37.842126 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:29:37.842570 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:29:37.847171 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m12:29:37.851621 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m12:29:37.855847 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m12:29:37.862613 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m12:29:37.863195 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:29:37.864698 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:29:37.865524 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:29:37.865879 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:29:37.866640 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:29:37.867009 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:29:37.867515 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:29:37.868320 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:29:37.868774 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m12:29:37.869482 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:29:37.870018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c, now test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175)
[0m12:29:37.870475 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m12:29:37.870962 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e, now model.airflow_dbt_training.stg_housing_prices)
[0m12:29:37.871413 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:29:37.871878 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:29:37.872546 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68, now model.airflow_dbt_training.region_type_composition)
[0m12:29:37.872943 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m12:29:37.873396 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m12:29:37.877570 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m12:29:37.877997 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m12:29:37.880961 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:29:37.881412 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:29:37.884475 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m12:29:37.885395 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m12:29:37.889527 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m12:29:37.890318 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:29:37.891115 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m12:29:37.891517 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m12:29:37.892350 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:29:37.892834 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:29:37.893421 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:29:37.894104 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m12:29:37.896813 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:29:37.897462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m12:29:37.898205 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:29:37.898675 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:29:37.899122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m12:29:37.899696 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:29:37.900416 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:29:37.901059 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.region_type_composition, now test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2)
[0m12:29:37.901454 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:29:37.905637 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m12:29:37.906089 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m12:29:37.906628 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:29:37.910652 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m12:29:37.911310 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:29:37.915360 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m12:29:37.915759 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:29:37.924995 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m12:29:37.925783 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:29:37.926674 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:29:37.927139 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:29:37.928032 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:29:37.928479 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:29:37.928938 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:29:37.929652 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:29:37.930176 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:29:37.930958 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:29:37.931394 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e)
[0m12:29:37.931857 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:29:37.932306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m12:29:37.932851 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:29:37.933304 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:29:37.933810 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m12:29:37.934237 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:29:37.934682 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m12:29:37.939591 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m12:29:37.940078 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:29:37.944155 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m12:29:37.944630 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:29:37.948823 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m12:29:37.949676 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:29:37.953854 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m12:29:37.954348 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:29:37.955269 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:29:37.955725 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:29:37.956644 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:29:37.957055 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:29:37.957522 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:29:37.958213 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:29:37.958764 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:29:37.959459 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:29:37.959973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m12:29:37.960444 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:29:37.960889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m12:29:37.961434 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:29:37.961857 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:29:37.962372 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m12:29:37.962781 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:29:37.963206 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m12:29:37.967514 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m12:29:37.967953 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:29:37.972030 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m12:29:37.972472 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:29:37.976597 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m12:29:37.977083 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:29:37.983748 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:29:37.984210 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:29:37.984675 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:29:37.985229 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m12:29:37.986265 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:29:37.986732 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:29:37.987156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905)
[0m12:29:37.987856 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:29:37.988721 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:29:37.989044 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:29:37.989460 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:29:37.989859 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m12:29:37.990340 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:29:37.991058 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:29:38.037445 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m12:29:38.037913 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:29:38.038380 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m12:29:38.038879 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:29:38.042415 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:29:38.042859 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:29:38.043278 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:29:38.043733 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m12:29:38.044361 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:29:38.045053 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:29:38.049033 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m12:29:38.049476 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:29:38.050190 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:29:38.050644 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:29:38.054990 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m12:29:38.055402 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:29:38.055903 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:29:38.056367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m12:29:38.057643 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:29:38.058006 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:29:38.058436 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.mart_housing_prices_breakdown, now test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a)
[0m12:29:38.058871 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:29:38.059330 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:29:38.060040 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:29:38.060466 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:29:38.064523 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m12:29:38.065147 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m12:29:38.065769 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:29:38.069845 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a"
[0m12:29:38.070552 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:29:38.071033 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:29:38.071519 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d)
[0m12:29:38.072063 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:29:38.076210 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m12:29:38.076957 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:29:38.077376 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:29:38.078147 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:29:38.078706 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:29:38.082947 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m12:29:38.083342 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:29:38.083937 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:29:38.084402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7)
[0m12:29:38.085332 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:29:38.085892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e)
[0m12:29:38.086283 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:29:38.086703 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:29:38.087176 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:29:38.087609 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:29:38.088378 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:29:38.092552 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m12:29:38.093089 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m12:29:38.097307 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m12:29:38.097841 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:29:38.098586 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:29:38.098972 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:29:38.099554 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281)
[0m12:29:38.105312 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:29:38.106443 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m12:29:38.107199 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:29:38.107613 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:29:38.108300 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:29:38.108963 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:29:38.113430 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m12:29:38.113962 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:29:38.114675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de)
[0m12:29:38.115699 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:29:38.116115 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:29:38.116535 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:29:38.117406 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:29:38.121587 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m12:29:38.122404 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:29:38.123062 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:29:38.124430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:38.124684 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c' was properly closed.
[0m12:29:38.124933 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281' was properly closed.
[0m12:29:38.125172 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e' was properly closed.
[0m12:29:38.125417 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de' was properly closed.
[0m12:29:38.131511 [debug] [MainThread]: Command end result
[0m12:29:38.240230 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:29:38.243204 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:29:38.251872 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:29:38.253688 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:29:38.254065 [info ] [MainThread]: Building catalog
[0m12:29:38.266816 [debug] [ThreadPool]: Acquiring new postgres connection 'dwh.information_schema'
[0m12:29:38.275160 [debug] [ThreadPool]: Using postgres connection "dwh.information_schema"
[0m12:29:38.275517 [debug] [ThreadPool]: On dwh.information_schema: BEGIN
[0m12:29:38.275771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:38.282281 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:29:38.282628 [debug] [ThreadPool]: Using postgres connection "dwh.information_schema"
[0m12:29:38.283110 [debug] [ThreadPool]: On dwh.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "dwh.information_schema"} */

    
    

    select
        'dwh' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('stg_location_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_location_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_example')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('stg_housing_prices')) or (upper(sch.nspname) = upper('public_bronze') and
           upper(tbl.relname) = upper('housing_prices')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('mart_housing_prices_breakdown')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_housing_prices')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('region_type_composition')) or (upper(sch.nspname) = upper('public_bronze') and
           upper(tbl.relname) = upper('location_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:29:38.287057 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.003 seconds
[0m12:29:38.290294 [debug] [ThreadPool]: On dwh.information_schema: ROLLBACK
[0m12:29:38.290766 [debug] [ThreadPool]: On dwh.information_schema: Close
[0m12:29:38.303115 [debug] [MainThread]: Wrote artifact CatalogArtifact to /dbt/target/catalog.json
[0m12:29:38.334959 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:29:38.336607 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:29:38.336885 [info ] [MainThread]: Catalog written to /dbt/target/catalog.json
[0m12:29:38.337791 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.241715, "process_in_blocks": "0", "process_kernel_time": 0.209091, "process_mem_max_rss": "120980", "process_out_blocks": "6056", "process_user_time": 2.389621}
[0m12:29:38.338285 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:29:38.338186 after 1.24 seconds
[0m12:29:38.338615 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:29:38.338855 [debug] [MainThread]: Connection 'dwh.information_schema' was properly closed.
[0m12:29:38.339165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97aae8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97c77c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9777d1b10>]}
[0m12:29:38.339615 [debug] [MainThread]: Flushing usage events
[0m12:29:38.859315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:46.617189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a773dc290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a773d1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7761b050>]}


============================== 12:29:46.619780 | 276c1103-e72d-4a48-99f2-ff669555656c ==============================
[0m12:29:46.619780 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:29:46.620294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8081', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:29:46.766483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '276c1103-e72d-4a48-99f2-ff669555656c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a76f0fe90>]}
[0m12:29:46.822352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '276c1103-e72d-4a48-99f2-ff669555656c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a79e2fbd0>]}
[0m12:32:49.652213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f289ecbc8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f289ecbf910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f289ecbc7d0>]}


============================== 12:32:49.659000 | b39ddca9-4606-4b0b-a98f-e9b45a9bbf22 ==============================
[0m12:32:49.659000 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:32:49.659910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:49.823904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b39ddca9-4606-4b0b-a98f-e9b45a9bbf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f289e66f090>]}
[0m12:32:49.886393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b39ddca9-4606-4b0b-a98f-e9b45a9bbf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a16e6dd0>]}
[0m12:32:49.887104 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:32:49.983881 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:32:50.136975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:32:50.137486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:32:50.191543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b39ddca9-4606-4b0b-a98f-e9b45a9bbf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f289ec06b50>]}
[0m12:32:50.213769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b39ddca9-4606-4b0b-a98f-e9b45a9bbf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f289d7aff10>]}
[0m12:32:50.214359 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 433 macros
[0m12:32:50.214701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b39ddca9-4606-4b0b-a98f-e9b45a9bbf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f289e3ad590>]}
[0m12:32:50.219518 [info ] [MainThread]: 
[0m12:32:50.219973 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:32:50.220314 [info ] [MainThread]: 
[0m12:32:50.220942 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:32:50.227161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_gold'
[0m12:32:50.228109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_bronze'
[0m12:32:50.241011 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m12:32:50.246867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_silver'
[0m12:32:50.279837 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m12:32:50.280225 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:32:50.280547 [debug] [ThreadPool]: On list_dwh_public_gold: BEGIN
[0m12:32:50.280886 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:32:50.281238 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m12:32:50.281547 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:32:50.281890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:50.282210 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m12:32:50.282536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:50.282884 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m12:32:50.283440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:50.283979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:50.291413 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:32:50.291963 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:32:50.292328 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:32:50.292648 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:32:50.293003 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m12:32:50.293321 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:32:50.293723 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:32:50.294111 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:32:50.294513 [debug] [ThreadPool]: On list_dwh_public_gold: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_gold"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:32:50.294906 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:32:50.295415 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m12:32:50.295960 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:32:50.299096 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m12:32:50.299670 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:32:50.301010 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m12:32:50.301352 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m12:32:50.301667 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m12:32:50.302897 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m12:32:50.304193 [debug] [ThreadPool]: On list_dwh_public_gold: ROLLBACK
[0m12:32:50.305406 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m12:32:50.305759 [debug] [ThreadPool]: On list_dwh_public: Close
[0m12:32:50.306508 [debug] [ThreadPool]: On list_dwh_public_gold: Close
[0m12:32:50.306766 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m12:32:50.307103 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m12:32:50.315956 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:50.316307 [debug] [MainThread]: On master: BEGIN
[0m12:32:50.316543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:32:50.323473 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:32:50.323829 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:50.324279 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:32:50.329680 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m12:32:50.332793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b39ddca9-4606-4b0b-a98f-e9b45a9bbf22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f289ed11c90>]}
[0m12:32:50.333243 [debug] [MainThread]: On master: ROLLBACK
[0m12:32:50.333731 [debug] [MainThread]: On master: Close
[0m12:32:50.338059 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m12:32:50.338477 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m12:32:50.338919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now model.airflow_dbt_training.housing_prices)
[0m12:32:50.339383 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m12:32:50.339864 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m12:32:50.340305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now model.airflow_dbt_training.location_data)
[0m12:32:50.340734 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m12:32:50.341158 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public_gold, now model.airflow_dbt_training.stg_example)
[0m12:32:50.341570 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.stg_location_data)
[0m12:32:50.341989 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m12:32:50.347685 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m12:32:50.351851 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m12:32:50.352475 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m12:32:50.354666 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m12:32:50.356781 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m12:32:50.360065 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m12:32:50.360585 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m12:32:50.361352 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m12:32:50.361760 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m12:32:50.362589 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m12:32:50.363476 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m12:32:50.363853 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m12:32:50.364583 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m12:32:50.365132 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:32:50.365589 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:32:50.366442 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m12:32:50.367019 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:32:50.367472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m12:32:50.368045 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m12:32:50.368569 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:32:50.369022 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m12:32:50.369677 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:32:50.370316 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:32:50.370845 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m12:32:50.371276 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:32:50.385607 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m12:32:50.390014 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m12:32:50.390515 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:32:50.394845 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m12:32:50.395931 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:32:50.396342 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:32:50.401080 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m12:32:50.402044 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:32:50.402513 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:32:50.403185 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:32:50.403786 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:32:50.404425 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:32:50.405113 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:32:50.405609 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:32:50.406244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m12:32:50.406986 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:32:50.407432 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:32:50.407885 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m12:32:50.408393 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:32:50.408856 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:32:50.409287 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m12:32:50.409807 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:32:50.414515 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m12:32:50.415116 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68)
[0m12:32:50.415561 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:32:50.419793 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m12:32:50.420417 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:32:50.424671 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m12:32:50.425387 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:32:50.432358 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m12:32:50.433494 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:32:50.434108 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:32:50.434700 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:32:50.435156 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:32:50.435966 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:32:50.436386 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:32:50.437234 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:32:50.437675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c, now test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175)
[0m12:32:50.438152 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m12:32:50.438835 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:32:50.439344 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m12:32:50.439770 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:32:50.440262 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522, now model.airflow_dbt_training.stg_housing_prices)
[0m12:32:50.440721 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:32:50.441151 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e, now model.airflow_dbt_training.region_type_composition)
[0m12:32:50.445619 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m12:32:50.446120 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m12:32:50.446569 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m12:32:50.446990 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m12:32:50.450233 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:32:50.450806 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:32:50.453752 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m12:32:50.454139 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:32:50.458494 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m12:32:50.459228 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m12:32:50.460000 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:32:50.460580 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m12:32:50.461485 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m12:32:50.462018 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:32:50.462431 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:32:50.463215 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m12:32:50.463658 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:32:50.464097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m12:32:50.465199 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:32:50.465704 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:32:50.466137 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m12:32:50.466854 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:32:50.469360 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:32:50.469851 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.region_type_composition, now test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2)
[0m12:32:50.470333 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:32:50.474918 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m12:32:50.475472 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m12:32:50.475904 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:32:50.480020 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m12:32:50.480637 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:32:50.484601 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m12:32:50.485298 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:32:50.494014 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m12:32:50.494499 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:32:50.495370 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:32:50.495938 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:32:50.496649 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:32:50.497378 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:32:50.497973 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:32:50.498672 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:32:50.499202 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:32:50.499671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e)
[0m12:32:50.500442 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:32:50.500904 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:32:50.501342 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m12:32:50.501844 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:32:50.502289 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:32:50.502878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m12:32:50.503361 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:32:50.507911 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m12:32:50.508397 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m12:32:50.508915 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:32:50.513079 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m12:32:50.513650 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:32:50.518166 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m12:32:50.518629 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:32:50.523085 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m12:32:50.523594 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:32:50.524449 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:32:50.524890 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:32:50.525738 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:32:50.526277 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:32:50.526653 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:32:50.527443 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:32:50.528064 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:32:50.528523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m12:32:50.529297 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:32:50.529745 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:32:50.530183 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m12:32:50.530681 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:32:50.531131 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:32:50.531570 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m12:32:50.532073 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:32:50.536790 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m12:32:50.537329 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m12:32:50.537760 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:32:50.541977 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m12:32:50.542616 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:32:50.546858 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m12:32:50.547364 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:32:50.553664 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m12:32:50.554345 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:32:50.554756 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:32:50.555474 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:32:50.556264 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:32:50.556666 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:32:50.557437 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:32:50.558184 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:32:50.558754 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:32:50.559540 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:32:50.559996 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:32:50.560433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905)
[0m12:32:50.560928 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m12:32:50.561397 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:32:50.561826 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m12:32:50.562335 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:32:50.562735 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:32:50.563166 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m12:32:50.563650 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:32:50.610453 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m12:32:50.613661 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:32:50.614184 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:32:50.618242 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m12:32:50.619288 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:32:50.619695 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:32:50.623780 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m12:32:50.624803 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:32:50.625672 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:32:50.626189 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:32:50.626788 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:32:50.627221 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:32:50.627688 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:32:50.628585 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:32:50.629209 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.mart_housing_prices_breakdown, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m12:32:50.629947 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:32:50.630438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905, now test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a)
[0m12:32:50.630969 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:32:50.631510 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:32:50.631967 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:32:50.632435 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:32:50.632949 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m12:32:50.637257 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m12:32:50.637806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d)
[0m12:32:50.642249 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a"
[0m12:32:50.642985 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:32:50.643554 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:32:50.644174 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:32:50.648481 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m12:32:50.652882 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m12:32:50.653302 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:32:50.654055 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:32:50.655483 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:32:50.656050 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:32:50.656412 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:32:50.656866 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:32:50.657416 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:32:50.658113 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:32:50.658844 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:32:50.659270 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7)
[0m12:32:50.659680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e)
[0m12:32:50.660159 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:32:50.660677 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:32:50.661224 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:32:50.661634 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:32:50.662097 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m12:32:50.662529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281)
[0m12:32:50.666903 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m12:32:50.671048 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m12:32:50.671513 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:32:50.671919 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:32:50.678099 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:32:50.678746 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m12:32:50.682977 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m12:32:50.683818 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:32:50.684234 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:32:50.685438 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:32:50.686072 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:32:50.686572 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:32:50.687292 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:32:50.687724 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de)
[0m12:32:50.688436 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:32:50.689095 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:32:50.689675 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:32:50.694214 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m12:32:50.694726 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:32:50.695394 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:32:50.696907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:50.697283 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de' was properly closed.
[0m12:32:50.697659 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e' was properly closed.
[0m12:32:50.697898 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c' was properly closed.
[0m12:32:50.698152 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281' was properly closed.
[0m12:32:50.704542 [debug] [MainThread]: Command end result
[0m12:32:50.805389 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:32:50.808264 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:32:50.816476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:32:50.818353 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:32:50.818727 [info ] [MainThread]: Building catalog
[0m12:32:50.830479 [debug] [ThreadPool]: Acquiring new postgres connection 'dwh.information_schema'
[0m12:32:50.838933 [debug] [ThreadPool]: Using postgres connection "dwh.information_schema"
[0m12:32:50.839286 [debug] [ThreadPool]: On dwh.information_schema: BEGIN
[0m12:32:50.839523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:50.846442 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:32:50.846807 [debug] [ThreadPool]: Using postgres connection "dwh.information_schema"
[0m12:32:50.847293 [debug] [ThreadPool]: On dwh.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "dwh.information_schema"} */

    
    

    select
        'dwh' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('mart_housing_prices_breakdown')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('region_type_composition')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('stg_housing_prices')) or (upper(sch.nspname) = upper('public_bronze') and
           upper(tbl.relname) = upper('housing_prices')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('stg_location_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_example')) or (upper(sch.nspname) = upper('public_bronze') and
           upper(tbl.relname) = upper('location_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_housing_prices')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_location_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:32:50.851537 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.004 seconds
[0m12:32:50.854830 [debug] [ThreadPool]: On dwh.information_schema: ROLLBACK
[0m12:32:50.855455 [debug] [ThreadPool]: On dwh.information_schema: Close
[0m12:32:50.867952 [debug] [MainThread]: Wrote artifact CatalogArtifact to /dbt/target/catalog.json
[0m12:32:50.899884 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:32:50.901363 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:32:50.901659 [info ] [MainThread]: Catalog written to /dbt/target/catalog.json
[0m12:32:50.902518 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.3058394, "process_in_blocks": "0", "process_kernel_time": 0.277423, "process_mem_max_rss": "120384", "process_out_blocks": "7872", "process_user_time": 2.546348}
[0m12:32:50.903007 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:32:50.902887 after 1.31 seconds
[0m12:32:50.903434 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:32:50.903772 [debug] [MainThread]: Connection 'dwh.information_schema' was properly closed.
[0m12:32:50.904090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f289ed07810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f289ed07590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f289fa4f9d0>]}
[0m12:32:50.904474 [debug] [MainThread]: Flushing usage events
[0m12:32:51.527667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:53.110160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37782d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa377a6bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37782d350>]}


============================== 12:32:53.113230 | 9bd02e56-480f-416f-b8c9-b5701efee05e ==============================
[0m12:32:53.113230 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:32:53.113768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8081', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:53.268439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bd02e56-480f-416f-b8c9-b5701efee05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37787ae90>]}
[0m12:32:53.328953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bd02e56-480f-416f-b8c9-b5701efee05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37a26e550>]}
[0m12:35:05.230774 [error] [MainThread]: Encountered an error:

[0m12:35:05.233516 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m12:35:05.234711 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 132.18304, "process_in_blocks": "0", "process_kernel_time": 0.089876, "process_mem_max_rss": "106224", "process_out_blocks": "3552", "process_user_time": 1.537887}
[0m12:35:05.235245 [debug] [MainThread]: Command `dbt docs serve` failed at 12:35:05.235139 after 132.18 seconds
[0m12:35:05.235631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37795be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37782f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37782c090>]}
[0m12:35:05.235998 [debug] [MainThread]: Flushing usage events
[0m12:35:05.862724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:31.923661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fbfabfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fc311d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fbfb6810>]}


============================== 12:35:31.926819 | ef5a7c23-7ba2-432e-a115-ce9e1c206c3d ==============================
[0m12:35:31.926819 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:35:31.927366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --port 8081 --host 0.0.0.0', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:35:32.089931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef5a7c23-7ba2-432e-a115-ce9e1c206c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fbadfe10>]}
[0m12:35:32.151096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef5a7c23-7ba2-432e-a115-ce9e1c206c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fe9f36d0>]}
[0m12:43:31.838680 [error] [MainThread]: Encountered an error:

[0m12:43:31.841115 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m12:43:31.842802 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 479.99655, "process_in_blocks": "0", "process_kernel_time": 0.089469, "process_mem_max_rss": "104604", "process_out_blocks": "3360", "process_user_time": 1.680032}
[0m12:43:31.843880 [debug] [MainThread]: Command `dbt docs serve` failed at 12:43:31.843691 after 480.00 seconds
[0m12:43:31.844333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fbfb6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fbfb40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fbfb7e50>]}
[0m12:43:31.844723 [debug] [MainThread]: Flushing usage events
[0m12:43:32.494514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:35.579129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e83b42750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e83b41cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e83b423d0>]}


============================== 12:43:35.582137 | 01daedc1-af08-4546-9da7-ed9cff407eff ==============================
[0m12:43:35.582137 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:43:35.582651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:43:35.739417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01daedc1-af08-4546-9da7-ed9cff407eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e83395410>]}
[0m12:43:35.799065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01daedc1-af08-4546-9da7-ed9cff407eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e86557690>]}
[0m12:43:35.799813 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:43:35.880814 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:43:36.009847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:36.010256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:36.062527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01daedc1-af08-4546-9da7-ed9cff407eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e83b932d0>]}
[0m12:43:36.164044 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:43:36.166548 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:43:36.179499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01daedc1-af08-4546-9da7-ed9cff407eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e81fdbf90>]}
[0m12:43:36.179974 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 433 macros
[0m12:43:36.180306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01daedc1-af08-4546-9da7-ed9cff407eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e81f3b7d0>]}
[0m12:43:36.183086 [info ] [MainThread]: 
[0m12:43:36.183517 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:36.183912 [info ] [MainThread]: 
[0m12:43:36.184648 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:36.190829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:43:36.204360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:43:36.218470 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:43:36.219649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m12:43:36.244900 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:43:36.245294 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:43:36.245647 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:43:36.245988 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:43:36.246367 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:43:36.246748 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m12:43:36.247105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:36.247535 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:43:36.247988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:36.248352 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m12:43:36.248968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:36.249532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:36.256477 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m12:43:36.257117 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m12:43:36.257447 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m12:43:36.257780 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m12:43:36.259162 [debug] [ThreadPool]: On list_dwh: Close
[0m12:43:36.260424 [debug] [ThreadPool]: On list_dwh: Close
[0m12:43:36.261614 [debug] [ThreadPool]: On list_dwh: Close
[0m12:43:36.262688 [debug] [ThreadPool]: On list_dwh: Close
[0m12:43:36.265773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_silver)
[0m12:43:36.266542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_gold)
[0m12:43:36.272439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_bronze)
[0m12:43:36.273971 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:43:36.274633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m12:43:36.276845 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m12:43:36.279275 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:43:36.279671 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m12:43:36.281941 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:43:36.282294 [debug] [ThreadPool]: On list_dwh_public_gold: BEGIN
[0m12:43:36.282637 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m12:43:36.282988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:36.283502 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m12:43:36.283910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:36.284349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:36.284929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:36.291408 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:43:36.292157 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m12:43:36.292647 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:43:36.292966 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:43:36.293323 [debug] [ThreadPool]: On list_dwh_public_gold: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_gold"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:43:36.293742 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:43:36.294105 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:43:36.294443 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:43:36.294882 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:43:36.295254 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:43:36.295714 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m12:43:36.296247 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:43:36.297205 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m12:43:36.298428 [debug] [ThreadPool]: On list_dwh_public_gold: ROLLBACK
[0m12:43:36.298830 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m12:43:36.300176 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m12:43:36.300599 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m12:43:36.300925 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m12:43:36.301398 [debug] [ThreadPool]: On list_dwh_public_gold: Close
[0m12:43:36.302739 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m12:43:36.303082 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m12:43:36.304230 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m12:43:36.305728 [debug] [ThreadPool]: On list_dwh_public: Close
[0m12:43:36.306617 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m12:43:36.314176 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:36.314628 [debug] [MainThread]: On master: BEGIN
[0m12:43:36.314893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:36.321847 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:43:36.322215 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:36.322672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:43:36.327654 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m12:43:36.330835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01daedc1-af08-4546-9da7-ed9cff407eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e807eda90>]}
[0m12:43:36.331314 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:36.331791 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:36.332120 [debug] [MainThread]: On master: BEGIN
[0m12:43:36.332842 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:43:36.333229 [debug] [MainThread]: On master: COMMIT
[0m12:43:36.333512 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:36.333760 [debug] [MainThread]: On master: COMMIT
[0m12:43:36.334171 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:36.334463 [debug] [MainThread]: On master: Close
[0m12:43:36.337329 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m12:43:36.337759 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m12:43:36.338829 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m12:43:36.340638 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m12:43:36.338328 [info ] [Thread-1 (]: 1 of 7 START sql view model public_bronze.housing_prices ....................... [RUN]
[0m12:43:36.339549 [info ] [Thread-2 (]: 2 of 7 START sql view model public_bronze.location_data ........................ [RUN]
[0m12:43:36.340218 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m12:43:36.342407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now model.airflow_dbt_training.housing_prices)
[0m12:43:36.341391 [info ] [Thread-4 (]: 4 of 7 START sql view model public_silver.stg_location_data .................... [RUN]
[0m12:43:36.343216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.location_data)
[0m12:43:36.343807 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now model.airflow_dbt_training.stg_example)
[0m12:43:36.344493 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m12:43:36.345276 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_dwh_public_gold, now model.airflow_dbt_training.stg_location_data)
[0m12:43:36.345787 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m12:43:36.346221 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m12:43:36.355770 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m12:43:36.356377 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m12:43:36.360670 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m12:43:36.363392 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m12:43:36.367030 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m12:43:36.367574 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m12:43:36.368603 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m12:43:36.369174 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m12:43:36.390576 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m12:43:36.425333 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m12:43:36.427075 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m12:43:36.429007 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m12:43:36.432969 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m12:43:36.434057 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:43:36.434502 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:43:36.435088 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:43:36.435738 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m12:43:36.436276 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m12:43:36.436698 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:43:36.437125 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m12:43:36.437557 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:43:36.437956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:36.438378 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m12:43:36.438785 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:43:36.439570 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:43:36.445981 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m12:43:36.446463 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:43:36.446823 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public_bronze"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m12:43:36.447457 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m12:43:36.447986 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:43:36.449039 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public_silver"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m12:43:36.449693 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m12:43:36.450227 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:43:36.450718 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m12:43:36.451155 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:43:36.451529 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:43:36.457320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m12:43:36.459710 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:43:36.460337 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:43:36.463929 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:43:36.464364 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:43:36.464792 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data" rename to "location_data__dbt_backup"
[0m12:43:36.469301 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:43:36.469791 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m12:43:36.470260 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public_bronze"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m12:43:36.470797 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m12:43:36.471527 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:36.472091 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:36.472631 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:36.522837 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m12:43:36.524525 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:43:36.527856 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:43:36.531108 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:43:36.534775 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:43:36.535302 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data__dbt_tmp" rename to "location_data"
[0m12:43:36.535770 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m12:43:36.536232 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m12:43:36.536675 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices" rename to "housing_prices__dbt_backup"
[0m12:43:36.537589 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:43:36.543315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:43:36.543899 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:43:36.547449 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:43:36.547883 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m12:43:36.563994 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m12:43:36.571728 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m12:43:36.574907 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m12:43:36.576556 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m12:43:36.577243 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:43:36.577732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:36.578153 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:43:36.578568 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:43:36.578990 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m12:43:36.580558 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m12:43:36.581021 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m12:43:36.581489 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m12:43:36.582056 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:43:36.582636 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m12:43:36.585864 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m12:43:36.593612 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m12:43:36.594286 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m12:43:36.593027 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public_bronze"."location_data__dbt_backup"
[0m12:43:36.597337 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m12:43:36.597729 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m12:43:36.600548 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_silver"."stg_location_data__dbt_backup"
[0m12:43:36.606497 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m12:43:36.607276 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m12:43:36.610098 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public_bronze"."housing_prices__dbt_backup"
[0m12:43:36.610811 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m12:43:36.611305 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public_bronze"."location_data__dbt_backup" cascade
[0m12:43:36.611847 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m12:43:36.612733 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m12:43:36.613165 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public_silver"."stg_location_data__dbt_backup" cascade
[0m12:43:36.613807 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public_bronze"."housing_prices__dbt_backup" cascade
[0m12:43:36.617229 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:43:36.619840 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m12:43:36.620379 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m12:43:36.620931 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m12:43:36.622259 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m12:43:36.624213 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m12:43:36.624794 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01daedc1-af08-4546-9da7-ed9cff407eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e82b8f850>]}
[0m12:43:36.626250 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m12:43:36.627609 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m12:43:36.628103 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01daedc1-af08-4546-9da7-ed9cff407eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e8057e190>]}
[0m12:43:36.628819 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public_bronze.location_data ................... [[32mCREATE VIEW[0m in 0.28s]
[0m12:43:36.629642 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01daedc1-af08-4546-9da7-ed9cff407eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e83ef4810>]}
[0m12:43:36.630565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01daedc1-af08-4546-9da7-ed9cff407eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e80440290>]}
[0m12:43:36.632164 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m12:43:36.631421 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.28s]
[0m12:43:36.633002 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public_silver.stg_location_data ............... [[32mCREATE VIEW[0m in 0.28s]
[0m12:43:36.633950 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public_bronze.housing_prices .................. [[32mCREATE VIEW[0m in 0.29s]
[0m12:43:36.635038 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m12:43:36.636390 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m12:43:36.637294 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m12:43:36.638597 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m12:43:36.639328 [info ] [Thread-2 (]: 5 of 7 START sql view model public_gold.region_type_composition ................ [RUN]
[0m12:43:36.640207 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition)
[0m12:43:36.640653 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m12:43:36.641056 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m12:43:36.641674 [info ] [Thread-4 (]: 6 of 7 START sql view model public_silver.stg_housing_prices ................... [RUN]
[0m12:43:36.646592 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m12:43:36.647200 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m12:43:36.647925 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m12:43:36.654170 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:43:36.654762 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m12:43:36.658994 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m12:43:36.659605 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m12:43:36.663946 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:43:36.664458 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m12:43:36.665142 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m12:43:36.665484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:43:36.666448 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:43:36.667135 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m12:43:36.667581 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:43:36.673262 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m12:43:36.673686 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m12:43:36.674088 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public_gold"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public_silver"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m12:43:36.674927 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m12:43:36.675254 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:43:36.675602 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public_silver"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public_bronze"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m12:43:36.676279 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:43:36.680093 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m12:43:36.680552 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:43:36.681122 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public_gold"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m12:43:36.684414 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:43:36.685017 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public_silver"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m12:43:36.685492 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:36.686814 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m12:43:36.687175 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m12:43:36.687508 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m12:43:36.687968 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:43:36.689140 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m12:43:36.689469 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:43:36.689786 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m12:43:36.691019 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:36.693834 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public_gold"."region_type_composition__dbt_backup"
[0m12:43:36.694465 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m12:43:36.694871 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public_gold"."region_type_composition__dbt_backup" cascade
[0m12:43:36.695282 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m12:43:36.698187 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_silver"."stg_housing_prices__dbt_backup"
[0m12:43:36.698640 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:43:36.699428 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m12:43:36.700819 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m12:43:36.701283 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public_silver"."stg_housing_prices__dbt_backup" cascade
[0m12:43:36.702034 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01daedc1-af08-4546-9da7-ed9cff407eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e805171d0>]}
[0m12:43:36.702533 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:43:36.703458 [info ] [Thread-2 (]: 5 of 7 OK created sql view model public_gold.region_type_composition ........... [[32mCREATE VIEW[0m in 0.06s]
[0m12:43:36.705037 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m12:43:36.705665 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m12:43:36.706558 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01daedc1-af08-4546-9da7-ed9cff407eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e80543dd0>]}
[0m12:43:36.707209 [info ] [Thread-4 (]: 6 of 7 OK created sql view model public_silver.stg_housing_prices .............. [[32mCREATE VIEW[0m in 0.06s]
[0m12:43:36.707868 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m12:43:36.709290 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:43:36.710140 [info ] [Thread-3 (]: 7 of 7 START sql view model public_gold.mart_housing_prices_breakdown .......... [RUN]
[0m12:43:36.710733 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m12:43:36.711238 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:43:36.714923 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:43:36.715636 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:43:36.720295 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:43:36.721331 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:43:36.721784 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m12:43:36.722120 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:43:36.729209 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m12:43:36.729647 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:43:36.730040 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public_silver"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public_gold"."region_type_composition" r
  ON p.region = r.region
  );
[0m12:43:36.732047 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:43:36.735949 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:43:36.736369 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m12:43:36.737159 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:43:36.738416 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m12:43:36.738881 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:43:36.739396 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m12:43:36.742384 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:36.746979 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_backup"
[0m12:43:36.747673 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:43:36.748041 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m12:43:36.748681 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:43:36.749910 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m12:43:36.750482 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01daedc1-af08-4546-9da7-ed9cff407eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e83384bd0>]}
[0m12:43:36.751321 [info ] [Thread-3 (]: 7 of 7 OK created sql view model public_gold.mart_housing_prices_breakdown ..... [[32mCREATE VIEW[0m in 0.04s]
[0m12:43:36.751981 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:43:36.753898 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:36.754230 [debug] [MainThread]: On master: BEGIN
[0m12:43:36.754493 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:36.761539 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:43:36.761927 [debug] [MainThread]: On master: COMMIT
[0m12:43:36.762198 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:36.762436 [debug] [MainThread]: On master: COMMIT
[0m12:43:36.762834 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:36.763190 [debug] [MainThread]: On master: Close
[0m12:43:36.763733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:36.763987 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m12:43:36.764243 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m12:43:36.764463 [debug] [MainThread]: Connection 'model.airflow_dbt_training.housing_prices' was properly closed.
[0m12:43:36.764678 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m12:43:36.765032 [info ] [MainThread]: 
[0m12:43:36.765451 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m12:43:36.767248 [debug] [MainThread]: Command end result
[0m12:43:36.803199 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:43:36.804846 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:43:36.811673 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:43:36.812231 [info ] [MainThread]: 
[0m12:43:36.812623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:36.812913 [info ] [MainThread]: 
[0m12:43:36.813470 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:43:36.814673 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2900074, "process_in_blocks": "0", "process_kernel_time": 0.174455, "process_mem_max_rss": "120628", "process_out_blocks": "2360", "process_user_time": 2.473167}
[0m12:43:36.815141 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:36.815046 after 1.29 seconds
[0m12:43:36.815516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e87e94e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e87e94410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e87e94450>]}
[0m12:43:36.815885 [debug] [MainThread]: Flushing usage events
[0m12:43:37.493996 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:40.473133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fb3fd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fb433050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fb433890>]}


============================== 12:43:40.475809 | 60492023-8454-49c9-a144-528ca9878534 ==============================
[0m12:43:40.475809 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:43:40.476529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:43:40.629126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60492023-8454-49c9-a144-528ca9878534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fa744d90>]}
[0m12:43:40.687885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60492023-8454-49c9-a144-528ca9878534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fdc696d0>]}
[0m12:43:40.688723 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:43:40.764894 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:43:40.891983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:40.892345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:40.944711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60492023-8454-49c9-a144-528ca9878534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2f9fb42d0>]}
[0m12:43:40.958027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60492023-8454-49c9-a144-528ca9878534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2f930bd90>]}
[0m12:43:40.958520 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 433 macros
[0m12:43:40.958839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60492023-8454-49c9-a144-528ca9878534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2f9f83650>]}
[0m12:43:40.962374 [info ] [MainThread]: 
[0m12:43:40.962822 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:40.963112 [info ] [MainThread]: 
[0m12:43:40.963823 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:40.969083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_silver'
[0m12:43:40.979607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_gold'
[0m12:43:40.990240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public_bronze'
[0m12:43:40.996230 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m12:43:41.025067 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:43:41.025492 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m12:43:41.025820 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m12:43:41.026168 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:43:41.026531 [debug] [ThreadPool]: On list_dwh_public_gold: BEGIN
[0m12:43:41.026845 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:43:41.027210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:41.027554 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m12:43:41.027915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:41.028288 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m12:43:41.028977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:41.029544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:41.036174 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:43:41.036918 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:43:41.037286 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m12:43:41.037704 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m12:43:41.038042 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:43:41.038346 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:43:41.038749 [debug] [ThreadPool]: On list_dwh_public_gold: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_gold"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:43:41.039210 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:43:41.039588 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m12:43:41.039945 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m12:43:41.040578 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m12:43:41.041117 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:43:41.042740 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m12:43:41.044064 [debug] [ThreadPool]: On list_dwh_public_gold: ROLLBACK
[0m12:43:41.044604 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m12:43:41.045163 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m12:43:41.046486 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m12:43:41.046991 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m12:43:41.047365 [debug] [ThreadPool]: On list_dwh_public_gold: Close
[0m12:43:41.048574 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m12:43:41.049897 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m12:43:41.050319 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m12:43:41.051513 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m12:43:41.053432 [debug] [ThreadPool]: On list_dwh_public: Close
[0m12:43:41.059695 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:41.060030 [debug] [MainThread]: On master: BEGIN
[0m12:43:41.060261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:41.066949 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:43:41.067331 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:41.067782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:43:41.072998 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m12:43:41.076164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60492023-8454-49c9-a144-528ca9878534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2f9bbba90>]}
[0m12:43:41.076564 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:41.077090 [debug] [MainThread]: On master: Close
[0m12:43:41.080290 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m12:43:41.080767 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m12:43:41.081361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m12:43:41.081774 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m12:43:41.082198 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m12:43:41.082661 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now model.airflow_dbt_training.location_data)
[0m12:43:41.083217 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m12:43:41.083818 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now model.airflow_dbt_training.stg_example)
[0m12:43:41.084289 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_dwh_public_gold, now model.airflow_dbt_training.stg_location_data)
[0m12:43:41.084702 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m12:43:41.093805 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m12:43:41.094299 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m12:43:41.094753 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m12:43:41.097069 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m12:43:41.099494 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m12:43:41.100007 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m12:43:41.103253 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m12:43:41.104208 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m12:43:41.104994 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m12:43:41.105395 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m12:43:41.106226 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m12:43:41.106938 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:43:41.108238 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m12:43:41.108658 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m12:43:41.109125 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:43:41.109680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m12:43:41.110159 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:43:41.110863 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m12:43:41.111424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m12:43:41.111866 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:43:41.112293 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m12:43:41.112938 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:43:41.113743 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:43:41.127196 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m12:43:41.127713 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:43:41.128194 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m12:43:41.133736 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m12:43:41.138445 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m12:43:41.138902 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:43:41.139375 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:43:41.140237 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:43:41.140639 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:43:41.141420 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m12:43:41.145924 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m12:43:41.146743 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m12:43:41.147432 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m12:43:41.147879 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:43:41.148580 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:43:41.149392 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:43:41.149788 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:43:41.150332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m12:43:41.150917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m12:43:41.151385 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m12:43:41.152107 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m12:43:41.152520 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:43:41.152934 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:43:41.153369 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:43:41.153828 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:43:41.158631 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m12:43:41.163168 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m12:43:41.167400 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m12:43:41.168195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68)
[0m12:43:41.169264 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:43:41.169866 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:43:41.170267 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:43:41.170699 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:43:41.171428 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m12:43:41.172096 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m12:43:41.172758 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m12:43:41.179553 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m12:43:41.180230 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:43:41.180791 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m12:43:41.181381 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m12:43:41.182078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c, now test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175)
[0m12:43:41.182628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e, now model.airflow_dbt_training.stg_housing_prices)
[0m12:43:41.183008 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:43:41.183434 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522, now model.airflow_dbt_training.region_type_composition)
[0m12:43:41.183864 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:43:41.184271 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m12:43:41.184967 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m12:43:41.185388 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m12:43:41.189814 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m12:43:41.192976 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m12:43:41.193539 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:43:41.196554 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m12:43:41.197644 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m12:43:41.198117 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:43:41.198815 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m12:43:41.199441 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:43:41.199862 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m12:43:41.200591 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m12:43:41.201308 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m12:43:41.205701 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m12:43:41.206560 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m12:43:41.207027 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:43:41.207582 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:43:41.208554 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:43:41.210068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m12:43:41.210728 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:43:41.211236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m12:43:41.211685 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.region_type_composition, now test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2)
[0m12:43:41.212118 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:43:41.212832 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m12:43:41.213229 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:43:41.213652 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:43:41.220272 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m12:43:41.220857 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:43:41.225554 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m12:43:41.230048 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m12:43:41.230793 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m12:43:41.231305 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:43:41.232164 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:43:41.232525 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:43:41.232903 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:43:41.233642 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m12:43:41.242759 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m12:43:41.243568 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m12:43:41.244260 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m12:43:41.244723 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:43:41.245458 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:43:41.246198 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:43:41.247011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e)
[0m12:43:41.247733 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:43:41.248256 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m12:43:41.248705 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m12:43:41.249155 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:43:41.249864 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m12:43:41.250274 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:43:41.250656 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:43:41.255846 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m12:43:41.256462 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:43:41.261273 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m12:43:41.265770 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m12:43:41.266606 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m12:43:41.267012 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:43:41.267887 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:43:41.268301 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:43:41.268696 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:43:41.269428 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m12:43:41.270108 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m12:43:41.271111 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m12:43:41.275668 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m12:43:41.276225 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:43:41.276854 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:43:41.277725 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:43:41.278571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m12:43:41.279041 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:43:41.279501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m12:43:41.279961 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m12:43:41.280391 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:43:41.281078 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m12:43:41.281494 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:43:41.281903 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:43:41.286523 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m12:43:41.287104 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:43:41.291719 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m12:43:41.296138 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m12:43:41.296863 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m12:43:41.297548 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:43:41.297916 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:43:41.298481 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:43:41.299266 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m12:43:41.299655 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:43:41.300340 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m12:43:41.304800 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m12:43:41.305393 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:43:41.306186 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m12:43:41.306732 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:43:41.307567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905)
[0m12:43:41.308212 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:43:41.308791 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:43:41.309209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m12:43:41.309619 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:43:41.310040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m12:43:41.310723 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m12:43:41.311166 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:43:41.316871 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:43:41.318059 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m12:43:41.318595 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:43:41.370683 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m12:43:41.376336 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m12:43:41.377118 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m12:43:41.378065 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:43:41.378640 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:43:41.379211 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:43:41.380448 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m12:43:41.381138 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:43:41.385535 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m12:43:41.386841 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m12:43:41.387478 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:43:41.388399 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m12:43:41.389354 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:43:41.389953 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.mart_housing_prices_breakdown, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m12:43:41.390465 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:43:41.391148 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a)
[0m12:43:41.391505 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:43:41.391931 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:43:41.392656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m12:43:41.393302 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:43:41.394128 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m12:43:41.398664 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m12:43:41.399399 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:43:41.403780 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a"
[0m12:43:41.404519 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:43:41.409557 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m12:43:41.410727 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d)
[0m12:43:41.411354 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:43:41.411895 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:43:41.412537 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:43:41.413342 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m12:43:41.413832 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:43:41.414522 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m12:43:41.419347 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m12:43:41.419929 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:43:41.420764 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m12:43:41.421243 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:43:41.421942 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7)
[0m12:43:41.422645 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:43:41.423572 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e)
[0m12:43:41.424018 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:43:41.424450 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:43:41.424893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m12:43:41.425309 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:43:41.426000 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m12:43:41.430904 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m12:43:41.431435 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:43:41.436171 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m12:43:41.436764 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:43:41.442152 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m12:43:41.442612 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:43:41.443334 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281)
[0m12:43:41.443847 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:43:41.444740 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m12:43:41.445098 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:43:41.445509 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:43:41.446179 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m12:43:41.446691 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:43:41.447914 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m12:43:41.454286 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m12:43:41.455088 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de)
[0m12:43:41.455857 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:43:41.460626 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m12:43:41.461299 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:43:41.461974 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m12:43:41.462552 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:43:41.463163 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m12:43:41.464504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:41.464832 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e' was properly closed.
[0m12:43:41.465241 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281' was properly closed.
[0m12:43:41.465610 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de' was properly closed.
[0m12:43:41.465862 [debug] [MainThread]: Connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c' was properly closed.
[0m12:43:41.472234 [debug] [MainThread]: Command end result
[0m12:43:41.612585 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:43:41.617230 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:43:41.631286 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:43:41.633865 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:43:41.634538 [info ] [MainThread]: Building catalog
[0m12:43:41.655037 [debug] [ThreadPool]: Acquiring new postgres connection 'dwh.information_schema'
[0m12:43:41.667191 [debug] [ThreadPool]: Using postgres connection "dwh.information_schema"
[0m12:43:41.667765 [debug] [ThreadPool]: On dwh.information_schema: BEGIN
[0m12:43:41.668134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:41.675068 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:43:41.675478 [debug] [ThreadPool]: Using postgres connection "dwh.information_schema"
[0m12:43:41.675995 [debug] [ThreadPool]: On dwh.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "dwh.information_schema"} */

    
    

    select
        'dwh' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_housing_prices')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_location_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_example')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('mart_housing_prices_breakdown')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('stg_housing_prices')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('region_type_composition')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('stg_location_data')) or (upper(sch.nspname) = upper('public_bronze') and
           upper(tbl.relname) = upper('location_data')) or (upper(sch.nspname) = upper('public_bronze') and
           upper(tbl.relname) = upper('housing_prices')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:43:41.680185 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.004 seconds
[0m12:43:41.683967 [debug] [ThreadPool]: On dwh.information_schema: ROLLBACK
[0m12:43:41.684528 [debug] [ThreadPool]: On dwh.information_schema: Close
[0m12:43:41.697614 [debug] [MainThread]: Wrote artifact CatalogArtifact to /dbt/target/catalog.json
[0m12:43:41.730142 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:43:41.731889 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:43:41.732529 [info ] [MainThread]: Catalog written to /dbt/target/catalog.json
[0m12:43:41.735932 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.3145522, "process_in_blocks": "0", "process_kernel_time": 0.281508, "process_mem_max_rss": "120692", "process_out_blocks": "6056", "process_user_time": 2.362656}
[0m12:43:41.736637 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:43:41.736519 after 1.32 seconds
[0m12:43:41.737034 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:43:41.737366 [debug] [MainThread]: Connection 'dwh.information_schema' was properly closed.
[0m12:43:41.737790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2f9710b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2ff5bcf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2ff5bc3d0>]}
[0m12:43:41.738334 [debug] [MainThread]: Flushing usage events
[0m12:43:42.259102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:50.081399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a7a1f48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a7a433b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a7a1f4310>]}


============================== 12:43:50.084113 | 77467b08-1d3a-458d-b5af-fe25a42d0e25 ==============================
[0m12:43:50.084113 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:43:50.084644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8081 --host 0.0.0.0', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:43:50.243342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77467b08-1d3a-458d-b5af-fe25a42d0e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a7a263dd0>]}
[0m12:43:50.304805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77467b08-1d3a-458d-b5af-fe25a42d0e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a7cc37310>]}
[0m16:37:49.581714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f87f5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f8b49910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f87f4fd0>]}


============================== 16:37:49.585374 | 190fd49b-af58-41e9-b3aa-3b91fb784543 ==============================
[0m16:37:49.585374 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:37:49.585996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:37:49.758624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '190fd49b-af58-41e9-b3aa-3b91fb784543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f7f05290>]}
[0m16:37:49.816976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '190fd49b-af58-41e9-b3aa-3b91fb784543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3fb229690>]}
[0m16:37:49.818206 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:37:49.901834 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:37:50.053099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:50.053470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:50.106707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '190fd49b-af58-41e9-b3aa-3b91fb784543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f7306dd0>]}
[0m16:37:50.206275 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m16:37:50.208740 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m16:37:50.229038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '190fd49b-af58-41e9-b3aa-3b91fb784543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f836aa50>]}
[0m16:37:50.229569 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 433 macros
[0m16:37:50.229917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '190fd49b-af58-41e9-b3aa-3b91fb784543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f7704550>]}
[0m16:37:50.232440 [info ] [MainThread]: 
[0m16:37:50.232844 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:37:50.233151 [info ] [MainThread]: 
[0m16:37:50.233977 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:37:50.240542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m16:37:50.248685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m16:37:50.254784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m16:37:50.262636 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m16:37:50.298818 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m16:37:50.299239 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m16:37:50.299603 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m16:37:50.299937 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m16:37:50.300297 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m16:37:50.300631 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m16:37:50.301030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:50.301407 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m16:37:50.301765 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m16:37:50.302141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:50.302742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:50.303067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:50.321978 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m16:37:50.322561 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.019 seconds
[0m16:37:50.323075 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.020 seconds
[0m16:37:50.323365 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m16:37:50.324681 [debug] [ThreadPool]: On list_dwh: Close
[0m16:37:50.326181 [debug] [ThreadPool]: On list_dwh: Close
[0m16:37:50.327344 [debug] [ThreadPool]: On list_dwh: Close
[0m16:37:50.328417 [debug] [ThreadPool]: On list_dwh: Close
[0m16:37:50.331835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m16:37:50.332439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_gold)
[0m16:37:50.338314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_silver)
[0m16:37:50.340294 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m16:37:50.340937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_bronze)
[0m16:37:50.343183 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m16:37:50.345524 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m16:37:50.345930 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m16:37:50.348110 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m16:37:50.348486 [debug] [ThreadPool]: On list_dwh_public_gold: BEGIN
[0m16:37:50.348840 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m16:37:50.349183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:50.349584 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m16:37:50.349899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:50.350227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:50.350752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:50.357380 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m16:37:50.357971 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:37:50.358451 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m16:37:50.358769 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:37:50.359152 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m16:37:50.359499 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:37:50.359977 [debug] [ThreadPool]: On list_dwh_public_gold: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_gold"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:37:50.360524 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m16:37:50.361011 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:37:50.361452 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m16:37:50.361946 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:37:50.362521 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m16:37:50.369813 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m16:37:50.370291 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m16:37:50.370724 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m16:37:50.371968 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m16:37:50.372309 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m16:37:50.373428 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m16:37:50.374619 [debug] [ThreadPool]: On list_dwh_public_gold: ROLLBACK
[0m16:37:50.375845 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m16:37:50.376174 [debug] [ThreadPool]: On list_dwh_public: Close
[0m16:37:50.376797 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m16:37:50.377232 [debug] [ThreadPool]: On list_dwh_public_gold: Close
[0m16:37:50.379310 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m16:37:50.385852 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:50.386189 [debug] [MainThread]: On master: BEGIN
[0m16:37:50.386435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:50.392911 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:37:50.393263 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:50.393822 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:37:50.403137 [debug] [MainThread]: SQL status: SELECT 9 in 0.009 seconds
[0m16:37:50.406357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '190fd49b-af58-41e9-b3aa-3b91fb784543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f831cd10>]}
[0m16:37:50.406799 [debug] [MainThread]: On master: ROLLBACK
[0m16:37:50.407285 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:50.407561 [debug] [MainThread]: On master: BEGIN
[0m16:37:50.408156 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:37:50.408428 [debug] [MainThread]: On master: COMMIT
[0m16:37:50.408677 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:50.408915 [debug] [MainThread]: On master: COMMIT
[0m16:37:50.409441 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:37:50.409721 [debug] [MainThread]: On master: Close
[0m16:37:50.413151 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m16:37:50.413586 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m16:37:50.414156 [info ] [Thread-1 (]: 1 of 7 START sql view model public_bronze.housing_prices ....................... [RUN]
[0m16:37:50.414707 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m16:37:50.415278 [info ] [Thread-2 (]: 2 of 7 START sql view model public_bronze.location_data ........................ [RUN]
[0m16:37:50.416089 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m16:37:50.416779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now model.airflow_dbt_training.housing_prices)
[0m16:37:50.417446 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m16:37:50.418167 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public_gold, now model.airflow_dbt_training.location_data)
[0m16:37:50.418940 [info ] [Thread-4 (]: 4 of 7 START sql view model public_silver.stg_location_data .................... [RUN]
[0m16:37:50.419593 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m16:37:50.420163 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.stg_example)
[0m16:37:50.420645 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m16:37:50.421095 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now model.airflow_dbt_training.stg_location_data)
[0m16:37:50.431408 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m16:37:50.431897 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m16:37:50.435516 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m16:37:50.436041 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m16:37:50.438529 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m16:37:50.438975 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m16:37:50.442140 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m16:37:50.453458 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m16:37:50.459482 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m16:37:50.499889 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m16:37:50.502335 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m16:37:50.503240 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m16:37:50.503821 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m16:37:50.504312 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m16:37:50.509071 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m16:37:50.509613 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m16:37:50.510139 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m16:37:50.510542 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m16:37:50.511131 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m16:37:50.511604 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:37:50.511997 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m16:37:50.512399 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m16:37:50.512790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:50.513420 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m16:37:50.513808 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:37:50.514389 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:37:50.520019 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m16:37:50.520665 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m16:37:50.521725 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public_bronze"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m16:37:50.522228 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m16:37:50.523035 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m16:37:50.523608 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m16:37:50.524185 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m16:37:50.524748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:37:50.525339 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m16:37:50.525988 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m16:37:50.526477 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public_silver"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m16:37:50.526949 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public_bronze"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m16:37:50.530661 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:37:50.536566 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m16:37:50.537188 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m16:37:50.539269 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m16:37:50.539684 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m16:37:50.543078 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m16:37:50.547342 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m16:37:50.547860 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m16:37:50.594861 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices" rename to "housing_prices__dbt_backup"
[0m16:37:50.596624 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m16:37:50.597083 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m16:37:50.597753 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data" rename to "location_data__dbt_backup"
[0m16:37:50.598195 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:37:50.598710 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:37:50.599136 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:37:50.602909 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m16:37:50.603425 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:37:50.606773 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m16:37:50.609924 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m16:37:50.610445 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m16:37:50.613561 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m16:37:50.614030 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m16:37:50.614501 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m16:37:50.615056 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data__dbt_tmp" rename to "location_data"
[0m16:37:50.615584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:37:50.616192 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:37:50.621975 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:37:50.622411 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:37:50.637147 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m16:37:50.640699 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m16:37:50.642233 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m16:37:50.643573 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m16:37:50.644000 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m16:37:50.644432 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m16:37:50.644849 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m16:37:50.645267 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m16:37:50.645733 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m16:37:50.646264 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m16:37:50.646689 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m16:37:50.647096 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m16:37:50.650415 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m16:37:50.657244 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_silver"."stg_location_data__dbt_backup"
[0m16:37:50.657855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m16:37:50.658241 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m16:37:50.658758 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m16:37:50.663994 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m16:37:50.666883 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public_bronze"."housing_prices__dbt_backup"
[0m16:37:50.669695 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m16:37:50.672474 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public_bronze"."location_data__dbt_backup"
[0m16:37:50.672961 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public_silver"."stg_location_data__dbt_backup" cascade
[0m16:37:50.673677 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m16:37:50.674362 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m16:37:50.675015 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m16:37:50.675548 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public_bronze"."housing_prices__dbt_backup" cascade
[0m16:37:50.676024 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m16:37:50.676494 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public_bronze"."location_data__dbt_backup" cascade
[0m16:37:50.681222 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:37:50.683701 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m16:37:50.684326 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m16:37:50.686319 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.011 seconds
[0m16:37:50.687830 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m16:37:50.688180 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.011 seconds
[0m16:37:50.688584 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '190fd49b-af58-41e9-b3aa-3b91fb784543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f8f7dc10>]}
[0m16:37:50.689949 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m16:37:50.690594 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '190fd49b-af58-41e9-b3aa-3b91fb784543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f8f0a190>]}
[0m16:37:50.691887 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m16:37:50.692593 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.26s]
[0m16:37:50.693998 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '190fd49b-af58-41e9-b3aa-3b91fb784543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3fb0e9710>]}
[0m16:37:50.695005 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m16:37:50.693425 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public_bronze.location_data ................... [[32mCREATE VIEW[0m in 0.27s]
[0m16:37:50.695852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '190fd49b-af58-41e9-b3aa-3b91fb784543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f4259690>]}
[0m16:37:50.696689 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public_silver.stg_location_data ............... [[32mCREATE VIEW[0m in 0.27s]
[0m16:37:50.697941 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m16:37:50.698734 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public_bronze.housing_prices .................. [[32mCREATE VIEW[0m in 0.28s]
[0m16:37:50.699660 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m16:37:50.700619 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m16:37:50.701945 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m16:37:50.702711 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m16:37:50.703576 [info ] [Thread-3 (]: 5 of 7 START sql view model public_gold.region_type_composition ................ [RUN]
[0m16:37:50.704509 [info ] [Thread-4 (]: 6 of 7 START sql view model public_silver.stg_housing_prices ................... [RUN]
[0m16:37:50.705249 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m16:37:50.706046 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m16:37:50.706683 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m16:37:50.707432 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m16:37:50.711534 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m16:37:50.716955 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m16:37:50.717842 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m16:37:50.721683 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m16:37:50.722323 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m16:37:50.726200 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m16:37:50.726741 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m16:37:50.727371 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m16:37:50.727703 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:37:50.728302 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m16:37:50.728645 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m16:37:50.728968 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:37:50.734277 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m16:37:50.734953 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m16:37:50.735978 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public_gold"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public_silver"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m16:37:50.736711 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m16:37:50.737320 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m16:37:50.737725 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public_silver"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public_bronze"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m16:37:50.741254 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:37:50.744732 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m16:37:50.745229 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:37:50.745713 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public_silver"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m16:37:50.749026 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m16:37:50.749555 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public_gold"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m16:37:50.749980 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:37:50.751216 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m16:37:50.751569 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m16:37:50.751910 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m16:37:50.752296 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:37:50.753438 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m16:37:50.753763 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m16:37:50.754309 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m16:37:50.755193 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m16:37:50.757830 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_silver"."stg_housing_prices__dbt_backup"
[0m16:37:50.758562 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m16:37:50.758943 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public_silver"."stg_housing_prices__dbt_backup" cascade
[0m16:37:50.759387 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m16:37:50.761833 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public_gold"."region_type_composition__dbt_backup"
[0m16:37:50.762436 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m16:37:50.762793 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public_gold"."region_type_composition__dbt_backup" cascade
[0m16:37:50.763253 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:37:50.764521 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m16:37:50.764919 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:37:50.766129 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m16:37:50.766692 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '190fd49b-af58-41e9-b3aa-3b91fb784543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f4160110>]}
[0m16:37:50.767373 [info ] [Thread-4 (]: 6 of 7 OK created sql view model public_silver.stg_housing_prices .............. [[32mCREATE VIEW[0m in 0.06s]
[0m16:37:50.768127 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m16:37:50.769035 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '190fd49b-af58-41e9-b3aa-3b91fb784543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f6fcf450>]}
[0m16:37:50.769779 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public_gold.region_type_composition ........... [[32mCREATE VIEW[0m in 0.06s]
[0m16:37:50.770458 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m16:37:50.771672 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m16:37:50.772606 [info ] [Thread-2 (]: 7 of 7 START sql view model public_gold.mart_housing_prices_breakdown .......... [RUN]
[0m16:37:50.773316 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m16:37:50.773947 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m16:37:50.778222 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m16:37:50.778872 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m16:37:50.783331 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m16:37:50.783972 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m16:37:50.784403 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m16:37:50.784734 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:37:50.791513 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m16:37:50.792134 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m16:37:50.792719 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public_silver"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public_gold"."region_type_composition" r
  ON p.region = r.region
  );
[0m16:37:50.795462 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:37:50.798903 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m16:37:50.799320 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m16:37:50.800113 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:37:50.801497 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m16:37:50.801994 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m16:37:50.802351 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m16:37:50.805152 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:37:50.807918 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_backup"
[0m16:37:50.808547 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m16:37:50.808890 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m16:37:50.809507 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:37:50.810789 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m16:37:50.811383 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '190fd49b-af58-41e9-b3aa-3b91fb784543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f4161d90>]}
[0m16:37:50.811966 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public_gold.mart_housing_prices_breakdown ..... [[32mCREATE VIEW[0m in 0.04s]
[0m16:37:50.812538 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m16:37:50.814430 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:50.814785 [debug] [MainThread]: On master: BEGIN
[0m16:37:50.815072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:50.822306 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:37:50.822768 [debug] [MainThread]: On master: COMMIT
[0m16:37:50.823212 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:50.823506 [debug] [MainThread]: On master: COMMIT
[0m16:37:50.823991 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:37:50.824308 [debug] [MainThread]: On master: Close
[0m16:37:50.824733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:50.824969 [debug] [MainThread]: Connection 'model.airflow_dbt_training.housing_prices' was properly closed.
[0m16:37:50.825234 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m16:37:50.825455 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m16:37:50.825672 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m16:37:50.826031 [info ] [MainThread]: 
[0m16:37:50.826333 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m16:37:50.828437 [debug] [MainThread]: Command end result
[0m16:37:50.863922 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m16:37:50.865606 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m16:37:50.871771 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m16:37:50.872107 [info ] [MainThread]: 
[0m16:37:50.872440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:50.872731 [info ] [MainThread]: 
[0m16:37:50.873115 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:37:50.874803 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3458685, "process_in_blocks": "65608", "process_kernel_time": 0.172261, "process_mem_max_rss": "121228", "process_out_blocks": "2376", "process_user_time": 2.482599}
[0m16:37:50.875343 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:50.875235 after 1.35 seconds
[0m16:37:50.875760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f884b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f8848410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f8849750>]}
[0m16:37:50.876123 [debug] [MainThread]: Flushing usage events
[0m16:37:51.682595 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:59:45.599120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e22719e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2256b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2256ab50>]}


============================== 21:59:45.602361 | 1779acb9-2b84-4ea4-aad8-6f49db2b81c6 ==============================
[0m21:59:45.602361 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:59:45.602925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:59:45.778307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e225f3950>]}
[0m21:59:45.835526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e24f8b650>]}
[0m21:59:45.836593 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:59:45.918141 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:59:46.065570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:59:46.066152 [debug] [MainThread]: Partial parsing: added file: airflow_dbt_training://models/silver/incremental_prices.sql
[0m21:59:46.360195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e21115610>]}
[0m21:59:46.465208 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m21:59:46.467815 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m21:59:46.489796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e21de7cd0>]}
[0m21:59:46.490515 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m21:59:46.490987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e20983150>]}
[0m21:59:46.494148 [info ] [MainThread]: 
[0m21:59:46.494830 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:59:46.495285 [info ] [MainThread]: 
[0m21:59:46.496240 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:59:46.501646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m21:59:46.507734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m21:59:46.508834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m21:59:46.515135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m21:59:46.613146 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m21:59:46.613584 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m21:59:46.613874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:46.614429 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m21:59:46.614774 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m21:59:46.615154 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m21:59:46.615490 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m21:59:46.615873 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m21:59:46.616233 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m21:59:46.616589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:46.616920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:46.617337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:46.638424 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m21:59:46.639947 [debug] [ThreadPool]: On list_dwh: Close
[0m21:59:46.640412 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.024 seconds
[0m21:59:46.640762 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.027 seconds
[0m21:59:46.641052 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.024 seconds
[0m21:59:46.642312 [debug] [ThreadPool]: On list_dwh: Close
[0m21:59:46.643769 [debug] [ThreadPool]: On list_dwh: Close
[0m21:59:46.645038 [debug] [ThreadPool]: On list_dwh: Close
[0m21:59:46.648061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_silver)
[0m21:59:46.654073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_bronze)
[0m21:59:46.654859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m21:59:46.660868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_gold)
[0m21:59:46.660013 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m21:59:46.662732 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m21:59:46.665064 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m21:59:46.667332 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m21:59:46.667732 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m21:59:46.668061 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m21:59:46.668411 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m21:59:46.668749 [debug] [ThreadPool]: On list_dwh_public_gold: BEGIN
[0m21:59:46.669098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:46.669439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:46.669771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:46.670115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:46.678019 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m21:59:46.678788 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m21:59:46.679433 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m21:59:46.679844 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m21:59:46.680261 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m21:59:46.680823 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m21:59:46.681359 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m21:59:46.681973 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m21:59:46.682513 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m21:59:46.683042 [debug] [ThreadPool]: On list_dwh_public_gold: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_gold"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m21:59:46.683572 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:59:46.684524 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m21:59:46.695005 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m21:59:46.695434 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m21:59:46.695777 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m21:59:46.697619 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m21:59:46.698122 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.013 seconds
[0m21:59:46.699339 [debug] [ThreadPool]: On list_dwh_public_gold: ROLLBACK
[0m21:59:46.700545 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m21:59:46.701804 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m21:59:46.702173 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m21:59:46.702735 [debug] [ThreadPool]: On list_dwh_public_gold: Close
[0m21:59:46.704158 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m21:59:46.704486 [debug] [ThreadPool]: On list_dwh_public: Close
[0m21:59:46.712839 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:46.713210 [debug] [MainThread]: On master: BEGIN
[0m21:59:46.713455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:46.719975 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:59:46.720627 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:46.721520 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:59:46.732667 [debug] [MainThread]: SQL status: SELECT 9 in 0.010 seconds
[0m21:59:46.736015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e209b5d50>]}
[0m21:59:46.736482 [debug] [MainThread]: On master: ROLLBACK
[0m21:59:46.736987 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:46.737272 [debug] [MainThread]: On master: BEGIN
[0m21:59:46.737829 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:59:46.738133 [debug] [MainThread]: On master: COMMIT
[0m21:59:46.738391 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:46.738863 [debug] [MainThread]: On master: COMMIT
[0m21:59:46.739609 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:59:46.740007 [debug] [MainThread]: On master: Close
[0m21:59:46.743620 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m21:59:46.744089 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m21:59:46.745451 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m21:59:46.746123 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m21:59:46.744731 [info ] [Thread-1 (]: 1 of 8 START sql view model public_bronze.housing_prices ....................... [RUN]
[0m21:59:46.746873 [info ] [Thread-2 (]: 2 of 8 START sql view model public_bronze.location_data ........................ [RUN]
[0m21:59:46.747727 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m21:59:46.748763 [info ] [Thread-4 (]: 4 of 8 START sql view model public_silver.stg_location_data .................... [RUN]
[0m21:59:46.749816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m21:59:46.750529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now model.airflow_dbt_training.location_data)
[0m21:59:46.751462 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public_gold, now model.airflow_dbt_training.stg_example)
[0m21:59:46.752074 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now model.airflow_dbt_training.stg_location_data)
[0m21:59:46.752590 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m21:59:46.753070 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m21:59:46.753657 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m21:59:46.754138 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m21:59:46.764225 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m21:59:46.766641 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m21:59:46.768843 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m21:59:46.772379 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m21:59:46.773772 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m21:59:46.774213 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m21:59:46.774696 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m21:59:46.785856 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m21:59:46.863439 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m21:59:46.866572 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m21:59:46.867416 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m21:59:46.868861 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m21:59:46.869340 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m21:59:46.869863 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m21:59:46.870496 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m21:59:46.870962 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m21:59:46.871477 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m21:59:46.871866 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m21:59:46.872251 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m21:59:46.872679 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:59:46.873086 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:59:46.873484 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m21:59:46.873877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:46.874652 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:59:46.880681 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m21:59:46.881610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m21:59:46.882107 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m21:59:46.882556 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m21:59:46.883107 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m21:59:46.883717 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m21:59:46.884267 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m21:59:46.884944 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public_bronze"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m21:59:46.885621 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m21:59:46.886071 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public_bronze"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m21:59:46.886539 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public_silver"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m21:59:46.887111 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m21:59:46.894257 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m21:59:46.894878 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m21:59:46.900563 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m21:59:46.901116 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m21:59:46.906434 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m21:59:46.908963 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m21:59:46.912148 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m21:59:46.915725 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m21:59:46.916221 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data" rename to "location_data__dbt_backup"
[0m21:59:46.916674 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices" rename to "housing_prices__dbt_backup"
[0m21:59:46.917114 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m21:59:46.917572 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m21:59:46.918405 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:59:46.922885 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m21:59:46.923424 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data__dbt_tmp" rename to "location_data"
[0m21:59:46.923835 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:59:46.924437 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:59:46.927618 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m21:59:46.928001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m21:59:46.931021 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m21:59:46.931429 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m21:59:46.931851 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m21:59:46.935007 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m21:59:46.935451 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m21:59:46.946481 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m21:59:46.953851 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m21:59:46.954349 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m21:59:46.954956 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m21:59:46.956620 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m21:59:46.957007 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:59:46.957444 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:59:46.957828 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m21:59:46.958260 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m21:59:46.959609 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m21:59:46.961014 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m21:59:46.961543 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m21:59:46.961971 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m21:59:46.962421 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m21:59:46.962918 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m21:59:46.963349 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m21:59:46.964012 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m21:59:46.970533 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public_bronze"."location_data__dbt_backup"
[0m21:59:46.970952 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m21:59:46.971416 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m21:59:46.979469 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m21:59:46.976668 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m21:59:46.979962 [debug] [Thread-4 (]: SQL status: COMMIT in 0.016 seconds
[0m21:59:46.982654 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public_bronze"."housing_prices__dbt_backup"
[0m21:59:46.983330 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m21:59:46.983763 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public_bronze"."location_data__dbt_backup" cascade
[0m21:59:46.986347 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_silver"."stg_location_data__dbt_backup"
[0m21:59:46.987150 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m21:59:46.987597 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m21:59:46.988380 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m21:59:46.988788 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public_bronze"."housing_prices__dbt_backup" cascade
[0m21:59:46.989342 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public_silver"."stg_location_data__dbt_backup" cascade
[0m21:59:46.993089 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m21:59:46.995557 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m21:59:46.996047 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m21:59:46.996585 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m21:59:46.998243 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.008 seconds
[0m21:59:46.999663 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m21:59:47.000980 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m21:59:47.002344 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m21:59:47.002768 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1df69590>]}
[0m21:59:47.003360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1de845d0>]}
[0m21:59:47.003898 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2011d050>]}
[0m21:59:47.004821 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m21:59:47.005547 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1de8ea10>]}
[0m21:59:47.006572 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_bronze.housing_prices .................. [[32mCREATE VIEW[0m in 0.25s]
[0m21:59:47.007740 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public_bronze.location_data ................... [[32mCREATE VIEW[0m in 0.25s]
[0m21:59:47.009191 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m21:59:47.010060 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public_silver.stg_location_data ............... [[32mCREATE VIEW[0m in 0.25s]
[0m21:59:47.011156 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m21:59:47.012435 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m21:59:47.013985 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m21:59:47.016206 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m21:59:47.016980 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m21:59:47.018200 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m21:59:47.017619 [info ] [Thread-3 (]: 5 of 8 START sql incremental model public_silver.incremental_prices ............ [RUN]
[0m21:59:47.019833 [info ] [Thread-1 (]: 6 of 8 START sql view model public_silver.stg_housing_prices ................... [RUN]
[0m21:59:47.020870 [info ] [Thread-2 (]: 7 of 8 START sql view model public_gold.region_type_composition ................ [RUN]
[0m21:59:47.022134 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.incremental_prices)
[0m21:59:47.022727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m21:59:47.023372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition)
[0m21:59:47.023990 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m21:59:47.024980 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m21:59:47.025608 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m21:59:47.030471 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m21:59:47.033998 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m21:59:47.037534 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m21:59:47.038377 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m21:59:47.039077 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m21:59:47.063991 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m21:59:47.069738 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m21:59:47.089400 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m21:59:47.094194 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m21:59:47.095302 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m21:59:47.095715 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m21:59:47.096149 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m21:59:47.096659 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m21:59:47.097089 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m21:59:47.097492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:47.097905 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m21:59:47.098314 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:59:47.098915 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:59:47.105200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m21:59:47.105821 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m21:59:47.106280 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m21:59:47.106760 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m21:59:47.107261 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m21:59:47.107685 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m21:59:47.108281 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public_silver"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public_bronze"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m21:59:47.108888 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public_gold"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public_silver"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m21:59:47.109416 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      
  
    

  create  table "dwh"."public_silver"."incremental_prices"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public_bronze"."housing_prices"

  );
  
  
[0m21:59:47.114237 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:59:47.114837 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:59:47.118337 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m21:59:47.121614 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m21:59:47.122134 [debug] [Thread-3 (]: SQL status: SELECT 1500 in 0.012 seconds
[0m21:59:47.122550 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public_silver"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m21:59:47.123036 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public_gold"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m21:59:47.127919 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m21:59:47.128560 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m21:59:47.129054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:59:47.129469 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m21:59:47.129861 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:59:47.131332 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m21:59:47.132700 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m21:59:47.133170 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m21:59:47.133599 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m21:59:47.134033 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m21:59:47.134446 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m21:59:47.134977 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m21:59:47.135837 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m21:59:47.136379 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1de7bbd0>]}
[0m21:59:47.136942 [info ] [Thread-3 (]: 5 of 8 OK created sql incremental model public_silver.incremental_prices ....... [[32mSELECT 1500[0m in 0.11s]
[0m21:59:47.137535 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m21:59:47.137910 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:59:47.141344 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public_silver"."stg_housing_prices__dbt_backup"
[0m21:59:47.141914 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m21:59:47.142772 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m21:59:47.145471 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public_gold"."region_type_composition__dbt_backup"
[0m21:59:47.145950 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public_silver"."stg_housing_prices__dbt_backup" cascade
[0m21:59:47.146801 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m21:59:47.147408 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public_gold"."region_type_composition__dbt_backup" cascade
[0m21:59:47.147851 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:59:47.149328 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m21:59:47.149727 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:59:47.150896 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m21:59:47.151596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1de5b890>]}
[0m21:59:47.152235 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1de65110>]}
[0m21:59:47.152928 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_silver.stg_housing_prices .............. [[32mCREATE VIEW[0m in 0.13s]
[0m21:59:47.153664 [info ] [Thread-2 (]: 7 of 8 OK created sql view model public_gold.region_type_composition ........... [[32mCREATE VIEW[0m in 0.13s]
[0m21:59:47.154460 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m21:59:47.155167 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m21:59:47.156342 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m21:59:47.156915 [info ] [Thread-4 (]: 8 of 8 START sql view model public_gold.mart_housing_prices_breakdown .......... [RUN]
[0m21:59:47.157780 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m21:59:47.158260 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m21:59:47.161881 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m21:59:47.162459 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m21:59:47.169890 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m21:59:47.170720 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m21:59:47.171107 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m21:59:47.171457 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:59:47.177934 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m21:59:47.178359 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m21:59:47.178792 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public_silver"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public_gold"."region_type_composition" r
  ON p.region = r.region
  );
[0m21:59:47.181836 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:59:47.185235 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m21:59:47.185614 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m21:59:47.186393 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:59:47.187616 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m21:59:47.187980 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m21:59:47.188327 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m21:59:47.191179 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m21:59:47.193828 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_backup"
[0m21:59:47.194475 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m21:59:47.194823 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m21:59:47.195585 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:59:47.196857 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m21:59:47.197413 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1779acb9-2b84-4ea4-aad8-6f49db2b81c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2010ebd0>]}
[0m21:59:47.198009 [info ] [Thread-4 (]: 8 of 8 OK created sql view model public_gold.mart_housing_prices_breakdown ..... [[32mCREATE VIEW[0m in 0.04s]
[0m21:59:47.198562 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m21:59:47.200441 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:47.200756 [debug] [MainThread]: On master: BEGIN
[0m21:59:47.200993 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:59:47.207741 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:59:47.208321 [debug] [MainThread]: On master: COMMIT
[0m21:59:47.208823 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:47.209232 [debug] [MainThread]: On master: COMMIT
[0m21:59:47.209816 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:59:47.210100 [debug] [MainThread]: On master: Close
[0m21:59:47.210569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:47.210814 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m21:59:47.211069 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m21:59:47.211296 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m21:59:47.211586 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m21:59:47.212139 [info ] [MainThread]: 
[0m21:59:47.212712 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m21:59:47.215073 [debug] [MainThread]: Command end result
[0m21:59:47.248597 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m21:59:47.250071 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m21:59:47.256232 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m21:59:47.256532 [info ] [MainThread]: 
[0m21:59:47.256880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:59:47.257196 [info ] [MainThread]: 
[0m21:59:47.257626 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m21:59:47.259318 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7104727, "process_in_blocks": "66672", "process_kernel_time": 0.298462, "process_mem_max_rss": "124456", "process_out_blocks": "3392", "process_user_time": 2.676213}
[0m21:59:47.259829 [debug] [MainThread]: Command `dbt run` succeeded at 21:59:47.259726 after 1.71 seconds
[0m21:59:47.260346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e268dccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e268dc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e268dc290>]}
[0m21:59:47.260948 [debug] [MainThread]: Flushing usage events
[0m21:59:48.050154 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:01:51.116683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec8b76b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec8bc1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec8b76090>]}


============================== 22:01:51.120073 | 1846a0c2-5856-44f0-9921-0042ac76ef70 ==============================
[0m22:01:51.120073 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:01:51.120657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:01:51.138951 [info ] [MainThread]: dbt version: 1.9.4
[0m22:01:51.139371 [info ] [MainThread]: python version: 3.11.12
[0m22:01:51.139758 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:01:51.140318 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m22:01:51.191973 [info ] [MainThread]: Using profiles dir at /dbt
[0m22:01:51.192387 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m22:01:51.192771 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m22:01:51.193491 [info ] [MainThread]: adapter type: postgres
[0m22:01:51.194010 [info ] [MainThread]: adapter version: 1.9.0
[0m22:01:51.290969 [info ] [MainThread]: Configuration:
[0m22:01:51.291377 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:01:51.291654 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:01:51.291947 [info ] [MainThread]: Required dependencies:
[0m22:01:51.292307 [debug] [MainThread]: Executing "git --help"
[0m22:01:51.299897 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:01:51.300451 [debug] [MainThread]: STDERR: "b''"
[0m22:01:51.300738 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:01:51.301077 [info ] [MainThread]: Connection:
[0m22:01:51.301461 [info ] [MainThread]:   host: dwh
[0m22:01:51.301925 [info ] [MainThread]:   port: 5432
[0m22:01:51.302321 [info ] [MainThread]:   user: airflow
[0m22:01:51.302702 [info ] [MainThread]:   database: dwh
[0m22:01:51.303043 [info ] [MainThread]:   schema: public
[0m22:01:51.303429 [info ] [MainThread]:   connect_timeout: 10
[0m22:01:51.303903 [info ] [MainThread]:   role: None
[0m22:01:51.304318 [info ] [MainThread]:   search_path: None
[0m22:01:51.304744 [info ] [MainThread]:   keepalives_idle: 0
[0m22:01:51.305103 [info ] [MainThread]:   sslmode: None
[0m22:01:51.305575 [info ] [MainThread]:   sslcert: None
[0m22:01:51.306117 [info ] [MainThread]:   sslkey: None
[0m22:01:51.306692 [info ] [MainThread]:   sslrootcert: None
[0m22:01:51.307185 [info ] [MainThread]:   application_name: dbt
[0m22:01:51.307631 [info ] [MainThread]:   retries: 1
[0m22:01:51.308137 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:01:51.381171 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:01:51.406076 [debug] [MainThread]: Using postgres connection "debug"
[0m22:01:51.406424 [debug] [MainThread]: On debug: select 1 as id
[0m22:01:51.406657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:01:51.413986 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m22:01:51.414881 [debug] [MainThread]: On debug: Close
[0m22:01:51.415206 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:01:51.415498 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:01:51.416371 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.35124856, "process_in_blocks": "104", "process_kernel_time": 0.199836, "process_mem_max_rss": "111300", "process_out_blocks": "16", "process_user_time": 1.4688}
[0m22:01:51.416960 [debug] [MainThread]: Command `dbt debug` succeeded at 22:01:51.416844 after 0.35 seconds
[0m22:01:51.417274 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:01:51.417572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec7b64650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec8da77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eccf15290>]}
[0m22:01:51.417951 [debug] [MainThread]: Flushing usage events
[0m22:01:52.072399 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:07:32.332892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9703e25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97042ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97042fb10>]}


============================== 22:07:32.335461 | 6b90255c-2507-4d1b-9ed4-50907d0ba0e8 ==============================
[0m22:07:32.335461 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:07:32.336016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:07:32.486110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9703d6f90>]}
[0m22:07:32.543323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96fb89650>]}
[0m22:07:32.544008 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:07:32.622234 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:07:32.730605 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:07:32.731037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc970afb610>]}
[0m22:07:34.221590 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.gold
- models.bronze
- models.silver
[0m22:07:34.236880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96e74d750>]}
[0m22:07:34.336679 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:07:34.339138 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:07:34.351327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96eb71490>]}
[0m22:07:34.351812 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:07:34.352127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96e796f90>]}
[0m22:07:34.354867 [info ] [MainThread]: 
[0m22:07:34.355380 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:07:34.355941 [info ] [MainThread]: 
[0m22:07:34.356945 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:07:34.363045 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:07:34.400947 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:07:34.401307 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:07:34.401568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:34.409092 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m22:07:34.410287 [debug] [ThreadPool]: On list_dwh: Close
[0m22:07:34.412032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:07:34.418347 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:07:34.418665 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:07:34.418899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:34.425390 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:07:34.425728 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:07:34.426066 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:07:34.428675 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m22:07:34.429976 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:07:34.430423 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:07:34.436561 [debug] [MainThread]: Using postgres connection "master"
[0m22:07:34.436856 [debug] [MainThread]: On master: BEGIN
[0m22:07:34.437114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:34.443736 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:07:34.444151 [debug] [MainThread]: Using postgres connection "master"
[0m22:07:34.444602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:07:34.449749 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m22:07:34.452814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96e786910>]}
[0m22:07:34.453245 [debug] [MainThread]: On master: ROLLBACK
[0m22:07:34.453758 [debug] [MainThread]: Using postgres connection "master"
[0m22:07:34.454019 [debug] [MainThread]: On master: BEGIN
[0m22:07:34.454622 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:07:34.454902 [debug] [MainThread]: On master: COMMIT
[0m22:07:34.455151 [debug] [MainThread]: Using postgres connection "master"
[0m22:07:34.455384 [debug] [MainThread]: On master: COMMIT
[0m22:07:34.455903 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:07:34.456284 [debug] [MainThread]: On master: Close
[0m22:07:34.459242 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:07:34.459691 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:07:34.460215 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:07:34.460864 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:07:34.461579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:07:34.462199 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:07:34.463363 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:07:34.463842 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:07:34.464368 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:07:34.465181 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:07:34.465682 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:07:34.466257 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:07:34.475808 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:07:34.476450 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:07:34.478833 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:07:34.479400 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:07:34.479952 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:07:34.480500 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:07:34.481075 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:07:34.481590 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:07:34.483854 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:07:34.497424 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:07:34.538149 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:07:34.539004 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:07:34.540085 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:07:34.540714 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:07:34.544770 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:07:34.545245 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:07:34.546039 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:07:34.550437 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:07:34.551330 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:07:34.551776 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:07:34.552264 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:07:34.552965 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:07:34.553623 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:07:34.554087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:34.554493 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:07:34.555115 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:07:34.555878 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:07:34.556416 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:07:34.561431 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:07:34.562329 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:07:34.563146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:07:34.563801 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:07:34.564720 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:07:34.565400 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m22:07:34.566492 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:07:34.567467 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:07:34.567925 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m22:07:34.568313 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:07:34.574093 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:07:34.576395 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:07:34.576848 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:07:34.577358 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:07:34.581288 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:07:34.581794 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:07:34.582225 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:07:34.582834 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:07:34.583826 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:07:34.584382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:07:34.587605 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:07:34.587991 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:07:34.588430 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:07:34.591684 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:07:34.592170 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:07:34.595424 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:07:34.598831 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:07:34.599297 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:07:34.599858 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:07:34.600305 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:07:34.600710 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:07:34.606690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:07:34.607101 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:07:34.618109 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m22:07:34.627559 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:07:34.631064 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:07:34.632546 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:07:34.635850 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:07:34.637554 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:07:34.638007 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:07:34.638456 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:07:34.638879 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:07:34.639310 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:07:34.639717 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:07:34.640120 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:07:34.640923 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:07:34.642340 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:07:34.642700 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:07:34.643007 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:07:34.643955 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:07:34.650502 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:07:34.656262 [debug] [Thread-2 (]: SQL status: COMMIT in 0.016 seconds
[0m22:07:34.659167 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:07:34.659569 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m22:07:34.660264 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:07:34.660639 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m22:07:34.663217 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:07:34.655891 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:07:34.663765 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:07:34.666330 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:07:34.666989 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:07:34.667425 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:07:34.668293 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:07:34.668728 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:07:34.669262 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:07:34.669905 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:07:34.672250 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:07:34.672669 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:07:34.674098 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:07:34.674654 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:07:34.676022 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:07:34.678336 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m22:07:34.678820 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96ef1bb10>]}
[0m22:07:34.680056 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:07:34.680534 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96c3f95d0>]}
[0m22:07:34.680876 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96fef6290>]}
[0m22:07:34.681584 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m22:07:34.682995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96f3ed010>]}
[0m22:07:34.682414 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m22:07:34.683980 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m22:07:34.684799 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:07:34.685613 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.22s]
[0m22:07:34.687032 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:07:34.687765 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:07:34.688795 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:07:34.690341 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:07:34.690758 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:07:34.691710 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:07:34.691338 [info ] [Thread-2 (]: 5 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:07:34.692402 [info ] [Thread-3 (]: 6 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:07:34.693506 [info ] [Thread-4 (]: 7 of 8 START sql view model public.stg_housing_prices .......................... [RUN]
[0m22:07:34.694243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.incremental_prices)
[0m22:07:34.694979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m22:07:34.695503 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m22:07:34.695976 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:07:34.696401 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:07:34.696856 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:07:34.701556 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:07:34.704968 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:07:34.708595 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:07:34.709468 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:07:34.709994 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:07:34.710523 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:07:34.719714 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:07:34.744251 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:07:34.768211 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m22:07:34.769026 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:07:34.769514 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:07:34.769911 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:07:34.770416 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:07:34.770781 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:07:34.771227 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:07:34.771627 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:07:34.772009 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m22:07:34.772806 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:07:34.779071 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m22:07:34.779667 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m22:07:34.780261 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:07:34.780861 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:07:34.781565 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:07:34.782226 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m22:07:34.782819 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:07:34.783342 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:07:34.783952 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      
  
    

  create  table "dwh"."public"."incremental_prices"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."housing_prices"

  );
  
  
[0m22:07:34.785277 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:07:34.788759 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:07:34.789155 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:07:34.789599 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:07:34.793097 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:07:34.793612 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:07:34.794029 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:07:34.794391 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:07:34.795635 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:07:34.796887 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:07:34.797359 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:07:34.797810 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:07:34.798255 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:07:34.798703 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:07:34.799068 [debug] [Thread-2 (]: SQL status: SELECT 1500 in 0.015 seconds
[0m22:07:34.804525 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:07:34.805103 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:07:34.805607 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:07:34.806093 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m22:07:34.808814 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:07:34.809435 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m22:07:34.810072 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:07:34.810468 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m22:07:34.813036 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:07:34.813521 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:07:34.814391 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:07:34.815059 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:07:34.815660 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:07:34.816329 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96c415310>]}
[0m22:07:34.816820 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:07:34.817499 [info ] [Thread-2 (]: 5 of 8 OK created sql incremental model public.incremental_prices .............. [[32mSELECT 1500[0m in 0.12s]
[0m22:07:34.817966 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:07:34.819335 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:07:34.820088 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:07:34.821544 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:07:34.822433 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96c43f590>]}
[0m22:07:34.823246 [info ] [Thread-4 (]: 7 of 8 OK created sql view model public.stg_housing_prices ..................... [[32mCREATE VIEW[0m in 0.13s]
[0m22:07:34.824024 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:07:34.824662 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96c5aad90>]}
[0m22:07:34.825344 [info ] [Thread-3 (]: 6 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.13s]
[0m22:07:34.825861 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:07:34.826868 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:07:34.827391 [info ] [Thread-1 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:07:34.827914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:07:34.828397 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:07:34.831887 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:07:34.832672 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:07:34.837099 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:07:34.837685 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:07:34.838049 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:07:34.838461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:34.845313 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:07:34.845756 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:07:34.846218 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:07:34.848301 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:07:34.851682 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:07:34.852090 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:07:34.852929 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:07:34.854185 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:07:34.854524 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:07:34.854833 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:07:34.857803 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:07:34.860548 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:07:34.861142 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:07:34.861502 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:07:34.862101 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:07:34.863392 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:07:34.863951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b90255c-2507-4d1b-9ed4-50907d0ba0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96c30af10>]}
[0m22:07:34.864531 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.04s]
[0m22:07:34.865072 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:07:34.866894 [debug] [MainThread]: Using postgres connection "master"
[0m22:07:34.867242 [debug] [MainThread]: On master: BEGIN
[0m22:07:34.867490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:34.874685 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:07:34.875211 [debug] [MainThread]: On master: COMMIT
[0m22:07:34.875488 [debug] [MainThread]: Using postgres connection "master"
[0m22:07:34.875786 [debug] [MainThread]: On master: COMMIT
[0m22:07:34.876349 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:07:34.876751 [debug] [MainThread]: On master: Close
[0m22:07:34.877193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:34.877434 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:07:34.877662 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:07:34.877906 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:07:34.878125 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:07:34.878470 [info ] [MainThread]: 
[0m22:07:34.878791 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m22:07:34.881052 [debug] [MainThread]: Command end result
[0m22:07:34.962636 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:07:34.964120 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:07:34.969910 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:07:34.970190 [info ] [MainThread]: 
[0m22:07:34.970590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:34.970877 [info ] [MainThread]: 
[0m22:07:34.971314 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m22:07:34.972513 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6919525, "process_in_blocks": "272", "process_kernel_time": 0.22135, "process_mem_max_rss": "127980", "process_out_blocks": "3352", "process_user_time": 3.742842}
[0m22:07:34.973008 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:34.972913 after 2.69 seconds
[0m22:07:34.973345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc974758ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc974758310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9714e29d0>]}
[0m22:07:34.973733 [debug] [MainThread]: Flushing usage events
[0m22:07:35.882546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:08:48.519450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05818d6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0582670e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05818ca290>]}


============================== 22:08:48.522187 | a80be7b1-8238-4d6e-b179-078ae40cd7aa ==============================
[0m22:08:48.522187 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:08:48.522807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:48.670894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05811dded0>]}
[0m22:08:48.727722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05842eb210>]}
[0m22:08:48.728396 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:08:48.807826 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:08:48.915672 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:08:48.916142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0581fe7810>]}
[0m22:08:50.403156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0580165290>]}
[0m22:08:50.499515 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:08:50.501925 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:08:50.514696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057f958050>]}
[0m22:08:50.515199 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:08:50.515521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057f945610>]}
[0m22:08:50.518998 [info ] [MainThread]: 
[0m22:08:50.519809 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:08:50.520991 [info ] [MainThread]: 
[0m22:08:50.521940 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:08:50.527870 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:08:50.534078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:08:50.545432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:08:50.556719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:08:50.587430 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:08:50.587841 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:08:50.588185 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:08:50.588519 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:08:50.588884 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:08:50.589217 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:08:50.589552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:50.589905 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:08:50.590254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:50.590655 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:08:50.591283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:50.591910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:50.598978 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m22:08:50.599681 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m22:08:50.600040 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m22:08:50.600372 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m22:08:50.601599 [debug] [ThreadPool]: On list_dwh: Close
[0m22:08:50.602754 [debug] [ThreadPool]: On list_dwh: Close
[0m22:08:50.603797 [debug] [ThreadPool]: On list_dwh: Close
[0m22:08:50.604837 [debug] [ThreadPool]: On list_dwh: Close
[0m22:08:50.607818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:08:50.608406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_bronze)
[0m22:08:50.615047 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:08:50.617191 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m22:08:50.617762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_gold)
[0m22:08:50.618378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public_silver)
[0m22:08:50.618766 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:08:50.619199 [debug] [ThreadPool]: On list_dwh_public_bronze: BEGIN
[0m22:08:50.621328 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m22:08:50.623365 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m22:08:50.623729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:50.624072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:50.624416 [debug] [ThreadPool]: On list_dwh_public_gold: BEGIN
[0m22:08:50.624771 [debug] [ThreadPool]: On list_dwh_public_silver: BEGIN
[0m22:08:50.625521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:50.625994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:50.631316 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:08:50.631965 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:08:50.632396 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:08:50.633191 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_bronze"
[0m22:08:50.633734 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:08:50.634293 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:08:50.634998 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m22:08:50.635619 [debug] [ThreadPool]: On list_dwh_public_bronze: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_bronze"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m22:08:50.636151 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_silver"
[0m22:08:50.636690 [debug] [ThreadPool]: Using postgres connection "list_dwh_public_gold"
[0m22:08:50.637182 [debug] [ThreadPool]: On list_dwh_public_silver: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_silver"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m22:08:50.637652 [debug] [ThreadPool]: On list_dwh_public_gold: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public_gold"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m22:08:50.638877 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:08:50.640341 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:08:50.640896 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m22:08:50.641326 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m22:08:50.641678 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:08:50.642872 [debug] [ThreadPool]: On list_dwh_public_gold: ROLLBACK
[0m22:08:50.643206 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m22:08:50.644322 [debug] [ThreadPool]: On list_dwh_public_silver: ROLLBACK
[0m22:08:50.646632 [debug] [ThreadPool]: On list_dwh_public_gold: Close
[0m22:08:50.647735 [debug] [ThreadPool]: On list_dwh_public_bronze: ROLLBACK
[0m22:08:50.648301 [debug] [ThreadPool]: On list_dwh_public_silver: Close
[0m22:08:50.648625 [debug] [ThreadPool]: On list_dwh_public_bronze: Close
[0m22:08:50.655979 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:50.656281 [debug] [MainThread]: On master: BEGIN
[0m22:08:50.656512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:50.662888 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:08:50.663208 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:50.663677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:08:50.669906 [debug] [MainThread]: SQL status: SELECT 14 in 0.006 seconds
[0m22:08:50.673985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0582035750>]}
[0m22:08:50.674409 [debug] [MainThread]: On master: ROLLBACK
[0m22:08:50.674885 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:50.675144 [debug] [MainThread]: On master: BEGIN
[0m22:08:50.675741 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:08:50.676002 [debug] [MainThread]: On master: COMMIT
[0m22:08:50.676246 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:50.676543 [debug] [MainThread]: On master: COMMIT
[0m22:08:50.677014 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:08:50.677279 [debug] [MainThread]: On master: Close
[0m22:08:50.680253 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:08:50.680733 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:08:50.681306 [info ] [Thread-1 (]: 1 of 8 START sql view model public_bronze.housing_prices ....................... [RUN]
[0m22:08:50.682020 [info ] [Thread-2 (]: 2 of 8 START sql view model public_bronze.location_data ........................ [RUN]
[0m22:08:50.682553 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:08:50.683065 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:08:50.683591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public_bronze, now model.airflow_dbt_training.housing_prices)
[0m22:08:50.684114 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dwh_public_gold, now model.airflow_dbt_training.location_data)
[0m22:08:50.684798 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:08:50.685577 [info ] [Thread-4 (]: 4 of 8 START sql view model public_silver.stg_location_data .................... [RUN]
[0m22:08:50.686205 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:08:50.686637 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:08:50.687133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dwh_public_silver, now model.airflow_dbt_training.stg_example)
[0m22:08:50.687591 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.stg_location_data)
[0m22:08:50.700200 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:08:50.700716 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:08:50.701136 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:08:50.701559 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:08:50.702878 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:08:50.705258 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:08:50.705666 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:08:50.708660 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:08:50.754387 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:08:50.754933 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:08:50.755391 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:08:50.756423 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:08:50.756877 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:08:50.757378 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:08:50.761315 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:08:50.764944 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:08:50.765330 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:08:50.765763 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:08:50.766744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:50.767180 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:08:50.767688 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:08:50.768055 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:08:50.768644 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:08:50.769064 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:08:50.769636 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:08:50.770046 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:08:50.774613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:08:50.775056 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:08:50.775684 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public_bronze"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:08:50.776822 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m22:08:50.777406 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m22:08:50.777875 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:08:50.778267 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:08:50.778654 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:08:50.779164 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:08:50.779607 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:08:50.786795 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:08:50.787250 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public_bronze"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:08:50.787777 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:08:50.788273 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public_silver"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:08:50.788769 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:08:50.789865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:08:50.793737 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:08:50.794192 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:08:50.794625 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:08:50.795072 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:08:50.795536 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public_bronze"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:08:50.799796 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:08:50.803564 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:08:50.807157 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:08:50.807788 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:08:50.808294 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:08:50.808705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:08:50.809152 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data" rename to "location_data__dbt_backup"
[0m22:08:50.815069 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:08:50.825773 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m22:08:50.829580 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:08:50.830075 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:08:50.833269 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:08:50.836219 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:08:50.836644 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:08:50.839758 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:08:50.840193 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public_silver"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:08:50.840694 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:08:50.841124 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:08:50.841550 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public_bronze"."location_data__dbt_tmp" rename to "location_data"
[0m22:08:50.842415 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:08:50.842887 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:08:50.844377 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:08:50.844780 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:08:50.846142 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:08:50.846521 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m22:08:50.847040 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:08:50.848378 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:08:50.848825 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:08:50.855818 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public_bronze"."housing_prices__dbt_backup"
[0m22:08:50.856263 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:08:50.856705 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:08:50.857117 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:08:50.862431 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:08:50.863007 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:08:50.863553 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public_bronze"."housing_prices__dbt_backup" cascade
[0m22:08:50.865904 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:08:50.868650 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_silver"."stg_location_data__dbt_backup"
[0m22:08:50.869048 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m22:08:50.869806 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:08:50.870186 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m22:08:50.872812 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:08:50.873200 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m22:08:50.873660 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public_silver"."stg_location_data__dbt_backup" cascade
[0m22:08:50.876184 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public_bronze"."location_data__dbt_backup"
[0m22:08:50.876842 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:08:50.879266 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:08:50.880049 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:08:50.880492 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:08:50.881060 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public_bronze"."location_data__dbt_backup" cascade
[0m22:08:50.882845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057c302150>]}
[0m22:08:50.883518 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:08:50.884327 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_bronze.housing_prices .................. [[32mCREATE VIEW[0m in 0.20s]
[0m22:08:50.885935 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:08:50.886489 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:08:50.887113 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:08:50.888891 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:08:50.889454 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057c273190>]}
[0m22:08:50.890462 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m22:08:50.891099 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:08:50.892072 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public_silver.stg_location_data ............... [[32mCREATE VIEW[0m in 0.20s]
[0m22:08:50.892715 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057c22f310>]}
[0m22:08:50.894201 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:08:50.894740 [info ] [Thread-1 (]: 5 of 8 START sql incremental model public_silver.incremental_prices ............ [RUN]
[0m22:08:50.895470 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:08:50.896124 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.21s]
[0m22:08:50.897110 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057c279390>]}
[0m22:08:50.897729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.incremental_prices)
[0m22:08:50.898273 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:08:50.898992 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:08:50.900505 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:08:50.899971 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public_bronze.location_data ................... [[32mCREATE VIEW[0m in 0.21s]
[0m22:08:50.901796 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:08:50.901265 [info ] [Thread-4 (]: 6 of 8 START sql view model public_silver.stg_housing_prices ................... [RUN]
[0m22:08:50.907960 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:08:50.911575 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:08:50.912227 [info ] [Thread-3 (]: 7 of 8 START sql view model public_gold.region_type_composition ................ [RUN]
[0m22:08:50.912763 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m22:08:50.913668 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m22:08:50.914223 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:08:50.914668 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:08:50.915150 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:08:50.918611 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:08:50.937363 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:08:50.970093 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:08:50.970787 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:08:50.971347 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp220850953408"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public_bronze"."housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public_silver"."incremental_prices")

  );
  
  
[0m22:08:50.971842 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:08:50.975512 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:08:50.975935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:50.979447 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:08:50.980606 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:08:50.981030 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:08:50.981357 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:08:50.981763 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:08:50.982358 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:08:50.982681 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:08:50.986513 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
               ^

[0m22:08:50.987061 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:08:50.989731 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:08:50.990600 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:08:50.991506 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public_silver"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public_bronze"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m22:08:50.992327 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m22:08:50.993172 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:08:50.993767 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public_gold"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public_silver"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:08:50.994849 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:08:50.998829 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:08:50.999463 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:08:51.000032 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public_silver"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:08:51.003720 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:08:51.004324 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public_gold"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:08:51.004898 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:08:51.007046 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:08:51.007529 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:08:51.008054 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:08:51.009643 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:08:51.010104 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:08:51.010575 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:08:51.011586 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:08:51.013680 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m22:08:51.017025 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public_silver"."stg_housing_prices__dbt_backup"
[0m22:08:51.017472 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m22:08:51.018751 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:08:51.021006 [debug] [Thread-1 (]: Database Error in model incremental_prices (models/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:08:51.025498 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public_gold"."region_type_composition__dbt_backup"
[0m22:08:51.026209 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public_silver"."stg_housing_prices__dbt_backup" cascade
[0m22:08:51.026822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057f98d5d0>]}
[0m22:08:51.027958 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:08:51.028944 [error] [Thread-1 (]: 5 of 8 ERROR creating sql incremental model public_silver.incremental_prices ... [[31mERROR[0m in 0.13s]
[0m22:08:51.029429 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:08:51.030077 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public_gold"."region_type_composition__dbt_backup" cascade
[0m22:08:51.031146 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:08:51.033091 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:08:51.033899 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^.
[0m22:08:51.034726 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:08:51.035521 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057c146e90>]}
[0m22:08:51.038100 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:08:51.039103 [info ] [Thread-4 (]: 6 of 8 OK created sql view model public_silver.stg_housing_prices .............. [[32mCREATE VIEW[0m in 0.12s]
[0m22:08:51.039917 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:08:51.040715 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057c279350>]}
[0m22:08:51.041360 [info ] [Thread-3 (]: 7 of 8 OK created sql view model public_gold.region_type_composition ........... [[32mCREATE VIEW[0m in 0.13s]
[0m22:08:51.041932 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:08:51.043274 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:08:51.043870 [info ] [Thread-2 (]: 8 of 8 START sql view model public_gold.mart_housing_prices_breakdown .......... [RUN]
[0m22:08:51.044380 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:08:51.044738 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:08:51.048386 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:08:51.049020 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:08:51.103192 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:08:51.103807 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:08:51.104155 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:08:51.104455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:08:51.111405 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m22:08:51.111840 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:08:51.112241 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public_silver"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public_gold"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:08:51.114221 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:08:51.117448 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:08:51.117838 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:08:51.118566 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:08:51.119827 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:08:51.120168 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:08:51.120482 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:08:51.123861 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:08:51.126546 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_backup"
[0m22:08:51.127158 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:08:51.127506 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public_gold"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:08:51.128120 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:08:51.129359 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:08:51.129898 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80be7b1-8238-4d6e-b179-078ae40cd7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057dfb4ed0>]}
[0m22:08:51.130460 [info ] [Thread-2 (]: 8 of 8 OK created sql view model public_gold.mart_housing_prices_breakdown ..... [[32mCREATE VIEW[0m in 0.09s]
[0m22:08:51.131049 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:08:51.132737 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:51.133136 [debug] [MainThread]: On master: BEGIN
[0m22:08:51.133516 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:08:51.140062 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:08:51.140546 [debug] [MainThread]: On master: COMMIT
[0m22:08:51.141007 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:51.141389 [debug] [MainThread]: On master: COMMIT
[0m22:08:51.141958 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:08:51.142258 [debug] [MainThread]: On master: Close
[0m22:08:51.142695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:51.142954 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:08:51.143179 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:08:51.143396 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:08:51.143611 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:08:51.143982 [info ] [MainThread]: 
[0m22:08:51.144298 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m22:08:51.146466 [debug] [MainThread]: Command end result
[0m22:08:51.180193 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:08:51.181791 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:08:51.187733 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:08:51.188047 [info ] [MainThread]: 
[0m22:08:51.188399 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:08:51.188682 [info ] [MainThread]: 
[0m22:08:51.189079 [error] [MainThread]:   Database Error in model incremental_prices (models/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:08:51.189491 [info ] [MainThread]: 
[0m22:08:51.189953 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:08:51.190944 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7236285, "process_in_blocks": "440", "process_kernel_time": 0.159434, "process_mem_max_rss": "128436", "process_out_blocks": "3360", "process_user_time": 3.916106}
[0m22:08:51.191381 [debug] [MainThread]: Command `dbt run` failed at 22:08:51.191287 after 2.72 seconds
[0m22:08:51.191743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0585c28450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0585c28d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057c473d50>]}
[0m22:08:51.192065 [debug] [MainThread]: Flushing usage events
[0m22:08:52.025805 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:14:14.997388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9948461a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9948461bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9948460e50>]}


============================== 22:14:14.999973 | b7f9e14b-5a04-4d47-99af-d1cf0d636334 ==============================
[0m22:14:14.999973 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:14:15.000531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:14:15.107595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7f9e14b-5a04-4d47-99af-d1cf0d636334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f994833e5d0>]}
[0m22:14:15.132403 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18441626, "process_in_blocks": "72", "process_kernel_time": 0.108751, "process_mem_max_rss": "98960", "process_out_blocks": "8", "process_user_time": 1.354449}
[0m22:14:15.132984 [debug] [MainThread]: Command `dbt clean` succeeded at 22:14:15.132866 after 0.19 seconds
[0m22:14:15.133315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9948794910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99484d7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f994c7c51d0>]}
[0m22:14:15.133694 [debug] [MainThread]: Flushing usage events
[0m22:14:15.781492 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:14:18.505539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e5882190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e5875d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e5ab3090>]}


============================== 22:14:18.508215 | 4ea0ba37-7c35-4bd6-b96d-13f1c24c6282 ==============================
[0m22:14:18.508215 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:14:18.508707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:14:18.671708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e5877290>]}
[0m22:14:18.728383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e82b7150>]}
[0m22:14:18.729321 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:14:18.806215 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:14:18.806890 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:14:18.807293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e497d710>]}
[0m22:14:20.250902 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.airflow_dbt_training.bronze
- models.airflow_dbt_training.silver
- models.airflow_dbt_training.gold
[0m22:14:20.267816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e414aa50>]}
[0m22:14:20.368091 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:14:20.370503 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:14:20.382763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e1c37e10>]}
[0m22:14:20.383243 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:14:20.383566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e4933c90>]}
[0m22:14:20.386067 [info ] [MainThread]: 
[0m22:14:20.386511 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:14:20.387124 [info ] [MainThread]: 
[0m22:14:20.388139 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:14:20.393627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:14:20.430689 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:14:20.431042 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:14:20.431296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:20.438795 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m22:14:20.440011 [debug] [ThreadPool]: On list_dwh: Close
[0m22:14:20.441758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:14:20.448093 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:14:20.448416 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:14:20.448673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:20.455188 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:14:20.455619 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:14:20.455967 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:14:20.458593 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:14:20.460020 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:14:20.460466 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:14:20.467261 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:20.467567 [debug] [MainThread]: On master: BEGIN
[0m22:14:20.467862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:14:20.474345 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:14:20.474701 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:20.475208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:14:20.481726 [debug] [MainThread]: SQL status: SELECT 14 in 0.006 seconds
[0m22:14:20.485676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e4985c10>]}
[0m22:14:20.486175 [debug] [MainThread]: On master: ROLLBACK
[0m22:14:20.486701 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:20.486965 [debug] [MainThread]: On master: BEGIN
[0m22:14:20.487570 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:14:20.487888 [debug] [MainThread]: On master: COMMIT
[0m22:14:20.488212 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:20.488631 [debug] [MainThread]: On master: COMMIT
[0m22:14:20.489210 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:14:20.489491 [debug] [MainThread]: On master: Close
[0m22:14:20.492780 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:14:20.493211 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:14:20.493743 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:14:20.494302 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:14:20.495583 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:14:20.494909 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:14:20.496327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:14:20.496937 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:14:20.497509 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:14:20.498728 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:14:20.499183 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:14:20.499733 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:14:20.500273 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:14:20.500768 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:14:20.510166 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:14:20.510625 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:14:20.511064 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:14:20.513328 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:14:20.515636 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:14:20.518803 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:14:20.520929 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:14:20.526803 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:14:20.542978 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:14:20.580314 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:14:20.597985 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:14:20.601020 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:14:20.602730 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:14:20.604540 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:14:20.605880 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:14:20.606226 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:14:20.606675 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:14:20.607733 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:14:20.608229 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:14:20.608678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:20.609506 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:14:20.609862 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:14:20.610195 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:14:20.610726 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:14:20.611050 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:14:20.611392 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:14:20.613596 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m22:14:20.614049 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:14:20.614541 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:14:20.615483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:14:20.615962 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:14:20.616470 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:14:20.617061 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:14:20.623207 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m22:14:20.623836 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:14:20.625922 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:14:20.626313 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:14:20.630931 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:14:20.631420 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:14:20.631867 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m22:14:20.632323 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:14:20.632805 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:14:20.633343 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:14:20.633802 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:20.634407 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:14:20.637819 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:14:20.638221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:14:20.638595 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:14:20.639120 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:14:20.642444 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:14:20.647064 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:14:20.647681 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m22:14:20.648420 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:14:20.648998 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:14:20.649470 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:20.653685 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:14:20.659890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:14:20.660318 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:14:20.660801 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:14:20.680107 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:14:20.681385 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:14:20.684852 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:14:20.685460 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:14:20.685961 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:14:20.686361 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:20.686798 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:14:20.687224 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:14:20.687626 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:14:20.693799 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:14:20.694865 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:14:20.695562 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:20.697234 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:14:20.697927 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:14:20.698409 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:14:20.698897 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:14:20.704772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m22:14:20.708228 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:14:20.708754 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:14:20.710300 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:14:20.713197 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:14:20.719276 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:14:20.719898 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:14:20.720605 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:14:20.721064 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:14:20.721487 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:14:20.721948 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:14:20.722439 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:14:20.725576 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:14:20.726009 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:14:20.726689 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:14:20.729408 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:14:20.729893 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:14:20.730294 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:14:20.730710 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:14:20.731395 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:14:20.733703 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:14:20.735113 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:14:20.735529 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:14:20.737860 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:14:20.738301 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e11224d0>]}
[0m22:14:20.738728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e10b44d0>]}
[0m22:14:20.740052 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:14:20.740757 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.24s]
[0m22:14:20.741212 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:14:20.741928 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.24s]
[0m22:14:20.742760 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:14:20.743511 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e115cc50>]}
[0m22:14:20.745242 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:14:20.745938 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:14:20.746806 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.24s]
[0m22:14:20.747672 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e1092990>]}
[0m22:14:20.748546 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:14:20.749289 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:14:20.750363 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:14:20.749957 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.25s]
[0m22:14:20.751627 [info ] [Thread-3 (]: 5 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:14:20.752475 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:14:20.753114 [info ] [Thread-1 (]: 6 of 8 START sql view model public.stg_housing_prices .......................... [RUN]
[0m22:14:20.753905 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:14:20.754497 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.incremental_prices)
[0m22:14:20.755128 [info ] [Thread-4 (]: 7 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:14:20.755917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m22:14:20.756880 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:14:20.757394 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.region_type_composition)
[0m22:14:20.757911 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:14:20.764716 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:14:20.765240 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:14:20.769038 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:20.772275 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:14:20.772678 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:14:20.773453 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:14:20.789698 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:14:20.808589 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:20.825933 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:14:20.829742 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:14:20.830267 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:20.830770 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp221420803516"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:14:20.831308 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:14:20.831714 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:14:20.832119 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:14:20.832548 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:14:20.832961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:20.833557 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:14:20.839937 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
               ^

[0m22:14:20.840522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:14:20.841488 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:14:20.842140 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:20.842538 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m22:14:20.843227 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m22:14:20.845651 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:14:20.847297 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:14:20.848961 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:14:20.854894 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:14:20.856413 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:20.858524 [debug] [Thread-3 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:14:20.862181 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:14:20.862825 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:14:20.863653 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e12a0f10>]}
[0m22:14:20.864138 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:14:20.865326 [error] [Thread-3 (]: 5 of 8 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.11s]
[0m22:14:20.866050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:20.867191 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:14:20.867807 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:20.869990 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:14:20.872504 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:14:20.873240 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^.
[0m22:14:20.873714 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:20.874165 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:14:20.875312 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:14:20.875720 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:14:20.879110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:14:20.882048 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:14:20.882471 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m22:14:20.883191 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:20.885899 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:14:20.886353 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:14:20.887034 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:14:20.887579 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:14:20.888026 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:14:20.889347 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:14:20.889766 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:14:20.890999 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:14:20.891528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e1164fd0>]}
[0m22:14:20.892637 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e06f86d0>]}
[0m22:14:20.892133 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public.stg_housing_prices ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m22:14:20.893413 [info ] [Thread-4 (]: 7 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.14s]
[0m22:14:20.894169 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:14:20.894857 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:14:20.896260 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:14:20.896893 [info ] [Thread-2 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:14:20.897363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:14:20.897768 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:14:20.901386 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:20.901948 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:14:20.906256 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:20.906875 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:20.907304 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:14:20.907879 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:14:20.914669 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m22:14:20.915142 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:20.915658 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:14:20.917645 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:14:20.921072 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:20.921458 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:14:20.922221 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:14:20.923579 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:14:20.923941 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:20.924260 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:14:20.927202 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:14:20.929967 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:14:20.930605 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:20.930992 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:14:20.931594 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:14:20.932859 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:14:20.933394 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ea0ba37-7c35-4bd6-b96d-13f1c24c6282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e1c37590>]}
[0m22:14:20.933969 [info ] [Thread-2 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.04s]
[0m22:14:20.934536 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:14:20.936372 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:20.936689 [debug] [MainThread]: On master: BEGIN
[0m22:14:20.937037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:14:20.944261 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:14:20.944657 [debug] [MainThread]: On master: COMMIT
[0m22:14:20.944968 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:20.945214 [debug] [MainThread]: On master: COMMIT
[0m22:14:20.945608 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:14:20.945866 [debug] [MainThread]: On master: Close
[0m22:14:20.946296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:20.946531 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:14:20.946766 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:14:20.947009 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:14:20.947229 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:14:20.947570 [info ] [MainThread]: 
[0m22:14:20.947888 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m22:14:20.949701 [debug] [MainThread]: Command end result
[0m22:14:20.982796 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:14:20.984182 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:14:20.990621 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:14:20.990935 [info ] [MainThread]: 
[0m22:14:20.991307 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:14:20.991737 [info ] [MainThread]: 
[0m22:14:20.992368 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:14:20.992780 [info ] [MainThread]: 
[0m22:14:20.993334 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:14:20.994794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5408792, "process_in_blocks": "24", "process_kernel_time": 0.170705, "process_mem_max_rss": "130100", "process_out_blocks": "3352", "process_user_time": 3.645064}
[0m22:14:20.995506 [debug] [MainThread]: Command `dbt run` failed at 22:14:20.995378 after 2.54 seconds
[0m22:14:20.995959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e58ce490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e5ab33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e9bf4350>]}
[0m22:14:20.996483 [debug] [MainThread]: Flushing usage events
[0m22:14:21.723937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:14:24.612232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346daad610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346daad1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346daaee90>]}


============================== 22:14:24.615126 | 781900a7-dbb0-429a-9d0d-f30fe74fddc4 ==============================
[0m22:14:24.615126 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:14:24.615680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:14:24.769161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d3c6e10>]}
[0m22:14:24.828480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34704e9490>]}
[0m22:14:24.829202 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:14:24.904189 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:14:25.027836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:14:25.028189 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:14:25.034343 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.airflow_dbt_training.gold
- models.airflow_dbt_training.bronze
- models.airflow_dbt_training.silver
[0m22:14:25.087193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346c7e52d0>]}
[0m22:14:25.185447 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:14:25.187881 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:14:25.200381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346c7f7c90>]}
[0m22:14:25.200869 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:14:25.201223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346e87c310>]}
[0m22:14:25.204713 [info ] [MainThread]: 
[0m22:14:25.205187 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:14:25.205685 [info ] [MainThread]: 
[0m22:14:25.206738 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:14:25.213312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:14:25.253806 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:14:25.254179 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:14:25.254784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:25.262232 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m22:14:25.263440 [debug] [ThreadPool]: On list_dwh: Close
[0m22:14:25.265267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:14:25.271658 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:14:25.272001 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:14:25.272243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:25.278978 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:14:25.279473 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:14:25.280305 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:14:25.283443 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:14:25.284957 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:14:25.285410 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:14:25.292730 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:25.293041 [debug] [MainThread]: On master: BEGIN
[0m22:14:25.293302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:14:25.300012 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:14:25.300402 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:25.301125 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:14:25.307440 [debug] [MainThread]: SQL status: SELECT 14 in 0.006 seconds
[0m22:14:25.311479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346c7f7510>]}
[0m22:14:25.312089 [debug] [MainThread]: On master: ROLLBACK
[0m22:14:25.312625 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:25.312895 [debug] [MainThread]: On master: BEGIN
[0m22:14:25.313522 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:14:25.313814 [debug] [MainThread]: On master: COMMIT
[0m22:14:25.314261 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:25.314839 [debug] [MainThread]: On master: COMMIT
[0m22:14:25.315266 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:14:25.315557 [debug] [MainThread]: On master: Close
[0m22:14:25.319001 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:14:25.319542 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:14:25.320063 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:14:25.320675 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:14:25.321626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:14:25.322078 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:14:25.322561 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:14:25.323171 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:14:25.323650 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:14:25.324315 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:14:25.325259 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:14:25.326047 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:14:25.335678 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:14:25.336716 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:14:25.337551 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:14:25.340112 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:14:25.340761 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:14:25.341239 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:14:25.341620 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:14:25.344383 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:14:25.344951 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:14:25.348675 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:14:25.401833 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:14:25.402707 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:14:25.403121 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:14:25.403477 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:14:25.404503 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:14:25.408630 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:14:25.409176 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:14:25.412933 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:14:25.413431 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:14:25.413963 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:14:25.414612 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:14:25.415178 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:14:25.415578 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:14:25.415971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:25.416394 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:14:25.417025 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:14:25.417673 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:14:25.418109 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:14:25.423276 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:14:25.424145 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:14:25.424977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:14:25.425678 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:14:25.426205 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m22:14:25.427035 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:14:25.427734 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m22:14:25.428295 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:14:25.428840 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:14:25.429533 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:14:25.429945 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:14:25.430410 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:14:25.431003 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:14:25.436766 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:14:25.439668 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:14:25.444666 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:14:25.445436 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:14:25.446009 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:14:25.446540 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:14:25.447096 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:14:25.451305 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:14:25.455426 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:14:25.456145 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:14:25.456674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:25.457190 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:25.457823 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:14:25.462008 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:14:25.465378 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:14:25.465769 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m22:14:25.466323 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:14:25.466778 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:14:25.467170 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:25.470535 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:14:25.474137 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:14:25.474674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:14:25.475053 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:14:25.475579 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:14:25.476037 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:14:25.497344 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:14:25.498820 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:14:25.499523 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:14:25.500136 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:14:25.500525 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:14:25.500913 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:14:25.501343 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:14:25.502801 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:14:25.503183 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:14:25.504598 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:14:25.505095 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:14:25.505651 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:14:25.506130 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:14:25.506648 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:14:25.509876 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:14:25.559565 [debug] [Thread-4 (]: SQL status: COMMIT in 0.052 seconds
[0m22:14:25.565379 [debug] [Thread-3 (]: SQL status: COMMIT in 0.058 seconds
[0m22:14:25.565805 [debug] [Thread-2 (]: SQL status: COMMIT in 0.060 seconds
[0m22:14:25.567176 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:14:25.570065 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:14:25.572881 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:14:25.575804 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:14:25.582934 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:14:25.583443 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:14:25.584139 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:14:25.584873 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:14:25.585320 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:14:25.585782 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:14:25.586223 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:14:25.586677 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:14:25.590533 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:14:25.593054 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:14:25.593603 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:14:25.595046 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:14:25.597506 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m22:14:25.598188 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.011 seconds
[0m22:14:25.599484 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:14:25.599893 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346dae2a90>]}
[0m22:14:25.601213 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:14:25.601524 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d3bb4d0>]}
[0m22:14:25.602339 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.26s]
[0m22:14:25.602972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346e872950>]}
[0m22:14:25.603827 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.27s]
[0m22:14:25.604656 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d3b8a50>]}
[0m22:14:25.605429 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:14:25.606238 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.28s]
[0m22:14:25.607206 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:14:25.608135 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.27s]
[0m22:14:25.609333 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:14:25.610476 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:14:25.611811 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:14:25.612279 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:14:25.613319 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:14:25.612873 [info ] [Thread-3 (]: 5 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:14:25.614253 [info ] [Thread-2 (]: 6 of 8 START sql view model public.stg_housing_prices .......................... [RUN]
[0m22:14:25.615106 [info ] [Thread-1 (]: 7 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:14:25.615908 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.incremental_prices)
[0m22:14:25.616434 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m22:14:25.616910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.region_type_composition)
[0m22:14:25.617346 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:14:25.617816 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:14:25.618238 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:14:25.632252 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:25.632780 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:14:25.636288 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:14:25.637392 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:14:25.643181 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:14:25.654219 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:14:25.658372 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:25.691071 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:14:25.695805 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:14:25.696848 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:25.697334 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:14:25.697847 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp221425673213"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:14:25.698320 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:14:25.698732 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:14:25.699192 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:14:25.699596 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:14:25.700057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:25.706983 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m22:14:25.707550 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
               ^

[0m22:14:25.708076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:14:25.708870 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:25.709772 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:14:25.710334 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:14:25.711020 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m22:14:25.711786 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:14:25.718509 [debug] [Thread-3 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:14:25.719522 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:14:25.720030 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:14:25.721628 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346ad9edd0>]}
[0m22:14:25.727893 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:14:25.733157 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:25.735614 [error] [Thread-3 (]: 5 of 8 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.10s]
[0m22:14:25.736575 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:14:25.737469 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:14:25.739221 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:14:25.743273 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^.
[0m22:14:25.744326 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:14:25.745055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:14:25.747586 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:14:25.749779 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:14:25.750552 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:25.751032 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:14:25.751485 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:14:25.751919 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:14:25.755479 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:14:25.760513 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:14:25.761793 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:14:25.762448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m22:14:25.762949 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:14:25.765800 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:14:25.766710 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:14:25.767214 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:14:25.767685 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:14:25.769145 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:14:25.769865 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346e1c4b10>]}
[0m22:14:25.770486 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.stg_housing_prices ..................... [[32mCREATE VIEW[0m in 0.15s]
[0m22:14:25.771090 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:14:25.771681 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:14:25.773240 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:14:25.773869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346aebfc10>]}
[0m22:14:25.774536 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.16s]
[0m22:14:25.775288 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:14:25.776643 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:14:25.777244 [info ] [Thread-4 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:14:25.777951 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:14:25.778695 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:14:25.783058 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:25.783679 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:14:25.788667 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:25.789301 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:25.789669 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:14:25.789980 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:14:25.797214 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m22:14:25.798018 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:25.798642 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:14:25.800955 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:14:25.804222 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:25.804633 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:14:25.805380 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:14:25.806743 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:14:25.807082 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:25.807391 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:14:25.810274 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m22:14:25.813240 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:14:25.814020 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:14:25.814390 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:14:25.815310 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:14:25.816990 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:14:25.817750 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '781900a7-dbb0-429a-9d0d-f30fe74fddc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346ae96f90>]}
[0m22:14:25.818357 [info ] [Thread-4 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.04s]
[0m22:14:25.818987 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:14:25.821300 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:25.821917 [debug] [MainThread]: On master: BEGIN
[0m22:14:25.822238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:14:25.829063 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:14:25.829540 [debug] [MainThread]: On master: COMMIT
[0m22:14:25.829989 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:25.830402 [debug] [MainThread]: On master: COMMIT
[0m22:14:25.831068 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:14:25.831445 [debug] [MainThread]: On master: Close
[0m22:14:25.831970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:25.832245 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:14:25.832480 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:14:25.832753 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:14:25.832994 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:14:25.833515 [info ] [MainThread]: 
[0m22:14:25.834017 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m22:14:25.836258 [debug] [MainThread]: Command end result
[0m22:14:25.877970 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:14:25.879543 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:14:25.885577 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:14:25.885868 [info ] [MainThread]: 
[0m22:14:25.886209 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:14:25.886498 [info ] [MainThread]: 
[0m22:14:25.886944 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:14:25.887368 [info ] [MainThread]: 
[0m22:14:25.888068 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:14:25.889158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3295946, "process_in_blocks": "0", "process_kernel_time": 0.071017, "process_mem_max_rss": "122260", "process_out_blocks": "2408", "process_user_time": 2.698659}
[0m22:14:25.889638 [debug] [MainThread]: Command `dbt run` failed at 22:14:25.889540 after 1.33 seconds
[0m22:14:25.889990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3471e28350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3468449850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3468448110>]}
[0m22:14:25.890361 [debug] [MainThread]: Flushing usage events
[0m22:14:26.566937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:17:14.961829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d0ebb2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d12cbbad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d0ef05b90>]}


============================== 22:17:14.964560 | 3a93b181-61a4-4668-b7b2-e6d6bf07edee ==============================
[0m22:17:14.964560 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:17:14.965075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:17:15.073281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a93b181-61a4-4668-b7b2-e6d6bf07edee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d0eba5cd0>]}
[0m22:17:15.084048 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17526451, "process_in_blocks": "0", "process_kernel_time": 0.109826, "process_mem_max_rss": "99100", "process_out_blocks": "8", "process_user_time": 1.447714}
[0m22:17:15.084564 [debug] [MainThread]: Command `dbt clean` succeeded at 22:17:15.084422 after 0.18 seconds
[0m22:17:15.084912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d0ede74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d0ec3ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d0ec04e10>]}
[0m22:17:15.085310 [debug] [MainThread]: Flushing usage events
[0m22:17:15.686536 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:17:17.233066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed348cb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed37e9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed348e390>]}


============================== 22:17:17.235692 | b976dade-c527-4ea7-b63a-e12f4889abe3 ==============================
[0m22:17:17.235692 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:17:17.236306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:17:17.388258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed34fb5d0>]}
[0m22:17:17.446311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed5ecb250>]}
[0m22:17:17.447037 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:17:17.525178 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:17:17.525796 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:17:17.526143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed2508f10>]}
[0m22:17:18.980646 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.airflow_dbt_training.silver
- models.airflow_dbt_training.gold
- models.airflow_dbt_training.bronze
[0m22:17:18.997489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed2172a10>]}
[0m22:17:19.104625 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:17:19.108184 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:17:19.125633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb376fe90>]}
[0m22:17:19.126448 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:17:19.127031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed194c150>]}
[0m22:17:19.131012 [info ] [MainThread]: 
[0m22:17:19.131777 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:19.132401 [info ] [MainThread]: 
[0m22:17:19.133443 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:17:19.142205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:17:19.187833 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:17:19.188222 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:17:19.188479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:19.196696 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m22:17:19.197958 [debug] [ThreadPool]: On list_dwh: Close
[0m22:17:19.199737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:17:19.206246 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:17:19.206576 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:17:19.206813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:19.213184 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:17:19.213653 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:17:19.214169 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:17:19.216637 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:17:19.218037 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:17:19.218451 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:17:19.225515 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:19.225970 [debug] [MainThread]: On master: BEGIN
[0m22:17:19.226214 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:19.232540 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:17:19.232868 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:19.233328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:17:19.239707 [debug] [MainThread]: SQL status: SELECT 14 in 0.006 seconds
[0m22:17:19.243607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb2c7ffd0>]}
[0m22:17:19.244055 [debug] [MainThread]: On master: ROLLBACK
[0m22:17:19.244573 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:19.244857 [debug] [MainThread]: On master: BEGIN
[0m22:17:19.245541 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:17:19.245823 [debug] [MainThread]: On master: COMMIT
[0m22:17:19.246280 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:19.246656 [debug] [MainThread]: On master: COMMIT
[0m22:17:19.247146 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:17:19.247430 [debug] [MainThread]: On master: Close
[0m22:17:19.251045 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:17:19.251649 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:17:19.252124 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:17:19.252685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:17:19.253335 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:17:19.253833 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:17:19.254402 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:17:19.254920 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:17:19.255635 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:17:19.256840 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:17:19.257767 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:17:19.266755 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:17:19.267368 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:17:19.267935 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:17:19.268521 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:17:19.269332 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:17:19.269900 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:17:19.272311 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:17:19.274569 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:17:19.278074 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:17:19.278763 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:17:19.279167 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:17:19.317133 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:17:19.322966 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:17:19.330745 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:17:19.333639 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:17:19.337558 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:17:19.341458 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:17:19.352509 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:17:19.353269 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:17:19.353943 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:17:19.354710 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:17:19.355144 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:17:19.355664 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:17:19.356241 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:17:19.356705 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:17:19.357114 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:17:19.357502 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:17:19.357878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:19.358243 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:17:19.362694 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m22:17:19.363178 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:17:19.363830 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:17:19.365503 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m22:17:19.366166 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:17:19.366887 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:17:19.367461 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m22:17:19.367933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:17:19.376037 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:17:19.376560 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:17:19.377067 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:17:19.377568 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:17:19.378049 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:17:19.378644 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:17:19.379139 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:17:19.379863 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:17:19.380324 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:17:19.384122 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:17:19.384567 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:17:19.384946 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:17:19.388221 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:17:19.388646 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:17:19.392594 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:17:19.396206 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:17:19.396701 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:17:19.397270 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:17:19.397695 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:17:19.398083 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:17:19.401661 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:17:19.402280 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:17:19.402771 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:17:19.403258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:17:19.403670 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:17:19.407020 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:17:19.416141 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:17:19.429905 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:17:19.430461 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:17:19.430882 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:17:19.431358 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:17:19.431883 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:17:19.433483 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:17:19.434091 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:17:19.434482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:17:19.434893 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:17:19.435244 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:17:19.436757 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:17:19.437162 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:17:19.440411 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:17:19.440895 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m22:17:19.441323 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:17:19.441820 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:17:19.447499 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m22:17:19.449287 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:17:19.449744 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:17:19.450186 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:17:19.453056 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:17:19.459022 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:17:19.459845 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:17:19.460285 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:17:19.460718 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:17:19.461397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:17:19.464548 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:17:19.464994 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m22:17:19.465737 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:17:19.466200 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:17:19.466609 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:17:19.469585 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:17:19.470103 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:17:19.472593 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:17:19.473808 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:17:19.474549 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:17:19.476849 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb3729890>]}
[0m22:17:19.477325 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:17:19.477676 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb2bb8fd0>]}
[0m22:17:19.478405 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.21s]
[0m22:17:19.478894 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:17:19.480701 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:17:19.479730 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m22:17:19.482462 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:17:19.483408 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:17:19.483861 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:17:19.484855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb372c750>]}
[0m22:17:19.486326 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:17:19.487439 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.23s]
[0m22:17:19.488390 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:17:19.489084 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb2c741d0>]}
[0m22:17:19.490257 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m22:17:19.491126 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:17:19.491733 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:17:19.492290 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:17:19.493032 [info ] [Thread-3 (]: 5 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:17:19.494907 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.incremental_prices)
[0m22:17:19.494015 [info ] [Thread-2 (]: 6 of 8 START sql view model public.stg_housing_prices .......................... [RUN]
[0m22:17:19.495677 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:17:19.496084 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:17:19.496576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m22:17:19.497125 [info ] [Thread-4 (]: 7 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:17:19.502933 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:17:19.504759 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:17:19.505319 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.region_type_composition)
[0m22:17:19.508734 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:17:19.509383 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:17:19.510020 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:17:19.513692 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:17:19.514268 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:17:19.529150 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:17:19.529825 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:17:19.549165 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:17:19.556605 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:17:19.567508 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:17:19.572150 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:17:19.572677 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:17:19.573379 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:17:19.573839 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp221719553093"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:17:19.574496 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:17:19.574986 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:17:19.575425 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:17:19.580703 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:17:19.581417 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:17:19.582231 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m22:17:19.583487 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
               ^

[0m22:17:19.584106 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m22:17:19.584769 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:17:19.585481 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:17:19.585974 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:17:19.592227 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:17:19.593070 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:17:19.595521 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:17:19.597569 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:17:19.599437 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:17:19.599953 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:17:19.600596 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:17:19.605429 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:17:19.606495 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:17:19.607549 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:17:19.610180 [debug] [Thread-3 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:17:19.611003 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed34b2550>]}
[0m22:17:19.611682 [error] [Thread-3 (]: 5 of 8 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.12s]
[0m22:17:19.612555 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:17:19.613172 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:17:19.615004 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^.
[0m22:17:19.615620 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m22:17:19.617527 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:17:19.621833 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:17:19.622459 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:17:19.623306 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:17:19.623732 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:17:19.624165 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:17:19.624875 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:17:19.626753 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:17:19.627878 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb2cd1910>]}
[0m22:17:19.628680 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.stg_housing_prices ..................... [[32mCREATE VIEW[0m in 0.13s]
[0m22:17:19.629256 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:17:19.629992 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m22:17:19.633498 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:17:19.634293 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:17:19.634705 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:17:19.635369 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:17:19.636851 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:17:19.637418 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed2528d10>]}
[0m22:17:19.638165 [info ] [Thread-4 (]: 7 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.13s]
[0m22:17:19.639273 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:17:19.640627 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:17:19.641215 [info ] [Thread-1 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:17:19.641755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:17:19.642217 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:17:19.646356 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:17:19.646960 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:17:19.652081 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:17:19.652827 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:17:19.653176 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:17:19.653501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:19.660456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:17:19.661089 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:17:19.661626 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:17:19.664319 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:17:19.667719 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:17:19.668255 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:17:19.669637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:17:19.671364 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:17:19.671810 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:17:19.672133 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:17:19.677713 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:17:19.680692 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:17:19.681482 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:17:19.681878 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:17:19.682625 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:17:19.684112 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:17:19.684728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b976dade-c527-4ea7-b63a-e12f4889abe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb2b50ad0>]}
[0m22:17:19.685339 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.04s]
[0m22:17:19.685896 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:17:19.688228 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:19.688620 [debug] [MainThread]: On master: BEGIN
[0m22:17:19.689029 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:17:19.696612 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:17:19.697109 [debug] [MainThread]: On master: COMMIT
[0m22:17:19.697621 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:19.698039 [debug] [MainThread]: On master: COMMIT
[0m22:17:19.698763 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:17:19.699212 [debug] [MainThread]: On master: Close
[0m22:17:19.699728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:19.699998 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:17:19.700236 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:17:19.700563 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:17:19.700796 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:17:19.701159 [info ] [MainThread]: 
[0m22:17:19.701498 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m22:17:19.703343 [debug] [MainThread]: Command end result
[0m22:17:19.742419 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:17:19.743998 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:17:19.750375 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:17:19.750712 [info ] [MainThread]: 
[0m22:17:19.751073 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:17:19.751400 [info ] [MainThread]: 
[0m22:17:19.752016 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:17:19.752463 [info ] [MainThread]: 
[0m22:17:19.752855 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:17:19.754282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5708153, "process_in_blocks": "8", "process_kernel_time": 0.248787, "process_mem_max_rss": "131456", "process_out_blocks": "3368", "process_user_time": 3.572587}
[0m22:17:19.754804 [debug] [MainThread]: Command `dbt run` failed at 22:17:19.754704 after 2.57 seconds
[0m22:17:19.755232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed34c1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed36c7150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed2523910>]}
[0m22:17:19.755662 [debug] [MainThread]: Flushing usage events
[0m22:17:20.426598 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:19:52.499731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b92c99490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b92aebc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b92aea2d0>]}


============================== 22:19:52.502414 | 7d9a3873-476f-449b-bc72-c217fcc3145f ==============================
[0m22:19:52.502414 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:19:52.502921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:19:52.608266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d9a3873-476f-449b-bc72-c217fcc3145f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b92b8f3d0>]}
[0m22:19:52.618594 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1692776, "process_in_blocks": "0", "process_kernel_time": 0.119535, "process_mem_max_rss": "99148", "process_out_blocks": "8", "process_user_time": 1.404545}
[0m22:19:52.619217 [debug] [MainThread]: Command `dbt clean` succeeded at 22:19:52.619077 after 0.17 seconds
[0m22:19:52.619662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b929bc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b96e58e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b96e59090>]}
[0m22:19:52.620040 [debug] [MainThread]: Flushing usage events
[0m22:19:53.232079 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:19:54.847636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b8300b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b8302690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b8301490>]}


============================== 22:19:54.851001 | 2bfa9a5d-7daf-4cd2-940e-bbe8691279b9 ==============================
[0m22:19:54.851001 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:19:54.851598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:19:55.009939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b7b8a590>]}
[0m22:19:55.070677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bad274d0>]}
[0m22:19:55.071458 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:19:55.151588 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:19:55.152427 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:19:55.152909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b83540d0>]}
[0m22:19:56.664665 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.airflow_dbt_training.silver
- models.airflow_dbt_training.gold
- models.airflow_dbt_training.bronze
[0m22:19:56.678923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b7bfd650>]}
[0m22:19:56.778259 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:19:56.780721 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:19:56.793075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b6b0f890>]}
[0m22:19:56.793668 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:19:56.794015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b7bb2250>]}
[0m22:19:56.797302 [info ] [MainThread]: 
[0m22:19:56.797957 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:19:56.798468 [info ] [MainThread]: 
[0m22:19:56.799294 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:19:56.806485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:19:56.844402 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:19:56.844764 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:19:56.845058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:56.852595 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m22:19:56.853817 [debug] [ThreadPool]: On list_dwh: Close
[0m22:19:56.855680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:19:56.861799 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:19:56.862084 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:19:56.862353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:19:56.869080 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:19:56.869625 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:19:56.870263 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:19:56.873167 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:19:56.874588 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:19:56.875137 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:19:56.882380 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:56.882827 [debug] [MainThread]: On master: BEGIN
[0m22:19:56.883055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:19:56.889615 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:19:56.890010 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:56.890658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:19:56.897862 [debug] [MainThread]: SQL status: SELECT 14 in 0.006 seconds
[0m22:19:56.901782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b6715ed0>]}
[0m22:19:56.902213 [debug] [MainThread]: On master: ROLLBACK
[0m22:19:56.902707 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:56.902969 [debug] [MainThread]: On master: BEGIN
[0m22:19:56.903530 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:19:56.903796 [debug] [MainThread]: On master: COMMIT
[0m22:19:56.904042 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:56.904300 [debug] [MainThread]: On master: COMMIT
[0m22:19:56.905017 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:19:56.905322 [debug] [MainThread]: On master: Close
[0m22:19:56.908494 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:19:56.909063 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:19:56.909600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:19:56.910038 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:19:56.910522 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:19:56.916568 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:19:56.920228 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:19:56.920866 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:19:56.921884 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:19:56.921475 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:19:56.922843 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:19:56.923464 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:19:56.924431 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:19:56.925218 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:19:56.925928 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:19:56.926422 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:19:56.928941 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:19:56.929472 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:19:56.932381 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:19:56.933072 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:19:56.936446 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:19:56.937114 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:19:56.959153 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:19:56.986363 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:19:56.991016 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:19:56.995013 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:19:56.996628 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:19:57.000513 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:19:57.002843 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:19:57.003526 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:19:57.004163 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:19:57.005011 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:19:57.005595 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:19:57.005969 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:19:57.006504 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:19:57.006889 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:19:57.007290 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:19:57.007696 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:19:57.008093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:57.008684 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:19:57.011122 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m22:19:57.011799 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:19:57.012465 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:19:57.013890 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:19:57.021421 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:19:57.022076 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m22:19:57.022866 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m22:19:57.023534 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:19:57.024039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:19:57.024487 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:19:57.024889 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:19:57.025389 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:19:57.025834 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:19:57.026366 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:19:57.026960 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:19:57.027474 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:19:57.031033 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:19:57.031470 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:19:57.032067 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:19:57.035571 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:19:57.036471 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:19:57.036892 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:19:57.037301 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:19:57.037729 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:19:57.041558 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:19:57.044902 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:19:57.056115 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m22:19:57.056587 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:19:57.064694 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:19:57.065215 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:19:57.068532 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:19:57.069130 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:19:57.069573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:19:57.070083 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:19:57.070497 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:19:57.070882 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:19:57.074282 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:19:57.078586 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:19:57.079313 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:19:57.079746 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m22:19:57.080200 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:19:57.080855 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:19:57.086979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:19:57.094696 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:19:57.095353 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:19:57.097232 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:19:57.097826 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:19:57.098288 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:19:57.104811 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:19:57.105524 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:19:57.107765 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:19:57.108419 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:19:57.108891 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:19:57.109331 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:19:57.109783 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:19:57.110443 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:19:57.113369 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:19:57.116645 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:19:57.117149 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m22:19:57.117548 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m22:19:57.118144 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m22:19:57.119143 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:19:57.122299 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:19:57.125152 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:19:57.128250 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:19:57.128782 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:19:57.129477 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:19:57.130666 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:19:57.133333 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:19:57.133830 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b44b7ad0>]}
[0m22:19:57.134314 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:19:57.135211 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m22:19:57.136368 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:19:57.137089 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:19:57.139856 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:19:57.140352 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:19:57.142308 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:19:57.143435 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b442cd90>]}
[0m22:19:57.144063 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:19:57.145232 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.22s]
[0m22:19:57.146103 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b442c9d0>]}
[0m22:19:57.147971 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:19:57.149199 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:19:57.150343 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m22:19:57.151881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b7bddf50>]}
[0m22:19:57.153117 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:19:57.154116 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.24s]
[0m22:19:57.156199 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:19:57.157093 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:19:57.158180 [info ] [Thread-1 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:19:57.159099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.region_type_composition)
[0m22:19:57.159568 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:19:57.160438 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:19:57.161457 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:19:57.165444 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:19:57.166278 [info ] [Thread-3 (]: 6 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:19:57.167458 [info ] [Thread-4 (]: 7 of 8 START sql view model public.stg_housing_prices .......................... [RUN]
[0m22:19:57.169225 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.incremental_prices)
[0m22:19:57.169921 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m22:19:57.170472 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:19:57.171133 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:19:57.171554 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:19:57.176645 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:19:57.183735 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:19:57.187475 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:19:57.188430 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:19:57.189227 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:19:57.189664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:57.190318 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:19:57.191329 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:19:57.208150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m22:19:57.229654 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:19:57.230173 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:19:57.248677 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:19:57.249349 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:19:57.249831 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:19:57.250291 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp221957230522"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:19:57.250850 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:19:57.251391 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:19:57.252131 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:19:57.252333 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:19:57.256332 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:19:57.257031 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:19:57.258130 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:19:57.260348 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:19:57.261015 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:19:57.261521 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m22:19:57.262110 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
               ^

[0m22:19:57.263115 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:19:57.263988 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:19:57.264734 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:19:57.265545 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m22:19:57.269172 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m22:19:57.274276 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:19:57.275212 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:19:57.276660 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:19:57.283742 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:19:57.284676 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:19:57.285348 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:19:57.287690 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:19:57.288256 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:19:57.289938 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:19:57.291448 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:19:57.292622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b4393490>]}
[0m22:19:57.293896 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:19:57.296178 [debug] [Thread-3 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:19:57.296912 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.13s]
[0m22:19:57.297479 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:19:57.298001 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b4241090>]}
[0m22:19:57.298873 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:19:57.299866 [error] [Thread-3 (]: 6 of 8 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.13s]
[0m22:19:57.301195 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:19:57.301847 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^.
[0m22:19:57.302308 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:19:57.306394 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:19:57.307196 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:19:57.307589 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:19:57.308195 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:19:57.309517 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:19:57.310082 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b4392750>]}
[0m22:19:57.310929 [info ] [Thread-4 (]: 7 of 8 OK created sql view model public.stg_housing_prices ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m22:19:57.312008 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:19:57.313250 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:19:57.313858 [info ] [Thread-2 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:19:57.314435 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:19:57.314808 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:19:57.319063 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:19:57.319766 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:19:57.324498 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:19:57.325135 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:19:57.325496 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:19:57.325815 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:19:57.332911 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m22:19:57.333552 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:19:57.334125 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:19:57.336443 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:19:57.339824 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:19:57.340206 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:19:57.341014 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:19:57.342390 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:19:57.342774 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:19:57.343119 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:19:57.346415 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:19:57.350064 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:19:57.350957 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:19:57.351442 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:19:57.352177 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:19:57.353600 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:19:57.354226 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bfa9a5d-7daf-4cd2-940e-bbe8691279b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b410ff50>]}
[0m22:19:57.354851 [info ] [Thread-2 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.04s]
[0m22:19:57.355419 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:19:57.357680 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:57.358140 [debug] [MainThread]: On master: BEGIN
[0m22:19:57.358455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:19:57.366481 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:19:57.367035 [debug] [MainThread]: On master: COMMIT
[0m22:19:57.367356 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:57.367762 [debug] [MainThread]: On master: COMMIT
[0m22:19:57.368430 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:19:57.368835 [debug] [MainThread]: On master: Close
[0m22:19:57.369267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:57.369508 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:19:57.369733 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:19:57.369977 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:19:57.370193 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:19:57.370540 [info ] [MainThread]: 
[0m22:19:57.370867 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m22:19:57.372942 [debug] [MainThread]: Command end result
[0m22:19:57.407557 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:19:57.409180 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:19:57.415357 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:19:57.415700 [info ] [MainThread]: 
[0m22:19:57.416061 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:19:57.416359 [info ] [MainThread]: 
[0m22:19:57.416883 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:19:57.417331 [info ] [MainThread]: 
[0m22:19:57.417834 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:19:57.419007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6243653, "process_in_blocks": "0", "process_kernel_time": 0.229716, "process_mem_max_rss": "128572", "process_out_blocks": "3360", "process_user_time": 3.755361}
[0m22:19:57.419860 [debug] [MainThread]: Command `dbt run` failed at 22:19:57.419590 after 2.63 seconds
[0m22:19:57.420377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b834ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b834ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b834fdd0>]}
[0m22:19:57.420822 [debug] [MainThread]: Flushing usage events
[0m22:19:58.097232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:21:50.201135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab0ebda50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab0ebdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab0ebd1d0>]}


============================== 22:21:50.203941 | 9c409dde-2f24-4030-a06c-ce1e090ffef8 ==============================
[0m22:21:50.203941 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:21:50.204524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:21:50.314654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c409dde-2f24-4030-a06c-ce1e090ffef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab0f36690>]}
[0m22:21:50.324702 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17323895, "process_in_blocks": "0", "process_kernel_time": 0.130269, "process_mem_max_rss": "99064", "process_out_blocks": "8", "process_user_time": 1.372844}
[0m22:21:50.325284 [debug] [MainThread]: Command `dbt clean` succeeded at 22:21:50.325166 after 0.17 seconds
[0m22:21:50.325782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab0eed490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab0ebec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab1219ad0>]}
[0m22:21:50.326168 [debug] [MainThread]: Flushing usage events
[0m22:21:50.968728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:21:58.176876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3160269950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31605c1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3160269bd0>]}


============================== 22:21:58.179882 | f532905b-a324-41b0-88bf-cd02f6054b33 ==============================
[0m22:21:58.179882 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:21:58.180405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:21:58.343300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315f3497d0>]}
[0m22:21:58.404440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3162c93290>]}
[0m22:21:58.405190 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:21:58.481682 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:21:58.482379 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:21:58.482728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315f774590>]}
[0m22:22:00.034339 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.airflow_dbt_training.silver
- models.airflow_dbt_training.gold
- models.airflow_dbt_training.bronze
[0m22:22:00.051529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315e3394d0>]}
[0m22:22:00.164854 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:22:00.167533 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:22:00.182619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315c687f10>]}
[0m22:22:00.183163 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:22:00.183508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315c70eb90>]}
[0m22:22:00.187103 [info ] [MainThread]: 
[0m22:22:00.187659 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:22:00.188015 [info ] [MainThread]: 
[0m22:22:00.188811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:22:00.194900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:22:00.235775 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:22:00.236152 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:22:00.236434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:00.244307 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m22:22:00.245568 [debug] [ThreadPool]: On list_dwh: Close
[0m22:22:00.247681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:22:00.254360 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:22:00.254712 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:22:00.254949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:22:00.261611 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:22:00.262002 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:22:00.262362 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:22:00.265130 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:22:00.266895 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:22:00.267401 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:22:00.274499 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:00.274863 [debug] [MainThread]: On master: BEGIN
[0m22:22:00.275098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:00.282110 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:22:00.282484 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:00.283188 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:22:00.291836 [debug] [MainThread]: SQL status: SELECT 14 in 0.008 seconds
[0m22:22:00.295763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315e323bd0>]}
[0m22:22:00.296246 [debug] [MainThread]: On master: ROLLBACK
[0m22:22:00.296782 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:00.297048 [debug] [MainThread]: On master: BEGIN
[0m22:22:00.297664 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:22:00.297944 [debug] [MainThread]: On master: COMMIT
[0m22:22:00.298189 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:00.298443 [debug] [MainThread]: On master: COMMIT
[0m22:22:00.299061 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:22:00.299349 [debug] [MainThread]: On master: Close
[0m22:22:00.302352 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:22:00.302804 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:22:00.303278 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:22:00.304568 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:22:00.303805 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:22:00.305489 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:22:00.306356 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:22:00.307757 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:22:00.309075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:22:00.309931 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:22:00.310532 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:22:00.311082 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:22:00.311543 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:22:00.311971 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:22:00.312370 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:22:00.313028 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:22:00.323825 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:22:00.326400 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:22:00.328816 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:22:00.332056 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:22:00.334242 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:22:00.340577 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:22:00.357118 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:22:00.372576 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:22:00.387508 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:22:00.388048 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:22:00.392031 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:22:00.396494 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:22:00.398269 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:22:00.399903 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:22:00.400400 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:22:00.400830 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:22:00.401256 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:22:00.401711 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:22:00.402121 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:22:00.402534 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:22:00.402929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:00.403333 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:22:00.403966 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:22:00.404787 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:22:00.410511 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m22:22:00.411332 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:22:00.411987 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:22:00.412772 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:22:00.413235 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m22:22:00.413671 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m22:22:00.414336 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:22:00.414997 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:22:00.415447 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:22:00.415859 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:22:00.416598 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:22:00.417400 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:22:00.418252 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:22:00.418708 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:22:00.419062 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:22:00.424818 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:22:00.426878 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:22:00.430637 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:22:00.434210 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:22:00.438020 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:22:00.438523 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:22:00.438981 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:22:00.439428 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:22:00.439875 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:22:00.440851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:22:00.441462 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:22:00.441917 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:22:00.442301 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:22:00.445657 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:22:00.449165 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:22:00.452345 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:22:00.455632 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:22:00.456145 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:22:00.456617 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:22:00.457062 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:22:00.457557 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:22:00.458370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:22:00.464192 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:22:00.469939 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m22:22:00.478263 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:22:00.481182 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:22:00.482581 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:22:00.482952 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m22:22:00.483451 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:22:00.483965 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:22:00.484421 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:22:00.485868 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:22:00.486286 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:22:00.486689 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:22:00.487108 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:22:00.487519 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:22:00.488178 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:22:00.491396 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:22:00.498408 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:22:00.510476 [debug] [Thread-3 (]: SQL status: COMMIT in 0.022 seconds
[0m22:22:00.511215 [debug] [Thread-2 (]: SQL status: COMMIT in 0.023 seconds
[0m22:22:00.511726 [debug] [Thread-4 (]: SQL status: COMMIT in 0.024 seconds
[0m22:22:00.512434 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:22:00.516279 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:22:00.519348 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:22:00.523520 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:22:00.524176 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:22:00.525455 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:22:00.526683 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:22:00.527936 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:22:00.528685 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:22:00.529237 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:22:00.529762 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:22:00.532604 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:22:00.535609 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:22:00.536225 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:22:00.536689 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:22:00.538335 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:22:00.540791 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.010 seconds
[0m22:22:00.542980 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:22:00.543737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315c3ba390>]}
[0m22:22:00.545950 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:22:00.546702 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315c39fc90>]}
[0m22:22:00.547293 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315c398090>]}
[0m22:22:00.548038 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.23s]
[0m22:22:00.548762 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315c3b8cd0>]}
[0m22:22:00.549757 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m22:22:00.551015 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.24s]
[0m22:22:00.552097 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:22:00.553202 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.24s]
[0m22:22:00.554178 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:22:00.554940 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:22:00.555919 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:22:00.557253 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:22:00.557813 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:22:00.559021 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:22:00.559735 [info ] [Thread-3 (]: 5 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:22:00.560341 [info ] [Thread-1 (]: 6 of 8 START sql view model public.stg_housing_prices .......................... [RUN]
[0m22:22:00.560912 [info ] [Thread-2 (]: 7 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:22:00.561516 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.incremental_prices)
[0m22:22:00.562198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m22:22:00.562940 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition)
[0m22:22:00.563484 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:22:00.563966 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:22:00.564465 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:22:00.571719 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:22:00.575091 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:22:00.578534 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:22:00.579246 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:22:00.579790 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:22:00.596523 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:22:00.600626 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:22:00.620271 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:22:00.638261 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:22:00.638868 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp222200619878"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:22:00.639402 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:22:00.640153 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:22:00.640607 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:22:00.641231 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:22:00.641969 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:22:00.642408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:00.642815 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:22:00.646361 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
               ^

[0m22:22:00.647154 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:22:00.651398 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:22:00.652331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:22:00.653024 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:22:00.654145 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:22:00.655037 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:22:00.655881 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m22:22:00.659061 [debug] [Thread-3 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:22:00.659910 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:22:00.660485 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:22:00.661227 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315c3a8550>]}
[0m22:22:00.665398 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:22:00.669655 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:22:00.670662 [error] [Thread-3 (]: 5 of 8 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.10s]
[0m22:22:00.671487 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:22:00.672393 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:22:00.673588 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:22:00.674837 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^.
[0m22:22:00.676728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:22:00.677444 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:22:00.679426 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:22:00.680964 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:22:00.681459 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:22:00.681883 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:22:00.682339 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:22:00.682752 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:22:00.686512 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:22:00.689465 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:22:00.690117 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m22:22:00.690954 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:22:00.693675 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:22:00.694132 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:22:00.694918 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:22:00.695470 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:22:00.696007 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:22:00.697889 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:22:00.698296 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:22:00.699614 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:22:00.700171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315c29d150>]}
[0m22:22:00.700808 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public.stg_housing_prices ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m22:22:00.701445 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315c39ec10>]}
[0m22:22:00.702218 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:22:00.703093 [info ] [Thread-2 (]: 7 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.14s]
[0m22:22:00.704169 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:22:00.705406 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:22:00.706068 [info ] [Thread-4 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:22:00.706588 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:22:00.706974 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:22:00.711053 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:22:00.711670 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:22:00.716358 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:22:00.717000 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:22:00.717395 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:22:00.717716 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:22:00.724401 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m22:22:00.724835 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:22:00.725281 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:22:00.727662 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:22:00.730976 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:22:00.731332 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:22:00.732118 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:22:00.733531 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:22:00.733893 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:22:00.734236 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:22:00.737410 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:22:00.740231 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:22:00.740883 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:22:00.741255 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:22:00.741883 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:22:00.743206 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:22:00.743776 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f532905b-a324-41b0-88bf-cd02f6054b33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315c25fa90>]}
[0m22:22:00.744499 [info ] [Thread-4 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.04s]
[0m22:22:00.745159 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:22:00.747183 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:00.747593 [debug] [MainThread]: On master: BEGIN
[0m22:22:00.747842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:22:00.754693 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:22:00.755092 [debug] [MainThread]: On master: COMMIT
[0m22:22:00.755358 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:00.755600 [debug] [MainThread]: On master: COMMIT
[0m22:22:00.756125 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:22:00.756566 [debug] [MainThread]: On master: Close
[0m22:22:00.757157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:00.757524 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:22:00.757759 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:22:00.758062 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:22:00.758293 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:22:00.758715 [info ] [MainThread]: 
[0m22:22:00.759047 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m22:22:00.760872 [debug] [MainThread]: Command end result
[0m22:22:00.795700 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:22:00.797353 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:22:00.804248 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:22:00.804621 [info ] [MainThread]: 
[0m22:22:00.805138 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:22:00.805620 [info ] [MainThread]: 
[0m22:22:00.806269 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:22:00.806819 [info ] [MainThread]: 
[0m22:22:00.807220 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:22:00.808575 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6834223, "process_in_blocks": "0", "process_kernel_time": 0.277199, "process_mem_max_rss": "128080", "process_out_blocks": "3352", "process_user_time": 3.771894}
[0m22:22:00.809228 [debug] [MainThread]: Command `dbt run` failed at 22:22:00.809064 after 2.68 seconds
[0m22:22:00.809675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3164741590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315e716c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31645d0e10>]}
[0m22:22:00.810025 [debug] [MainThread]: Flushing usage events
[0m22:22:01.560461 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:22:31.430595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf06b6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf06b5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf0686050>]}


============================== 22:22:31.433146 | 5254c6cb-e77e-4ce5-ad31-afcc06c4121b ==============================
[0m22:22:31.433146 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:22:31.433761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ls --resource-type model --output path', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:22:31.583439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5254c6cb-e77e-4ce5-ad31-afcc06c4121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febef7495d0>]}
[0m22:22:31.640159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5254c6cb-e77e-4ce5-ad31-afcc06c4121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf30a94d0>]}
[0m22:22:31.640852 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:22:31.723720 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:22:31.850908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:22:31.851274 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:22:31.857660 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.airflow_dbt_training.gold
- models.airflow_dbt_training.silver
- models.airflow_dbt_training.bronze
[0m22:22:31.904691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5254c6cb-e77e-4ce5-ad31-afcc06c4121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febeef0c250>]}
[0m22:22:32.003231 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:22:32.005689 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:22:32.016766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5254c6cb-e77e-4ce5-ad31-afcc06c4121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febef74a350>]}
[0m22:22:32.017239 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:22:32.017551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5254c6cb-e77e-4ce5-ad31-afcc06c4121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febef785a10>]}
[0m22:22:32.019269 [info ] [MainThread]: models/airflow_dbt_training/bronze/housing_prices.sql
[0m22:22:32.019632 [info ] [MainThread]: models/airflow_dbt_training/silver/incremental_prices.sql
[0m22:22:32.020036 [info ] [MainThread]: models/airflow_dbt_training/bronze/location_data.sql
[0m22:22:32.020437 [info ] [MainThread]: models/airflow_dbt_training/gold/mart_housing_prices_breakdown.sql
[0m22:22:32.020949 [info ] [MainThread]: models/airflow_dbt_training/gold/region_type_composition.sql
[0m22:22:32.021421 [info ] [MainThread]: models/staging/stg_example.sql
[0m22:22:32.021844 [info ] [MainThread]: models/airflow_dbt_training/silver/stg_housing_prices.sql
[0m22:22:32.022363 [info ] [MainThread]: models/airflow_dbt_training/silver/stg_location_data.sql
[0m22:22:32.023882 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.64371824, "process_in_blocks": "24", "process_kernel_time": 0.11004, "process_mem_max_rss": "109656", "process_out_blocks": "1160", "process_user_time": 1.800657}
[0m22:22:32.024384 [debug] [MainThread]: Command `dbt ls` succeeded at 22:22:32.024293 after 0.64 seconds
[0m22:22:32.024739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf06da150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf09b8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf49e90d0>]}
[0m22:22:32.025064 [debug] [MainThread]: Flushing usage events
[0m22:22:32.651264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:23:24.026600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd04d5450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd04ca3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd04d64d0>]}


============================== 22:23:24.029476 | a458a0f9-7e60-4780-91cf-807477f2de32 ==============================
[0m22:23:24.029476 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:23:24.030021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:23:24.140686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a458a0f9-7e60-4780-91cf-807477f2de32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd0565c90>]}
[0m22:23:24.151826 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18006812, "process_in_blocks": "0", "process_kernel_time": 0.110358, "process_mem_max_rss": "99064", "process_out_blocks": "16", "process_user_time": 1.414591}
[0m22:23:24.152308 [debug] [MainThread]: Command `dbt clean` succeeded at 22:23:24.152204 after 0.18 seconds
[0m22:23:24.152689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd04d6e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd4828ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd4828d10>]}
[0m22:23:24.153087 [debug] [MainThread]: Flushing usage events
[0m22:23:24.733394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:23:27.066919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863bf814d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863cab8510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863bfbb510>]}


============================== 22:23:27.069591 | 95dc547d-5572-43ed-bcfb-c42466dde126 ==============================
[0m22:23:27.069591 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:23:27.070123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:23:27.220937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863b8cd690>]}
[0m22:23:27.278133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863e7f15d0>]}
[0m22:23:27.278896 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:23:27.356490 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:23:27.357112 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:23:27.357471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863b963990>]}
[0m22:23:28.797892 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.airflow_dbt_training.silver
- models.airflow_dbt_training.bronze
- models.airflow_dbt_training.gold
[0m22:23:28.814091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863a9ee7d0>]}
[0m22:23:28.914497 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:23:28.916868 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:23:28.928991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863ad48250>]}
[0m22:23:28.929497 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:23:28.929827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863a1c80d0>]}
[0m22:23:28.932375 [info ] [MainThread]: 
[0m22:23:28.932801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:23:28.933080 [info ] [MainThread]: 
[0m22:23:28.934020 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:23:28.939686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:23:28.976929 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:23:28.977287 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:23:28.977556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:28.985009 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m22:23:28.986272 [debug] [ThreadPool]: On list_dwh: Close
[0m22:23:28.988058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:23:28.994385 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:23:28.994700 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:23:28.994943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:23:29.001316 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:23:29.001959 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:23:29.002819 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:23:29.005586 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:23:29.006973 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:23:29.007412 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:23:29.014392 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:29.014734 [debug] [MainThread]: On master: BEGIN
[0m22:23:29.015019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:23:29.021599 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:23:29.021949 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:29.022473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:23:29.029150 [debug] [MainThread]: SQL status: SELECT 14 in 0.006 seconds
[0m22:23:29.033278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863a9ed690>]}
[0m22:23:29.039753 [debug] [MainThread]: On master: ROLLBACK
[0m22:23:29.040329 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:29.040604 [debug] [MainThread]: On master: BEGIN
[0m22:23:29.041194 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:23:29.041465 [debug] [MainThread]: On master: COMMIT
[0m22:23:29.041722 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:29.042067 [debug] [MainThread]: On master: COMMIT
[0m22:23:29.042540 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:23:29.042845 [debug] [MainThread]: On master: Close
[0m22:23:29.045976 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:23:29.046594 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:23:29.047108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:23:29.047502 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:23:29.053122 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:23:29.053762 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:23:29.057326 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:23:29.058335 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:23:29.057945 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:23:29.059012 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:23:29.060141 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:23:29.060857 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:23:29.061495 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:23:29.062096 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:23:29.062612 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:23:29.063331 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:23:29.063741 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:23:29.064230 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:23:29.066820 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:23:29.074577 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:23:29.090788 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:23:29.111850 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:23:29.112460 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:23:29.118482 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:23:29.119764 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:23:29.123657 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:23:29.124756 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:23:29.125351 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:23:29.125889 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:23:29.126703 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:23:29.127242 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:23:29.127696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:29.128091 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:23:29.128769 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:23:29.133105 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:23:29.133625 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:23:29.134541 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:23:29.135701 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m22:23:29.136395 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:23:29.137001 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:23:29.137445 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:23:29.137891 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:23:29.138342 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:23:29.138776 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:23:29.139222 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:23:29.139733 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:23:29.140644 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:23:29.146383 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:23:29.149067 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:23:29.152646 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:23:29.153282 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:23:29.154094 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:23:29.154985 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m22:23:29.155639 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m22:23:29.156263 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:23:29.157000 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:23:29.157440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:23:29.157821 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:23:29.161339 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:23:29.161843 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:23:29.164939 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:23:29.165515 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:23:29.166015 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:23:29.166552 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:23:29.167401 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:23:29.167891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:23:29.173664 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:23:29.179363 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m22:23:29.188080 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:23:29.189763 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:23:29.193406 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:23:29.196594 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:23:29.197024 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:23:29.197452 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:23:29.197919 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:23:29.198368 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:23:29.198798 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:23:29.199209 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:23:29.200037 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:23:29.203128 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:23:29.203627 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:23:29.204061 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:23:29.204464 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:23:29.207657 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:23:29.208246 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m22:23:29.216363 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:23:29.216852 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m22:23:29.217283 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:23:29.220094 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:23:29.225450 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:23:29.227138 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:23:29.227990 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:23:29.228442 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:23:29.228896 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:23:29.229324 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:23:29.229790 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:23:29.231321 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:23:29.231766 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:23:29.232308 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:23:29.232803 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:23:29.233763 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:23:29.236102 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:23:29.236631 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:23:29.237136 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m22:23:29.239987 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:23:29.240398 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:23:29.244432 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:23:29.244807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860b67b6d0>]}
[0m22:23:29.245504 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:23:29.246839 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:23:29.247498 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:23:29.248173 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.19s]
[0m22:23:29.248700 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:23:29.249269 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:23:29.249813 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860b7dd890>]}
[0m22:23:29.250428 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:23:29.251434 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m22:23:29.252627 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:23:29.253500 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:23:29.253981 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:23:29.254608 [info ] [Thread-1 (]: 5 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:23:29.255136 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:23:29.255688 [info ] [Thread-2 (]: 6 of 8 START sql view model public.stg_housing_prices .......................... [RUN]
[0m22:23:29.256190 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:23:29.256712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.incremental_prices)
[0m22:23:29.258315 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:23:29.258897 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m22:23:29.260410 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:23:29.260860 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:23:29.261376 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:23:29.261900 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860b7dd010>]}
[0m22:23:29.262515 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860b53dad0>]}
[0m22:23:29.269587 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:23:29.272891 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:23:29.273686 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m22:23:29.274504 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m22:23:29.276310 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:23:29.276757 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:23:29.277208 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:23:29.277835 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:23:29.282558 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:23:29.305153 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:23:29.316005 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:23:29.321797 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:23:29.322330 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:23:29.332032 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:23:29.332734 [info ] [Thread-3 (]: 7 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:23:29.333512 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp222329314181"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:23:29.334188 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m22:23:29.334679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:29.335182 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:23:29.338949 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:23:29.339824 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m22:23:29.340208 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:23:29.340872 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m22:23:29.342118 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:23:29.348252 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:23:29.349023 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
               ^

[0m22:23:29.351117 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:23:29.355476 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:23:29.356138 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:23:29.356810 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:23:29.357476 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:23:29.359763 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:23:29.360895 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:23:29.361469 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:23:29.363473 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:23:29.364600 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:23:29.365196 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:23:29.368795 [debug] [Thread-1 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:23:29.369562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860b527a90>]}
[0m22:23:29.370114 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m22:23:29.371077 [error] [Thread-1 (]: 5 of 8 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.11s]
[0m22:23:29.375121 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:23:29.375730 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m22:23:29.376480 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:23:29.377258 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:23:29.377779 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:23:29.378940 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^.
[0m22:23:29.379666 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:23:29.380680 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:23:29.382866 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:23:29.384892 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:23:29.385436 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:23:29.389017 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:23:29.389567 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860b646950>]}
[0m22:23:29.390049 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:23:29.390845 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.stg_housing_prices ..................... [[32mCREATE VIEW[0m in 0.13s]
[0m22:23:29.391721 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:23:29.392198 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:23:29.393926 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:23:29.394573 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:23:29.394924 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:23:29.397917 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:23:29.401004 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:23:29.401693 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:23:29.402080 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:23:29.402806 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:23:29.404511 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:23:29.405190 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8608407910>]}
[0m22:23:29.405782 [info ] [Thread-3 (]: 7 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.07s]
[0m22:23:29.406375 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:23:29.407453 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:23:29.408028 [info ] [Thread-4 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:23:29.408556 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:23:29.408977 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:23:29.412874 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:23:29.413494 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:23:29.417857 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:23:29.418469 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:23:29.418823 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:23:29.419156 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:23:29.425904 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m22:23:29.426433 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:23:29.427081 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:23:29.429632 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:23:29.433052 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:23:29.433501 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:23:29.434453 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:23:29.435790 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:23:29.436136 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:23:29.436449 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:23:29.439726 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:23:29.442682 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:23:29.443346 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:23:29.443718 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:23:29.444337 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:23:29.445748 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:23:29.446341 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95dc547d-5572-43ed-bcfb-c42466dde126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860842ad10>]}
[0m22:23:29.446953 [info ] [Thread-4 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.04s]
[0m22:23:29.447536 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:23:29.449322 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:29.449657 [debug] [MainThread]: On master: BEGIN
[0m22:23:29.449904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:23:29.456697 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:23:29.457319 [debug] [MainThread]: On master: COMMIT
[0m22:23:29.457898 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:29.458179 [debug] [MainThread]: On master: COMMIT
[0m22:23:29.458708 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:23:29.459027 [debug] [MainThread]: On master: Close
[0m22:23:29.459502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:29.459811 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:23:29.460044 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:23:29.460265 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:23:29.460487 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:23:29.460868 [info ] [MainThread]: 
[0m22:23:29.461214 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m22:23:29.462989 [debug] [MainThread]: Command end result
[0m22:23:29.496383 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:23:29.497818 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:23:29.503600 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:23:29.503866 [info ] [MainThread]: 
[0m22:23:29.504248 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:23:29.504542 [info ] [MainThread]: 
[0m22:23:29.505143 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:23:29.505728 [info ] [MainThread]: 
[0m22:23:29.506232 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:23:29.507262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4920218, "process_in_blocks": "88", "process_kernel_time": 0.170334, "process_mem_max_rss": "128176", "process_out_blocks": "3352", "process_user_time": 3.617113}
[0m22:23:29.507724 [debug] [MainThread]: Command `dbt run` failed at 22:23:29.507623 after 2.49 seconds
[0m22:23:29.508116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863bf82b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863bf81410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f863bdd9c90>]}
[0m22:23:29.508478 [debug] [MainThread]: Flushing usage events
[0m22:23:30.208274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:24:19.044684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fa4eab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fa60fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fa4e8fd0>]}


============================== 22:24:19.047359 | d116800b-cfb5-4105-bde1-c4c77f013a5d ==============================
[0m22:24:19.047359 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:24:19.047859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:24:19.196440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f9d5fa10>]}
[0m22:24:19.252782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fcf35250>]}
[0m22:24:19.253546 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:24:19.331967 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:24:19.438745 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:24:19.439182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fabfb750>]}
[0m22:24:20.857334 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.airflow_dbt_training.silver
- models.airflow_dbt_training.bronze
- models.airflow_dbt_training.gold
[0m22:24:20.870885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f9185750>]}
[0m22:24:20.966442 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:24:20.968864 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:24:20.980962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f913ef90>]}
[0m22:24:20.981440 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:24:20.981786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f854eb90>]}
[0m22:24:20.984412 [info ] [MainThread]: 
[0m22:24:20.984838 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:24:20.985160 [info ] [MainThread]: 
[0m22:24:20.986038 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:24:20.991361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:24:21.029511 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:24:21.029882 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:24:21.030137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:21.039282 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m22:24:21.040490 [debug] [ThreadPool]: On list_dwh: Close
[0m22:24:21.042240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:24:21.048594 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:24:21.048935 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:24:21.049170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:21.055711 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:24:21.056034 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:24:21.056523 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:24:21.059703 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m22:24:21.061285 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:24:21.061738 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:24:21.068527 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:21.068833 [debug] [MainThread]: On master: BEGIN
[0m22:24:21.069069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:21.075566 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:24:21.076052 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:21.076976 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:24:21.083501 [debug] [MainThread]: SQL status: SELECT 14 in 0.006 seconds
[0m22:24:21.087745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f892ee50>]}
[0m22:24:21.088167 [debug] [MainThread]: On master: ROLLBACK
[0m22:24:21.088670 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:21.088927 [debug] [MainThread]: On master: BEGIN
[0m22:24:21.089549 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:24:21.089926 [debug] [MainThread]: On master: COMMIT
[0m22:24:21.090300 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:21.090698 [debug] [MainThread]: On master: COMMIT
[0m22:24:21.091315 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:24:21.091729 [debug] [MainThread]: On master: Close
[0m22:24:21.095422 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:24:21.095982 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:24:21.096703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:24:21.097314 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:24:21.103053 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:24:21.107559 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:24:21.108515 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:24:21.108134 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:24:21.109242 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:24:21.109893 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:24:21.110755 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:24:21.111405 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:24:21.112018 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:24:21.112706 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:24:21.113253 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:24:21.129753 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:24:21.140016 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:24:21.157305 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:24:21.158642 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:24:21.159106 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:24:21.161298 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:24:21.162167 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:24:21.166117 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:24:21.166578 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:24:21.170474 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:24:21.171388 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:24:21.171807 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:24:21.172213 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:24:21.172790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:21.173315 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:24:21.177153 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:24:21.180954 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:24:21.181621 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:24:21.182777 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:24:21.183227 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:24:21.183639 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:24:21.184066 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:24:21.184686 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:24:21.185088 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:24:21.185490 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:24:21.187934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m22:24:21.188439 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:24:21.189005 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:24:21.190597 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:24:21.198508 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:24:21.199289 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m22:24:21.199669 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m22:24:21.200265 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:24:21.200951 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m22:24:21.201437 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:24:21.201886 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:24:21.202382 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:24:21.202859 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:24:21.203318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:21.203738 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:24:21.204205 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:24:21.207757 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:24:21.208221 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:24:21.208816 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:24:21.212389 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:24:21.213113 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:24:21.213601 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:24:21.214015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:21.214539 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:24:21.218039 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:24:21.221485 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:24:21.232616 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:24:21.240380 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:24:21.240827 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m22:24:21.241298 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:24:21.241873 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:24:21.242299 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:21.245660 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:24:21.246202 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:24:21.250415 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:24:21.250820 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:24:21.251272 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:24:21.251813 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:24:21.255017 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:24:21.255465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m22:24:21.256055 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:24:21.261844 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:24:21.262387 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m22:24:21.264088 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:24:21.265475 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:24:21.265859 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:24:21.267218 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:24:21.272703 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:24:21.273207 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:24:21.274663 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:24:21.275130 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:24:21.275570 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:24:21.276079 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:24:21.276519 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:24:21.276981 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:24:21.277598 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:24:21.285341 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m22:24:21.288263 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:24:21.288879 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:24:21.289277 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m22:24:21.289802 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m22:24:21.290210 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:24:21.290616 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.013 seconds
[0m22:24:21.293428 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:24:21.296047 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:24:21.298606 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:24:21.299345 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:24:21.300023 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:24:21.300424 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:24:21.300966 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:24:21.302739 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:24:21.303160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f9958ed0>]}
[0m22:24:21.304502 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:24:21.305383 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m22:24:21.306107 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb496a50>]}
[0m22:24:21.306721 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:24:21.307538 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.19s]
[0m22:24:21.308885 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:24:21.309494 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:24:21.310153 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:24:21.310637 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:24:21.311268 [info ] [Thread-3 (]: 5 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:24:21.312889 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:24:21.313668 [info ] [Thread-1 (]: 6 of 8 START sql view model public.stg_housing_prices .......................... [RUN]
[0m22:24:21.314199 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.009 seconds
[0m22:24:21.314792 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.incremental_prices)
[0m22:24:21.315399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m22:24:21.316160 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f5e785d0>]}
[0m22:24:21.318032 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:24:21.318490 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:24:21.318972 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:24:21.319680 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m22:24:21.325559 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f5dddd50>]}
[0m22:24:21.327445 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:24:21.331017 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:21.331749 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:24:21.332420 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m22:24:21.333522 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:24:21.334067 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:24:21.335156 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:24:21.350139 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:21.362129 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:24:21.389687 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:24:21.390317 [info ] [Thread-2 (]: 7 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:24:21.390880 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp222421371572"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:24:21.391333 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:21.391841 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition)
[0m22:24:21.392291 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:24:21.392741 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:24:21.393206 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:24:21.393795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:21.397709 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:24:21.398625 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:24:21.402911 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:24:21.403686 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:24:21.404091 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:24:21.404731 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:24:21.405711 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
               ^

[0m22:24:21.406421 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m22:24:21.407733 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:24:21.408449 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:21.409096 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m22:24:21.411339 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:24:21.416413 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:21.417464 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:24:21.418392 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m22:24:21.419219 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:24:21.420063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:24:21.420670 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:24:21.422297 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:24:21.423677 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:21.424157 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:24:21.427033 [debug] [Thread-3 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:24:21.427527 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:24:21.428220 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f6941090>]}
[0m22:24:21.428720 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:24:21.431944 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:24:21.439229 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:24:21.440178 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:21.432839 [error] [Thread-3 (]: 5 of 8 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.11s]
[0m22:24:21.440852 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:24:21.441319 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:24:21.442076 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:24:21.442886 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^.
[0m22:24:21.443497 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:21.444207 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:24:21.446441 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:24:21.447767 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:24:21.448247 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:24:21.448739 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:24:21.449335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f440e550>]}
[0m22:24:21.450347 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public.stg_housing_prices ..................... [[32mCREATE VIEW[0m in 0.13s]
[0m22:24:21.450996 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:24:21.453195 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:24:21.456209 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:24:21.456950 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:24:21.457308 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:24:21.457946 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:24:21.459242 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:24:21.459768 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f44c7ed0>]}
[0m22:24:21.460344 [info ] [Thread-2 (]: 7 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.07s]
[0m22:24:21.460896 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:24:21.462261 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:24:21.463143 [info ] [Thread-4 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:24:21.463915 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:24:21.464338 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:24:21.468036 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:21.468755 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:24:21.473048 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:21.473722 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:21.474232 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:24:21.474616 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:24:21.481861 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m22:24:21.482347 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:21.482748 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:24:21.484945 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:24:21.488461 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:21.488887 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:24:21.489682 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:24:21.491094 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:24:21.491462 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:21.491804 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:24:21.494847 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:24:21.497565 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:24:21.498199 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:21.498577 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:24:21.499195 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:24:21.500467 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:24:21.501016 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd116800b-cfb5-4105-bde1-c4c77f013a5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1f44857d0>]}
[0m22:24:21.501613 [info ] [Thread-4 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.04s]
[0m22:24:21.502168 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:24:21.504092 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:21.504517 [debug] [MainThread]: On master: BEGIN
[0m22:24:21.504800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:24:21.512308 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:24:21.512681 [debug] [MainThread]: On master: COMMIT
[0m22:24:21.513031 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:21.513343 [debug] [MainThread]: On master: COMMIT
[0m22:24:21.513763 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:24:21.514044 [debug] [MainThread]: On master: Close
[0m22:24:21.514456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:21.514691 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:24:21.514931 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:24:21.515152 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:24:21.515367 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:24:21.515717 [info ] [MainThread]: 
[0m22:24:21.516092 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m22:24:21.518247 [debug] [MainThread]: Command end result
[0m22:24:21.603503 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:24:21.605111 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:24:21.611112 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:24:21.611392 [info ] [MainThread]: 
[0m22:24:21.611733 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:24:21.612133 [info ] [MainThread]: 
[0m22:24:21.612557 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:24:21.613187 [info ] [MainThread]: 
[0m22:24:21.613803 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:24:21.614851 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6203172, "process_in_blocks": "0", "process_kernel_time": 0.210418, "process_mem_max_rss": "130084", "process_out_blocks": "3360", "process_user_time": 3.677318}
[0m22:24:21.615340 [debug] [MainThread]: Command `dbt run` failed at 22:24:21.615242 after 2.62 seconds
[0m22:24:21.615740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fc0ac250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fe888cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1fb33d790>]}
[0m22:24:21.616134 [debug] [MainThread]: Flushing usage events
[0m22:24:22.383237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:24:25.994163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b46a6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b48d4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b46a6610>]}


============================== 22:24:25.996854 | d88cc4e3-f737-4b82-b555-e68eb446292b ==============================
[0m22:24:25.996854 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:24:25.997436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:24:26.105806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd88cc4e3-f737-4b82-b555-e68eb446292b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b472f310>]}
[0m22:24:26.116093 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17180093, "process_in_blocks": "0", "process_kernel_time": 0.100025, "process_mem_max_rss": "99076", "process_out_blocks": "0", "process_user_time": 1.37035}
[0m22:24:26.116637 [debug] [MainThread]: Command `dbt clean` succeeded at 22:24:26.116534 after 0.17 seconds
[0m22:24:26.117006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b46fa610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b46f8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b49d8990>]}
[0m22:24:26.117354 [debug] [MainThread]: Flushing usage events
[0m22:24:26.772032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:24:28.979318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1679296550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1679296050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16792967d0>]}


============================== 22:24:28.982194 | 7ddde29a-f64f-4c11-9e62-0a85464be6ff ==============================
[0m22:24:28.982194 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:24:28.982750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:24:29.141301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1678933f10>]}
[0m22:24:29.202735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167bb03610>]}
[0m22:24:29.203492 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:24:29.279161 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:24:29.279789 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:24:29.280154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1678137750>]}
[0m22:24:30.722603 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.airflow_dbt_training.bronze
- models.airflow_dbt_training.gold
- models.airflow_dbt_training.silver
[0m22:24:30.738705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16779a7cd0>]}
[0m22:24:30.838898 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:24:30.841325 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:24:30.853533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16775d81d0>]}
[0m22:24:30.854026 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:24:30.854381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16779a6f90>]}
[0m22:24:30.856825 [info ] [MainThread]: 
[0m22:24:30.857186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:24:30.857550 [info ] [MainThread]: 
[0m22:24:30.858465 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:24:30.863779 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:24:30.901957 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:24:30.902335 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:24:30.902594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:30.910065 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m22:24:30.911257 [debug] [ThreadPool]: On list_dwh: Close
[0m22:24:30.913103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:24:30.919393 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:24:30.919706 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:24:30.919943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:30.926489 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:24:30.926827 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:24:30.927132 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:24:30.929827 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:24:30.931270 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:24:30.931795 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:24:30.938604 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:30.938932 [debug] [MainThread]: On master: BEGIN
[0m22:24:30.939164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:30.945730 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:24:30.946201 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:30.946821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:24:30.953160 [debug] [MainThread]: SQL status: SELECT 14 in 0.006 seconds
[0m22:24:30.957158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167552d410>]}
[0m22:24:30.957605 [debug] [MainThread]: On master: ROLLBACK
[0m22:24:30.958097 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:30.958358 [debug] [MainThread]: On master: BEGIN
[0m22:24:30.958954 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:24:30.959215 [debug] [MainThread]: On master: COMMIT
[0m22:24:30.959490 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:30.959762 [debug] [MainThread]: On master: COMMIT
[0m22:24:30.960198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:24:30.960506 [debug] [MainThread]: On master: Close
[0m22:24:30.963960 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:24:30.964381 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:24:30.965008 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:24:30.965516 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:24:30.965992 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:24:30.966976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:24:30.967592 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:24:30.968251 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:24:30.968918 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:24:30.969493 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:24:30.970238 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:24:30.971001 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:24:30.971422 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:24:30.980264 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:24:30.980976 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:24:30.981478 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:24:30.983808 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:24:30.984379 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:24:30.987007 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:24:30.990542 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:24:30.992673 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:24:30.993299 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:24:30.993831 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:24:31.025737 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:24:31.066723 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:24:31.068397 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:24:31.072772 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:24:31.076927 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:24:31.079021 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:24:31.079581 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:24:31.080080 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:24:31.081191 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:24:31.081836 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:24:31.082241 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:24:31.082685 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:24:31.083092 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:24:31.083560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:31.083977 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:24:31.084409 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:24:31.085100 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:24:31.087144 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m22:24:31.088054 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:24:31.088613 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:24:31.090180 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:24:31.097360 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:24:31.098174 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:24:31.098882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m22:24:31.099660 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:31.100212 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m22:24:31.100959 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m22:24:31.101457 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:24:31.104940 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:24:31.105368 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:24:31.105768 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:24:31.106358 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:24:31.106968 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:24:31.107441 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:24:31.107898 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:24:31.108795 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:24:31.114657 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:24:31.120364 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m22:24:31.125994 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m22:24:31.129318 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:24:31.133839 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:24:31.139855 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:24:31.144265 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:24:31.144992 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:24:31.145600 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:24:31.146195 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:24:31.146799 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:24:31.147356 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:24:31.148396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:24:31.148920 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:31.149500 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:24:31.154182 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:24:31.158005 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:24:31.163560 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:24:31.164115 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:24:31.164600 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:24:31.165047 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:24:31.165941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:24:31.166417 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:31.166932 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:31.169234 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:24:31.171311 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:24:31.172840 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:24:31.173309 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:24:31.173785 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:24:31.174203 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:24:31.174632 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:24:31.175040 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:24:31.175443 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:24:31.775390 [debug] [Thread-3 (]: SQL status: COMMIT in 0.627 seconds
[0m22:24:31.785272 [debug] [Thread-4 (]: SQL status: COMMIT in 0.609 seconds
[0m22:24:31.792082 [debug] [Thread-2 (]: SQL status: COMMIT in 0.616 seconds
[0m22:24:31.793409 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:24:31.799576 [debug] [Thread-1 (]: SQL status: COMMIT in 0.624 seconds
[0m22:24:31.800395 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:24:31.805522 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:24:31.814942 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:24:31.819259 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:24:31.820084 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:24:31.820853 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:24:31.821337 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:24:31.822327 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:24:31.822866 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:24:31.823378 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:24:31.824178 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:24:31.827164 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:24:31.830083 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:24:31.830689 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:24:31.831147 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m22:24:31.834058 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:24:31.834811 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m22:24:31.836724 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:24:31.837220 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1674a6e610>]}
[0m22:24:31.838689 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:24:31.839243 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1674a6f090>]}
[0m22:24:31.840782 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1674a8a050>]}
[0m22:24:31.840022 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.86s]
[0m22:24:31.841769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1674a60dd0>]}
[0m22:24:31.842754 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.87s]
[0m22:24:31.843787 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.86s]
[0m22:24:31.844834 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:24:31.846531 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.88s]
[0m22:24:31.847787 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:24:31.848867 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:24:31.850084 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:24:31.852693 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:24:31.853679 [info ] [Thread-3 (]: 5 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:24:31.854545 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:24:31.855364 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.incremental_prices)
[0m22:24:31.856135 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:24:31.857179 [info ] [Thread-2 (]: 6 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:24:31.858183 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:24:31.859011 [info ] [Thread-4 (]: 7 of 8 START sql view model public.stg_housing_prices .......................... [RUN]
[0m22:24:31.860200 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition)
[0m22:24:31.869509 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:24:31.870211 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m22:24:31.870713 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:24:31.871581 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:24:31.872284 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:24:31.876609 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:24:31.880779 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:31.910271 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:24:31.921196 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:24:31.930939 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:31.938588 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:24:31.944417 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:24:31.945079 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp222431915866"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:24:31.945630 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:31.946324 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:24:31.946822 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:24:31.947641 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:24:31.948073 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:24:31.948541 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:24:31.949115 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:24:31.954049 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
               ^

[0m22:24:31.955186 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:24:31.956088 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:24:31.957047 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:24:31.959692 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:31.961041 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:24:31.961825 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m22:24:31.963063 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:24:31.967934 [debug] [Thread-3 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:24:31.968713 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:24:31.969488 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167490ba90>]}
[0m22:24:31.969944 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:24:31.974775 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:24:31.976079 [error] [Thread-3 (]: 5 of 8 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.11s]
[0m22:24:31.982213 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:31.983057 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:24:31.984124 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:24:31.984785 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:24:31.985760 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^.
[0m22:24:31.986631 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:31.988833 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:24:31.990385 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:24:31.991739 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:24:31.992208 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:24:31.992931 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:31.993534 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:24:31.994001 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:24:31.996801 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m22:24:32.000074 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:24:32.000790 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:24:32.001143 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:24:32.001941 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:24:32.003293 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:24:32.003893 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16771c2890>]}
[0m22:24:32.004513 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m22:24:32.005340 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.14s]
[0m22:24:32.008742 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:24:32.009587 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:24:32.010766 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:24:32.011771 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:24:32.012823 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:24:32.014382 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:24:32.014968 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1674a23850>]}
[0m22:24:32.015580 [info ] [Thread-4 (]: 7 of 8 OK created sql view model public.stg_housing_prices ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m22:24:32.016271 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:24:32.017343 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:24:32.018606 [info ] [Thread-1 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:24:32.019283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:24:32.019705 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:24:32.023680 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:32.024310 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:24:32.028575 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:32.029288 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:32.029660 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:24:32.030027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:32.037025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:24:32.037479 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:32.037920 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:24:32.039969 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:24:32.043936 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:32.044357 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:24:32.045162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:24:32.046551 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:24:32.046925 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:32.047410 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:24:32.050481 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:24:32.053249 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:24:32.053895 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:24:32.054248 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:24:32.054856 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:24:32.056213 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:24:32.056753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde29a-f64f-4c11-9e62-0a85464be6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16749947d0>]}
[0m22:24:32.057338 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.04s]
[0m22:24:32.057916 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:24:32.059682 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:32.060025 [debug] [MainThread]: On master: BEGIN
[0m22:24:32.060263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:24:32.066847 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:24:32.067320 [debug] [MainThread]: On master: COMMIT
[0m22:24:32.067632 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:32.067888 [debug] [MainThread]: On master: COMMIT
[0m22:24:32.068309 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:24:32.068582 [debug] [MainThread]: On master: Close
[0m22:24:32.069018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:32.069256 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:24:32.069480 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:24:32.069705 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:24:32.069947 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:24:32.070292 [info ] [MainThread]: 
[0m22:24:32.070599 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m22:24:32.072965 [debug] [MainThread]: Command end result
[0m22:24:32.106738 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:24:32.108348 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:24:32.114456 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:24:32.114749 [info ] [MainThread]: 
[0m22:24:32.115084 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:24:32.115398 [info ] [MainThread]: 
[0m22:24:32.115965 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:24:32.116354 [info ] [MainThread]: 
[0m22:24:32.116874 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:24:32.118013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.19046, "process_in_blocks": "0", "process_kernel_time": 0.220163, "process_mem_max_rss": "130244", "process_out_blocks": "3360", "process_user_time": 3.662718}
[0m22:24:32.118533 [debug] [MainThread]: Command `dbt run` failed at 22:24:32.118401 after 3.19 seconds
[0m22:24:32.118887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16790e6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16790e6e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16790ed750>]}
[0m22:24:32.119269 [debug] [MainThread]: Flushing usage events
[0m22:24:32.824270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:26:26.364917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b09971dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b09ca89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b09971a90>]}


============================== 22:26:26.367746 | e006abc7-be0f-4b66-95db-52e87adc92c4 ==============================
[0m22:26:26.367746 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:26:26.368342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:26:26.484301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e006abc7-be0f-4b66-95db-52e87adc92c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0984abd0>]}
[0m22:26:26.494471 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18879524, "process_in_blocks": "0", "process_kernel_time": 0.099928, "process_mem_max_rss": "98924", "process_out_blocks": "16", "process_user_time": 1.408988}
[0m22:26:26.494978 [debug] [MainThread]: Command `dbt clean` succeeded at 22:26:26.494835 after 0.19 seconds
[0m22:26:26.495313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b099bff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b099be210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b09cc5ad0>]}
[0m22:26:26.495821 [debug] [MainThread]: Flushing usage events
[0m22:26:27.139755 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:26:29.928812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9e4792d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9e486fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda2583ad0>]}


============================== 22:26:29.931414 | 4490d69a-0b3d-4e14-ade3-5f0f66321901 ==============================
[0m22:26:29.931414 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:26:29.931950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:26:30.080285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9e775310>]}
[0m22:26:30.137686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda0e93690>]}
[0m22:26:30.138410 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:26:30.220023 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:26:30.220675 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:26:30.221026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9d9969d0>]}
[0m22:26:31.693457 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.airflow_dbt_training.gold
- models.airflow_dbt_training.bronze
- models.airflow_dbt_training.silver
[0m22:26:31.712218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9c984dd0>]}
[0m22:26:31.816914 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:26:31.819367 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:26:31.831699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9a9e4050>]}
[0m22:26:31.832175 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:26:31.832501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9d9dc410>]}
[0m22:26:31.835251 [info ] [MainThread]: 
[0m22:26:31.835684 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:26:31.835967 [info ] [MainThread]: 
[0m22:26:31.836648 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:26:31.841865 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:26:31.880610 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:26:31.880984 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:26:31.881246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:31.888811 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m22:26:31.890045 [debug] [ThreadPool]: On list_dwh: Close
[0m22:26:31.891821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:26:31.898070 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:26:31.898383 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:26:31.898625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:26:31.905187 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:26:31.905531 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:26:31.905943 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:26:31.908706 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:26:31.910110 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:26:31.910556 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:26:31.917418 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:31.917722 [debug] [MainThread]: On master: BEGIN
[0m22:26:31.917954 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:26:31.924490 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:26:31.924903 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:31.925464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:26:31.931715 [debug] [MainThread]: SQL status: SELECT 14 in 0.006 seconds
[0m22:26:31.935598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9a854b50>]}
[0m22:26:31.935993 [debug] [MainThread]: On master: ROLLBACK
[0m22:26:31.936450 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:31.936710 [debug] [MainThread]: On master: BEGIN
[0m22:26:31.937328 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:26:31.937666 [debug] [MainThread]: On master: COMMIT
[0m22:26:31.937928 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:31.938166 [debug] [MainThread]: On master: COMMIT
[0m22:26:31.938623 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:26:31.938894 [debug] [MainThread]: On master: Close
[0m22:26:31.942157 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:26:31.942603 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:26:31.943136 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:26:31.943681 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:26:31.944255 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:26:31.945028 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:26:31.945667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:26:31.946271 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:26:31.946934 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:26:31.947552 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:26:31.948168 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:26:31.948853 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:26:31.949459 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:26:31.950262 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:26:31.959307 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:26:31.959816 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:26:31.962396 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:26:31.962920 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:26:31.965531 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:26:31.969113 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:26:31.970486 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:26:31.976471 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:26:31.982271 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:26:32.055364 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:26:32.057193 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:26:32.057918 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:26:32.058486 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:26:32.062889 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:26:32.064331 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:26:32.064970 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:26:32.065482 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:26:32.066068 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:26:32.066585 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:26:32.067010 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:26:32.067401 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:26:32.067810 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:26:32.068228 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:26:32.068623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:32.069003 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:26:32.069389 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:26:32.076318 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:26:32.077209 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:26:32.077819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:26:32.078412 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:26:32.078799 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m22:26:32.079223 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:26:32.079708 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:26:32.080199 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:26:32.080650 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:26:32.081121 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:26:32.081592 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:26:32.082151 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:26:32.083490 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:26:32.084074 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:26:32.084463 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:26:32.084861 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:26:32.092375 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:26:32.096796 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:26:32.100382 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:26:32.103923 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:26:32.104426 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:26:32.104959 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:26:32.105435 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:26:32.105896 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:26:32.106691 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:26:32.107235 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:26:32.107639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:26:32.108032 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:26:32.111292 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:26:32.115013 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:26:32.118350 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:26:32.121786 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:26:32.122287 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:26:32.122728 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:26:32.123206 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:26:32.123656 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:26:32.126119 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:26:32.126577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:26:32.127043 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:26:32.132662 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m22:26:32.156761 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:26:32.158339 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:26:32.159754 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:26:32.161164 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:26:32.161710 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:26:32.162190 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:26:32.162633 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:26:32.163054 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:26:32.163463 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:26:32.163888 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:26:32.164280 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:26:32.164698 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:26:32.177284 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m22:26:32.189034 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:26:32.189691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m22:26:32.190236 [debug] [Thread-2 (]: SQL status: COMMIT in 0.025 seconds
[0m22:26:32.190749 [debug] [Thread-3 (]: SQL status: COMMIT in 0.025 seconds
[0m22:26:32.200358 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:26:32.204871 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:26:32.209192 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:26:32.213883 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:26:32.214580 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:26:32.215882 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:26:32.217035 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:26:32.217974 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:26:32.218747 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:26:32.219355 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:26:32.219973 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:26:32.223324 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:26:32.227838 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:26:32.232647 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.012 seconds
[0m22:26:32.236057 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.015 seconds
[0m22:26:32.238080 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:26:32.238625 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.018 seconds
[0m22:26:32.241088 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:26:32.241953 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9a943810>]}
[0m22:26:32.244655 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:26:32.245675 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd99da3bd0>]}
[0m22:26:32.248196 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd99d5b550>]}
[0m22:26:32.247066 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.28s]
[0m22:26:32.250858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd99dcd850>]}
[0m22:26:32.249838 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.30s]
[0m22:26:32.252334 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.30s]
[0m22:26:32.253773 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:26:32.255019 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m22:26:32.256233 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:26:32.257320 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:26:32.259324 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:26:32.260201 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:26:32.262445 [info ] [Thread-4 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:26:32.263538 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:26:32.264444 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:26:32.265496 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.region_type_composition)
[0m22:26:32.266579 [info ] [Thread-2 (]: 6 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:26:32.267680 [info ] [Thread-3 (]: 7 of 8 START sql view model public.stg_housing_prices .......................... [RUN]
[0m22:26:32.268654 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:26:32.269664 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.incremental_prices)
[0m22:26:32.270401 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.stg_housing_prices)
[0m22:26:32.277216 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:26:32.278169 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:26:32.281255 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:26:32.291164 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:26:32.296001 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:26:32.297555 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:26:32.298247 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:26:32.309519 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:26:32.326133 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:26:32.351335 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:26:32.363850 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:26:32.364904 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:26:32.365327 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp222632341998"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:26:32.365836 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:26:32.366209 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:26:32.366606 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:26:32.366987 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:26:32.367337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:26:32.367897 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:26:32.373952 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m22:26:32.374570 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
               ^

[0m22:26:32.375090 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:26:32.375871 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:26:32.376407 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:26:32.376876 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m22:26:32.377500 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:26:32.380259 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:26:32.381501 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:26:32.385993 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:26:32.387099 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:26:32.387732 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:26:32.389039 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:26:32.394245 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:26:32.396487 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:26:32.397522 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:26:32.398483 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:26:32.401141 [debug] [Thread-2 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:26:32.402046 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:26:32.402564 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:26:32.403159 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9834e690>]}
[0m22:26:32.407043 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:26:32.408215 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m22:26:32.409227 [error] [Thread-2 (]: 6 of 8 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.13s]
[0m22:26:32.410122 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:26:32.415593 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:26:32.417229 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:26:32.418226 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:26:32.419468 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:26:32.420412 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^.
[0m22:26:32.421068 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:26:32.422620 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:26:32.424425 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:26:32.424997 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m22:26:32.427894 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:26:32.428568 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:26:32.429267 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9a85d690>]}
[0m22:26:32.429744 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:26:32.430454 [info ] [Thread-3 (]: 7 of 8 OK created sql view model public.stg_housing_prices ..................... [[32mCREATE VIEW[0m in 0.16s]
[0m22:26:32.431214 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:26:32.431616 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:26:32.433277 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:26:32.433947 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd99d8ecd0>]}
[0m22:26:32.434810 [info ] [Thread-4 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.17s]
[0m22:26:32.435720 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:26:32.436842 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:26:32.437438 [info ] [Thread-1 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:26:32.437973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:26:32.438380 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:26:32.442133 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:26:32.442705 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:26:32.447112 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:26:32.447819 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:26:32.448166 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:26:32.448802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:32.455421 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:26:32.455912 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:26:32.456318 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:26:32.458352 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:26:32.461725 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:26:32.462149 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:26:32.462913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:26:32.464277 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:26:32.464692 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:26:32.465035 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:26:32.468313 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:26:32.471008 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:26:32.471711 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:26:32.472054 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:26:32.472649 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:26:32.473934 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:26:32.474512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4490d69a-0b3d-4e14-ade3-5f0f66321901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd99c6c090>]}
[0m22:26:32.475121 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.04s]
[0m22:26:32.475765 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:26:32.478174 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:32.478632 [debug] [MainThread]: On master: BEGIN
[0m22:26:32.478888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:26:32.487098 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:26:32.487971 [debug] [MainThread]: On master: COMMIT
[0m22:26:32.489232 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:32.489706 [debug] [MainThread]: On master: COMMIT
[0m22:26:32.490444 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:26:32.490913 [debug] [MainThread]: On master: Close
[0m22:26:32.491502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:32.491846 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:26:32.492087 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:26:32.492306 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:26:32.492575 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:26:32.492988 [info ] [MainThread]: 
[0m22:26:32.493301 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m22:26:32.495985 [debug] [MainThread]: Command end result
[0m22:26:32.529156 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:26:32.530682 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:26:32.536839 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:26:32.537182 [info ] [MainThread]: 
[0m22:26:32.537550 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:26:32.537968 [info ] [MainThread]: 
[0m22:26:32.538550 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:26:32.538966 [info ] [MainThread]: 
[0m22:26:32.539352 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:26:32.540408 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.662812, "process_in_blocks": "0", "process_kernel_time": 0.159267, "process_mem_max_rss": "129664", "process_out_blocks": "3360", "process_user_time": 3.792553}
[0m22:26:32.540914 [debug] [MainThread]: Command `dbt run` failed at 22:26:32.540746 after 2.66 seconds
[0m22:26:32.541265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9e6af550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9e4c6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9e4c7a10>]}
[0m22:26:32.541648 [debug] [MainThread]: Flushing usage events
[0m22:26:33.239298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:27:15.596528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe69f728d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe69dc2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe69dc2f90>]}


============================== 22:27:15.599180 | 950fe7b2-a43e-43ec-bfc5-2aeb29d80acc ==============================
[0m22:27:15.599180 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:27:15.599911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:27:15.708114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '950fe7b2-a43e-43ec-bfc5-2aeb29d80acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe6aaa89d0>]}
[0m22:27:15.718273 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1723928, "process_in_blocks": "0", "process_kernel_time": 0.110189, "process_mem_max_rss": "99124", "process_out_blocks": "16", "process_user_time": 1.362346}
[0m22:27:15.718718 [debug] [MainThread]: Command `dbt clean` succeeded at 22:27:15.718621 after 0.17 seconds
[0m22:27:15.719095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe69dc9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe69f71890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe69f72cd0>]}
[0m22:27:15.719492 [debug] [MainThread]: Flushing usage events
[0m22:27:16.292444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:27:18.229429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a461e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a4612650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a461ed10>]}


============================== 22:27:18.232110 | 6d8f8c63-7906-4fa2-84c4-25396583511e ==============================
[0m22:27:18.232110 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:27:18.232803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:27:18.383538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a4670b10>]}
[0m22:27:18.441130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a706f5d0>]}
[0m22:27:18.441848 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:27:18.517897 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:27:18.518505 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:27:18.518873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a3d6c7d0>]}
[0m22:27:19.985415 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.silver
- models.gold
- models.bronze
[0m22:27:20.001352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a2d23e10>]}
[0m22:27:20.101400 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:27:20.103801 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:27:20.116154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a2d2f2d0>]}
[0m22:27:20.116647 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:27:20.116978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a297f0d0>]}
[0m22:27:20.120436 [info ] [MainThread]: 
[0m22:27:20.120905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:27:20.121272 [info ] [MainThread]: 
[0m22:27:20.122106 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:27:20.128248 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:27:20.167070 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:27:20.167441 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:27:20.167689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:20.176948 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m22:27:20.178149 [debug] [ThreadPool]: On list_dwh: Close
[0m22:27:20.179888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:27:20.186326 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:27:20.186648 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:27:20.186880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:27:20.193446 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:27:20.193846 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:27:20.194330 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:27:20.197106 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:27:20.198499 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:27:20.198951 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:27:20.205687 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:20.205992 [debug] [MainThread]: On master: BEGIN
[0m22:27:20.206225 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:27:20.212662 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:27:20.213034 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:20.213646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:27:20.219913 [debug] [MainThread]: SQL status: SELECT 14 in 0.006 seconds
[0m22:27:20.223912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1977e88fd0>]}
[0m22:27:20.224336 [debug] [MainThread]: On master: ROLLBACK
[0m22:27:20.224817 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:20.225078 [debug] [MainThread]: On master: BEGIN
[0m22:27:20.225600 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:27:20.225877 [debug] [MainThread]: On master: COMMIT
[0m22:27:20.226121 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:20.226379 [debug] [MainThread]: On master: COMMIT
[0m22:27:20.226792 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:27:20.227112 [debug] [MainThread]: On master: Close
[0m22:27:20.229924 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:27:20.230394 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:27:20.230938 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:27:20.231567 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:27:20.232111 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:27:20.232990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:27:20.233401 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:27:20.234033 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:27:20.234595 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:27:20.235379 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:27:20.236285 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:27:20.236838 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:27:20.237534 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:27:20.243514 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:27:20.247653 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:27:20.250182 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:27:20.250674 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:27:20.251086 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:27:20.254151 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:27:20.257892 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:27:20.259989 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:27:20.265926 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:27:20.266652 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:27:20.287503 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:27:20.328820 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:27:20.334036 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:27:20.336484 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:27:20.338650 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:27:20.339783 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:27:20.340408 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:27:20.340821 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:27:20.341256 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:27:20.341741 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:27:20.342165 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:27:20.342611 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:27:20.343030 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:27:20.343411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:20.343809 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:27:20.344455 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:27:20.345089 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:27:20.350668 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m22:27:20.351427 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:27:20.352254 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:27:20.352951 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:27:20.353766 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:27:20.354419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:27:20.354997 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:27:20.355554 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:27:20.355944 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:27:20.356405 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m22:27:20.362383 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:27:20.364386 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:27:20.364840 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:27:20.365334 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:27:20.368928 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:27:20.369398 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:27:20.369956 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:27:20.370417 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:27:20.371038 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:27:20.371509 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:27:20.375167 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:27:20.375597 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:27:20.376022 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:27:20.379094 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:27:20.379555 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:27:20.383207 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:27:20.386612 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:27:20.387055 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:27:20.387622 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:27:20.388084 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:27:20.388508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:27:20.391801 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:27:20.392233 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:27:20.392728 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:27:20.393131 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:27:20.399068 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m22:27:20.412994 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:27:20.413699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m22:27:20.421369 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:27:20.421800 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:27:20.422411 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:27:20.423860 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:27:20.424293 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:27:20.424856 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:27:20.425283 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:27:20.425677 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:27:20.426134 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:27:20.426553 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:27:20.426972 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:27:20.428321 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:27:20.428989 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:27:20.429326 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:27:20.441008 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m22:27:20.447707 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:27:20.448321 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m22:27:20.448700 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m22:27:20.453994 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:27:20.456933 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:27:20.457324 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m22:27:20.459873 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:27:20.460316 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:27:20.461030 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:27:20.463626 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:27:20.464281 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:27:20.464806 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:27:20.465489 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:27:20.465960 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:27:20.466505 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:27:20.468480 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:27:20.470823 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:27:20.471296 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:27:20.471813 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:27:20.473629 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m22:27:20.474023 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1977d89710>]}
[0m22:27:20.475335 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:27:20.476611 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:27:20.477826 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:27:20.478497 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.23s]
[0m22:27:20.479217 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1977d3ca90>]}
[0m22:27:20.479812 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1977e86850>]}
[0m22:27:20.480763 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:27:20.481444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1977d3f810>]}
[0m22:27:20.482234 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.24s]
[0m22:27:20.483155 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.25s]
[0m22:27:20.484673 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.25s]
[0m22:27:20.485991 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:27:20.486654 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:27:20.487295 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:27:20.487933 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:27:20.488718 [info ] [Thread-4 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:27:20.489924 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.region_type_composition)
[0m22:27:20.490414 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:27:20.490897 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:27:20.494285 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:27:20.494766 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:27:20.495411 [info ] [Thread-3 (]: 6 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:27:20.496381 [info ] [Thread-2 (]: 7 of 8 START sql view model public.stg_housing_prices .......................... [RUN]
[0m22:27:20.497568 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.incremental_prices)
[0m22:27:20.498296 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m22:27:20.498884 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:27:20.499279 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:27:20.499727 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:27:20.506447 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:27:20.511096 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:27:20.514272 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:27:20.515249 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:27:20.516112 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:27:20.516653 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:27:20.537998 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:27:20.538505 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:27:20.559412 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:27:20.560266 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:27:20.560627 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:27:20.560966 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:27:20.570807 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:27:20.571680 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp222720552153"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:27:20.572253 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:27:20.572879 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m22:27:20.573675 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m22:27:20.574286 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:27:20.574814 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:27:20.575308 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:27:20.575823 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m22:27:20.577710 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:27:20.578103 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:27:20.581546 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:27:20.584810 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:27:20.585358 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:27:20.585824 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:27:20.586572 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
               ^

[0m22:27:20.587131 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:27:20.587962 [debug] [Thread-3 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:27:20.589572 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:27:20.590040 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:27:20.592312 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:27:20.594666 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:27:20.595244 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:27:20.595938 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:27:20.597243 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:27:20.600135 [debug] [Thread-3 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:27:20.600663 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m22:27:20.601375 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1977d4cc90>]}
[0m22:27:20.604371 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:27:20.604803 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m22:27:20.605609 [error] [Thread-3 (]: 6 of 8 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.10s]
[0m22:27:20.606762 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:27:20.612721 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:27:20.613574 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:27:20.614044 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:27:20.614956 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:27:20.615698 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^.
[0m22:27:20.616262 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:27:20.616725 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:27:20.619126 [debug] [Thread-2 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:27:20.619623 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:27:20.621037 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:27:20.621594 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1977dd3ad0>]}
[0m22:27:20.622171 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1977e72e90>]}
[0m22:27:20.622868 [info ] [Thread-2 (]: 7 of 8 OK created sql view model public.stg_housing_prices ..................... [[32mCREATE VIEW[0m in 0.12s]
[0m22:27:20.624095 [info ] [Thread-4 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.13s]
[0m22:27:20.625327 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:27:20.626041 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:27:20.627423 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:27:20.627973 [info ] [Thread-1 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:27:20.628484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:27:20.628932 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:27:20.633681 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:27:20.634316 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:27:20.639358 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:27:20.640100 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:27:20.640443 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:27:20.640803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:20.647789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:27:20.648651 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:27:20.649332 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:27:20.651557 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:27:20.655145 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:27:20.655582 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:27:20.656396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:27:20.657659 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:27:20.658017 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:27:20.658349 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:27:20.661352 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:27:20.664226 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:27:20.664867 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:27:20.665214 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:27:20.665889 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:27:20.667163 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:27:20.667728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d8f8c63-7906-4fa2-84c4-25396583511e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1977d4de10>]}
[0m22:27:20.668301 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.04s]
[0m22:27:20.668871 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:27:20.670653 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:20.670961 [debug] [MainThread]: On master: BEGIN
[0m22:27:20.671196 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:27:20.677857 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:27:20.678407 [debug] [MainThread]: On master: COMMIT
[0m22:27:20.678798 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:20.679121 [debug] [MainThread]: On master: COMMIT
[0m22:27:20.679601 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:27:20.679992 [debug] [MainThread]: On master: Close
[0m22:27:20.680491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:20.680779 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:27:20.681014 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:27:20.681235 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:27:20.681453 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:27:20.681839 [info ] [MainThread]: 
[0m22:27:20.682153 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m22:27:20.684054 [debug] [MainThread]: Command end result
[0m22:27:20.718080 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:27:20.719523 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:27:20.725525 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:27:20.725825 [info ] [MainThread]: 
[0m22:27:20.726170 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:27:20.726471 [info ] [MainThread]: 
[0m22:27:20.727002 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:27:20.727507 [info ] [MainThread]: 
[0m22:27:20.727912 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:27:20.728910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5522892, "process_in_blocks": "0", "process_kernel_time": 0.120272, "process_mem_max_rss": "128092", "process_out_blocks": "3352", "process_user_time": 3.718429}
[0m22:27:20.729336 [debug] [MainThread]: Command `dbt run` failed at 22:27:20.729239 after 2.55 seconds
[0m22:27:20.729731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a4671610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a466af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a466b110>]}
[0m22:27:20.730102 [debug] [MainThread]: Flushing usage events
[0m22:27:21.424456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:28:17.355403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7d592c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7d5df6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7d592750>]}


============================== 22:28:17.358031 | f552a604-0ed2-4d78-8633-0994a30ef37b ==============================
[0m22:28:17.358031 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:28:17.358524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:28:17.507863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7c90b810>]}
[0m22:28:17.564253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7ffb7190>]}
[0m22:28:17.564964 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:28:17.641887 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:28:17.746642 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:28:17.747082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7dcab890>]}
[0m22:28:19.169615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7b9ff450>]}
[0m22:28:19.262702 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:28:19.265184 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:28:19.277506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7b5ba1d0>]}
[0m22:28:19.277989 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:28:19.278312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7c1b1c50>]}
[0m22:28:19.281583 [info ] [MainThread]: 
[0m22:28:19.282177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:28:19.282725 [info ] [MainThread]: 
[0m22:28:19.284204 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:28:19.292413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:28:19.336514 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:28:19.336867 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:28:19.337136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:19.346089 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m22:28:19.347403 [debug] [ThreadPool]: On list_dwh: Close
[0m22:28:19.349262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:28:19.355523 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:28:19.355823 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:28:19.356120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:19.362922 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:28:19.363344 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:28:19.363918 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:28:19.367021 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:28:19.368411 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:28:19.368858 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:28:19.375603 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:19.375897 [debug] [MainThread]: On master: BEGIN
[0m22:28:19.376142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:28:19.383062 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:28:19.383477 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:19.384176 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:28:19.390563 [debug] [MainThread]: SQL status: SELECT 14 in 0.006 seconds
[0m22:28:19.394606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7b516750>]}
[0m22:28:19.395018 [debug] [MainThread]: On master: ROLLBACK
[0m22:28:19.395523 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:19.395797 [debug] [MainThread]: On master: BEGIN
[0m22:28:19.396426 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:28:19.396730 [debug] [MainThread]: On master: COMMIT
[0m22:28:19.396989 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:19.397223 [debug] [MainThread]: On master: COMMIT
[0m22:28:19.397671 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:28:19.398046 [debug] [MainThread]: On master: Close
[0m22:28:19.401346 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:28:19.401816 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:28:19.402357 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:28:19.403006 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:28:19.403911 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:28:19.404484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:28:19.404880 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:28:19.405475 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:28:19.406027 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:28:19.406557 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:28:19.407795 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:28:19.407263 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:28:19.408806 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:28:19.418254 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:28:19.420670 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:28:19.421344 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:28:19.421805 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:28:19.422723 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:28:19.423409 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:28:19.425679 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:28:19.426103 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:28:19.429413 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:28:19.461537 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:28:19.481134 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:28:19.482805 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:28:19.486770 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:28:19.487264 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:28:19.488721 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:28:19.492866 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:28:19.493298 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:28:19.493831 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:28:19.494278 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:28:19.494938 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:28:19.495341 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:28:19.495750 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:28:19.496166 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:28:19.496587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:19.497009 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:28:19.497397 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:28:19.498175 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:28:19.504351 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:28:19.505087 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:28:19.505816 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:28:19.506477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:28:19.507016 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m22:28:19.507658 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:28:19.508197 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m22:28:19.508725 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:28:19.509193 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:28:19.509634 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:28:19.510067 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:28:19.510496 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:28:19.517690 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:28:19.518345 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:28:19.518978 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:28:19.519436 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:28:19.519985 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:28:19.524068 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:28:19.524480 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:28:19.524872 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:28:19.528180 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:28:19.528614 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:28:19.531768 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:28:19.535134 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:28:19.535566 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:28:19.536128 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:28:19.536584 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:28:19.537001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:28:19.540460 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:28:19.540873 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:28:19.541323 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:28:19.541716 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:28:19.544779 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:28:19.545170 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m22:28:19.548308 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:28:19.550203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:28:19.550640 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:28:19.561486 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:28:19.568944 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:28:19.570442 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:28:19.571072 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:28:19.571646 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:28:19.572033 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:28:19.572419 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:28:19.572829 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:28:19.574190 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:28:19.574589 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:28:19.576061 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:28:19.576577 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:28:19.577077 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:28:19.577520 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:28:19.577919 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:28:19.580519 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m22:28:19.587361 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:28:19.587991 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m22:28:19.593606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m22:28:19.596626 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:28:19.593378 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:28:19.597329 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m22:28:19.600145 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:28:19.600846 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:28:19.601291 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:28:19.603930 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:28:19.604634 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:28:19.605093 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:28:19.605866 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:28:19.606308 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:28:19.606860 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:28:19.608537 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:28:19.610978 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:28:19.611538 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:28:19.612038 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:28:19.613424 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:28:19.615230 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:28:19.615632 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7847af50>]}
[0m22:28:19.616939 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:28:19.617543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f78d59ed0>]}
[0m22:28:19.618787 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:28:19.619467 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m22:28:19.620309 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m22:28:19.621310 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f78d0e3d0>]}
[0m22:28:19.622096 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f78dea310>]}
[0m22:28:19.622753 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:28:19.623379 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:28:19.624335 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.21s]
[0m22:28:19.625270 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m22:28:19.626689 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:28:19.627673 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:28:19.628157 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:28:19.628711 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:28:19.629847 [info ] [Thread-2 (]: 5 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:28:19.631067 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:28:19.630675 [info ] [Thread-1 (]: 6 of 8 START sql view model public.stg_housing_prices .......................... [RUN]
[0m22:28:19.631939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.incremental_prices)
[0m22:28:19.633232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m22:28:19.632668 [info ] [Thread-3 (]: 7 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:28:19.633942 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:28:19.634403 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:28:19.634930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m22:28:19.641769 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:28:19.645406 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:28:19.646097 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:28:19.646853 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:28:19.650290 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:28:19.650696 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:28:19.680933 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:28:19.697582 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:28:19.707090 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:28:19.702964 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:28:19.708113 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp222819684852"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:28:19.708685 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:28:19.709555 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:28:19.709918 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:28:19.710241 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:28:19.710843 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:28:19.711178 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:28:19.711588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:19.715748 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "updated_at" does not exist
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
               ^

[0m22:28:19.716551 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:28:19.717107 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m22:28:19.717707 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:28:19.719855 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:28:19.721432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:28:19.722327 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:28:19.722900 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  create view "dwh"."public"."stg_housing_prices__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week
FROM source
  );
[0m22:28:19.723753 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:28:19.728464 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:28:19.729000 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:28:19.729936 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:28:19.730673 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:28:19.734349 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:28:19.736340 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:28:19.737276 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:28:19.738163 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:28:19.740187 [debug] [Thread-2 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:28:19.740822 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:28:19.741309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:28:19.742039 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7998ed50>]}
[0m22:28:19.744146 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:28:19.745129 [error] [Thread-2 (]: 5 of 8 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.11s]
[0m22:28:19.745684 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:28:19.746318 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:28:19.746786 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:28:19.747511 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^.
[0m22:28:19.748921 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m22:28:19.752323 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:28:19.752796 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:28:19.753575 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:28:19.756999 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:28:19.757547 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:28:19.758246 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:28:19.758778 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop view if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:28:19.759185 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:28:19.760663 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:28:19.761183 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:28:19.761835 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7b995e50>]}
[0m22:28:19.763201 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:28:19.763887 [info ] [Thread-3 (]: 7 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.13s]
[0m22:28:19.764583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7b55fe90>]}
[0m22:28:19.765145 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:28:19.765808 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public.stg_housing_prices ..................... [[32mCREATE VIEW[0m in 0.13s]
[0m22:28:19.767020 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:28:19.768234 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:28:19.768888 [info ] [Thread-4 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:28:19.769596 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:28:19.769963 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:28:19.773846 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:28:19.774474 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:28:19.779247 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:28:19.780004 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:28:19.780405 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:28:19.780717 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:28:19.787385 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m22:28:19.787850 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:28:19.788250 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:28:19.790228 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:28:19.793791 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:28:19.794192 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:28:19.794933 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:28:19.796155 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:28:19.796488 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:28:19.796817 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:28:19.800582 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:28:19.803379 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:28:19.804035 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:28:19.804378 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:28:19.805006 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:28:19.806254 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:28:19.806792 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f552a604-0ed2-4d78-8633-0994a30ef37b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f784bc2d0>]}
[0m22:28:19.807358 [info ] [Thread-4 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.04s]
[0m22:28:19.807922 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:28:19.810048 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:19.810380 [debug] [MainThread]: On master: BEGIN
[0m22:28:19.810637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:28:19.817350 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:28:19.817753 [debug] [MainThread]: On master: COMMIT
[0m22:28:19.818117 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:19.818397 [debug] [MainThread]: On master: COMMIT
[0m22:28:19.818892 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:28:19.819184 [debug] [MainThread]: On master: Close
[0m22:28:19.819588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:28:19.819822 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:28:19.820063 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:28:19.820279 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:28:19.820495 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:28:19.820879 [info ] [MainThread]: 
[0m22:28:19.821259 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m22:28:19.823195 [debug] [MainThread]: Command end result
[0m22:28:19.906283 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:28:19.907734 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:28:19.913601 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:28:19.913911 [info ] [MainThread]: 
[0m22:28:19.914242 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:28:19.914547 [info ] [MainThread]: 
[0m22:28:19.914990 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  column "updated_at" does not exist
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                 ^
[0m22:28:19.915348 [info ] [MainThread]: 
[0m22:28:19.915751 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:28:19.916696 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6115675, "process_in_blocks": "0", "process_kernel_time": 0.171504, "process_mem_max_rss": "130272", "process_out_blocks": "3368", "process_user_time": 3.702488}
[0m22:28:19.917147 [debug] [MainThread]: Command `dbt run` failed at 22:28:19.917054 after 2.61 seconds
[0m22:28:19.917501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f801651d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f818f43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f798fc150>]}
[0m22:28:19.917930 [debug] [MainThread]: Flushing usage events
[0m22:28:20.599108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:34:40.765970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d6c1d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d9065650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d6c1d4d0>]}


============================== 22:34:40.768971 | bed9f699-ed31-4963-a2c2-6aa2dc08024b ==============================
[0m22:34:40.768971 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:34:40.769525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:34:40.925353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d61dcd10>]}
[0m22:34:40.984386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d9669810>]}
[0m22:34:40.985111 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:34:41.063402 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:34:41.192129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:34:41.192825 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/incremental_prices.sql
[0m22:34:41.193350 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/stg_housing_prices.sql
[0m22:34:41.737388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d4da6f10>]}
[0m22:34:41.870612 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:34:41.873675 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:34:41.888400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c6f23e90>]}
[0m22:34:41.888940 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:34:41.889298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c6f683d0>]}
[0m22:34:41.892922 [info ] [MainThread]: 
[0m22:34:41.893597 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:34:41.894017 [info ] [MainThread]: 
[0m22:34:41.894749 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:34:41.901408 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:34:42.001690 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:34:42.002069 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:34:42.002334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:42.010027 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m22:34:42.011318 [debug] [ThreadPool]: On list_dwh: Close
[0m22:34:42.013672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:34:42.022932 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:34:42.023469 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:34:42.023867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:42.030763 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:34:42.031177 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:34:42.031538 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:34:42.034330 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:34:42.035815 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:34:42.036392 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:34:42.043842 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:42.044197 [debug] [MainThread]: On master: BEGIN
[0m22:34:42.044432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:42.052247 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:34:42.052660 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:42.053227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:34:42.059808 [debug] [MainThread]: SQL status: SELECT 14 in 0.006 seconds
[0m22:34:42.063979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d411bc50>]}
[0m22:34:42.064448 [debug] [MainThread]: On master: ROLLBACK
[0m22:34:42.064950 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:42.065251 [debug] [MainThread]: On master: BEGIN
[0m22:34:42.065828 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:34:42.066105 [debug] [MainThread]: On master: COMMIT
[0m22:34:42.066447 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:42.066839 [debug] [MainThread]: On master: COMMIT
[0m22:34:42.067541 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:42.067926 [debug] [MainThread]: On master: Close
[0m22:34:42.071174 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:34:42.071697 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:34:42.072708 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:34:42.074215 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:34:42.072248 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:34:42.073719 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:34:42.075024 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:34:42.077105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:34:42.076058 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:34:42.078388 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:34:42.079753 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:34:42.080431 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:34:42.081050 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:34:42.081490 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:34:42.082002 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:34:42.091888 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:34:42.092427 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:34:42.094902 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:34:42.097172 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:34:42.100842 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:34:42.101696 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:34:42.108196 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:34:42.119363 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:34:42.125092 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:34:42.180014 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:34:42.181087 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:34:42.182562 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:34:42.184456 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:34:42.185247 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:34:42.185814 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:34:42.186276 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:34:42.186936 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:34:42.187316 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:34:42.187758 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:34:42.188253 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:34:42.188765 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:34:42.189182 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:34:42.189588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:42.190011 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:34:42.190400 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:34:42.197770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:34:42.198529 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m22:34:42.199098 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m22:34:42.199858 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m22:34:42.200679 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:34:42.201228 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:34:42.201758 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:34:42.202224 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:34:42.202743 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:34:42.203186 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:34:42.203695 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:34:42.204168 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:34:42.205969 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:34:42.206690 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:34:42.207128 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:34:42.214685 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:34:42.215188 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m22:34:42.218947 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:34:42.222720 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:34:42.223202 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:34:42.226943 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:34:42.227435 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:34:42.227926 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:34:42.228471 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:34:42.228905 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:34:42.233488 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:34:42.234076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:34:42.234465 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:34:42.234916 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:34:42.235312 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:34:42.238655 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:34:42.241944 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:34:42.245409 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:34:42.246016 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:34:42.246498 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:34:42.246938 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:34:42.247382 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:34:42.253170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:34:42.264377 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m22:34:42.274540 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:34:42.275208 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m22:34:42.275625 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:34:42.278533 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:34:42.282896 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:34:42.284558 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:34:42.285015 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:34:42.285615 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:34:42.286151 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:34:42.286576 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:34:42.287083 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:34:42.287518 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:34:42.287938 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:34:42.290189 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:34:42.297091 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:34:42.297806 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m22:34:42.303234 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:34:42.303920 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m22:34:42.304308 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m22:34:42.307227 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:34:42.307667 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:34:42.310525 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:34:42.313353 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:34:42.314067 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:34:42.314864 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:34:42.315616 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:34:42.316165 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:34:42.316633 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:34:42.317081 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:34:42.317741 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:34:42.320238 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:34:42.322245 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:34:42.323809 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:34:42.324484 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d410e350>]}
[0m22:34:42.325026 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c6420e50>]}
[0m22:34:42.325755 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m22:34:42.326253 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:34:42.327636 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m22:34:42.326959 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.24s]
[0m22:34:42.328784 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:34:42.330363 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:34:42.331847 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:34:42.332590 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:34:42.333982 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c643c750>]}
[0m22:34:42.335024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c6488610>]}
[0m22:34:42.336020 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m22:34:42.337454 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.26s]
[0m22:34:42.338039 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:34:42.338868 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:34:42.339585 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:34:42.340428 [info ] [Thread-2 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:34:42.341772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition)
[0m22:34:42.342387 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:34:42.342912 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:34:42.346648 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:34:42.347391 [info ] [Thread-4 (]: 6 of 8 START sql table model public.stg_housing_prices ......................... [RUN]
[0m22:34:42.348191 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m22:34:42.348768 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:34:42.352895 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:42.353481 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:34:42.354100 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:34:42.360631 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:34:42.386893 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:42.387558 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:34:42.388222 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:34:42.388785 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:34:42.389441 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:42.389785 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:34:42.390084 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:34:42.395768 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m22:34:42.396418 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:34:42.396956 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m22:34:42.397502 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:34:42.397974 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:42.398516 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  
    

  create  table "dwh"."public"."stg_housing_prices__dbt_tmp"
  
  
    as
  
  (
    

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
  );
  
[0m22:34:42.400071 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:34:42.403708 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:34:42.404089 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:34:42.404864 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:42.406075 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:34:42.406519 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:34:42.406909 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:34:42.409677 [debug] [Thread-4 (]: SQL status: SELECT 1500 in 0.011 seconds
[0m22:34:42.415304 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m22:34:42.417456 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:42.420180 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:34:42.420712 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:34:42.421429 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:34:42.421956 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:34:42.422441 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:34:42.423706 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:34:42.424066 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:42.424475 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:34:42.424956 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:34:42.426389 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:34:42.427113 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d5d2ad50>]}
[0m22:34:42.427706 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.09s]
[0m22:34:42.428257 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:34:42.430047 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:34:42.433093 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:34:42.436047 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:42.436431 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop table if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:34:42.437187 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:34:42.438611 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:34:42.439237 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c4315dd0>]}
[0m22:34:42.439961 [info ] [Thread-4 (]: 6 of 8 OK created sql table model public.stg_housing_prices .................... [[32mSELECT 1500[0m in 0.09s]
[0m22:34:42.440670 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:34:42.441807 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:34:42.442594 [info ] [Thread-1 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:34:42.443786 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:34:42.444441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.incremental_prices)
[0m22:34:42.445143 [info ] [Thread-3 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:34:42.445730 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:34:42.446280 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:34:42.452092 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:34:42.454113 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:34:42.458510 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:42.459345 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:34:42.475333 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:34:42.484636 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:42.503698 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:34:42.504331 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp223442494619"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."stg_housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:34:42.504734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:42.505346 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:42.505710 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:34:42.506021 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:34:42.512551 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m22:34:42.513277 [debug] [Thread-1 (]: Postgres adapter: Postgres error: aggregate functions are not allowed in WHERE
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                                    ^

[0m22:34:42.514120 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:42.514879 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:34:42.515611 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:34:42.518423 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:34:42.523021 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:42.523725 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:34:42.525024 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:34:42.526398 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:34:42.526806 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:42.529480 [debug] [Thread-1 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  aggregate functions are not allowed in WHERE
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                                      ^
[0m22:34:42.529966 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:34:42.530610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c43dfd50>]}
[0m22:34:42.531599 [error] [Thread-1 (]: 7 of 8 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.09s]
[0m22:34:42.532502 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:34:42.533293 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  aggregate functions are not allowed in WHERE
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                                      ^.
[0m22:34:42.534052 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:34:42.538578 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:34:42.539311 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:42.539728 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:34:42.540665 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:34:42.542396 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:34:42.543107 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed9f699-ed31-4963-a2c2-6aa2dc08024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c43e0950>]}
[0m22:34:42.543789 [info ] [Thread-3 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.10s]
[0m22:34:42.544411 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:34:42.546660 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:42.547157 [debug] [MainThread]: On master: BEGIN
[0m22:34:42.547508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:34:42.554631 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:34:42.555026 [debug] [MainThread]: On master: COMMIT
[0m22:34:42.555341 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:42.555618 [debug] [MainThread]: On master: COMMIT
[0m22:34:42.556056 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:42.556349 [debug] [MainThread]: On master: Close
[0m22:34:42.556757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:42.556997 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:34:42.557237 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:34:42.557464 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:34:42.557685 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:34:42.558221 [info ] [MainThread]: 
[0m22:34:42.558806 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 6 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m22:34:42.561045 [debug] [MainThread]: Command end result
[0m22:34:42.596184 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:34:42.597712 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:34:42.603913 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:34:42.604254 [info ] [MainThread]: 
[0m22:34:42.604591 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:34:42.604903 [info ] [MainThread]: 
[0m22:34:42.605323 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  aggregate functions are not allowed in WHERE
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                                      ^
[0m22:34:42.605763 [info ] [MainThread]: 
[0m22:34:42.606310 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:34:42.607910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8953644, "process_in_blocks": "0", "process_kernel_time": 0.190055, "process_mem_max_rss": "131800", "process_out_blocks": "3384", "process_user_time": 3.040892}
[0m22:34:42.608416 [debug] [MainThread]: Command `dbt run` failed at 22:34:42.608301 after 1.90 seconds
[0m22:34:42.608778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d6c1ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d51968d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d6c508d0>]}
[0m22:34:42.609141 [debug] [MainThread]: Flushing usage events
[0m22:34:43.369865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:34:52.573757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75866f2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75866f1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75866f0fd0>]}


============================== 22:34:52.577164 | f619a7ce-cb20-481c-95c1-79bea2850df2 ==============================
[0m22:34:52.577164 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:34:52.577707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:34:52.732987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75874cee90>]}
[0m22:34:52.792352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7589129610>]}
[0m22:34:52.793130 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:34:52.874002 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:34:53.002504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:34:53.002863 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:34:53.055424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7585b81750>]}
[0m22:34:53.165003 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:34:53.167447 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:34:53.179993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75857f14d0>]}
[0m22:34:53.180589 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:34:53.180966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7584b22a50>]}
[0m22:34:53.184100 [info ] [MainThread]: 
[0m22:34:53.184556 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:34:53.184891 [info ] [MainThread]: 
[0m22:34:53.185912 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:34:53.191817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:34:53.231898 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:34:53.232262 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:34:53.232516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:53.240218 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m22:34:53.241468 [debug] [ThreadPool]: On list_dwh: Close
[0m22:34:53.243607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:34:53.250299 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:34:53.250645 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:34:53.250906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:53.257539 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:34:53.257918 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:34:53.258269 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:34:53.261315 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m22:34:53.262810 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:34:53.263268 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:34:53.270171 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:53.270502 [debug] [MainThread]: On master: BEGIN
[0m22:34:53.270766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:53.277635 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:34:53.278004 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:53.278470 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:34:53.285098 [debug] [MainThread]: SQL status: SELECT 13 in 0.006 seconds
[0m22:34:53.288932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7584bde610>]}
[0m22:34:53.289369 [debug] [MainThread]: On master: ROLLBACK
[0m22:34:53.289859 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:53.290121 [debug] [MainThread]: On master: BEGIN
[0m22:34:53.290855 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:34:53.291354 [debug] [MainThread]: On master: COMMIT
[0m22:34:53.291800 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:53.292109 [debug] [MainThread]: On master: COMMIT
[0m22:34:53.292592 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:53.292869 [debug] [MainThread]: On master: Close
[0m22:34:53.295768 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:34:53.296292 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:34:53.296826 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:34:53.297514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:34:53.298315 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:34:53.298826 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:34:53.299441 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:34:53.299960 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:34:53.300523 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:34:53.302082 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:34:53.301162 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:34:53.312012 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:34:53.312661 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:34:53.313114 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:34:53.313603 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:34:53.314191 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:34:53.314683 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:34:53.317384 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:34:53.318015 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:34:53.320244 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:34:53.361460 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:34:53.364980 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:34:53.365464 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:34:53.366258 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:34:53.366962 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:34:53.371308 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:34:53.371800 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:34:53.377091 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:34:53.377648 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:34:53.381838 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:34:53.382585 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:34:53.383282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:53.383758 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:34:53.384383 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:34:53.384783 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:34:53.385420 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:34:53.385842 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:34:53.386255 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:34:53.386646 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:34:53.387057 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:34:53.391824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:34:53.392480 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:34:53.393051 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:34:53.394395 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:34:53.395081 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:34:53.395776 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:34:53.396417 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m22:34:53.402100 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m22:34:53.404722 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:34:53.405179 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:34:53.405625 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:34:53.406049 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:34:53.406566 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:34:53.407175 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:34:53.407668 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:34:53.408081 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:34:53.412087 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:34:53.412838 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:34:53.413275 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:34:53.413692 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:34:53.414098 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:34:53.417719 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:34:53.421462 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:34:53.425221 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:34:53.425713 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:34:53.426106 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:34:53.426557 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:34:53.427018 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:34:53.430262 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:34:53.431286 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:34:53.431778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:34:53.432409 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:34:53.438058 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m22:34:53.443855 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m22:34:53.452382 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:34:53.456066 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:34:53.459369 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:34:53.460951 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:34:53.461471 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:34:53.461960 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:34:53.462440 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:34:53.462897 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:34:53.463303 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:34:53.463907 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:34:53.464267 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:53.464862 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:34:53.466329 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:34:53.467960 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:34:53.468455 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:34:53.468881 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:34:53.469306 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:34:53.469708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:34:53.470119 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:34:53.476046 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m22:34:53.479801 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:34:53.528798 [debug] [Thread-3 (]: SQL status: COMMIT in 0.048 seconds
[0m22:34:53.529248 [debug] [Thread-2 (]: SQL status: COMMIT in 0.064 seconds
[0m22:34:53.531045 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:34:53.539381 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:34:53.540030 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:34:53.542876 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:34:53.543673 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:34:53.544380 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:34:53.544817 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:34:53.545629 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:34:53.546364 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:34:53.546997 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:34:53.547560 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:34:53.552779 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:34:53.555202 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:34:53.555651 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:34:53.556043 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:34:53.556435 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:34:53.558122 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:34:53.560946 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:34:53.561304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75853eb810>]}
[0m22:34:53.562556 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:34:53.563128 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7585f73b50>]}
[0m22:34:53.563853 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7585f720d0>]}
[0m22:34:53.564782 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.26s]
[0m22:34:53.565586 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75853ebcd0>]}
[0m22:34:53.566332 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m22:34:53.567811 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:34:53.567161 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.26s]
[0m22:34:53.568639 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m22:34:53.569442 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:34:53.571213 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:34:53.571857 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:34:53.572564 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:34:53.573576 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:34:53.574314 [info ] [Thread-1 (]: 5 of 8 START sql table model public.stg_housing_prices ......................... [RUN]
[0m22:34:53.575214 [info ] [Thread-4 (]: 6 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:34:53.576132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m22:34:53.576876 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.region_type_composition)
[0m22:34:53.577393 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:34:53.577882 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:34:53.581719 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:53.585883 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:34:53.586995 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:34:53.597750 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:34:53.607184 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:34:53.619306 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:53.619879 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:34:53.620538 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:34:53.620882 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:34:53.621472 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:53.621829 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:34:53.622149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:53.627947 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m22:34:53.628489 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:34:53.628946 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:34:53.629768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:34:53.630214 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:53.630833 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  
    

  create  table "dwh"."public"."stg_housing_prices__dbt_tmp"
  
  
    as
  
  (
    

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
  );
  
[0m22:34:53.631552 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:34:53.635143 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:34:53.635520 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:34:53.636259 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:53.637682 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:34:53.638102 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:34:53.638431 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:34:53.641360 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:34:53.644246 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:34:53.644694 [debug] [Thread-1 (]: SQL status: SELECT 1500 in 0.013 seconds
[0m22:34:53.645381 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:34:53.652720 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:53.653221 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:34:53.653678 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices" rename to "stg_housing_prices__dbt_backup"
[0m22:34:53.654402 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:34:53.656369 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:34:53.656793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:34:53.662591 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7586ba1790>]}
[0m22:34:53.662909 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:53.663608 [info ] [Thread-4 (]: 6 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.09s]
[0m22:34:53.664148 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:34:53.664854 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:34:53.665653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:53.667353 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:34:53.667840 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:53.668212 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:34:53.674250 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m22:34:53.677088 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:34:53.680477 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:34:53.680941 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop table if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:34:53.686367 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m22:34:53.687795 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:34:53.688394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75839d6b10>]}
[0m22:34:53.688964 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.stg_housing_prices .................... [[32mSELECT 1500[0m in 0.11s]
[0m22:34:53.689536 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:34:53.690735 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:34:53.691205 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:34:53.692189 [info ] [Thread-2 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:34:53.692973 [info ] [Thread-3 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:34:53.693653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.incremental_prices)
[0m22:34:53.694224 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:34:53.694769 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:34:53.695264 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:34:53.706851 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:34:53.710539 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:53.711578 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:34:53.727748 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:34:53.732081 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:53.748204 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:53.754312 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:34:53.754923 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:34:53.755469 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:34:53.755936 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp223453747091"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."stg_housing_prices"

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:34:53.756558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:34:53.763040 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m22:34:53.763610 [debug] [Thread-2 (]: Postgres adapter: Postgres error: aggregate functions are not allowed in WHERE
LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                                    ^

[0m22:34:53.764120 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:53.764941 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:34:53.765440 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:34:53.768325 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:34:53.772511 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:53.773550 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:34:53.775145 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:34:53.777141 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:34:53.778213 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:53.778671 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:34:53.781383 [debug] [Thread-2 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  aggregate functions are not allowed in WHERE
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                                      ^
[0m22:34:53.782016 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7586e1d490>]}
[0m22:34:53.782968 [error] [Thread-2 (]: 7 of 8 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.09s]
[0m22:34:53.783840 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:34:53.784618 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m22:34:53.785532 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  aggregate functions are not allowed in WHERE
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                                      ^.
[0m22:34:53.789878 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:34:53.791997 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:34:53.792399 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:34:53.793251 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:34:53.794939 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:34:53.795871 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f619a7ce-cb20-481c-95c1-79bea2850df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7586818c50>]}
[0m22:34:53.796744 [info ] [Thread-3 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.10s]
[0m22:34:53.797387 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:34:53.799253 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:53.799551 [debug] [MainThread]: On master: BEGIN
[0m22:34:53.799828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:34:53.807640 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:34:53.808074 [debug] [MainThread]: On master: COMMIT
[0m22:34:53.808410 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:53.808799 [debug] [MainThread]: On master: COMMIT
[0m22:34:53.809428 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:53.809718 [debug] [MainThread]: On master: Close
[0m22:34:53.810145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:53.810401 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:34:53.810624 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:34:53.810843 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:34:53.811061 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:34:53.811427 [info ] [MainThread]: 
[0m22:34:53.811794 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 6 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m22:34:53.814420 [debug] [MainThread]: Command end result
[0m22:34:53.851443 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:34:53.853124 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:34:53.859323 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:34:53.859667 [info ] [MainThread]: 
[0m22:34:53.860010 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:34:53.860310 [info ] [MainThread]: 
[0m22:34:53.860731 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  aggregate functions are not allowed in WHERE
  LINE 17: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                                      ^
[0m22:34:53.861348 [info ] [MainThread]: 
[0m22:34:53.862059 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m22:34:53.863043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3409082, "process_in_blocks": "0", "process_kernel_time": 0.219453, "process_mem_max_rss": "121472", "process_out_blocks": "2408", "process_user_time": 2.473843}
[0m22:34:53.863532 [debug] [MainThread]: Command `dbt run` failed at 22:34:53.863415 after 1.34 seconds
[0m22:34:53.863886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75869274d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758aa69150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7587501590>]}
[0m22:34:53.864247 [debug] [MainThread]: Flushing usage events
[0m22:34:54.552241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:37:06.304945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbd132410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbd125f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbd132290>]}


============================== 22:37:06.307545 | d71be001-308c-4813-99d2-3a39ef1e8767 ==============================
[0m22:37:06.307545 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:37:06.308355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:37:06.460782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbd16bcd0>]}
[0m22:37:06.517615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbfb69410>]}
[0m22:37:06.518321 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:37:06.601450 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:37:06.729465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:37:06.730152 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/incremental_prices.sql
[0m22:37:07.019999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbb5dac50>]}
[0m22:37:07.118402 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:37:07.120862 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:37:07.133194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbc561510>]}
[0m22:37:07.133693 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:37:07.134035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbbda2750>]}
[0m22:37:07.136633 [info ] [MainThread]: 
[0m22:37:07.137122 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:37:07.137453 [info ] [MainThread]: 
[0m22:37:07.138369 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:37:07.144004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:37:07.182077 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:37:07.182457 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:37:07.182719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:07.190132 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m22:37:07.191427 [debug] [ThreadPool]: On list_dwh: Close
[0m22:37:07.193213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:37:07.200196 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:37:07.200586 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:37:07.200830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:37:07.207629 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:37:07.207997 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:37:07.208388 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:37:07.210935 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:37:07.212397 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:37:07.212874 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:37:07.262492 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:07.262835 [debug] [MainThread]: On master: BEGIN
[0m22:37:07.263071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:37:07.269529 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:37:07.269929 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:07.270536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:37:07.276743 [debug] [MainThread]: SQL status: SELECT 13 in 0.006 seconds
[0m22:37:07.280548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbb5b42d0>]}
[0m22:37:07.281005 [debug] [MainThread]: On master: ROLLBACK
[0m22:37:07.281479 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:07.281728 [debug] [MainThread]: On master: BEGIN
[0m22:37:07.282330 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:37:07.282680 [debug] [MainThread]: On master: COMMIT
[0m22:37:07.282973 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:07.283253 [debug] [MainThread]: On master: COMMIT
[0m22:37:07.283660 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:07.283918 [debug] [MainThread]: On master: Close
[0m22:37:07.287392 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:37:07.287875 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:37:07.288376 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:37:07.288894 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:37:07.289750 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:37:07.289405 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:37:07.290436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:37:07.291089 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:37:07.291923 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:37:07.292744 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:37:07.293234 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:37:07.293832 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:37:07.294436 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:37:07.294903 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:37:07.304118 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:37:07.304690 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:37:07.305155 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:37:07.307572 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:37:07.310115 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:37:07.310632 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:37:07.313938 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:37:07.314800 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:37:07.359945 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:37:07.361961 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:37:07.362909 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:37:07.363362 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:37:07.367816 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:37:07.368219 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:37:07.368852 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:37:07.369246 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:37:07.374513 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:37:07.374992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:07.375518 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:37:07.375938 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:37:07.376819 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:37:07.377238 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:37:07.377662 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:37:07.378067 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:37:07.378443 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:37:07.379201 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:37:07.382974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:37:07.383519 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:37:07.384009 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:37:07.385618 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m22:37:07.386174 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:37:07.386776 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:37:07.387324 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m22:37:07.393233 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m22:37:07.395888 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:37:07.396382 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:37:07.396869 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:37:07.397284 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:37:07.397702 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:37:07.398246 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:37:07.398709 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:37:07.399348 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:37:07.403071 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:37:07.403570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:37:07.403921 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:37:07.404376 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:37:07.404802 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:37:07.407926 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:37:07.411230 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:37:07.415149 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:37:07.415673 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:37:07.416087 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:37:07.416561 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:37:07.417011 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:37:07.420381 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:37:07.421186 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:37:07.421749 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:37:07.425076 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:37:07.425681 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:37:07.426180 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:37:07.426584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:37:07.426984 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:37:07.430203 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:37:07.460286 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:37:07.460938 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:37:07.463821 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:37:07.464284 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:37:07.464688 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:37:07.465216 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:37:07.466669 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:37:07.467072 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:37:07.467485 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:37:07.467891 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:37:07.468325 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:37:07.469676 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:37:07.470280 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:37:07.470716 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:37:07.471213 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:37:07.472770 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:37:07.479421 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:37:07.479996 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m22:37:07.480368 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m22:37:07.487895 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:37:07.488341 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m22:37:07.491122 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:37:07.493863 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:37:07.494304 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:37:07.496914 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:37:07.497608 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:37:07.498304 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:37:07.499083 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:37:07.499487 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:37:07.499969 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:37:07.500444 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:37:07.501725 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:37:07.504152 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:37:07.504672 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:37:07.506092 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:37:07.508345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfba22f010>]}
[0m22:37:07.508941 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfba128c90>]}
[0m22:37:07.509690 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.22s]
[0m22:37:07.510229 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m22:37:07.511029 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.22s]
[0m22:37:07.511587 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.011 seconds
[0m22:37:07.512427 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:37:07.514596 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:37:07.515616 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:37:07.517646 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:37:07.518705 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:37:07.519783 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfba334610>]}
[0m22:37:07.521664 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfba25ad50>]}
[0m22:37:07.520842 [info ] [Thread-1 (]: 5 of 8 START sql table model public.stg_housing_prices ......................... [RUN]
[0m22:37:07.523004 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.23s]
[0m22:37:07.524233 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.23s]
[0m22:37:07.525268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m22:37:07.526141 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:37:07.526797 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:37:07.527306 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:37:07.532245 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:07.532939 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:37:07.533856 [info ] [Thread-3 (]: 6 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:37:07.534691 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m22:37:07.535449 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:37:07.539433 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:37:07.540473 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:37:07.551542 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:37:07.561518 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:37:07.567400 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:37:07.567836 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:37:07.568181 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:37:07.574378 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:07.575181 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:07.575631 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m22:37:07.576219 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:37:07.577111 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:37:07.577625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:07.578126 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:37:07.580521 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:37:07.584185 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:37:07.584578 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:37:07.585424 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:37:07.587504 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:37:07.587939 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:37:07.588340 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:37:07.589072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:37:07.589453 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:07.589808 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  
    

  create  table "dwh"."public"."stg_housing_prices__dbt_tmp"
  
  
    as
  
  (
    

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
  );
  
[0m22:37:07.591384 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:37:07.594097 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:37:07.594711 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:37:07.595081 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:37:07.595672 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:37:07.597059 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:37:07.597662 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbd872a10>]}
[0m22:37:07.598284 [info ] [Thread-3 (]: 6 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.06s]
[0m22:37:07.598853 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:37:07.602275 [debug] [Thread-1 (]: SQL status: SELECT 1500 in 0.012 seconds
[0m22:37:07.609674 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:07.610113 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices" rename to "stg_housing_prices__dbt_backup"
[0m22:37:07.610869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:37:07.616286 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:07.616730 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:37:07.617433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:37:07.618878 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:37:07.619317 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:07.619671 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:37:07.622837 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:37:07.625712 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:37:07.628711 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:07.629073 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop table if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:37:07.632887 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:37:07.634256 [debug] [Thread-1 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:37:07.634821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbc593290>]}
[0m22:37:07.635405 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.stg_housing_prices .................... [[32mSELECT 1500[0m in 0.11s]
[0m22:37:07.635959 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:37:07.637242 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:37:07.637821 [info ] [Thread-4 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:37:07.638326 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m22:37:07.638740 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:37:07.644354 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:37:07.645921 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:37:07.646562 [info ] [Thread-2 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:37:07.647408 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:37:07.647938 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:37:07.651801 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:07.652268 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:37:07.668520 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:37:07.677778 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:07.693011 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:07.693479 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp223707686718"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."stg_housing_prices"

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m22:37:07.693849 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:37:07.694759 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:07.695133 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:37:07.695464 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:37:07.701800 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m22:37:07.702303 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:07.702797 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:37:07.704732 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:37:07.708054 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:07.708440 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:37:07.708905 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.015 seconds
[0m22:37:07.723303 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:07.723833 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m22:37:07.724235 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m22:37:07.725635 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:37:07.726144 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:07.726501 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:37:07.726896 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m22:37:07.727440 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:07.727833 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp223707686718'
        
      order by ordinal_position

  
[0m22:37:07.730552 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:37:07.734030 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:37:07.734744 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:07.735132 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:37:07.735773 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:37:07.737120 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:37:07.737687 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfba3e32d0>]}
[0m22:37:07.738311 [info ] [Thread-2 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.09s]
[0m22:37:07.738941 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:37:07.739517 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.011 seconds
[0m22:37:07.745953 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:07.746480 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:37:07.749559 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.003 seconds
[0m22:37:07.760589 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:07.761047 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:37:07.763504 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:37:07.780183 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m22:37:07.780846 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:07.781231 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      
        
        
        delete from "dwh"."public"."incremental_prices" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "incremental_prices__dbt_tmp223707686718" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price")
    (
        select "id", "date", "region", "price"
        from "incremental_prices__dbt_tmp223707686718"
    )
  
[0m22:37:07.782743 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:37:07.784070 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:37:07.784421 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:07.784733 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:37:07.787692 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:37:07.788435 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:37:07.788984 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71be001-308c-4813-99d2-3a39ef1e8767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfba214350>]}
[0m22:37:07.789596 [info ] [Thread-4 (]: 7 of 8 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 0[0m in 0.15s]
[0m22:37:07.790157 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:37:07.792218 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:07.792556 [debug] [MainThread]: On master: BEGIN
[0m22:37:07.792805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:37:07.799561 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:37:07.799931 [debug] [MainThread]: On master: COMMIT
[0m22:37:07.800274 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:07.800719 [debug] [MainThread]: On master: COMMIT
[0m22:37:07.801447 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:07.801891 [debug] [MainThread]: On master: Close
[0m22:37:07.802407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:07.802677 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:37:07.802913 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:37:07.803169 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:37:07.803393 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:37:07.803757 [info ] [MainThread]: 
[0m22:37:07.804096 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 6 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m22:37:07.806020 [debug] [MainThread]: Command end result
[0m22:37:07.838750 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:37:07.840335 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:37:07.846505 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:37:07.846840 [info ] [MainThread]: 
[0m22:37:07.847209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:37:07.847505 [info ] [MainThread]: 
[0m22:37:07.847862 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m22:37:07.848961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5941339, "process_in_blocks": "0", "process_kernel_time": 0.192195, "process_mem_max_rss": "125668", "process_out_blocks": "3416", "process_user_time": 2.670509}
[0m22:37:07.849456 [debug] [MainThread]: Command `dbt run` succeeded at 22:37:07.849354 after 1.59 seconds
[0m22:37:07.849795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbc9bc110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfba2a02d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc14a8d90>]}
[0m22:37:07.850152 [debug] [MainThread]: Flushing usage events
[0m22:37:08.645902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:37:50.983132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80491baa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804939f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8049293ad0>]}


============================== 22:37:50.986056 | feef1310-8751-4822-8c19-1ab77d80f07b ==============================
[0m22:37:50.986056 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:37:50.986602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:37:51.137106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80491daa50>]}
[0m22:37:51.194404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804bba3550>]}
[0m22:37:51.195138 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:37:51.271671 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:37:51.395264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:37:51.395635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:37:51.445083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80485972d0>]}
[0m22:37:51.541696 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:37:51.544323 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:37:51.556337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80481f3b90>]}
[0m22:37:51.556826 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:37:51.557137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8048581710>]}
[0m22:37:51.560421 [info ] [MainThread]: 
[0m22:37:51.561129 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:37:51.561652 [info ] [MainThread]: 
[0m22:37:51.562702 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:37:51.569220 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:37:51.612781 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:37:51.613138 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:37:51.613419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:51.622777 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.009 seconds
[0m22:37:51.624068 [debug] [ThreadPool]: On list_dwh: Close
[0m22:37:51.625941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:37:51.632420 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:37:51.632715 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:37:51.632954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:37:51.639438 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:37:51.639966 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:37:51.640633 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:37:51.643408 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:37:51.644939 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:37:51.645453 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:37:51.652499 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:51.652877 [debug] [MainThread]: On master: BEGIN
[0m22:37:51.653109 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:37:51.659751 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:37:51.660107 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:51.660563 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:37:51.666983 [debug] [MainThread]: SQL status: SELECT 13 in 0.006 seconds
[0m22:37:51.670764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80481ac310>]}
[0m22:37:51.671199 [debug] [MainThread]: On master: ROLLBACK
[0m22:37:51.671686 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:51.671947 [debug] [MainThread]: On master: BEGIN
[0m22:37:51.672528 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:37:51.672808 [debug] [MainThread]: On master: COMMIT
[0m22:37:51.673063 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:51.673336 [debug] [MainThread]: On master: COMMIT
[0m22:37:51.673808 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:51.674078 [debug] [MainThread]: On master: Close
[0m22:37:51.677409 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:37:51.677981 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m22:37:51.678471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:37:51.678828 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:37:51.684466 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:37:51.689078 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:37:51.689584 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:37:51.690087 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m22:37:51.690639 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:37:51.691314 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m22:37:51.692175 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:37:51.692568 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:37:51.693101 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m22:37:51.693779 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:37:51.694439 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:37:51.710619 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:37:51.731176 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:37:51.736919 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:37:51.739217 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:37:51.739663 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:37:51.741826 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:37:51.742682 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:37:51.745735 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:37:51.746174 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:37:51.750421 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:37:51.751045 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:37:51.751477 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:37:51.751894 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:37:51.757011 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:37:51.757536 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:37:51.761234 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:37:51.761664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:51.762263 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:37:51.762749 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:37:51.763604 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:37:51.764020 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:37:51.764437 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:37:51.765031 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:37:51.765512 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:37:51.765923 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:37:51.771124 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m22:37:51.771955 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:37:51.772772 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:37:51.773338 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m22:37:51.773816 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:37:51.774379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m22:37:51.775011 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:37:51.775772 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:37:51.776147 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:37:51.776570 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:37:51.777003 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:37:51.777492 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:37:51.783358 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:37:51.785672 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:37:51.786392 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:37:51.787070 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:37:51.787558 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:37:51.787956 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:37:51.788340 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:37:51.791770 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:37:51.795742 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:37:51.799489 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:37:51.803448 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:37:51.803947 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:37:51.804410 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:37:51.804878 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:37:51.805323 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:37:51.806109 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:37:51.811825 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:37:51.812373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m22:37:51.815505 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:37:51.815923 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m22:37:51.824290 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:37:51.831889 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:37:51.832939 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:37:51.836178 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:37:51.836623 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:37:51.837159 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:37:51.837608 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:37:51.838043 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:37:51.838556 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:37:51.840060 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:37:51.840453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:37:51.840830 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:37:51.841339 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:37:51.842696 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:37:51.844023 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:37:51.844527 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:37:51.844921 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m22:37:51.845379 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:37:51.845806 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:37:51.854375 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:37:51.854801 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:37:51.855190 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m22:37:51.855583 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:37:51.901782 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:37:51.904638 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:37:51.905035 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m22:37:51.905572 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:37:51.906278 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:37:51.909043 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:37:51.909472 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m22:37:51.909966 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:37:51.910662 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:37:51.913277 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:37:51.913720 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:37:51.914297 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:37:51.915059 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:37:51.917431 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:37:51.918049 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:37:51.918489 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:37:51.921143 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:37:51.921519 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804b02ed90>]}
[0m22:37:51.922167 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:37:51.922856 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.23s]
[0m22:37:51.923550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804424b090>]}
[0m22:37:51.925843 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:37:51.926360 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:37:51.927153 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:37:51.927959 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.21s]
[0m22:37:51.930674 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:37:51.931447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80489d4d90>]}
[0m22:37:51.932504 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:37:51.934917 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8049fdc490>]}
[0m22:37:51.936416 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:37:51.933883 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.25s]
[0m22:37:51.937763 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.24s]
[0m22:37:51.938617 [info ] [Thread-2 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m22:37:51.939766 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:37:51.940719 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:37:51.941384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition)
[0m22:37:51.942925 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:37:51.943501 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:37:51.944117 [info ] [Thread-3 (]: 6 of 8 START sql table model public.stg_housing_prices ......................... [RUN]
[0m22:37:51.949258 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:37:51.949957 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.stg_housing_prices)
[0m22:37:51.950501 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:37:51.954125 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:51.955287 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:37:51.959659 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:37:51.960309 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_housing_prices
[0m22:37:51.961181 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:37:51.977223 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:37:51.977630 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:37:51.988481 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:51.989257 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:51.989792 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: BEGIN
[0m22:37:51.990344 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:37:51.991083 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m22:37:51.992002 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:37:51.992500 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:37:51.994583 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:37:51.997945 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:37:51.998343 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:37:51.999092 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:37:52.000709 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:37:52.001083 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m22:37:52.001482 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:37:52.001995 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:52.002427 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:37:52.002874 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */

  
    

  create  table "dwh"."public"."stg_housing_prices__dbt_tmp"
  
  
    as
  
  (
    

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
  );
  
[0m22:37:52.006263 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:37:52.009083 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:37:52.009750 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:37:52.010101 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:37:52.010705 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:37:52.011970 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:37:52.012523 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804427d510>]}
[0m22:37:52.013086 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.07s]
[0m22:37:52.013668 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:37:52.014093 [debug] [Thread-3 (]: SQL status: SELECT 1500 in 0.011 seconds
[0m22:37:52.023510 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:52.023983 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices" rename to "stg_housing_prices__dbt_backup"
[0m22:37:52.024746 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:37:52.028263 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:52.028915 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
alter table "dwh"."public"."stg_housing_prices__dbt_tmp" rename to "stg_housing_prices"
[0m22:37:52.029681 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:37:52.031342 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:37:52.031682 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:52.032015 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: COMMIT
[0m22:37:52.035406 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:37:52.038308 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_housing_prices__dbt_backup"
[0m22:37:52.041345 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_housing_prices"
[0m22:37:52.041809 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_housing_prices"} */
drop table if exists "dwh"."public"."stg_housing_prices__dbt_backup" cascade
[0m22:37:52.045855 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m22:37:52.047235 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_housing_prices: Close
[0m22:37:52.047842 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8046344e90>]}
[0m22:37:52.048411 [info ] [Thread-3 (]: 6 of 8 OK created sql table model public.stg_housing_prices .................... [[32mSELECT 1500[0m in 0.10s]
[0m22:37:52.049141 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:37:52.050247 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:37:52.050672 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:37:52.051196 [info ] [Thread-4 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:37:52.052012 [info ] [Thread-1 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:37:52.052757 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m22:37:52.053442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:37:52.054038 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:37:52.054459 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:37:52.068577 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:52.069152 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:37:52.070035 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:37:52.070610 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:37:52.074882 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:52.101508 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:52.101957 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:37:52.102306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:52.112264 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:52.112830 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp223752105820"
  
  
    as
  
  (
    
SELECT *
FROM "dwh"."public"."stg_housing_prices"

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m22:37:52.113234 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:37:52.113692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:37:52.114435 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:52.114882 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM "dwh"."public"."stg_housing_prices"
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:37:52.117219 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:37:52.120721 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:52.121238 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:37:52.122000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:37:52.123441 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:37:52.123787 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:52.124205 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:37:52.125136 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.012 seconds
[0m22:37:52.132394 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m22:37:52.135116 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:37:52.135829 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:37:52.136288 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:37:52.143863 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:52.144399 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m22:37:52.144850 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:37:52.146417 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:37:52.146790 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m22:37:52.147268 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:52.147695 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp223752105820'
        
      order by ordinal_position

  
[0m22:37:52.148303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8048938c50>]}
[0m22:37:52.149157 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.09s]
[0m22:37:52.149740 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:37:52.154060 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.005 seconds
[0m22:37:52.161885 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:52.162364 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:37:52.165199 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:37:52.173884 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:52.174335 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:37:52.176948 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:37:52.193806 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m22:37:52.194419 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:52.194858 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      
        
        
        delete from "dwh"."public"."incremental_prices" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "incremental_prices__dbt_tmp223752105820" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price")
    (
        select "id", "date", "region", "price"
        from "incremental_prices__dbt_tmp223752105820"
    )
  
[0m22:37:52.195810 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:37:52.197159 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:37:52.197500 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:37:52.197865 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:37:52.200708 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:37:52.201439 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:37:52.201978 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feef1310-8751-4822-8c19-1ab77d80f07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8048972cd0>]}
[0m22:37:52.202564 [info ] [Thread-4 (]: 7 of 8 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 0[0m in 0.15s]
[0m22:37:52.203131 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:37:52.205078 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:52.205461 [debug] [MainThread]: On master: BEGIN
[0m22:37:52.205734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:37:52.212735 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:37:52.213104 [debug] [MainThread]: On master: COMMIT
[0m22:37:52.213506 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:52.213839 [debug] [MainThread]: On master: COMMIT
[0m22:37:52.214232 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:37:52.214540 [debug] [MainThread]: On master: Close
[0m22:37:52.214961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:52.215227 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:37:52.215472 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:37:52.215700 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:37:52.215953 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:37:52.216330 [info ] [MainThread]: 
[0m22:37:52.216709 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 6 view models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m22:37:52.219072 [debug] [MainThread]: Command end result
[0m22:37:52.252576 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:37:52.254152 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:37:52.260232 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:37:52.260525 [info ] [MainThread]: 
[0m22:37:52.260874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:37:52.261175 [info ] [MainThread]: 
[0m22:37:52.261572 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m22:37:52.262710 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3320245, "process_in_blocks": "0", "process_kernel_time": 0.219201, "process_mem_max_rss": "123300", "process_out_blocks": "2432", "process_user_time": 2.421179}
[0m22:37:52.263204 [debug] [MainThread]: Command `dbt run` succeeded at 22:37:52.263064 after 1.33 seconds
[0m22:37:52.263542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804d4e0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804d4e0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804d4e0350>]}
[0m22:37:52.263951 [debug] [MainThread]: Flushing usage events
[0m22:37:53.001589 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:40:24.460650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2152a01e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2152a4fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21529f6cd0>]}


============================== 22:40:24.464773 | 19a01ec5-6139-4438-bf2c-6e787a524304 ==============================
[0m22:40:24.464773 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:40:24.465796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:40:24.622272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19a01ec5-6139-4438-bf2c-6e787a524304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2152a4e750>]}
[0m22:40:24.678215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19a01ec5-6139-4438-bf2c-6e787a524304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2155419910>]}
[0m22:40:24.678917 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:40:24.757407 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:40:24.880782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:40:24.881478 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/stg_housing_prices.sql
[0m22:40:25.329712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19a01ec5-6139-4438-bf2c-6e787a524304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2150935e90>]}
[0m22:40:25.432135 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:40:25.434729 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:40:25.449612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19a01ec5-6139-4438-bf2c-6e787a524304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214edabf50>]}
[0m22:40:25.450310 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:40:25.450827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a01ec5-6139-4438-bf2c-6e787a524304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21509538d0>]}
[0m22:40:25.455606 [info ] [MainThread]: 
[0m22:40:25.456386 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:40:25.456925 [info ] [MainThread]: 
[0m22:40:25.458026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:40:25.465768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:40:25.560541 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:40:25.560919 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:40:25.561186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:25.568693 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.007 seconds
[0m22:40:25.569986 [debug] [ThreadPool]: On list_dwh: Close
[0m22:40:25.571792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:40:25.578377 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:40:25.578739 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:40:25.578979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:40:25.585600 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:40:25.585983 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:40:25.586315 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:40:25.589412 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m22:40:25.590870 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:40:25.591330 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:40:25.598499 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:25.598835 [debug] [MainThread]: On master: BEGIN
[0m22:40:25.599068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:25.605926 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:40:25.606669 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:25.607597 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:40:25.614198 [debug] [MainThread]: SQL status: SELECT 13 in 0.006 seconds
[0m22:40:25.618121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a01ec5-6139-4438-bf2c-6e787a524304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214ed30e50>]}
[0m22:40:25.618817 [debug] [MainThread]: On master: ROLLBACK
[0m22:40:25.619578 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:25.620002 [debug] [MainThread]: On master: BEGIN
[0m22:40:25.620854 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:40:25.621290 [debug] [MainThread]: On master: COMMIT
[0m22:40:25.621664 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:25.622030 [debug] [MainThread]: On master: COMMIT
[0m22:40:25.622642 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:40:25.622942 [debug] [MainThread]: On master: Close
[0m22:40:25.626171 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:40:25.626648 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:40:25.627216 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m22:40:25.627837 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m22:40:25.628410 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:40:25.628981 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:40:25.629684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:40:25.630487 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:40:25.631347 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m22:40:25.632278 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m22:40:25.633109 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:40:25.633682 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:40:25.634358 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:40:25.634936 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:40:25.644531 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:40:25.647030 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:40:25.647563 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:40:25.647995 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:40:25.651845 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:40:25.652299 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:40:25.656048 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:40:25.656593 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:40:25.668070 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:40:25.689704 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:40:25.720330 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:40:25.724623 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:40:25.727726 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:40:25.731703 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:40:25.732661 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:40:25.733864 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:40:25.734469 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:40:25.735046 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:40:25.735491 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:40:25.735905 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:40:25.736315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:25.736715 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:40:25.737130 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:40:25.737534 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:40:25.738156 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:40:25.738555 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:40:25.744341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:40:25.745092 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:40:25.745957 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:40:25.747083 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:40:25.747783 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:40:25.748559 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:40:25.749481 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:40:25.750288 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m22:40:25.756247 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m22:40:25.759107 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:40:25.759748 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:40:25.760186 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:40:25.760666 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:40:25.761164 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:40:25.761599 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:40:25.762053 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:40:25.766056 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:40:25.766731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:40:25.767167 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:40:25.770690 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:40:25.771337 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:40:25.771808 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:40:25.772152 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:40:25.772597 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:40:25.776161 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:40:25.780225 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:40:25.783730 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:40:25.784328 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:40:25.784811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:40:25.785345 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:40:25.786034 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:40:25.792262 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:40:25.808795 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:40:25.809277 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:40:25.813067 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:40:25.813551 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:40:25.813954 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:40:25.817139 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:40:25.817671 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:40:25.819529 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:40:25.820016 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:40:25.820475 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:40:25.821028 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:40:25.821549 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:40:25.822014 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:40:25.823526 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:40:25.823916 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:40:25.824434 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:40:25.825791 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:40:25.826207 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:40:25.826632 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:40:25.827013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m22:40:25.827541 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:40:25.833186 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m22:40:25.835118 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:40:25.835507 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m22:40:25.838482 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:40:25.846778 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:40:25.847181 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m22:40:25.847633 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:40:25.848307 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:40:25.849034 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:40:25.851909 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:40:25.852359 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:40:25.852817 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:40:25.853268 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:40:25.853977 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:40:25.854691 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:40:25.858245 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:40:25.860712 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:40:25.862285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a01ec5-6139-4438-bf2c-6e787a524304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214e3015d0>]}
[0m22:40:25.862938 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.23s]
[0m22:40:25.863583 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:40:25.864120 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.009 seconds
[0m22:40:25.864856 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.010 seconds
[0m22:40:25.865271 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.011 seconds
[0m22:40:25.866909 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:40:25.867902 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:40:25.870439 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:40:25.871942 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:40:25.872559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m22:40:25.873141 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a01ec5-6139-4438-bf2c-6e787a524304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214e377d10>]}
[0m22:40:25.874102 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:40:25.874888 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a01ec5-6139-4438-bf2c-6e787a524304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214e3a2f50>]}
[0m22:40:25.875545 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a01ec5-6139-4438-bf2c-6e787a524304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214e2a7e90>]}
[0m22:40:25.876322 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.24s]
[0m22:40:25.880716 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:40:25.881635 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.24s]
[0m22:40:25.882535 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.25s]
[0m22:40:25.883315 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:40:25.884219 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:40:25.884976 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:40:25.886087 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:40:25.888036 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:40:25.888668 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:40:25.889312 [info ] [Thread-3 (]: 5 of 7 START sql view model public.region_type_composition ..................... [RUN]
[0m22:40:25.890026 [info ] [Thread-2 (]: 6 of 7 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:40:25.890684 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m22:40:25.891243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.incremental_prices)
[0m22:40:25.891881 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:40:25.892608 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:40:25.896245 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:40:25.909000 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:40:25.909868 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:40:25.914176 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:40:25.914612 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:40:25.925653 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:40:25.931335 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:40:25.931748 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:40:25.949158 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m22:40:25.960145 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:40:25.965846 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:40:25.967821 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:25.968453 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp224025948784"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (


WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m22:40:25.968840 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:40:25.969929 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:40:25.973312 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:40:25.973699 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:40:25.974494 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:40:25.975804 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:40:25.976289 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:40:25.976645 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:40:25.980458 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:40:25.983380 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:40:25.983836 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.015 seconds
[0m22:40:25.984521 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:40:25.999113 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:25.999673 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:40:26.000124 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m22:40:26.000843 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:40:26.001258 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m22:40:26.002756 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:40:26.003206 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:26.003779 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp224025948784'
        
      order by ordinal_position

  
[0m22:40:26.004434 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a01ec5-6139-4438-bf2c-6e787a524304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214e2d4150>]}
[0m22:40:26.005040 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.11s]
[0m22:40:26.005605 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:40:26.006465 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:40:26.007380 [info ] [Thread-4 (]: 7 of 7 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:40:26.008263 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:40:26.008994 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:40:26.018483 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:26.019143 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.015 seconds
[0m22:40:26.025459 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:26.026164 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:40:26.026696 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:40:26.031165 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:26.032021 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.005 seconds
[0m22:40:26.040990 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:26.041629 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:40:26.042200 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:26.042542 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:40:26.043025 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:40:26.044208 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:40:26.060144 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m22:40:26.062695 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m22:40:26.063127 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:26.063852 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (


WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:40:26.064459 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:26.064851 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      
        
        
        delete from "dwh"."public"."incremental_prices" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "incremental_prices__dbt_tmp224025948784" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price")
    (
        select "id", "date", "region", "price"
        from "incremental_prices__dbt_tmp224025948784"
    )
  
[0m22:40:26.065731 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m22:40:26.067044 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:40:26.067485 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:26.067955 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:40:26.068536 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:40:26.073701 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:26.074279 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:40:26.075182 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:40:26.076493 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:40:26.076901 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:26.077234 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:40:26.078243 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m22:40:26.079034 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:40:26.079593 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a01ec5-6139-4438-bf2c-6e787a524304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214e29bfd0>]}
[0m22:40:26.080211 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 0[0m in 0.19s]
[0m22:40:26.080786 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:40:26.082057 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m22:40:26.085209 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:40:26.086617 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:26.087070 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:40:26.087821 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:40:26.089666 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:40:26.090371 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a01ec5-6139-4438-bf2c-6e787a524304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214e2e2f50>]}
[0m22:40:26.091047 [info ] [Thread-4 (]: 7 of 7 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.08s]
[0m22:40:26.091728 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:40:26.093833 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:26.094196 [debug] [MainThread]: On master: BEGIN
[0m22:40:26.094476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:26.101728 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:40:26.102190 [debug] [MainThread]: On master: COMMIT
[0m22:40:26.102529 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:26.102783 [debug] [MainThread]: On master: COMMIT
[0m22:40:26.103206 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:40:26.103602 [debug] [MainThread]: On master: Close
[0m22:40:26.104343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:26.104800 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m22:40:26.105046 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:40:26.105269 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:40:26.105538 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:40:26.105967 [info ] [MainThread]: 
[0m22:40:26.106312 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m22:40:26.108206 [debug] [MainThread]: Command end result
[0m22:40:26.142941 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:40:26.144462 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:40:26.150331 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:40:26.150617 [info ] [MainThread]: 
[0m22:40:26.150963 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:40:26.151262 [info ] [MainThread]: 
[0m22:40:26.151647 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m22:40:26.152837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7462803, "process_in_blocks": "0", "process_kernel_time": 0.181466, "process_mem_max_rss": "129116", "process_out_blocks": "3392", "process_user_time": 2.863145}
[0m22:40:26.153366 [debug] [MainThread]: Command `dbt run` succeeded at 22:40:26.153241 after 1.75 seconds
[0m22:40:26.153699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2152c374d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2152c37550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2156d58410>]}
[0m22:40:26.154074 [debug] [MainThread]: Flushing usage events
[0m22:40:26.931143 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:40:29.280177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d2bd53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d2bd4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d2bd6710>]}


============================== 22:40:29.282898 | c99877ea-b103-4e6a-9c27-8809a66de871 ==============================
[0m22:40:29.282898 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:40:29.283429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:40:29.433796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c99877ea-b103-4e6a-9c27-8809a66de871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d2781010>]}
[0m22:40:29.490533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c99877ea-b103-4e6a-9c27-8809a66de871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d56236d0>]}
[0m22:40:29.491289 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:40:29.569471 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:40:29.692834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:40:29.693229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:40:29.744154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c99877ea-b103-4e6a-9c27-8809a66de871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d1b9c690>]}
[0m22:40:29.841677 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:40:29.844127 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:40:29.856066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c99877ea-b103-4e6a-9c27-8809a66de871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d2332c10>]}
[0m22:40:29.856564 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:40:29.856880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99877ea-b103-4e6a-9c27-8809a66de871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d1bd76d0>]}
[0m22:40:29.859541 [info ] [MainThread]: 
[0m22:40:29.860168 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:40:29.860655 [info ] [MainThread]: 
[0m22:40:29.861555 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:40:29.868418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:40:29.909867 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:40:29.910247 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:40:29.910509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:29.918024 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.007 seconds
[0m22:40:29.919266 [debug] [ThreadPool]: On list_dwh: Close
[0m22:40:29.921001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:40:29.927509 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:40:29.927797 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:40:29.928029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:40:29.934496 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:40:29.934829 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:40:29.935135 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:40:29.937625 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:40:29.939009 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:40:29.939468 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:40:29.946200 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:29.946531 [debug] [MainThread]: On master: BEGIN
[0m22:40:29.946774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:29.953439 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:40:29.953794 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:29.954371 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:40:29.960647 [debug] [MainThread]: SQL status: SELECT 13 in 0.006 seconds
[0m22:40:29.964418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99877ea-b103-4e6a-9c27-8809a66de871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d13bce50>]}
[0m22:40:29.964833 [debug] [MainThread]: On master: ROLLBACK
[0m22:40:29.965316 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:29.965598 [debug] [MainThread]: On master: BEGIN
[0m22:40:29.966189 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:40:29.966474 [debug] [MainThread]: On master: COMMIT
[0m22:40:29.966726 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:29.966998 [debug] [MainThread]: On master: COMMIT
[0m22:40:29.967472 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:40:29.967755 [debug] [MainThread]: On master: Close
[0m22:40:29.971109 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:40:29.971712 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:40:29.972254 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m22:40:29.972911 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m22:40:29.973726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:40:29.974289 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:40:29.974799 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:40:29.975369 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:40:29.975859 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:40:29.976449 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m22:40:29.977451 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m22:40:29.978553 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:40:29.988160 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:40:29.988851 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:40:29.989515 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:40:29.992180 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:40:29.992874 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:40:29.993369 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:40:29.993779 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:40:29.996361 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:40:29.999812 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:40:30.000323 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:40:30.032872 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:40:30.038750 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:40:30.041244 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:40:30.045218 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:40:30.050331 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:40:30.054092 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:40:30.055286 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:40:30.056024 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:40:30.056795 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:40:30.057192 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:40:30.057705 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:40:30.058106 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:40:30.058544 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:40:30.058943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:30.059344 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:40:30.059778 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:40:30.060170 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:40:30.060993 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:40:30.066959 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:40:30.067965 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:40:30.068829 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:40:30.069577 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:40:30.070115 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m22:40:30.070795 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m22:40:30.071365 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:40:30.071835 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:40:30.072275 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:40:30.072677 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:40:30.073312 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:40:30.073842 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:40:30.074344 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:40:30.074956 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:40:30.080843 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:40:30.082914 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:40:30.083302 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m22:40:30.086970 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:40:30.090292 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:40:30.090824 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:40:30.094512 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:40:30.094967 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:40:30.095411 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:40:30.095973 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:40:30.096526 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:40:30.097109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:40:30.100658 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:40:30.101077 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:40:30.101540 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:40:30.104683 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:40:30.105128 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:40:30.108528 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:40:30.111653 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:40:30.112102 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:40:30.112743 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:40:30.113205 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:40:30.113617 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:40:30.119578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:40:30.120109 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:40:30.146182 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:40:30.149294 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:40:30.149729 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:40:30.150125 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m22:40:30.151179 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:40:30.151583 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:40:30.152008 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:40:30.153459 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:40:30.153945 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:40:30.154353 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:40:30.154900 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:40:30.155310 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:40:30.155801 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:40:30.158030 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:40:30.201912 [debug] [Thread-4 (]: SQL status: COMMIT in 0.046 seconds
[0m22:40:30.206493 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:40:30.206901 [debug] [Thread-3 (]: SQL status: COMMIT in 0.051 seconds
[0m22:40:30.207275 [debug] [Thread-2 (]: SQL status: COMMIT in 0.052 seconds
[0m22:40:30.209979 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:40:30.215815 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:40:30.218515 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:40:30.221051 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:40:30.221726 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:40:30.222165 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:40:30.222834 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:40:30.223541 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:40:30.223981 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:40:30.224515 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:40:30.224953 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:40:30.228424 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:40:30.230907 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:40:30.231422 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:40:30.231936 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:40:30.234219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99877ea-b103-4e6a-9c27-8809a66de871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d2c15e10>]}
[0m22:40:30.235617 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:40:30.235997 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.011 seconds
[0m22:40:30.237206 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:40:30.237877 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.26s]
[0m22:40:30.240237 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:40:30.241019 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99877ea-b103-4e6a-9c27-8809a66de871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5cfea2690>]}
[0m22:40:30.241998 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:40:30.242650 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99877ea-b103-4e6a-9c27-8809a66de871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d2bf71d0>]}
[0m22:40:30.244762 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99877ea-b103-4e6a-9c27-8809a66de871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d2bf5c50>]}
[0m22:40:30.243831 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m22:40:30.246576 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.27s]
[0m22:40:30.247239 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:40:30.248175 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.26s]
[0m22:40:30.248947 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:40:30.249575 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:40:30.250148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m22:40:30.250865 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:40:30.251851 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:40:30.252793 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:40:30.256935 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:40:30.257615 [info ] [Thread-3 (]: 5 of 7 START sql view model public.region_type_composition ..................... [RUN]
[0m22:40:30.258705 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m22:40:30.259436 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:40:30.262752 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:40:30.263718 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:40:30.264802 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:40:30.265947 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:40:30.270839 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:40:30.265525 [info ] [Thread-4 (]: 6 of 7 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:40:30.271954 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m22:40:30.272366 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:40:30.285080 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:40:30.285668 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:40:30.286274 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:40:30.286748 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:40:30.287331 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:40:30.304632 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m22:40:30.305148 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:40:30.305569 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:40:30.314667 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m22:40:30.323181 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:40:30.328748 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:40:30.339955 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:40:30.341306 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:40:30.341678 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:40:30.342105 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:40:30.344332 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:30.344743 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp224030319954"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (


WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m22:40:30.345181 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:40:30.345701 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:40:30.348423 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:40:30.349075 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:40:30.349414 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:40:30.350012 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:40:30.351247 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:40:30.351821 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99877ea-b103-4e6a-9c27-8809a66de871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5cfe1d550>]}
[0m22:40:30.352393 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.09s]
[0m22:40:30.353087 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:40:30.353917 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:40:30.354480 [info ] [Thread-1 (]: 7 of 7 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:40:30.354997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:40:30.355414 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:40:30.364134 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.019 seconds
[0m22:40:30.363753 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:30.380003 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:30.380572 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m22:40:30.381059 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:40:30.385347 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:30.385828 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m22:40:30.386397 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:30.386801 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp224030319954'
        
      order by ordinal_position

  
[0m22:40:30.387365 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:30.387712 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:40:30.388013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:30.392354 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.005 seconds
[0m22:40:30.398196 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:30.398802 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:40:30.399247 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:40:30.399747 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:30.400208 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (


WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:40:30.402601 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.003 seconds
[0m22:40:30.403024 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:40:30.411551 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:30.414781 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:30.415269 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:40:30.415766 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:40:30.416737 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:40:30.417979 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:40:30.418325 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:40:30.418750 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:30.424453 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:40:30.432518 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m22:40:30.436566 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m22:40:30.439278 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:40:30.440205 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:40:30.440579 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:40:30.441125 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:30.441525 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      
        
        
        delete from "dwh"."public"."incremental_prices" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "incremental_prices__dbt_tmp224030319954" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price")
    (
        select "id", "date", "region", "price"
        from "incremental_prices__dbt_tmp224030319954"
    )
  
[0m22:40:30.442012 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:40:30.443260 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:40:30.443651 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m22:40:30.445135 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:40:30.445516 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:40:30.445854 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:40:30.446435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99877ea-b103-4e6a-9c27-8809a66de871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ccd18350>]}
[0m22:40:30.447016 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.09s]
[0m22:40:30.447582 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:40:30.448823 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:40:30.449610 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:40:30.450186 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99877ea-b103-4e6a-9c27-8809a66de871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d2746290>]}
[0m22:40:30.450843 [info ] [Thread-4 (]: 6 of 7 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 0[0m in 0.18s]
[0m22:40:30.451543 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:40:30.453993 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:30.454348 [debug] [MainThread]: On master: BEGIN
[0m22:40:30.454658 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:30.461524 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:40:30.461895 [debug] [MainThread]: On master: COMMIT
[0m22:40:30.462220 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:30.462663 [debug] [MainThread]: On master: COMMIT
[0m22:40:30.463381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:40:30.463733 [debug] [MainThread]: On master: Close
[0m22:40:30.464201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:30.464457 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:40:30.464691 [debug] [MainThread]: Connection 'model.airflow_dbt_training.location_data' was properly closed.
[0m22:40:30.464914 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:40:30.465154 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:40:30.465516 [info ] [MainThread]: 
[0m22:40:30.465844 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m22:40:30.467625 [debug] [MainThread]: Command end result
[0m22:40:30.503325 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:40:30.504893 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:40:30.510805 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:40:30.511081 [info ] [MainThread]: 
[0m22:40:30.511446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:40:30.511742 [info ] [MainThread]: 
[0m22:40:30.512106 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m22:40:30.513169 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.284742, "process_in_blocks": "0", "process_kernel_time": 0.11888, "process_mem_max_rss": "122900", "process_out_blocks": "2408", "process_user_time": 2.496491}
[0m22:40:30.513647 [debug] [MainThread]: Command `dbt run` succeeded at 22:40:30.513524 after 1.29 seconds
[0m22:40:30.514031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d2e0f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d2f14690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d6f60fd0>]}
[0m22:40:30.514458 [debug] [MainThread]: Flushing usage events
[0m22:40:31.139965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:42:22.203082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69738e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6976cc890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69738f110>]}


============================== 22:42:22.205686 | c8142486-55ed-49a1-8038-b8ed997bbe8b ==============================
[0m22:42:22.205686 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:42:22.206262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:42:22.352404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8142486-55ed-49a1-8038-b8ed997bbe8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6975bb150>]}
[0m22:42:22.408086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8142486-55ed-49a1-8038-b8ed997bbe8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc699dad910>]}
[0m22:42:22.408899 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:42:22.485522 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:42:22.610523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:42:22.611152 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/incremental_prices.sql
[0m22:42:22.611597 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/stg_housing_prices.sql
[0m22:42:22.795754 [error] [MainThread]: Encountered an error:
Compilation Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  expected token ',', got 'trust'
    line 4
      unique_key='id'  -- optional if you trust all rows are unique
[0m22:42:22.796979 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.64369255, "process_in_blocks": "16", "process_kernel_time": 0.139966, "process_mem_max_rss": "110532", "process_out_blocks": "16", "process_user_time": 1.769572}
[0m22:42:22.797772 [debug] [MainThread]: Command `dbt run` failed at 22:42:22.797496 after 0.64 seconds
[0m22:42:22.798183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6973e6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6975cb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69b6ed250>]}
[0m22:42:22.798629 [debug] [MainThread]: Flushing usage events
[0m22:42:23.429525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:42:39.256944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbccd76190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcda8c510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcdb53bd0>]}


============================== 22:42:39.260719 | 7a9f56e3-a33e-492c-a2ee-cc963641f13b ==============================
[0m22:42:39.260719 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:42:39.269609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:42:39.425661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a9f56e3-a33e-492c-a2ee-cc963641f13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcc53fb50>]}
[0m22:42:39.486095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a9f56e3-a33e-492c-a2ee-cc963641f13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcf7c74d0>]}
[0m22:42:39.486881 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:42:39.572963 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:42:39.697320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:42:39.697955 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/incremental_prices.sql
[0m22:42:39.698401 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/stg_housing_prices.sql
[0m22:42:40.159445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a9f56e3-a33e-492c-a2ee-cc963641f13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc9102210>]}
[0m22:42:40.253861 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:42:40.256244 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:42:40.268578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a9f56e3-a33e-492c-a2ee-cc963641f13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcb979d90>]}
[0m22:42:40.269076 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:42:40.269395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a9f56e3-a33e-492c-a2ee-cc963641f13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcb9fc7d0>]}
[0m22:42:40.272394 [info ] [MainThread]: 
[0m22:42:40.273187 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:42:40.274121 [info ] [MainThread]: 
[0m22:42:40.275431 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:42:40.281187 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:42:40.364223 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:42:40.364615 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:42:40.364882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:40.374019 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.009 seconds
[0m22:42:40.375280 [debug] [ThreadPool]: On list_dwh: Close
[0m22:42:40.376999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:42:40.383464 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:42:40.383775 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:42:40.384014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:40.390696 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:42:40.391074 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:42:40.391457 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:42:40.393944 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:42:40.395396 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:42:40.395878 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:42:40.402557 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:40.402850 [debug] [MainThread]: On master: BEGIN
[0m22:42:40.403094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:42:40.409527 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:42:40.409993 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:40.410669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:42:40.417533 [debug] [MainThread]: SQL status: SELECT 13 in 0.006 seconds
[0m22:42:40.421209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a9f56e3-a33e-492c-a2ee-cc963641f13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcad01610>]}
[0m22:42:40.421606 [debug] [MainThread]: On master: ROLLBACK
[0m22:42:40.422088 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:40.422347 [debug] [MainThread]: On master: BEGIN
[0m22:42:40.422922 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:42:40.423293 [debug] [MainThread]: On master: COMMIT
[0m22:42:40.423657 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:40.424044 [debug] [MainThread]: On master: COMMIT
[0m22:42:40.424590 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:42:40.424968 [debug] [MainThread]: On master: Close
[0m22:42:40.429040 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:42:40.429517 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:42:40.430038 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m22:42:40.430696 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:42:40.431409 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m22:42:40.432381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:42:40.433095 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:42:40.434148 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m22:42:40.435106 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:42:40.435936 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:42:40.436983 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m22:42:40.438135 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:42:40.438945 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:42:40.450209 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:42:40.449467 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:42:40.450976 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:42:40.453325 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:42:40.453753 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:42:40.456515 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:42:40.459984 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:42:40.460572 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:42:40.460937 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:42:40.461987 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:42:40.488694 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:42:40.507023 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:42:40.508784 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:42:40.512820 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:42:40.516578 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:42:40.517668 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:42:40.518265 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:42:40.518966 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:42:40.519481 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:42:40.520029 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:42:40.520449 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:42:40.520874 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:42:40.521284 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:42:40.521744 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:42:40.522151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:40.522547 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:42:40.523188 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:42:40.529695 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:42:40.530577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:42:40.531261 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:42:40.532029 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:42:40.532678 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m22:42:40.533153 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m22:42:40.533689 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:42:40.534467 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:42:40.535191 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:42:40.535628 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:42:40.536424 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:42:40.537003 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:42:40.537679 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:42:40.538075 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:42:40.543847 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:42:40.545918 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:42:40.546341 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m22:42:40.549985 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:42:40.553988 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:42:40.554471 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:42:40.557738 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:42:40.558185 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:42:40.558806 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:42:40.559366 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:42:40.559826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:42:40.563229 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:42:40.563640 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:42:40.564087 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:42:40.564483 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:42:40.564903 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:42:40.569444 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:42:40.572884 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:42:40.573456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:42:40.576712 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:42:40.577206 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:42:40.577664 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:42:40.583470 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:42:40.599773 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:42:40.600688 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:42:40.601348 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:42:40.601867 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:42:40.602299 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:42:40.602750 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:42:40.604363 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:42:40.605881 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:42:40.607689 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:42:40.608376 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:42:40.608851 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:42:40.609333 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:42:40.609796 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:42:40.610231 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:42:40.610649 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:42:40.611180 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:42:40.618835 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m22:42:40.619531 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m22:42:40.622287 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:42:40.618507 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:42:40.622908 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m22:42:40.625652 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:42:40.631382 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:42:40.632116 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:42:40.634800 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:42:40.635493 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:42:40.635920 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:42:40.636374 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:42:40.637154 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:42:40.637611 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:42:40.638251 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:42:40.641119 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:42:40.643514 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:42:40.644004 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:42:40.645998 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a9f56e3-a33e-492c-a2ee-cc963641f13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc87d12d0>]}
[0m22:42:40.647433 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:42:40.647814 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m22:42:40.648224 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.010 seconds
[0m22:42:40.648944 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.21s]
[0m22:42:40.650623 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:42:40.651196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a9f56e3-a33e-492c-a2ee-cc963641f13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcf65fa10>]}
[0m22:42:40.652808 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:42:40.653511 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:42:40.654488 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.22s]
[0m22:42:40.655334 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a9f56e3-a33e-492c-a2ee-cc963641f13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc856c110>]}
[0m22:42:40.656660 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a9f56e3-a33e-492c-a2ee-cc963641f13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc864b0d0>]}
[0m22:42:40.657854 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:42:40.658673 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m22:42:40.659464 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.21s]
[0m22:42:40.660493 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:42:40.661389 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:42:40.661842 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:42:40.663069 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.stg_housing_prices)
[0m22:42:40.663636 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:42:40.664130 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:42:40.664766 [info ] [Thread-1 (]: 5 of 7 START sql view model public.region_type_composition ..................... [RUN]
[0m22:42:40.668407 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:42:40.669011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.region_type_composition)
[0m22:42:40.669700 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:42:40.673784 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:42:40.675222 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:42:40.676487 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:42:40.677178 [info ] [Thread-4 (]: 6 of 7 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:42:40.677667 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:42:40.678149 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m22:42:40.683130 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:42:40.683689 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:42:40.694787 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:42:40.696119 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:42:40.696570 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:42:40.697170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:40.697792 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:42:40.714375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m22:42:40.720033 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:42:40.725694 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:42:40.738259 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:42:40.741751 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:42:40.747331 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:42:40.751172 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:42:40.751773 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp224240729932"
  
  
    as
  
  (
    

with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."public"."incremental_prices")

  );
  
  
[0m22:42:40.752182 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:42:40.752710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:42:40.754060 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:42:40.754439 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:42:40.754758 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:42:40.757625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:42:40.760417 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:42:40.761162 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:42:40.761544 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:42:40.762086 [debug] [Thread-4 (]: Postgres adapter: Postgres error: aggregate functions are not allowed in WHERE
LINE 35: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                                    ^

[0m22:42:40.762545 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:42:40.763294 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:42:40.765937 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:42:40.769035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a9f56e3-a33e-492c-a2ee-cc963641f13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc8541810>]}
[0m22:42:40.769811 [info ] [Thread-1 (]: 5 of 7 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.10s]
[0m22:42:40.771130 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:42:40.773726 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:42:40.775189 [info ] [Thread-3 (]: 7 of 7 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:42:40.776938 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:42:40.778567 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:42:40.793638 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:42:40.797454 [debug] [Thread-4 (]: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  aggregate functions are not allowed in WHERE
  LINE 35: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                                      ^
[0m22:42:40.798370 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a9f56e3-a33e-492c-a2ee-cc963641f13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc8569350>]}
[0m22:42:40.799783 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:42:40.799260 [error] [Thread-4 (]: 6 of 7 ERROR creating sql incremental model public.incremental_prices .......... [[31mERROR[0m in 0.12s]
[0m22:42:40.808076 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:42:40.809200 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:42:40.810593 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.incremental_prices' to be skipped because of status 'error'.  Reason: Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  aggregate functions are not allowed in WHERE
  LINE 35: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                                      ^.
[0m22:42:40.811830 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:42:40.814373 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:42:40.815371 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:42:40.823596 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m22:42:40.824208 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:42:40.824664 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:42:40.827473 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:42:40.830793 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:42:40.831299 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:42:40.832338 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:42:40.833800 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:42:40.834185 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:42:40.834515 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:42:40.837361 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:42:40.840136 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:42:40.840767 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:42:40.841135 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:42:40.841734 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:42:40.842978 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:42:40.843566 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a9f56e3-a33e-492c-a2ee-cc963641f13b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc85f7dd0>]}
[0m22:42:40.844221 [info ] [Thread-3 (]: 7 of 7 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.07s]
[0m22:42:40.844835 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:42:40.846858 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:40.847236 [debug] [MainThread]: On master: BEGIN
[0m22:42:40.847495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:42:40.854420 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:42:40.854852 [debug] [MainThread]: On master: COMMIT
[0m22:42:40.855175 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:40.855479 [debug] [MainThread]: On master: COMMIT
[0m22:42:40.856132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:42:40.856624 [debug] [MainThread]: On master: Close
[0m22:42:40.857098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:40.857349 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:42:40.857580 [debug] [MainThread]: Connection 'model.airflow_dbt_training.location_data' was properly closed.
[0m22:42:40.857835 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:42:40.858079 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:42:40.858428 [info ] [MainThread]: 
[0m22:42:40.858741 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m22:42:40.860594 [debug] [MainThread]: Command end result
[0m22:42:40.901559 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:42:40.903739 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:42:40.909791 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:42:40.910126 [info ] [MainThread]: 
[0m22:42:40.910492 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:42:40.910855 [info ] [MainThread]: 
[0m22:42:40.911372 [error] [MainThread]:   Database Error in model incremental_prices (models/airflow_dbt_training/silver/incremental_prices.sql)
  aggregate functions are not allowed in WHERE
  LINE 35: WHERE updated_at > (SELECT MAX(updated_at) FROM "dwh"."publi...
                                      ^
[0m22:42:40.911900 [info ] [MainThread]: 
[0m22:42:40.912414 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:42:40.913787 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.707817, "process_in_blocks": "0", "process_kernel_time": 0.150738, "process_mem_max_rss": "129308", "process_out_blocks": "3384", "process_user_time": 2.884129}
[0m22:42:40.914532 [debug] [MainThread]: Command `dbt run` failed at 22:42:40.914348 after 1.71 seconds
[0m22:42:40.915044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbccdcac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbccfab310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbcdb53bd0>]}
[0m22:42:40.915477 [debug] [MainThread]: Flushing usage events
[0m22:42:41.605369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:43:06.353291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5607e1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe560b35910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5607d5d10>]}


============================== 22:43:06.356016 | f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58 ==============================
[0m22:43:06.356016 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:43:06.356547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:06.506315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe562eae510>]}
[0m22:43:06.562634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5631fac10>]}
[0m22:43:06.563348 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:43:06.640032 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:43:06.764140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:43:06.764859 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/incremental_prices.sql
[0m22:43:07.043864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55fbb5a90>]}
[0m22:43:07.140328 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:43:07.142833 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:43:07.155484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55ff5b650>]}
[0m22:43:07.155960 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:43:07.156321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55eb06b50>]}
[0m22:43:07.159830 [info ] [MainThread]: 
[0m22:43:07.160515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:43:07.161050 [info ] [MainThread]: 
[0m22:43:07.161992 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:43:07.167942 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:43:07.206770 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:43:07.207130 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:43:07.207406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:07.214923 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.007 seconds
[0m22:43:07.216187 [debug] [ThreadPool]: On list_dwh: Close
[0m22:43:07.217890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:43:07.224497 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:43:07.224793 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:43:07.225083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:07.231505 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:43:07.231824 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:43:07.232137 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:43:07.234697 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:43:07.236150 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:43:07.236630 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:43:07.287598 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:07.288032 [debug] [MainThread]: On master: BEGIN
[0m22:43:07.288285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:43:07.294814 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:43:07.295466 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:07.296344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:43:07.302604 [debug] [MainThread]: SQL status: SELECT 13 in 0.005 seconds
[0m22:43:07.306806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55d9a6650>]}
[0m22:43:07.307399 [debug] [MainThread]: On master: ROLLBACK
[0m22:43:07.307890 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:07.308173 [debug] [MainThread]: On master: BEGIN
[0m22:43:07.308760 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:43:07.309127 [debug] [MainThread]: On master: COMMIT
[0m22:43:07.309629 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:07.310036 [debug] [MainThread]: On master: COMMIT
[0m22:43:07.310629 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:07.311006 [debug] [MainThread]: On master: Close
[0m22:43:07.315686 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:43:07.316160 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:43:07.316657 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m22:43:07.317344 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m22:43:07.318229 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:43:07.319319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:43:07.320040 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:43:07.320941 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:43:07.322061 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m22:43:07.323046 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:43:07.324642 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:43:07.324055 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m22:43:07.325954 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:43:07.336832 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:43:07.339790 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:43:07.340407 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:43:07.340797 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:43:07.342002 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:43:07.342431 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:43:07.343104 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:43:07.345430 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:43:07.390251 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:43:07.409207 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:43:07.411363 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:43:07.412281 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:43:07.413330 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:43:07.413802 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:07.418829 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:43:07.419547 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:07.427629 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:43:07.428373 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:43:07.429178 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:43:07.429880 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:07.430608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:07.431246 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:43:07.431850 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:07.432440 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:43:07.434078 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:43:07.435094 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:43:07.435670 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:43:07.442295 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m22:43:07.443063 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m22:43:07.443649 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:07.444342 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:07.445097 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:43:07.445709 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:43:07.447835 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:43:07.448511 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:43:07.458421 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:07.464581 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m22:43:07.465137 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:43:07.465554 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m22:43:07.465945 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:07.466347 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:07.466863 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:07.467245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:43:07.467681 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:43:07.468133 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:43:07.468598 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:43:07.472028 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:07.472739 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:43:07.473211 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:07.473582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:43:07.476749 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:07.477130 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:43:07.477698 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:43:07.488537 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:43:07.496253 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:43:07.499910 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:07.502993 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:07.503552 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:07.504035 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:43:07.504458 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:07.504870 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:43:07.505311 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:43:07.506802 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:43:07.507332 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:43:07.507823 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:07.508222 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:07.511453 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:07.514533 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:07.514997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m22:43:07.515435 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:43:07.515858 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:43:07.516305 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:43:07.522884 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:43:07.528935 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:43:07.530469 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:43:07.530990 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m22:43:07.528601 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:07.531567 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:07.531935 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m22:43:07.533276 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:43:07.533701 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:43:07.534115 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:43:07.538460 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:43:07.538911 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:07.539767 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:07.540173 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:43:07.540605 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:43:07.542172 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:43:07.544841 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:43:07.545619 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:07.546005 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:43:07.546445 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:43:07.546877 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m22:43:07.549177 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:43:07.549582 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m22:43:07.552386 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:43:07.553786 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:43:07.555576 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:43:07.556368 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:07.556737 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55d84eb10>]}
[0m22:43:07.557362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe560807790>]}
[0m22:43:07.558691 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:43:07.559146 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:43:07.559840 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.23s]
[0m22:43:07.560629 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.24s]
[0m22:43:07.561786 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55d96e590>]}
[0m22:43:07.562918 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:43:07.563958 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:43:07.565022 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.24s]
[0m22:43:07.567090 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:43:07.568114 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:43:07.570881 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:43:07.571704 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:43:07.572445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m22:43:07.573028 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55d949410>]}
[0m22:43:07.573612 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:43:07.574790 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.23s]
[0m22:43:07.580282 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:43:07.580974 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:43:07.582164 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:43:07.583150 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:43:07.584075 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:43:07.584844 [info ] [Thread-3 (]: 5 of 7 START sql view model public.region_type_composition ..................... [RUN]
[0m22:43:07.585777 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:43:07.586907 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m22:43:07.587927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.incremental_prices)
[0m22:43:07.588582 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:43:07.589164 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:43:07.593390 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:43:07.601998 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:43:07.602905 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:43:07.603279 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:43:07.607614 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:43:07.629140 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:07.629589 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:43:07.629916 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:43:07.651933 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m22:43:07.656099 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:07.656526 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:07.657048 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp224307638973"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m22:43:07.657594 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:43:07.658093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:07.660356 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:43:07.663711 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:07.664066 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:43:07.664817 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:43:07.666111 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:43:07.666456 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:07.666782 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:43:07.669531 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m22:43:07.672203 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:43:07.672836 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:07.673197 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:43:07.673655 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.016 seconds
[0m22:43:07.679400 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:43:07.680752 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:43:07.691454 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:07.692159 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55d88c750>]}
[0m22:43:07.692596 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m22:43:07.693268 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.11s]
[0m22:43:07.694031 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:43:07.694685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m22:43:07.695826 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:43:07.696303 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:07.696926 [info ] [Thread-2 (]: 7 of 7 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:43:07.697499 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp224307638973'
        
      order by ordinal_position

  
[0m22:43:07.698111 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:43:07.698783 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:43:07.707090 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:07.707661 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.009 seconds
[0m22:43:07.713878 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:07.714454 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:43:07.715044 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:43:07.719490 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:07.720384 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:07.720778 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:43:07.721090 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:43:07.722460 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:43:07.731017 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:07.731578 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:43:07.732467 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m22:43:07.732874 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:07.733432 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:43:07.734157 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:43:07.742559 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m22:43:07.742991 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m22:43:07.746545 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:07.747006 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:43:07.747573 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:07.747938 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:07.748397 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price")
    (
        select "id", "date", "region", "price"
        from "incremental_prices__dbt_tmp224307638973"
    )


  
[0m22:43:07.749992 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:43:07.750576 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:07.750933 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:43:07.751361 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:43:07.752655 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:43:07.752989 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:07.753297 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:43:07.753859 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:43:07.756576 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:43:07.756975 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:43:07.757668 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:07.758470 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:43:07.758929 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:43:07.759600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5607ee350>]}
[0m22:43:07.760699 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:43:07.760321 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 0[0m in 0.17s]
[0m22:43:07.762302 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:43:07.762953 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:43:07.763788 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2cf28fa-a8dc-4c6e-989f-ac11c24c7b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5602b6090>]}
[0m22:43:07.764462 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.07s]
[0m22:43:07.765369 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:43:07.767354 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:07.767820 [debug] [MainThread]: On master: BEGIN
[0m22:43:07.768163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:43:07.775063 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:43:07.775517 [debug] [MainThread]: On master: COMMIT
[0m22:43:07.775978 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:07.776432 [debug] [MainThread]: On master: COMMIT
[0m22:43:07.777035 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:07.777332 [debug] [MainThread]: On master: Close
[0m22:43:07.777766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:07.778009 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:43:07.778237 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:43:07.778462 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:43:07.778705 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_location_data' was properly closed.
[0m22:43:07.779055 [info ] [MainThread]: 
[0m22:43:07.779370 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m22:43:07.781509 [debug] [MainThread]: Command end result
[0m22:43:07.816630 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:43:07.818128 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:43:07.824075 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:43:07.824347 [info ] [MainThread]: 
[0m22:43:07.824715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:07.825049 [info ] [MainThread]: 
[0m22:43:07.825404 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m22:43:07.826488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5231806, "process_in_blocks": "0", "process_kernel_time": 0.148603, "process_mem_max_rss": "127428", "process_out_blocks": "3400", "process_user_time": 2.655051}
[0m22:43:07.826966 [debug] [MainThread]: Command `dbt run` succeeded at 22:43:07.826847 after 1.52 seconds
[0m22:43:07.827305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe564b38fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe564b38410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe564b393d0>]}
[0m22:43:07.827683 [debug] [MainThread]: Flushing usage events
[0m22:43:08.522110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:43:10.690014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45996795d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45997a11d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45996790d0>]}


============================== 22:43:10.692786 | 46120174-8e62-4d33-9f74-5a82b248b95f ==============================
[0m22:43:10.692786 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:43:10.693306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:10.857369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46120174-8e62-4d33-9f74-5a82b248b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4599975290>]}
[0m22:43:10.919099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46120174-8e62-4d33-9f74-5a82b248b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f459c093810>]}
[0m22:43:10.919847 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:43:11.009698 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:43:11.149303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:43:11.149794 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:43:11.208076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46120174-8e62-4d33-9f74-5a82b248b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4597b11450>]}
[0m22:43:11.306446 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:43:11.309079 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:43:11.321073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46120174-8e62-4d33-9f74-5a82b248b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4597f0b4d0>]}
[0m22:43:11.321549 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:43:11.321859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46120174-8e62-4d33-9f74-5a82b248b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f459b29ccd0>]}
[0m22:43:11.324705 [info ] [MainThread]: 
[0m22:43:11.325253 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:43:11.325701 [info ] [MainThread]: 
[0m22:43:11.326517 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:43:11.333157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:43:11.372846 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:43:11.373206 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:43:11.373476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:11.382440 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.009 seconds
[0m22:43:11.383692 [debug] [ThreadPool]: On list_dwh: Close
[0m22:43:11.385499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:43:11.391878 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:43:11.392164 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:43:11.392443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:11.398840 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:43:11.399164 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:43:11.399502 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:43:11.402157 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:43:11.403599 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:43:11.404052 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:43:11.410875 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:11.411177 [debug] [MainThread]: On master: BEGIN
[0m22:43:11.411428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:43:11.417900 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:43:11.418222 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:11.418697 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:43:11.425028 [debug] [MainThread]: SQL status: SELECT 13 in 0.006 seconds
[0m22:43:11.428694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46120174-8e62-4d33-9f74-5a82b248b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45983e8150>]}
[0m22:43:11.429093 [debug] [MainThread]: On master: ROLLBACK
[0m22:43:11.429569 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:11.429835 [debug] [MainThread]: On master: BEGIN
[0m22:43:11.430419 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:43:11.430679 [debug] [MainThread]: On master: COMMIT
[0m22:43:11.430925 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:11.431187 [debug] [MainThread]: On master: COMMIT
[0m22:43:11.431611 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:11.431892 [debug] [MainThread]: On master: Close
[0m22:43:11.435671 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:43:11.436162 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:43:11.436704 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m22:43:11.437331 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m22:43:11.438311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:43:11.438925 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:43:11.439513 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:43:11.439926 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:43:11.440413 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:43:11.440995 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m22:43:11.441659 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:43:11.443527 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m22:43:11.455917 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:43:11.457256 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:43:11.460345 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:43:11.461278 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:43:11.462270 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:43:11.463677 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:43:11.464247 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:43:11.464726 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:43:11.467244 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:43:11.527906 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:43:11.539970 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:43:11.543166 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:43:11.544110 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:43:11.545076 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:43:11.545668 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:11.546093 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:11.550329 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:43:11.554188 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:43:11.554662 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:43:11.555095 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:43:11.555986 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:11.556445 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:11.556882 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:43:11.557263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:11.557699 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:43:11.558109 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:43:11.558878 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:43:11.559305 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:43:11.565053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:43:11.565930 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m22:43:11.566803 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:11.567428 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m22:43:11.567880 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m22:43:11.568369 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:11.568837 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:43:11.569324 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:11.569856 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:11.570341 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:43:11.570922 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:43:11.571391 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:43:11.572220 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:43:11.578506 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:43:11.585740 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:11.586336 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m22:43:11.586741 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m22:43:11.587180 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:43:11.587668 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:11.591252 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:11.594784 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:11.595416 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:43:11.595930 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:43:11.596348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:11.596796 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:43:11.600292 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:11.600891 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:43:11.601361 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:43:11.601878 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:43:11.602316 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:11.605706 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:11.608711 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:11.612006 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:11.612446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:43:11.612905 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:43:11.613317 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:43:11.613762 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:43:11.625126 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:43:11.634862 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:43:11.636631 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:43:11.637083 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:43:11.637508 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:43:11.637890 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:11.638391 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:11.639894 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:43:11.643186 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:43:11.643688 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:43:11.644111 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:43:11.644654 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:11.645223 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:11.645943 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:43:11.646382 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:43:11.648523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:43:11.696231 [debug] [Thread-4 (]: SQL status: COMMIT in 0.049 seconds
[0m22:43:11.699528 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:43:11.699934 [debug] [Thread-2 (]: SQL status: COMMIT in 0.053 seconds
[0m22:43:11.700309 [debug] [Thread-3 (]: SQL status: COMMIT in 0.054 seconds
[0m22:43:11.702984 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:43:11.708349 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:11.711091 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:43:11.713788 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:43:11.714511 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:11.715003 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:43:11.715723 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:11.716384 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:11.716815 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:43:11.717364 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:43:11.717815 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:43:11.721109 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:43:11.723520 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:43:11.724021 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:43:11.724558 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:43:11.726503 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:43:11.726898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46120174-8e62-4d33-9f74-5a82b248b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45968c46d0>]}
[0m22:43:11.728200 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:43:11.729445 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:43:11.730708 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:43:11.731407 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m22:43:11.732281 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46120174-8e62-4d33-9f74-5a82b248b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4598bc3690>]}
[0m22:43:11.733226 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:43:11.733791 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46120174-8e62-4d33-9f74-5a82b248b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4598bc1310>]}
[0m22:43:11.734336 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46120174-8e62-4d33-9f74-5a82b248b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45977847d0>]}
[0m22:43:11.735103 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.28s]
[0m22:43:11.736510 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m22:43:11.737734 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.27s]
[0m22:43:11.738447 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:43:11.739126 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:43:11.739811 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:43:11.740462 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:43:11.740928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m22:43:11.742387 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:43:11.742847 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:43:11.743475 [info ] [Thread-3 (]: 5 of 7 START sql view model public.region_type_composition ..................... [RUN]
[0m22:43:11.747151 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:43:11.747744 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m22:43:11.748582 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:43:11.752128 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:43:11.753033 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:43:11.754050 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:43:11.754660 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:43:11.758897 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:43:11.759556 [info ] [Thread-4 (]: 6 of 7 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:43:11.760449 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m22:43:11.761256 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:11.761751 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:43:11.762251 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:43:11.773363 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:43:11.775706 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:43:11.776500 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:43:11.793083 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m22:43:11.798759 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:11.799252 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:43:11.806568 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:43:11.815350 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:11.821019 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:43:11.827204 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:43:11.833721 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:43:11.835694 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:11.836117 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:11.836614 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp224311810869"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m22:43:11.837114 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:43:11.837524 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:43:11.841502 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m22:43:11.844262 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:43:11.845124 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:11.845512 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:43:11.846105 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:43:11.847424 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:43:11.847973 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46120174-8e62-4d33-9f74-5a82b248b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45969dbf50>]}
[0m22:43:11.848565 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.10s]
[0m22:43:11.849170 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:43:11.849885 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:43:11.850414 [info ] [Thread-1 (]: 7 of 7 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:43:11.850984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:43:11.851378 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:43:11.857108 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.020 seconds
[0m22:43:11.860011 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:11.876132 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:11.876907 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m22:43:11.877445 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:43:11.881643 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:11.882182 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m22:43:11.882858 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:11.883254 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp224311810869'
        
      order by ordinal_position

  
[0m22:43:11.883838 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:11.884179 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:43:11.884487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:11.888857 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.005 seconds
[0m22:43:11.894835 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:11.895484 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:43:11.895931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:43:11.896469 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:11.897056 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:43:11.899094 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.003 seconds
[0m22:43:11.899535 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:43:11.908257 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:11.911460 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:11.911938 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:43:11.912433 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:43:11.913369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:43:11.914610 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:43:11.915071 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:11.915414 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:43:11.915812 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.003 seconds
[0m22:43:11.923902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m22:43:11.924651 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m22:43:11.927380 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:43:11.928013 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:11.928693 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:11.929121 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price")
    (
        select "id", "date", "region", "price"
        from "incremental_prices__dbt_tmp224311810869"
    )


  
[0m22:43:11.929630 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:43:11.930361 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:43:11.930762 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:43:11.932122 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:43:11.933401 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:43:11.933907 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:11.934257 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:43:11.934908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46120174-8e62-4d33-9f74-5a82b248b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4596855e50>]}
[0m22:43:11.935509 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.08s]
[0m22:43:11.936119 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:43:11.937030 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m22:43:11.937811 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:43:11.938369 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46120174-8e62-4d33-9f74-5a82b248b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45977ed5d0>]}
[0m22:43:11.938973 [info ] [Thread-4 (]: 6 of 7 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 0[0m in 0.18s]
[0m22:43:11.939634 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:43:11.942077 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:11.942538 [debug] [MainThread]: On master: BEGIN
[0m22:43:11.942801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:43:11.949851 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:43:11.950503 [debug] [MainThread]: On master: COMMIT
[0m22:43:11.950933 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:11.951262 [debug] [MainThread]: On master: COMMIT
[0m22:43:11.951756 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:11.952061 [debug] [MainThread]: On master: Close
[0m22:43:11.952473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:11.952711 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:43:11.952953 [debug] [MainThread]: Connection 'model.airflow_dbt_training.location_data' was properly closed.
[0m22:43:11.953174 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:43:11.953393 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:43:11.953743 [info ] [MainThread]: 
[0m22:43:11.954113 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m22:43:11.956256 [debug] [MainThread]: Command end result
[0m22:43:12.000658 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:43:12.002756 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:43:12.008901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:43:12.009224 [info ] [MainThread]: 
[0m22:43:12.009598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:12.009890 [info ] [MainThread]: 
[0m22:43:12.010266 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m22:43:12.011450 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3755174, "process_in_blocks": "0", "process_kernel_time": 0.221513, "process_mem_max_rss": "124708", "process_out_blocks": "2416", "process_user_time": 2.527269}
[0m22:43:12.011915 [debug] [MainThread]: Command `dbt run` succeeded at 22:43:12.011819 after 1.38 seconds
[0m22:43:12.012277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f459d9d0450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f459d9d0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f459d9d1450>]}
[0m22:43:12.012623 [debug] [MainThread]: Flushing usage events
[0m22:43:12.647337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:43:16.306441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ae7d1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aea0ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ae7c5d10>]}


============================== 22:43:16.309435 | ce54359f-0328-4cfa-baf8-5318afa70091 ==============================
[0m22:43:16.309435 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:43:16.310116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:43:16.496907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce54359f-0328-4cfa-baf8-5318afa70091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ae312610>]}
[0m22:43:16.559615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce54359f-0328-4cfa-baf8-5318afa70091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65b120f0d0>]}
[0m22:43:16.560364 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:43:16.640132 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:43:16.766614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:43:16.766985 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:43:16.823789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce54359f-0328-4cfa-baf8-5318afa70091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ae2fa250>]}
[0m22:43:16.928470 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:43:16.931590 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:43:16.944990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce54359f-0328-4cfa-baf8-5318afa70091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65adf2d810>]}
[0m22:43:16.945529 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:43:16.945856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce54359f-0328-4cfa-baf8-5318afa70091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65b0418dd0>]}
[0m22:43:16.949005 [info ] [MainThread]: 
[0m22:43:16.949542 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:43:16.949975 [info ] [MainThread]: 
[0m22:43:16.950666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:43:16.956589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:43:16.999292 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:43:16.999661 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:43:16.999920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:17.007643 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.008 seconds
[0m22:43:17.009042 [debug] [ThreadPool]: On list_dwh: Close
[0m22:43:17.011057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:43:17.017967 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:43:17.018342 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:43:17.018587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:17.025389 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:43:17.025783 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:43:17.026318 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:43:17.029228 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m22:43:17.030769 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:43:17.031252 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:43:17.038730 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:17.039057 [debug] [MainThread]: On master: BEGIN
[0m22:43:17.039331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:43:17.045883 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:43:17.046221 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:17.046739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:43:17.052967 [debug] [MainThread]: SQL status: SELECT 13 in 0.006 seconds
[0m22:43:17.056778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce54359f-0328-4cfa-baf8-5318afa70091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aba03150>]}
[0m22:43:17.057196 [debug] [MainThread]: On master: ROLLBACK
[0m22:43:17.057710 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:17.057974 [debug] [MainThread]: On master: BEGIN
[0m22:43:17.058567 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:43:17.058829 [debug] [MainThread]: On master: COMMIT
[0m22:43:17.059119 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:17.059412 [debug] [MainThread]: On master: COMMIT
[0m22:43:17.059863 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:17.060226 [debug] [MainThread]: On master: Close
[0m22:43:17.063588 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:43:17.064526 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:43:17.065566 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:43:17.064153 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m22:43:17.066289 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:43:17.065164 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m22:43:17.067086 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m22:43:17.067818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:43:17.068502 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m22:43:17.069517 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:43:17.070203 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:43:17.070742 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:43:17.071323 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:43:17.071823 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:43:17.072281 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:43:17.078083 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:43:17.082291 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:43:17.084707 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:43:17.086852 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:43:17.090293 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:43:17.091169 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:43:17.091960 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:43:17.092519 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:43:17.114064 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:43:17.164836 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:43:17.169604 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:43:17.172670 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:43:17.174085 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:43:17.175103 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:17.175667 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:17.176384 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:43:17.176824 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:17.177287 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:43:17.177804 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:43:17.178313 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:43:17.178758 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:17.179183 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:43:17.179779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:17.180173 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:43:17.180938 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:43:17.187349 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m22:43:17.188294 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m22:43:17.189432 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:17.190523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:43:17.191809 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:17.192691 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m22:43:17.193452 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:43:17.194113 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:17.194619 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:43:17.195098 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:17.195758 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:43:17.196671 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:43:17.197455 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:43:17.198128 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:43:17.198648 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:43:17.204264 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:43:17.207078 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:17.211168 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:17.215193 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:17.219177 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:17.219710 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:43:17.220194 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:43:17.220688 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:43:17.221162 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:43:17.222175 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:17.222798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:17.223166 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:17.226946 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:17.227436 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:43:17.230821 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:17.234426 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:17.235038 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:43:17.238437 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:17.238974 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:43:17.239500 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:43:17.240074 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:43:17.240771 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:17.246547 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:43:17.247143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m22:43:17.261321 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:43:17.262847 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:43:17.263383 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m22:43:17.264916 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:43:17.265406 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:17.265845 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:17.268948 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:43:17.269502 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:17.269932 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:43:17.270376 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:43:17.270802 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:17.271212 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:43:17.271918 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:43:17.274640 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:43:17.324001 [debug] [Thread-1 (]: SQL status: COMMIT in 0.052 seconds
[0m22:43:17.329982 [debug] [Thread-4 (]: SQL status: COMMIT in 0.058 seconds
[0m22:43:17.332175 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:43:17.335102 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:43:17.335588 [debug] [Thread-2 (]: SQL status: COMMIT in 0.063 seconds
[0m22:43:17.337590 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:43:17.342970 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:43:17.343744 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:43:17.346485 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:43:17.347334 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:43:17.347835 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:43:17.348302 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:43:17.349060 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:43:17.349489 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:43:17.350153 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:43:17.353610 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:43:17.356178 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:43:17.356698 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:43:17.357252 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m22:43:17.358598 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:43:17.360524 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.010 seconds
[0m22:43:17.360902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce54359f-0328-4cfa-baf8-5318afa70091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a895a910>]}
[0m22:43:17.362295 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:43:17.363648 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:43:17.364354 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce54359f-0328-4cfa-baf8-5318afa70091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aef69410>]}
[0m22:43:17.365263 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m22:43:17.366215 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce54359f-0328-4cfa-baf8-5318afa70091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65af4f88d0>]}
[0m22:43:17.367018 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce54359f-0328-4cfa-baf8-5318afa70091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aeb13290>]}
[0m22:43:17.367851 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.29s]
[0m22:43:17.368537 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:43:17.370619 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:43:17.369235 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.30s]
[0m22:43:17.369928 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.30s]
[0m22:43:17.372417 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:43:17.372896 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:43:17.373552 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:43:17.374315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m22:43:17.375302 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:43:17.375750 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:43:17.376437 [info ] [Thread-3 (]: 5 of 7 START sql view model public.region_type_composition ..................... [RUN]
[0m22:43:17.380964 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:43:17.381684 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m22:43:17.382339 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:43:17.385581 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:43:17.386670 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:43:17.387113 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:43:17.391537 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:43:17.392620 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:43:17.393334 [info ] [Thread-4 (]: 6 of 7 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:43:17.393814 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m22:43:17.394318 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:17.394697 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:43:17.395182 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:43:17.406134 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:43:17.408538 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:43:17.409192 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:43:17.423561 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m22:43:17.424081 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:17.424485 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:43:17.438074 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m22:43:17.464744 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:17.467185 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:17.467678 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:43:17.468204 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp224317443878"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m22:43:17.468876 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:43:17.469476 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:17.470956 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:43:17.471370 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:17.471699 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:43:17.474833 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:43:17.478088 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:43:17.479040 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:43:17.479424 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:43:17.480035 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:43:17.481738 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:43:17.482511 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce54359f-0328-4cfa-baf8-5318afa70091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65abad8990>]}
[0m22:43:17.483217 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.10s]
[0m22:43:17.483826 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:43:17.484707 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:43:17.485334 [info ] [Thread-1 (]: 7 of 7 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:43:17.485869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:43:17.486478 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:43:17.492280 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.023 seconds
[0m22:43:17.501284 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:17.511943 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:17.512702 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m22:43:17.513239 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:43:17.518289 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:17.518926 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m22:43:17.519301 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:17.519694 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp224317443878'
        
      order by ordinal_position

  
[0m22:43:17.520446 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:17.520829 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:43:17.521145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:17.525391 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.005 seconds
[0m22:43:17.531348 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:17.531951 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:43:17.532431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:43:17.532986 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:17.533437 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:43:17.535468 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.003 seconds
[0m22:43:17.535985 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:43:17.545068 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:17.548770 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:17.549337 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:43:17.549851 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:43:17.550861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:43:17.552188 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:43:17.552623 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.002 seconds
[0m22:43:17.553052 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:17.558808 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:43:17.562619 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m22:43:17.563121 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m22:43:17.566138 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:43:17.566992 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:43:17.567382 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:43:17.567886 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:17.568266 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price")
    (
        select "id", "date", "region", "price"
        from "incremental_prices__dbt_tmp224317443878"
    )


  
[0m22:43:17.568735 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:43:17.570179 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:43:17.570569 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:43:17.571846 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:43:17.572400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce54359f-0328-4cfa-baf8-5318afa70091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ae357210>]}
[0m22:43:17.572855 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:43:17.573550 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.09s]
[0m22:43:17.574054 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:43:17.574671 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:43:17.577802 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:43:17.578753 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:43:17.579419 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce54359f-0328-4cfa-baf8-5318afa70091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65abb4df50>]}
[0m22:43:17.580043 [info ] [Thread-4 (]: 6 of 7 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 0[0m in 0.19s]
[0m22:43:17.580644 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:43:17.582463 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:17.582808 [debug] [MainThread]: On master: BEGIN
[0m22:43:17.583054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:43:17.589856 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:43:17.590335 [debug] [MainThread]: On master: COMMIT
[0m22:43:17.590828 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:17.591148 [debug] [MainThread]: On master: COMMIT
[0m22:43:17.591683 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:17.592006 [debug] [MainThread]: On master: Close
[0m22:43:17.592441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:17.592696 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:43:17.592948 [debug] [MainThread]: Connection 'model.airflow_dbt_training.location_data' was properly closed.
[0m22:43:17.593169 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:43:17.593390 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:43:17.593758 [info ] [MainThread]: 
[0m22:43:17.594081 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m22:43:17.595672 [debug] [MainThread]: Command end result
[0m22:43:17.632327 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:43:17.633901 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:43:17.640067 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:43:17.640370 [info ] [MainThread]: 
[0m22:43:17.640725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:17.641013 [info ] [MainThread]: 
[0m22:43:17.641426 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m22:43:17.642501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3887141, "process_in_blocks": "0", "process_kernel_time": 0.18824, "process_mem_max_rss": "123408", "process_out_blocks": "2416", "process_user_time": 2.546199}
[0m22:43:17.642961 [debug] [MainThread]: Command `dbt run` succeeded at 22:43:17.642860 after 1.39 seconds
[0m22:43:17.643302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aeb10610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65b2b4c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65b2b4d150>]}
[0m22:43:17.643709 [debug] [MainThread]: Flushing usage events
[0m22:43:18.324670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:11.225691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc5d9a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc60f9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc5fdba50>]}


============================== 22:47:11.228439 | 2c7043f4-56eb-49b6-aa0c-0850b8a5c003 ==============================
[0m22:47:11.228439 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:47:11.228945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:47:11.380426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c7043f4-56eb-49b6-aa0c-0850b8a5c003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc51086d0>]}
[0m22:47:11.438791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c7043f4-56eb-49b6-aa0c-0850b8a5c003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc87bd8d0>]}
[0m22:47:11.439522 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:47:11.518788 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:47:11.646607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:47:11.647003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:47:11.701807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c7043f4-56eb-49b6-aa0c-0850b8a5c003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc4523e50>]}
[0m22:47:11.805665 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:47:11.808990 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:47:11.822368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c7043f4-56eb-49b6-aa0c-0850b8a5c003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc4554710>]}
[0m22:47:11.822887 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:47:11.823215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c7043f4-56eb-49b6-aa0c-0850b8a5c003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc4dbd290>]}
[0m22:47:11.825996 [info ] [MainThread]: 
[0m22:47:11.826453 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:11.826972 [info ] [MainThread]: 
[0m22:47:11.828224 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:47:11.834299 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:47:11.878102 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:47:11.878560 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:47:11.878941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:11.886675 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.008 seconds
[0m22:47:11.887984 [debug] [ThreadPool]: On list_dwh: Close
[0m22:47:11.889834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:47:11.896950 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:47:11.897347 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:47:11.897596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:47:11.904190 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:47:11.904774 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:47:11.905541 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:47:11.908628 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m22:47:11.910038 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:47:11.910575 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:47:11.916388 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:11.916774 [debug] [MainThread]: On master: BEGIN
[0m22:47:11.917013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:47:11.923824 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:47:11.924212 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:11.924841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:47:11.928681 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m22:47:11.929884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c7043f4-56eb-49b6-aa0c-0850b8a5c003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc41d8150>]}
[0m22:47:11.930314 [debug] [MainThread]: On master: ROLLBACK
[0m22:47:11.930785 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:11.931049 [debug] [MainThread]: On master: BEGIN
[0m22:47:11.931630 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:47:11.931939 [debug] [MainThread]: On master: COMMIT
[0m22:47:11.932238 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:11.932556 [debug] [MainThread]: On master: COMMIT
[0m22:47:11.933083 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:11.933371 [debug] [MainThread]: On master: Close
[0m22:47:11.936865 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:47:11.937348 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:47:11.938357 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:47:11.937947 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m22:47:11.939057 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:47:11.939652 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m22:47:11.940476 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m22:47:11.941301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:47:11.942138 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m22:47:11.943071 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:47:11.943675 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:47:11.944168 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:47:11.944973 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:47:11.945449 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:47:11.945982 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:47:11.951913 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:47:11.956592 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:47:11.959360 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:47:11.962218 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:47:11.965857 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:47:11.967151 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:47:11.967783 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:47:11.978658 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:47:11.984642 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:47:12.032289 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:47:12.034188 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:47:12.037975 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:47:12.043619 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:47:12.044960 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:47:12.045652 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:47:12.046447 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:47:12.047020 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:47:12.047490 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:47:12.048010 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:47:12.048442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:12.048881 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:47:12.049275 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:47:12.049661 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:47:12.050227 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:47:12.050900 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:47:12.056960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:47:12.057642 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:47:12.058238 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:47:12.059177 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m22:47:12.059981 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.raw_housing_prices" does not exist
LINE 8: FROM "dwh"."public"."raw_housing_prices"
             ^

[0m22:47:12.060822 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:47:12.061989 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m22:47:12.062697 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: ROLLBACK
[0m22:47:12.063425 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m22:47:12.064149 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:47:12.064974 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:47:12.065863 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:47:12.066774 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:47:12.067521 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:47:12.068340 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:47:12.069120 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:47:12.072445 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.raw_location_data" does not exist
LINE 8:     SELECT * FROM "dwh"."public"."raw_location_data"
                          ^

[0m22:47:12.078564 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.raw_location_data" does not exist
LINE 7:     SELECT * FROM public.raw_location_data
                          ^

[0m22:47:12.084306 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:47:12.085321 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: ROLLBACK
[0m22:47:12.086463 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: ROLLBACK
[0m22:47:12.087358 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:47:12.088748 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:47:12.090230 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:47:12.092732 [debug] [Thread-1 (]: Database Error in model housing_prices (models/airflow_dbt_training/bronze/housing_prices.sql)
  relation "public.raw_housing_prices" does not exist
  LINE 8: FROM "dwh"."public"."raw_housing_prices"
               ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/bronze/housing_prices.sql
[0m22:47:12.095047 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:47:12.099324 [debug] [Thread-4 (]: Database Error in model stg_location_data (models/airflow_dbt_training/silver/stg_location_data.sql)
  relation "public.raw_location_data" does not exist
  LINE 8:     SELECT * FROM "dwh"."public"."raw_location_data"
                            ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/silver/stg_location_data.sql
[0m22:47:12.101329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c7043f4-56eb-49b6-aa0c-0850b8a5c003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc30ef310>]}
[0m22:47:12.103530 [debug] [Thread-2 (]: Database Error in model location_data (models/airflow_dbt_training/bronze/location_data.sql)
  relation "public.raw_location_data" does not exist
  LINE 7:     SELECT * FROM public.raw_location_data
                            ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/bronze/location_data.sql
[0m22:47:12.108099 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:47:12.108736 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c7043f4-56eb-49b6-aa0c-0850b8a5c003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc0613a50>]}
[0m22:47:12.109718 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model public.housing_prices ..................... [[31mERROR[0m in 0.15s]
[0m22:47:12.110516 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c7043f4-56eb-49b6-aa0c-0850b8a5c003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc41e2a90>]}
[0m22:47:12.111367 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:47:12.112694 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model public.stg_location_data .................. [[31mERROR[0m in 0.16s]
[0m22:47:12.114613 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:47:12.116033 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model public.location_data ...................... [[31mERROR[0m in 0.17s]
[0m22:47:12.118286 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:47:12.119639 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:47:12.120600 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.housing_prices' to be skipped because of status 'error'.  Reason: Database Error in model housing_prices (models/airflow_dbt_training/bronze/housing_prices.sql)
  relation "public.raw_housing_prices" does not exist
  LINE 8: FROM "dwh"."public"."raw_housing_prices"
               ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/bronze/housing_prices.sql.
[0m22:47:12.121673 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:47:12.133619 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.stg_location_data' to be skipped because of status 'error'.  Reason: Database Error in model stg_location_data (models/airflow_dbt_training/silver/stg_location_data.sql)
  relation "public.raw_location_data" does not exist
  LINE 8:     SELECT * FROM "dwh"."public"."raw_location_data"
                            ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/silver/stg_location_data.sql.
[0m22:47:12.146677 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:47:12.147406 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:47:12.148153 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.location_data' to be skipped because of status 'error'.  Reason: Database Error in model location_data (models/airflow_dbt_training/bronze/location_data.sql)
  relation "public.raw_location_data" does not exist
  LINE 7:     SELECT * FROM public.raw_location_data
                            ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/bronze/location_data.sql.
[0m22:47:12.148771 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:47:12.149227 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:47:12.149684 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:47:12.150293 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:47:12.150770 [info ] [Thread-4 (]: 5 of 7 SKIP relation public.region_type_composition ............................ [[33mSKIP[0m]
[0m22:47:12.151914 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:47:12.152608 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:47:12.153124 [info ] [Thread-1 (]: 6 of 7 SKIP relation public.incremental_prices ................................. [[33mSKIP[0m]
[0m22:47:12.153933 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:47:12.154624 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:47:12.155114 [info ] [Thread-1 (]: 7 of 7 SKIP relation public.mart_housing_prices_breakdown ...................... [[33mSKIP[0m]
[0m22:47:12.155666 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:47:12.165974 [debug] [Thread-3 (]: SQL status: COMMIT in 0.014 seconds
[0m22:47:12.173631 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:47:12.179645 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:47:12.180092 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:47:12.189001 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m22:47:12.191506 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:47:12.192089 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c7043f4-56eb-49b6-aa0c-0850b8a5c003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc2f02a10>]}
[0m22:47:12.192665 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m22:47:12.193265 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:47:12.195285 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:12.195672 [debug] [MainThread]: On master: BEGIN
[0m22:47:12.195927 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:47:12.202748 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:47:12.203285 [debug] [MainThread]: On master: COMMIT
[0m22:47:12.203744 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:12.204150 [debug] [MainThread]: On master: COMMIT
[0m22:47:12.204682 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:47:12.205052 [debug] [MainThread]: On master: Close
[0m22:47:12.205643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:12.205996 [debug] [MainThread]: Connection 'model.airflow_dbt_training.housing_prices' was properly closed.
[0m22:47:12.206358 [debug] [MainThread]: Connection 'model.airflow_dbt_training.location_data' was properly closed.
[0m22:47:12.206737 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_example' was properly closed.
[0m22:47:12.207033 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_location_data' was properly closed.
[0m22:47:12.207428 [info ] [MainThread]: 
[0m22:47:12.207830 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m22:47:12.209598 [debug] [MainThread]: Command end result
[0m22:47:12.289624 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:47:12.291152 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:47:12.297281 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:47:12.297855 [info ] [MainThread]: 
[0m22:47:12.298387 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m22:47:12.298766 [info ] [MainThread]: 
[0m22:47:12.299514 [error] [MainThread]:   Database Error in model housing_prices (models/airflow_dbt_training/bronze/housing_prices.sql)
  relation "public.raw_housing_prices" does not exist
  LINE 8: FROM "dwh"."public"."raw_housing_prices"
               ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/bronze/housing_prices.sql
[0m22:47:12.300037 [info ] [MainThread]: 
[0m22:47:12.300596 [error] [MainThread]:   Database Error in model stg_location_data (models/airflow_dbt_training/silver/stg_location_data.sql)
  relation "public.raw_location_data" does not exist
  LINE 8:     SELECT * FROM "dwh"."public"."raw_location_data"
                            ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/silver/stg_location_data.sql
[0m22:47:12.301109 [info ] [MainThread]: 
[0m22:47:12.301671 [error] [MainThread]:   Database Error in model location_data (models/airflow_dbt_training/bronze/location_data.sql)
  relation "public.raw_location_data" does not exist
  LINE 7:     SELECT * FROM public.raw_location_data
                            ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/bronze/location_data.sql
[0m22:47:12.302241 [info ] [MainThread]: 
[0m22:47:12.302851 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=3 TOTAL=7
[0m22:47:12.304069 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1292336, "process_in_blocks": "0", "process_kernel_time": 0.189598, "process_mem_max_rss": "121108", "process_out_blocks": "2312", "process_user_time": 2.235271}
[0m22:47:12.304722 [debug] [MainThread]: Command `dbt run` failed at 22:47:12.304619 after 1.13 seconds
[0m22:47:12.305294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc49b0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cca0fc450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc06d5ad0>]}
[0m22:47:12.305835 [debug] [MainThread]: Flushing usage events
[0m22:47:13.034424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:40.444451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf404ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf7521d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf452790>]}


============================== 22:53:40.450233 | 4b026431-9486-4089-9d80-800c61caca40 ==============================
[0m22:53:40.450233 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:53:40.450757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:53:40.461160 [info ] [MainThread]: dbt version: 1.9.4
[0m22:53:40.461734 [info ] [MainThread]: python version: 3.11.12
[0m22:53:40.462246 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:53:40.462780 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m22:53:40.512920 [info ] [MainThread]: Using profiles dir at /dbt
[0m22:53:40.513346 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m22:53:40.513663 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m22:53:40.514156 [info ] [MainThread]: adapter type: postgres
[0m22:53:40.514530 [info ] [MainThread]: adapter version: 1.9.0
[0m22:53:40.610585 [info ] [MainThread]: Configuration:
[0m22:53:40.610989 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:53:40.611272 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:53:40.611676 [info ] [MainThread]: Required dependencies:
[0m22:53:40.612022 [debug] [MainThread]: Executing "git --help"
[0m22:53:40.614024 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:53:40.614586 [debug] [MainThread]: STDERR: "b''"
[0m22:53:40.614958 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:53:40.615415 [info ] [MainThread]: Connection:
[0m22:53:40.615958 [info ] [MainThread]:   host: dwh
[0m22:53:40.616416 [info ] [MainThread]:   port: 5432
[0m22:53:40.616874 [info ] [MainThread]:   user: airflow
[0m22:53:40.617375 [info ] [MainThread]:   database: dwh
[0m22:53:40.617709 [info ] [MainThread]:   schema: public
[0m22:53:40.618036 [info ] [MainThread]:   connect_timeout: 10
[0m22:53:40.618402 [info ] [MainThread]:   role: None
[0m22:53:40.618723 [info ] [MainThread]:   search_path: None
[0m22:53:40.619110 [info ] [MainThread]:   keepalives_idle: 0
[0m22:53:40.619404 [info ] [MainThread]:   sslmode: None
[0m22:53:40.619776 [info ] [MainThread]:   sslcert: None
[0m22:53:40.620132 [info ] [MainThread]:   sslkey: None
[0m22:53:40.620429 [info ] [MainThread]:   sslrootcert: None
[0m22:53:40.620797 [info ] [MainThread]:   application_name: dbt
[0m22:53:40.621285 [info ] [MainThread]:   retries: 1
[0m22:53:40.622078 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:53:40.695609 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:53:40.722019 [debug] [MainThread]: Using postgres connection "debug"
[0m22:53:40.722411 [debug] [MainThread]: On debug: select 1 as id
[0m22:53:40.722659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:40.730142 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m22:53:40.731008 [debug] [MainThread]: On debug: Close
[0m22:53:40.731342 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:53:40.731634 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:53:40.732515 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.33856457, "process_in_blocks": "1376", "process_kernel_time": 0.141329, "process_mem_max_rss": "111892", "process_out_blocks": "1704", "process_user_time": 1.534437}
[0m22:53:40.732968 [debug] [MainThread]: Command `dbt debug` succeeded at 22:53:40.732868 after 0.34 seconds
[0m22:53:40.733270 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:53:40.733635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf454e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faace7b0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf663ed0>]}
[0m22:53:40.733980 [debug] [MainThread]: Flushing usage events
[0m22:53:41.398580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:46.852306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58c5d1b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58c80bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58c5c63d0>]}


============================== 22:53:46.855212 | 055b510d-e6d7-46eb-b8b7-f8af9df71049 ==============================
[0m22:53:46.855212 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:53:46.855733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:53:47.010291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '055b510d-e6d7-46eb-b8b7-f8af9df71049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58c0eadd0>]}
[0m22:53:47.068108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '055b510d-e6d7-46eb-b8b7-f8af9df71049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f00d810>]}
[0m22:53:47.068826 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:53:47.152150 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:53:47.277603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:53:47.277957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:53:47.329471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '055b510d-e6d7-46eb-b8b7-f8af9df71049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58b59ca50>]}
[0m22:53:47.436143 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:53:47.438672 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:53:47.456826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '055b510d-e6d7-46eb-b8b7-f8af9df71049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58bd2dc10>]}
[0m22:53:47.457381 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:53:47.457716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055b510d-e6d7-46eb-b8b7-f8af9df71049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58b9f0150>]}
[0m22:53:47.460664 [info ] [MainThread]: 
[0m22:53:47.461178 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:53:47.461686 [info ] [MainThread]: 
[0m22:53:47.462649 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:53:47.469135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:53:47.510194 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:53:47.510571 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:53:47.510943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:47.519124 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m22:53:47.520413 [debug] [ThreadPool]: On list_dwh: Close
[0m22:53:47.522175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:53:47.528751 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:53:47.529077 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:53:47.529340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:47.536123 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:53:47.536480 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:53:47.536885 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:53:47.541219 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m22:53:47.542578 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:53:47.543060 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:53:47.548819 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:47.549142 [debug] [MainThread]: On master: BEGIN
[0m22:53:47.549380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:47.556051 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:53:47.556407 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:47.556963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:53:47.561492 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m22:53:47.562689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055b510d-e6d7-46eb-b8b7-f8af9df71049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58b9c4f50>]}
[0m22:53:47.563137 [debug] [MainThread]: On master: ROLLBACK
[0m22:53:47.563617 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:47.563898 [debug] [MainThread]: On master: BEGIN
[0m22:53:47.564485 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:53:47.564837 [debug] [MainThread]: On master: COMMIT
[0m22:53:47.565413 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:47.566011 [debug] [MainThread]: On master: COMMIT
[0m22:53:47.566507 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:53:47.566800 [debug] [MainThread]: On master: Close
[0m22:53:47.573337 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:53:47.574480 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m22:53:47.575066 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:53:47.575584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:53:47.575995 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:53:47.576467 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:53:47.577081 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m22:53:47.577740 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:53:47.578513 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m22:53:47.579410 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m22:53:47.580603 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:53:47.590508 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:53:47.591186 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:53:47.591725 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:53:47.592178 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:53:47.592875 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:53:47.593332 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:53:47.593743 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:53:47.596000 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:53:47.598230 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:53:47.611693 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:53:47.640460 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:53:47.641081 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:53:47.641692 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:53:47.642148 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:53:47.646054 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:53:47.646647 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:53:47.651522 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:53:47.655402 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:53:47.656060 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:53:47.656564 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:53:47.657287 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:53:47.657736 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:53:47.658129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:47.658592 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:53:47.658994 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:53:47.659402 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:53:47.660017 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:53:47.660418 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:53:47.660831 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:53:47.666533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:53:47.667264 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:53:47.668021 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:53:47.668708 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m22:53:47.669628 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:53:47.670315 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m22:53:47.670716 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:53:47.671374 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:53:47.671838 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:53:47.672380 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m22:53:47.678586 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:53:47.680804 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:53:47.681210 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m22:53:47.681644 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:53:47.682159 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:53:47.685955 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:53:47.686464 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:53:47.686877 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:53:47.687434 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:53:47.690831 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:53:47.691255 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:53:47.691884 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:53:47.708931 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m22:53:47.709473 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m22:53:47.709840 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:53:47.711234 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:53:47.711538 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:53:47.714977 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:53:47.716292 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:53:47.716716 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:53:47.717153 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:53:47.717579 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:53:47.718026 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:53:47.718445 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:53:47.718871 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:53:47.719459 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:53:47.719868 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:53:47.721396 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:53:47.721723 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:53:47.722069 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:53:47.725021 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:53:47.725444 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m22:53:47.725898 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m22:53:47.732998 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:53:47.735772 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:53:47.736183 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m22:53:47.738937 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:53:47.744460 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:53:47.745164 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:53:47.749032 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:53:47.749803 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:53:47.750271 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:53:47.750717 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:53:47.751405 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:53:47.751836 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:53:47.752507 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:53:47.753056 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:53:47.753590 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:53:47.754033 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:53:47.756446 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:53:47.757720 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:53:47.758110 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:53:47.759313 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:53:47.762190 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:53:47.762736 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055b510d-e6d7-46eb-b8b7-f8af9df71049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff588734210>]}
[0m22:53:47.763323 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055b510d-e6d7-46eb-b8b7-f8af9df71049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff588742310>]}
[0m22:53:47.763953 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055b510d-e6d7-46eb-b8b7-f8af9df71049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff588756410>]}
[0m22:53:47.764767 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.17s]
[0m22:53:47.765344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055b510d-e6d7-46eb-b8b7-f8af9df71049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff588742a10>]}
[0m22:53:47.766069 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m22:53:47.766847 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m22:53:47.767752 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:53:47.768570 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.19s]
[0m22:53:47.769345 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:53:47.770062 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:53:47.771018 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:53:47.772333 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:53:47.772943 [info ] [Thread-3 (]: 5 of 7 START sql view model public.region_type_composition ..................... [RUN]
[0m22:53:47.773819 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m22:53:47.774414 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:53:47.775231 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:53:47.775892 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m22:53:47.779608 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:53:47.780439 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:53:47.829612 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:53:47.830203 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:53:47.833854 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:53:47.834649 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:53:47.835060 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:53:47.835868 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:53:47.836253 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:53:47.836836 [info ] [Thread-2 (]: 6 of 7 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:53:47.837315 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:53:47.837780 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.incremental_prices)
[0m22:53:47.838475 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:53:47.847831 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:53:47.848611 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:53:47.854200 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m22:53:47.854673 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:53:47.855070 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:53:47.862494 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:53:47.871107 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:53:47.879514 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:53:47.890802 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:53:47.897463 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:53:47.903084 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:53:47.903834 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m22:53:47.904301 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:53:47.905103 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:53:47.905432 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m22:53:47.905734 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:53:47.907994 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:53:47.910815 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:53:47.911430 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:53:47.911774 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:53:47.912396 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:53:47.914062 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:53:47.914621 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m22:53:47.915167 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055b510d-e6d7-46eb-b8b7-f8af9df71049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58d520950>]}
[0m22:53:47.915618 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:53:47.916330 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.14s]
[0m22:53:47.916913 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      
  
    

  create  table "dwh"."public"."incremental_prices"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

  );
  
  
[0m22:53:47.917589 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:53:47.918635 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:53:47.919269 [info ] [Thread-4 (]: 7 of 7 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:53:47.919892 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:53:47.920385 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:53:47.931179 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:47.931882 [debug] [Thread-2 (]: SQL status: SELECT 1500 in 0.014 seconds
[0m22:53:47.939581 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:53:47.940053 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:53:47.940514 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:53:47.940988 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:53:47.946655 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:47.947132 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m22:53:47.948050 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:53:47.948551 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:47.948910 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:53:47.949245 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:53:47.950301 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055b510d-e6d7-46eb-b8b7-f8af9df71049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58b9e18d0>]}
[0m22:53:47.951129 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model public.incremental_prices .............. [[32mSELECT 1500[0m in 0.11s]
[0m22:53:47.951761 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:53:47.956546 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m22:53:47.957206 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:47.957795 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:53:47.960513 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:53:47.964355 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:47.964829 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:53:47.965732 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:53:47.967136 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:53:47.967516 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:47.967862 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:53:47.971173 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:53:47.974133 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:53:47.974962 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:47.975375 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:53:47.976070 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:53:47.977404 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:53:47.977961 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055b510d-e6d7-46eb-b8b7-f8af9df71049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58c609250>]}
[0m22:53:47.978527 [info ] [Thread-4 (]: 7 of 7 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.06s]
[0m22:53:47.979107 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:53:47.981655 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:47.982038 [debug] [MainThread]: On master: BEGIN
[0m22:53:47.982328 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:53:47.989983 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:53:47.990358 [debug] [MainThread]: On master: COMMIT
[0m22:53:47.990692 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:47.990963 [debug] [MainThread]: On master: COMMIT
[0m22:53:47.991350 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:53:47.991631 [debug] [MainThread]: On master: Close
[0m22:53:47.992201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:47.992576 [debug] [MainThread]: Connection 'model.airflow_dbt_training.housing_prices' was properly closed.
[0m22:53:47.992818 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:53:47.993068 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:53:47.993291 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:53:47.993746 [info ] [MainThread]: 
[0m22:53:47.994091 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m22:53:47.995820 [debug] [MainThread]: Command end result
[0m22:53:48.031458 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:53:48.032975 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:53:48.039146 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:53:48.039446 [info ] [MainThread]: 
[0m22:53:48.039799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:53:48.040148 [info ] [MainThread]: 
[0m22:53:48.040544 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m22:53:48.041797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2415516, "process_in_blocks": "88", "process_kernel_time": 0.207641, "process_mem_max_rss": "125108", "process_out_blocks": "2520", "process_user_time": 2.37304}
[0m22:53:48.042458 [debug] [MainThread]: Command `dbt run` succeeded at 22:53:48.042296 after 1.24 seconds
[0m22:53:48.042943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff59094cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff59094c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff59094c350>]}
[0m22:53:48.043418 [debug] [MainThread]: Flushing usage events
[0m22:53:48.769322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:51.398512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1c571b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1c566290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1d3dd190>]}


============================== 22:53:51.401178 | 62cc4ebf-2165-48e4-8b88-4f927929429f ==============================
[0m22:53:51.401178 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:53:51.401715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:53:51.548835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62cc4ebf-2165-48e4-8b88-4f927929429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1bd850d0>]}
[0m22:53:51.605467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62cc4ebf-2165-48e4-8b88-4f927929429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1ef85050>]}
[0m22:53:51.606169 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:53:51.686013 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m22:53:51.811367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:53:51.811713 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:53:51.862121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62cc4ebf-2165-48e4-8b88-4f927929429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1b1fe850>]}
[0m22:53:51.960950 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:53:51.963637 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:53:51.975541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62cc4ebf-2165-48e4-8b88-4f927929429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1b5bd5d0>]}
[0m22:53:51.976028 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m22:53:51.976348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62cc4ebf-2165-48e4-8b88-4f927929429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1c5de4d0>]}
[0m22:53:51.979358 [info ] [MainThread]: 
[0m22:53:51.979891 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:53:51.980348 [info ] [MainThread]: 
[0m22:53:51.981237 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:53:51.986956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m22:53:52.026202 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m22:53:52.026559 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:53:52.026960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:52.034477 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m22:53:52.035710 [debug] [ThreadPool]: On list_dwh: Close
[0m22:53:52.037446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m22:53:52.043886 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:53:52.044190 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m22:53:52.044426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:52.051020 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:53:52.051371 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m22:53:52.051792 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:53:52.054361 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m22:53:52.055766 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m22:53:52.056204 [debug] [ThreadPool]: On list_dwh_public: Close
[0m22:53:52.062756 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:52.063054 [debug] [MainThread]: On master: BEGIN
[0m22:53:52.063293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:52.069756 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:53:52.070094 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:52.070555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:53:52.075188 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m22:53:52.077776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62cc4ebf-2165-48e4-8b88-4f927929429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f19729390>]}
[0m22:53:52.078175 [debug] [MainThread]: On master: ROLLBACK
[0m22:53:52.078627 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:52.078903 [debug] [MainThread]: On master: BEGIN
[0m22:53:52.079481 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:53:52.079767 [debug] [MainThread]: On master: COMMIT
[0m22:53:52.080016 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:52.080256 [debug] [MainThread]: On master: COMMIT
[0m22:53:52.080714 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:53:52.080992 [debug] [MainThread]: On master: Close
[0m22:53:52.084326 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m22:53:52.084792 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m22:53:52.085322 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m22:53:52.085933 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m22:53:52.086578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m22:53:52.087052 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m22:53:52.087516 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m22:53:52.088372 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m22:53:52.088858 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m22:53:52.089423 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m22:53:52.090130 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m22:53:52.090707 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m22:53:52.100479 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m22:53:52.101193 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m22:53:52.101803 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m22:53:52.104179 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m22:53:52.104793 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m22:53:52.105271 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m22:53:52.105845 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m22:53:52.108757 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m22:53:52.109308 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m22:53:52.117998 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m22:53:52.129240 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m22:53:52.169543 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m22:53:52.172820 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m22:53:52.176826 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m22:53:52.177245 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m22:53:52.178279 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:53:52.178705 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:53:52.182695 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m22:53:52.183174 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:53:52.183620 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m22:53:52.184052 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m22:53:52.184755 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:53:52.185156 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m22:53:52.185563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:52.185977 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:53:52.186384 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m22:53:52.186793 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:53:52.187596 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:53:52.193604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:53:52.194371 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:53:52.195015 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:53:52.195714 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m22:53:52.196168 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:53:52.196775 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m22:53:52.197284 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:53:52.197707 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m22:53:52.198112 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m22:53:52.198746 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m22:53:52.199220 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:53:52.199730 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:53:52.200313 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m22:53:52.207654 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:53:52.208060 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m22:53:52.208756 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m22:53:52.209259 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m22:53:52.209681 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:53:52.213218 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:53:52.216777 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:53:52.217255 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:53:52.220625 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:53:52.221069 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m22:53:52.221554 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m22:53:52.224726 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:53:52.225216 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m22:53:52.225849 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m22:53:52.226630 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:53:52.227240 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:53:52.230319 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:53:52.230736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:53:52.231158 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m22:53:52.234242 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:53:52.234686 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m22:53:52.243072 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:53:52.251536 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m22:53:52.256900 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:53:52.257527 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m22:53:52.258100 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:53:52.258480 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:53:52.258916 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:53:52.259381 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m22:53:52.260869 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:53:52.261248 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:53:52.262621 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:53:52.263134 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:53:52.264533 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:53:52.264958 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:53:52.265387 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m22:53:52.265797 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:53:52.266174 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m22:53:52.266685 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m22:53:52.268368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:53:52.317325 [debug] [Thread-3 (]: SQL status: COMMIT in 0.050 seconds
[0m22:53:52.319473 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m22:53:52.319890 [debug] [Thread-2 (]: SQL status: COMMIT in 0.053 seconds
[0m22:53:52.320301 [debug] [Thread-4 (]: SQL status: COMMIT in 0.053 seconds
[0m22:53:52.322933 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m22:53:52.328424 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m22:53:52.331099 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m22:53:52.333652 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m22:53:52.334389 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m22:53:52.334793 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m22:53:52.335515 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m22:53:52.336188 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m22:53:52.336626 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m22:53:52.337129 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m22:53:52.337572 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m22:53:52.340681 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:53:52.343210 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m22:53:52.343762 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m22:53:52.346671 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m22:53:52.347186 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.009 seconds
[0m22:53:52.347522 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.009 seconds
[0m22:53:52.349193 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m22:53:52.349556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62cc4ebf-2165-48e4-8b88-4f927929429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1a981810>]}
[0m22:53:52.349966 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62cc4ebf-2165-48e4-8b88-4f927929429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1b9585d0>]}
[0m22:53:52.351198 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m22:53:52.351961 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.26s]
[0m22:53:52.352520 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62cc4ebf-2165-48e4-8b88-4f927929429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1a9803d0>]}
[0m22:53:52.353182 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.26s]
[0m22:53:52.354348 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m22:53:52.355339 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62cc4ebf-2165-48e4-8b88-4f927929429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1bdaee50>]}
[0m22:53:52.356217 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m22:53:52.356935 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m22:53:52.357703 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m22:53:52.359018 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m22:53:52.358410 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m22:53:52.359754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m22:53:52.360728 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m22:53:52.361166 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m22:53:52.361594 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m22:53:52.362418 [info ] [Thread-2 (]: 5 of 7 START sql view model public.region_type_composition ..................... [RUN]
[0m22:53:52.366227 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m22:53:52.366912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition)
[0m22:53:52.367715 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m22:53:52.371203 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m22:53:52.372141 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m22:53:52.372757 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m22:53:52.373602 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m22:53:52.377914 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m22:53:52.378556 [info ] [Thread-4 (]: 6 of 7 START sql incremental model public.incremental_prices ................... [RUN]
[0m22:53:52.379609 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m22:53:52.380102 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m22:53:52.386023 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:53:52.391733 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m22:53:52.393596 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m22:53:52.394075 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:53:52.394861 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m22:53:52.411443 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m22:53:52.417139 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:53:52.422816 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m22:53:52.440977 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m22:53:52.443460 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:53:52.448105 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:53:52.448638 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp225352426715"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m22:53:52.449142 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m22:53:52.449588 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:53:52.450427 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:53:52.451759 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:53:52.452122 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:53:52.452465 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m22:53:52.455611 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:53:52.458441 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m22:53:52.459050 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m22:53:52.459408 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m22:53:52.459971 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:53:52.461205 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m22:53:52.461623 [debug] [Thread-4 (]: SQL status: SELECT 1500 in 0.012 seconds
[0m22:53:52.467330 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62cc4ebf-2165-48e4-8b88-4f927929429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f197188d0>]}
[0m22:53:52.476592 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:53:52.477719 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m22:53:52.477325 [info ] [Thread-2 (]: 5 of 7 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.10s]
[0m22:53:52.478591 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m22:53:52.479450 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m22:53:52.480318 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:53:52.480820 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp225352426715'
        
      order by ordinal_position

  
[0m22:53:52.481400 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:53:52.482411 [info ] [Thread-1 (]: 7 of 7 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m22:53:52.483466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m22:53:52.484053 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:53:52.492845 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:52.493371 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.012 seconds
[0m22:53:52.499855 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:53:52.500472 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:53:52.501276 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:53:52.505528 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:52.505993 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.005 seconds
[0m22:53:52.515148 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:53:52.515637 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:53:52.516193 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:52.516550 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m22:53:52.516855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:52.518395 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m22:53:52.527096 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m22:53:52.527817 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:53:52.528221 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp225352426715"
    )


  
[0m22:53:52.528687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m22:53:52.529170 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:52.529621 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m22:53:52.530137 [debug] [Thread-4 (]: SQL status: INSERT 0 1500 in 0.002 seconds
[0m22:53:52.531565 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:53:52.531923 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m22:53:52.532260 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m22:53:52.532670 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:53:52.535886 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:52.536306 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m22:53:52.536732 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m22:53:52.537563 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m22:53:52.538273 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62cc4ebf-2165-48e4-8b88-4f927929429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1bd845d0>]}
[0m22:53:52.538891 [info ] [Thread-4 (]: 6 of 7 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 1500[0m in 0.16s]
[0m22:53:52.539493 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m22:53:52.540085 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:53:52.541605 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:53:52.541988 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:52.542350 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m22:53:52.545721 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:53:52.548765 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m22:53:52.549564 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m22:53:52.550023 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m22:53:52.550721 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:53:52.552020 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m22:53:52.552590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62cc4ebf-2165-48e4-8b88-4f927929429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1c57e9d0>]}
[0m22:53:52.553153 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.07s]
[0m22:53:52.553805 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m22:53:52.556131 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:52.556524 [debug] [MainThread]: On master: BEGIN
[0m22:53:52.556810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:53:52.563589 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:53:52.564047 [debug] [MainThread]: On master: COMMIT
[0m22:53:52.564444 [debug] [MainThread]: Using postgres connection "master"
[0m22:53:52.564788 [debug] [MainThread]: On master: COMMIT
[0m22:53:52.565272 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:53:52.565564 [debug] [MainThread]: On master: Close
[0m22:53:52.565974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:52.566212 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m22:53:52.566452 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m22:53:52.566706 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_example' was properly closed.
[0m22:53:52.566997 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m22:53:52.567452 [info ] [MainThread]: 
[0m22:53:52.567817 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m22:53:52.569545 [debug] [MainThread]: Command end result
[0m22:53:52.605397 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m22:53:52.606938 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m22:53:52.612875 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m22:53:52.613165 [info ] [MainThread]: 
[0m22:53:52.613620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:53:52.613920 [info ] [MainThread]: 
[0m22:53:52.614282 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m22:53:52.615447 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2665956, "process_in_blocks": "0", "process_kernel_time": 0.202181, "process_mem_max_rss": "122812", "process_out_blocks": "2416", "process_user_time": 2.355415}
[0m22:53:52.615965 [debug] [MainThread]: Command `dbt run` succeeded at 22:53:52.615863 after 1.27 seconds
[0m22:53:52.616327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1d284750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f1c7cb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f208c4fd0>]}
[0m22:53:52.616675 [debug] [MainThread]: Flushing usage events
[0m22:53:53.221435 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:05.201295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc847b13210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc848834e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc847b12e10>]}


============================== 23:00:05.206632 | 83bac6f2-dbb5-4d64-b6d0-18566135589f ==============================
[0m23:00:05.206632 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:00:05.207160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:00:05.216551 [info ] [MainThread]: dbt version: 1.9.4
[0m23:00:05.216972 [info ] [MainThread]: python version: 3.11.12
[0m23:00:05.217435 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m23:00:05.217976 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m23:00:05.266304 [info ] [MainThread]: Using profiles dir at /dbt
[0m23:00:05.266738 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m23:00:05.267204 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m23:00:05.267975 [info ] [MainThread]: adapter type: postgres
[0m23:00:05.268508 [info ] [MainThread]: adapter version: 1.9.0
[0m23:00:05.367501 [info ] [MainThread]: Configuration:
[0m23:00:05.367918 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:00:05.368198 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:00:05.368642 [info ] [MainThread]: Required dependencies:
[0m23:00:05.369074 [debug] [MainThread]: Executing "git --help"
[0m23:00:05.370956 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:00:05.371511 [debug] [MainThread]: STDERR: "b''"
[0m23:00:05.371804 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:00:05.372125 [info ] [MainThread]: Connection:
[0m23:00:05.372547 [info ] [MainThread]:   host: dwh
[0m23:00:05.372954 [info ] [MainThread]:   port: 5432
[0m23:00:05.373315 [info ] [MainThread]:   user: airflow
[0m23:00:05.373732 [info ] [MainThread]:   database: dwh
[0m23:00:05.374105 [info ] [MainThread]:   schema: public
[0m23:00:05.374445 [info ] [MainThread]:   connect_timeout: 10
[0m23:00:05.374779 [info ] [MainThread]:   role: None
[0m23:00:05.375166 [info ] [MainThread]:   search_path: None
[0m23:00:05.375435 [info ] [MainThread]:   keepalives_idle: 0
[0m23:00:05.375714 [info ] [MainThread]:   sslmode: None
[0m23:00:05.375983 [info ] [MainThread]:   sslcert: None
[0m23:00:05.376375 [info ] [MainThread]:   sslkey: None
[0m23:00:05.376688 [info ] [MainThread]:   sslrootcert: None
[0m23:00:05.377055 [info ] [MainThread]:   application_name: dbt
[0m23:00:05.377448 [info ] [MainThread]:   retries: 1
[0m23:00:05.378100 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:00:05.446518 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:00:05.471914 [debug] [MainThread]: Using postgres connection "debug"
[0m23:00:05.472267 [debug] [MainThread]: On debug: select 1 as id
[0m23:00:05.472511 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:05.480053 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m23:00:05.480969 [debug] [MainThread]: On debug: Close
[0m23:00:05.481313 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:00:05.481611 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:00:05.482459 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.33226675, "process_in_blocks": "0", "process_kernel_time": 0.120418, "process_mem_max_rss": "111804", "process_out_blocks": "1704", "process_user_time": 1.555403}
[0m23:00:05.482938 [debug] [MainThread]: Command `dbt debug` succeeded at 23:00:05.482837 after 0.33 seconds
[0m23:00:05.483236 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:00:05.483733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc847b3d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc847b3d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc84713c390>]}
[0m23:00:05.484160 [debug] [MainThread]: Flushing usage events
[0m23:00:06.148393 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:07.881899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce88a9e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce888efd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce888efdd0>]}


============================== 23:00:07.884589 | ef78a7f1-02d8-4e1c-9463-24849963359b ==============================
[0m23:00:07.884589 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:00:07.895146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:00:08.041246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef78a7f1-02d8-4e1c-9463-24849963359b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8894bcd0>]}
[0m23:00:08.097581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef78a7f1-02d8-4e1c-9463-24849963359b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8b309c10>]}
[0m23:00:08.098360 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:00:08.176138 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:00:08.300943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:00:08.301303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:00:08.351574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef78a7f1-02d8-4e1c-9463-24849963359b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce875bfd10>]}
[0m23:00:08.448461 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:00:08.451246 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:00:08.469040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef78a7f1-02d8-4e1c-9463-24849963359b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce881ec610>]}
[0m23:00:08.469524 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m23:00:08.469835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef78a7f1-02d8-4e1c-9463-24849963359b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce87933e10>]}
[0m23:00:08.473856 [info ] [MainThread]: 
[0m23:00:08.474661 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:00:08.475214 [info ] [MainThread]: 
[0m23:00:08.476172 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:00:08.483847 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:00:08.523611 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:00:08.523978 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:00:08.524238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:08.531782 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m23:00:08.533017 [debug] [ThreadPool]: On list_dwh: Close
[0m23:00:08.534814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:00:08.541174 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:00:08.541507 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:00:08.541743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:08.548385 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:00:08.548741 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:00:08.549338 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:00:08.552164 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m23:00:08.553462 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:00:08.553920 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:00:08.559594 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:08.559898 [debug] [MainThread]: On master: BEGIN
[0m23:00:08.560174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:08.566956 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:00:08.567332 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:08.567802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:00:08.571380 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m23:00:08.572582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef78a7f1-02d8-4e1c-9463-24849963359b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce87933f90>]}
[0m23:00:08.573035 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:08.573521 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:08.573792 [debug] [MainThread]: On master: BEGIN
[0m23:00:08.574402 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:00:08.574668 [debug] [MainThread]: On master: COMMIT
[0m23:00:08.574919 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:08.575224 [debug] [MainThread]: On master: COMMIT
[0m23:00:08.575683 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:00:08.576112 [debug] [MainThread]: On master: Close
[0m23:00:08.581140 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:00:08.581638 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:00:08.582242 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m23:00:08.582870 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m23:00:08.583568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:00:08.584110 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:00:08.584872 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:00:08.585352 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:00:08.585994 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:00:08.586924 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m23:00:08.587669 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:00:08.588510 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m23:00:08.599086 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:00:08.599860 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:00:08.602108 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:00:08.602602 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:00:08.603260 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:00:08.604004 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:00:08.604461 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:00:08.604930 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:00:08.607418 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:00:08.610466 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:00:08.668557 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:00:08.674674 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:00:08.677439 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:00:08.681450 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:00:08.682091 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:00:08.682590 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:00:08.686892 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:00:08.687309 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:00:08.687754 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:00:08.688220 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:00:08.688823 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:00:08.689297 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:00:08.689721 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:00:08.690128 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:00:08.690527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:08.690971 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:00:08.691586 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:00:08.692190 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:00:08.697962 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:00:08.698572 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:00:08.699268 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:00:08.699833 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:00:08.700451 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:00:08.701369 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:00:08.702351 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m23:00:08.703202 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:00:08.703821 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:00:08.704339 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:00:08.704688 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:00:08.705229 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:00:08.705870 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m23:00:08.711572 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:00:08.713190 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:00:08.717061 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:00:08.717625 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:00:08.718048 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:00:08.718483 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:00:08.718991 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:00:08.722164 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:00:08.725398 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:00:08.725988 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:00:08.726382 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:00:08.726804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:08.727191 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:00:08.733017 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:00:08.753625 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:00:08.754217 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:00:08.756343 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:00:08.756776 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:00:08.757373 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:00:08.757767 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m23:00:08.758178 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:00:08.758702 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:00:08.760017 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:00:08.760425 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:00:08.760836 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:00:08.761258 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:00:08.762002 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:00:08.762465 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m23:00:08.769060 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:00:08.769597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m23:00:08.774851 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:00:08.775256 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m23:00:08.775748 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m23:00:08.778333 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:00:08.778771 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:00:08.781317 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:00:08.784907 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:00:08.785626 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:00:08.786527 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:00:08.787211 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:00:08.787591 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:00:08.788036 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:00:08.788473 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:00:08.788920 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:00:08.791238 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:00:08.792077 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:00:08.792455 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:00:08.792828 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:00:08.794339 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:00:08.796972 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:00:08.797312 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef78a7f1-02d8-4e1c-9463-24849963359b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce85be3a10>]}
[0m23:00:08.798542 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:00:08.799322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef78a7f1-02d8-4e1c-9463-24849963359b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce84228090>]}
[0m23:00:08.800023 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m23:00:08.800570 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef78a7f1-02d8-4e1c-9463-24849963359b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce84228b50>]}
[0m23:00:08.801167 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef78a7f1-02d8-4e1c-9463-24849963359b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce84203210>]}
[0m23:00:08.801845 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.22s]
[0m23:00:08.802658 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:00:08.803654 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m23:00:08.804988 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m23:00:08.806221 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:00:08.807254 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:00:08.807968 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:00:08.808916 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:00:08.809850 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m23:00:08.810522 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:00:08.811133 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:00:08.811823 [info ] [Thread-1 (]: 5 of 7 START sql view model public.region_type_composition ..................... [RUN]
[0m23:00:08.863083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.region_type_composition)
[0m23:00:08.863525 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:00:08.866787 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:00:08.867685 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:00:08.868618 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:00:08.869304 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:00:08.873090 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:00:08.873732 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:00:08.874356 [info ] [Thread-4 (]: 6 of 7 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:00:08.875045 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m23:00:08.875574 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:00:08.884327 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:00:08.884982 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:00:08.885702 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:00:08.886109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:08.886720 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:00:08.903601 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m23:00:08.904120 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:00:08.909704 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:00:08.917530 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:00:08.926125 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:00:08.931941 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m23:00:08.937947 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:00:08.940683 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:00:08.942052 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:00:08.942688 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:00:08.943060 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:00:08.943564 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:00:08.944052 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:00:08.944375 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:00:08.946938 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:00:08.949665 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m23:00:08.950295 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:00:08.950646 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m23:00:08.951302 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:00:08.952859 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:00:08.953282 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:00:08.953729 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:00:08.954285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef78a7f1-02d8-4e1c-9463-24849963359b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce84201550>]}
[0m23:00:08.954770 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      
  
    

  create  table "dwh"."public"."incremental_prices"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

  );
  
  
[0m23:00:08.955592 [info ] [Thread-1 (]: 5 of 7 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.09s]
[0m23:00:08.956441 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:00:08.957287 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:00:08.957870 [info ] [Thread-2 (]: 7 of 7 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m23:00:08.958363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m23:00:08.958808 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:00:08.967314 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:08.967841 [debug] [Thread-4 (]: SQL status: SELECT 1500 in 0.012 seconds
[0m23:00:08.973541 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:00:08.974064 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:00:08.974454 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:00:08.975103 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:00:08.979433 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:08.980055 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m23:00:08.980972 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:00:08.981573 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:08.981973 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m23:00:08.982517 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef78a7f1-02d8-4e1c-9463-24849963359b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce85c8d850>]}
[0m23:00:08.982916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:08.983617 [info ] [Thread-4 (]: 6 of 7 OK created sql incremental model public.incremental_prices .............. [[32mSELECT 1500[0m in 0.11s]
[0m23:00:08.984493 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:00:08.990652 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:00:08.991202 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:08.991631 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m23:00:08.994887 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:00:09.000183 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:09.000657 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m23:00:09.001495 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:09.002829 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:00:09.003195 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:09.003518 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:00:09.006432 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:00:09.009326 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m23:00:09.009940 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:09.010312 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m23:00:09.010991 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:00:09.012342 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m23:00:09.012894 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef78a7f1-02d8-4e1c-9463-24849963359b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce88a9cf90>]}
[0m23:00:09.013496 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.05s]
[0m23:00:09.014090 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:00:09.016453 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:09.016874 [debug] [MainThread]: On master: BEGIN
[0m23:00:09.017164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:09.024629 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:00:09.025102 [debug] [MainThread]: On master: COMMIT
[0m23:00:09.025492 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:09.026039 [debug] [MainThread]: On master: COMMIT
[0m23:00:09.026508 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:00:09.026815 [debug] [MainThread]: On master: Close
[0m23:00:09.027250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:09.027491 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:00:09.027717 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m23:00:09.027964 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_example' was properly closed.
[0m23:00:09.028185 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:00:09.028612 [info ] [MainThread]: 
[0m23:00:09.029084 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m23:00:09.031087 [debug] [MainThread]: Command end result
[0m23:00:09.066971 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:00:09.068522 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:00:09.074457 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:00:09.074746 [info ] [MainThread]: 
[0m23:00:09.075135 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:00:09.075422 [info ] [MainThread]: 
[0m23:00:09.075776 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:00:09.077077 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2468889, "process_in_blocks": "0", "process_kernel_time": 0.179339, "process_mem_max_rss": "123712", "process_out_blocks": "2520", "process_user_time": 2.32145}
[0m23:00:09.077623 [debug] [MainThread]: Command `dbt run` succeeded at 23:00:09.077508 after 1.25 seconds
[0m23:00:09.078001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8cc5cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8cc5c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8cc5ccd0>]}
[0m23:00:09.078359 [debug] [MainThread]: Flushing usage events
[0m23:00:09.736217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:11.536015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f749a0520d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7497bcfbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7497bcffd0>]}


============================== 23:00:11.538806 | 5253f3aa-c842-45c6-80ec-fd294c0680a2 ==============================
[0m23:00:11.538806 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:00:11.539341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:00:11.697085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5253f3aa-c842-45c6-80ec-fd294c0680a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7497385610>]}
[0m23:00:11.756844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5253f3aa-c842-45c6-80ec-fd294c0680a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f749a597450>]}
[0m23:00:11.757631 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:00:11.843325 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:00:11.974214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:00:11.974607 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:00:12.032462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5253f3aa-c842-45c6-80ec-fd294c0680a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7496718190>]}
[0m23:00:12.143006 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:00:12.146086 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:00:12.161914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5253f3aa-c842-45c6-80ec-fd294c0680a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7496bf6750>]}
[0m23:00:12.162600 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m23:00:12.163221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5253f3aa-c842-45c6-80ec-fd294c0680a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7499753a10>]}
[0m23:00:12.166811 [info ] [MainThread]: 
[0m23:00:12.167374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:00:12.167859 [info ] [MainThread]: 
[0m23:00:12.168877 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:00:12.175491 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:00:12.217906 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:00:12.218289 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:00:12.218584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:12.226642 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m23:00:12.228015 [debug] [ThreadPool]: On list_dwh: Close
[0m23:00:12.230102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:00:12.237397 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:00:12.237771 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:00:12.238045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:12.245253 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:00:12.246096 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:00:12.246697 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:00:12.249468 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m23:00:12.251090 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:00:12.251702 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:00:12.258993 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:12.259394 [debug] [MainThread]: On master: BEGIN
[0m23:00:12.259637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:12.266418 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:00:12.266832 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:12.267782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:00:12.272818 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m23:00:12.275609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5253f3aa-c842-45c6-80ec-fd294c0680a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74973fd090>]}
[0m23:00:12.276078 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:12.276611 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:12.276885 [debug] [MainThread]: On master: BEGIN
[0m23:00:12.277479 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:00:12.277747 [debug] [MainThread]: On master: COMMIT
[0m23:00:12.278013 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:12.278315 [debug] [MainThread]: On master: COMMIT
[0m23:00:12.278815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:00:12.279156 [debug] [MainThread]: On master: Close
[0m23:00:12.282671 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:00:12.283257 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:00:12.284228 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:00:12.283856 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m23:00:12.284897 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:00:12.285580 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m23:00:12.286211 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m23:00:12.287371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:00:12.288126 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m23:00:12.288815 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:00:12.289475 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:00:12.290009 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:00:12.290590 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:00:12.291044 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:00:12.291485 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:00:12.297286 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:00:12.301965 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:00:12.304837 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:00:12.307594 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:00:12.311375 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:00:12.312722 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:00:12.324568 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:00:12.341003 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:00:12.346874 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:00:12.384682 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:00:12.385506 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:00:12.390392 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:00:12.390890 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:00:12.392619 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:00:12.393268 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:00:12.393884 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:00:12.394335 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:00:12.394787 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:00:12.395223 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:00:12.395616 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:00:12.396138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:12.396691 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:00:12.397127 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:00:12.397532 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:00:12.398204 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:00:12.405452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:00:12.406305 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:00:12.407249 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:00:12.407918 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m23:00:12.409368 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:00:12.410194 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m23:00:12.410740 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:00:12.411355 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:00:12.412181 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m23:00:12.412969 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:00:12.413411 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:00:12.421843 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:00:12.422498 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:00:12.423006 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:00:12.423485 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:00:12.423900 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:00:12.428570 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:00:12.429242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:00:12.429648 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:00:12.430090 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:00:12.430499 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m23:00:12.434034 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:00:12.437477 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:00:12.441034 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:00:12.441582 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:00:12.442128 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:00:12.442503 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:12.442952 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:00:12.446508 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:00:12.447103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:00:12.447482 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:00:12.447994 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:00:12.448439 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:12.467407 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:00:12.469981 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:00:12.473450 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:00:12.473916 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:00:12.474337 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:00:12.474768 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:00:12.475203 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:00:12.476716 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:00:12.477152 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:00:12.477525 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:00:12.478058 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:00:12.479531 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:00:12.479928 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:00:12.480365 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:00:12.480808 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:00:12.482197 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:00:12.484264 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:00:12.484780 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:00:12.485229 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:00:12.537582 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:00:12.538146 [debug] [Thread-4 (]: SQL status: COMMIT in 0.053 seconds
[0m23:00:12.538592 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:00:12.544327 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m23:00:12.547261 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:00:12.547593 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:00:12.550646 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:00:12.551116 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:00:12.551822 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:00:12.552243 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:00:12.553017 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:00:12.555685 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:00:12.556169 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:00:12.556682 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:00:12.557378 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:00:12.558013 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:00:12.559965 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:00:12.562477 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:00:12.562932 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:00:12.563435 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:00:12.566490 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:00:12.567052 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.009 seconds
[0m23:00:12.567469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5253f3aa-c842-45c6-80ec-fd294c0680a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7495f77f90>]}
[0m23:00:12.568836 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:00:12.570220 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:00:12.570729 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5253f3aa-c842-45c6-80ec-fd294c0680a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f749739ea10>]}
[0m23:00:12.571481 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.28s]
[0m23:00:12.572457 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5253f3aa-c842-45c6-80ec-fd294c0680a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7494dcb3d0>]}
[0m23:00:12.573324 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5253f3aa-c842-45c6-80ec-fd294c0680a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7497bbb150>]}
[0m23:00:12.574156 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.28s]
[0m23:00:12.575025 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:00:12.575783 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.28s]
[0m23:00:12.576597 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.28s]
[0m23:00:12.577370 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:00:12.578651 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:00:12.579256 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:00:12.579942 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:00:12.580821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m23:00:12.581689 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:00:12.582104 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:00:12.586244 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:00:12.587031 [info ] [Thread-2 (]: 5 of 7 START sql view model public.region_type_composition ..................... [RUN]
[0m23:00:12.587996 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition)
[0m23:00:12.588469 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:00:12.592203 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:00:12.593307 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:00:12.593777 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:00:12.598722 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:00:12.599345 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:00:12.600561 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:00:12.600168 [info ] [Thread-4 (]: 6 of 7 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:00:12.601059 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:00:12.601565 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m23:00:12.602096 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:12.602649 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:00:12.617530 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:00:12.618101 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m23:00:12.618741 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:00:12.619157 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:00:12.619737 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:00:12.632195 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m23:00:12.646239 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:00:12.651941 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m23:00:12.664345 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m23:00:12.670907 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:00:12.675605 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:00:12.676063 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:00:12.676582 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp230012655355"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:00:12.677088 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:00:12.677503 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:00:12.680366 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:00:12.683204 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m23:00:12.683828 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:00:12.684304 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m23:00:12.684867 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:00:12.686222 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:00:12.686784 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5253f3aa-c842-45c6-80ec-fd294c0680a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7494e7f950>]}
[0m23:00:12.687379 [info ] [Thread-2 (]: 5 of 7 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.10s]
[0m23:00:12.687966 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:00:12.688754 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:00:12.689744 [debug] [Thread-4 (]: SQL status: SELECT 1500 in 0.012 seconds
[0m23:00:12.689295 [info ] [Thread-1 (]: 7 of 7 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m23:00:12.695775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m23:00:12.707285 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:00:12.707812 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:00:12.708295 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:00:12.716760 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:12.717283 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m23:00:12.717951 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:00:12.718445 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp230012655355'
        
      order by ordinal_position

  
[0m23:00:12.718942 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:00:12.723254 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:12.723912 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:12.724290 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m23:00:12.724612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:12.725136 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.006 seconds
[0m23:00:12.730861 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:00:12.731364 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:00:12.732241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:00:12.732587 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:12.733113 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m23:00:12.734592 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:00:12.741164 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:00:12.743876 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:00:12.747043 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:12.747540 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:00:12.748049 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m23:00:12.749030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:12.750340 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:00:12.750683 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:12.751024 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:00:12.751508 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:00:12.759091 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m23:00:12.760515 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:00:12.763249 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m23:00:12.764132 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:00:12.764545 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m23:00:12.765097 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:00:12.765542 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp230012655355"
    )


  
[0m23:00:12.766023 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:00:12.767326 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m23:00:12.767745 [debug] [Thread-4 (]: SQL status: INSERT 0 1500 in 0.002 seconds
[0m23:00:12.769024 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:00:12.769401 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:00:12.769741 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:00:12.770372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5253f3aa-c842-45c6-80ec-fd294c0680a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7497f61290>]}
[0m23:00:12.770963 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.07s]
[0m23:00:12.771570 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:00:12.772663 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m23:00:12.773516 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:00:12.774149 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5253f3aa-c842-45c6-80ec-fd294c0680a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7496bbd350>]}
[0m23:00:12.774809 [info ] [Thread-4 (]: 6 of 7 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 1500[0m in 0.17s]
[0m23:00:12.775536 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:00:12.777652 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:12.778128 [debug] [MainThread]: On master: BEGIN
[0m23:00:12.778482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:12.785472 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:00:12.786146 [debug] [MainThread]: On master: COMMIT
[0m23:00:12.786727 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:12.787233 [debug] [MainThread]: On master: COMMIT
[0m23:00:12.787915 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:00:12.788244 [debug] [MainThread]: On master: Close
[0m23:00:12.788679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:12.788916 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m23:00:12.789139 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:00:12.789372 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_example' was properly closed.
[0m23:00:12.789596 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:00:12.790011 [info ] [MainThread]: 
[0m23:00:12.790391 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m23:00:12.792185 [debug] [MainThread]: Command end result
[0m23:00:12.827444 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:00:12.828975 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:00:12.835095 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:00:12.835381 [info ] [MainThread]: 
[0m23:00:12.835746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:00:12.836033 [info ] [MainThread]: 
[0m23:00:12.836342 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:00:12.837458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3513325, "process_in_blocks": "0", "process_kernel_time": 0.190594, "process_mem_max_rss": "122908", "process_out_blocks": "2416", "process_user_time": 2.467694}
[0m23:00:12.837910 [debug] [MainThread]: Command `dbt run` succeeded at 23:00:12.837796 after 1.35 seconds
[0m23:00:12.838240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7497db34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7497db3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f749bed4e90>]}
[0m23:00:12.838615 [debug] [MainThread]: Flushing usage events
[0m23:00:13.583479 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:07:57.419763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9403eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde93f69990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9455ad90>]}


============================== 23:07:57.422554 | 50f9a8a9-4d77-46b3-8543-c209e5436703 ==============================
[0m23:07:57.422554 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:07:57.423056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:07:57.574053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50f9a8a9-4d77-46b3-8543-c209e5436703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde93e76dd0>]}
[0m23:07:57.633333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50f9a8a9-4d77-46b3-8543-c209e5436703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde968ad910>]}
[0m23:07:57.634121 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:07:57.712672 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:07:57.843322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:07:57.843723 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:07:57.901171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50f9a8a9-4d77-46b3-8543-c209e5436703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde92797390>]}
[0m23:07:58.004424 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:07:58.007016 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:07:58.020249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50f9a8a9-4d77-46b3-8543-c209e5436703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde93382310>]}
[0m23:07:58.020889 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 433 macros
[0m23:07:58.021285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f9a8a9-4d77-46b3-8543-c209e5436703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde92b41990>]}
[0m23:07:58.023948 [info ] [MainThread]: 
[0m23:07:58.024350 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:58.024619 [info ] [MainThread]: 
[0m23:07:58.025258 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:07:58.030757 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:07:58.070694 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:07:58.071071 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:07:58.071375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:58.079060 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m23:07:58.080390 [debug] [ThreadPool]: On list_dwh: Close
[0m23:07:58.082355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:07:58.088801 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:07:58.089113 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:07:58.089388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:58.095857 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:07:58.096196 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:07:58.096786 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:07:58.099902 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m23:07:58.101369 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:07:58.101788 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:07:58.108586 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:58.108890 [debug] [MainThread]: On master: BEGIN
[0m23:07:58.109123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:58.115823 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:07:58.116177 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:58.116817 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:07:58.121391 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m23:07:58.124136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f9a8a9-4d77-46b3-8543-c209e5436703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde93382990>]}
[0m23:07:58.124570 [debug] [MainThread]: On master: ROLLBACK
[0m23:07:58.125039 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:58.125321 [debug] [MainThread]: On master: BEGIN
[0m23:07:58.125911 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:07:58.126176 [debug] [MainThread]: On master: COMMIT
[0m23:07:58.126555 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:58.126896 [debug] [MainThread]: On master: COMMIT
[0m23:07:58.127365 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:07:58.127639 [debug] [MainThread]: On master: Close
[0m23:07:58.131849 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:07:58.132324 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:07:58.132902 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m23:07:58.133527 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m23:07:58.134170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:07:58.134627 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:07:58.135493 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:07:58.135982 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:07:58.136466 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:07:58.137075 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m23:07:58.137598 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:07:58.138164 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m23:07:58.147632 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:07:58.148662 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:07:58.151197 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:07:58.151965 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:07:58.152560 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:07:58.153248 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:07:58.156142 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:07:58.156632 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:07:58.157013 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:07:58.160493 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:07:58.208512 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:07:58.212626 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:07:58.216758 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:07:58.219477 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:07:58.220561 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:07:58.221188 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:07:58.222124 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:07:58.222536 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:07:58.222961 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:07:58.227294 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:07:58.227772 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:07:58.228213 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:07:58.228614 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:07:58.229501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:58.229969 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:07:58.230388 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:07:58.230997 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:07:58.231578 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:07:58.235541 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:07:58.236257 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:07:58.236801 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:07:58.237722 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:07:58.238221 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:07:58.238749 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:07:58.239467 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:07:58.239876 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:07:58.248109 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:07:58.248530 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:07:58.248909 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:07:58.249334 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m23:07:58.249763 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:07:58.253191 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:07:58.253691 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:07:58.254154 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:07:58.254682 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:07:58.255410 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type
FROM source
  );
[0m23:07:58.255972 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:07:58.256354 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:07:58.259899 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:07:58.260522 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:07:58.264312 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:07:58.264791 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m23:07:58.265253 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:07:58.268648 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:07:58.269105 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:07:58.272260 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:07:58.272799 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m23:07:58.273312 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:07:58.273753 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:07:58.274167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:07:58.280122 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:07:58.283819 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:07:58.297325 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m23:07:58.300666 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:07:58.296898 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:07:58.301274 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:07:58.302622 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:07:58.303059 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:07:58.303538 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:07:58.304031 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:07:58.304483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:07:58.304976 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:07:58.305428 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:07:58.306881 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:07:58.307292 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:07:58.307903 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:07:58.309264 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:07:58.309663 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:07:58.310123 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:07:58.310633 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:07:58.314546 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m23:07:58.363827 [debug] [Thread-3 (]: SQL status: COMMIT in 0.056 seconds
[0m23:07:58.365751 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:07:58.366197 [debug] [Thread-1 (]: SQL status: COMMIT in 0.056 seconds
[0m23:07:58.366586 [debug] [Thread-4 (]: SQL status: COMMIT in 0.056 seconds
[0m23:07:58.369262 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:07:58.377214 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:07:58.377591 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:07:58.380198 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:07:58.380884 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:07:58.381662 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:07:58.382107 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:07:58.382780 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:07:58.383215 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:07:58.383704 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:07:58.384253 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:07:58.387588 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:07:58.389926 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:07:58.390426 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:07:58.390818 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:07:58.392611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50f9a8a9-4d77-46b3-8543-c209e5436703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde93ebf250>]}
[0m23:07:58.393090 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.008 seconds
[0m23:07:58.394476 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:07:58.395665 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:07:58.396436 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.26s]
[0m23:07:58.398139 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:07:58.399056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50f9a8a9-4d77-46b3-8543-c209e5436703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde92b9ced0>]}
[0m23:07:58.399733 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50f9a8a9-4d77-46b3-8543-c209e5436703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9337c090>]}
[0m23:07:58.400623 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:07:58.401387 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50f9a8a9-4d77-46b3-8543-c209e5436703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde93365fd0>]}
[0m23:07:58.402505 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.26s]
[0m23:07:58.403944 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m23:07:58.405882 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m23:07:58.407061 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:07:58.407893 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:07:58.408703 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:07:58.410416 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:07:58.411368 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:07:58.412313 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m23:07:58.412993 [info ] [Thread-3 (]: 5 of 7 START sql view model public.region_type_composition ..................... [RUN]
[0m23:07:58.413617 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:07:58.414276 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m23:07:58.418467 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:07:58.419125 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:07:58.423454 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:07:58.424575 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:07:58.425318 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:07:58.425937 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:07:58.426976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.incremental_prices)
[0m23:07:58.427788 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:07:58.428454 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:07:58.433700 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:07:58.447651 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:07:58.448472 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:07:58.448845 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:07:58.449163 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:07:58.449747 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:07:58.466851 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m23:07:58.472478 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:07:58.479589 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:07:58.492277 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:07:58.495808 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:07:58.496219 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m23:07:58.502195 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:07:58.508692 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:07:58.509130 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:07:58.509467 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:07:58.510897 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:07:58.511308 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp230758485435"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:07:58.511800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:58.518609 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m23:07:58.521456 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m23:07:58.522080 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:07:58.522421 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m23:07:58.523018 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:07:58.524365 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:07:58.524919 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50f9a8a9-4d77-46b3-8543-c209e5436703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde945aaad0>]}
[0m23:07:58.525539 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.11s]
[0m23:07:58.526505 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:07:58.527477 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:07:58.528135 [info ] [Thread-2 (]: 7 of 7 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m23:07:58.528663 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m23:07:58.529150 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:07:58.538126 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:07:58.538802 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:07:58.543199 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:07:58.543855 [debug] [Thread-1 (]: SQL status: SELECT 10500 in 0.032 seconds
[0m23:07:58.549553 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:07:58.559808 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:07:58.560526 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m23:07:58.561028 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:07:58.561488 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:07:58.562171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:07:58.562550 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:07:58.563194 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp230758485435'
        
      order by ordinal_position

  
[0m23:07:58.568456 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:07:58.568955 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:07:58.569527 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m23:07:58.570050 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m23:07:58.576036 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:07:58.576667 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:07:58.578576 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:07:58.582054 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:07:58.582510 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:07:58.582959 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m23:07:58.592234 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:07:58.592783 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:07:58.593257 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:07:58.594806 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:07:58.595206 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:07:58.595528 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:07:58.596080 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:07:58.605040 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:07:58.605524 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m23:07:58.608522 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m23:07:58.608994 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:07:58.609777 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:07:58.610251 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp230758485435"
    )


  
[0m23:07:58.610741 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m23:07:58.611461 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:07:58.612761 [debug] [Thread-2 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m23:07:58.613333 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50f9a8a9-4d77-46b3-8543-c209e5436703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde91171b10>]}
[0m23:07:58.613924 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.08s]
[0m23:07:58.614510 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:07:58.617664 [debug] [Thread-1 (]: SQL status: INSERT 0 10500 in 0.006 seconds
[0m23:07:58.619358 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:07:58.619747 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:07:58.620099 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:07:58.630334 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m23:07:58.631247 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:07:58.631814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50f9a8a9-4d77-46b3-8543-c209e5436703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde910f4410>]}
[0m23:07:58.632415 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 10500[0m in 0.20s]
[0m23:07:58.633209 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:07:58.635781 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:58.636161 [debug] [MainThread]: On master: BEGIN
[0m23:07:58.636407 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:07:58.643171 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:07:58.643596 [debug] [MainThread]: On master: COMMIT
[0m23:07:58.644120 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:58.644674 [debug] [MainThread]: On master: COMMIT
[0m23:07:58.645300 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:07:58.645813 [debug] [MainThread]: On master: Close
[0m23:07:58.646453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:58.646857 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:07:58.647168 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m23:07:58.647538 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:07:58.647893 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_location_data' was properly closed.
[0m23:07:58.648320 [info ] [MainThread]: 
[0m23:07:58.648717 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m23:07:58.650892 [debug] [MainThread]: Command end result
[0m23:07:58.687204 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:07:58.688793 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:07:58.694786 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:07:58.695086 [info ] [MainThread]: 
[0m23:07:58.695457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:07:58.695749 [info ] [MainThread]: 
[0m23:07:58.696107 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:07:58.697161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3297267, "process_in_blocks": "0", "process_kernel_time": 0.140488, "process_mem_max_rss": "124256", "process_out_blocks": "2416", "process_user_time": 2.518759}
[0m23:07:58.697637 [debug] [MainThread]: Command `dbt run` succeeded at 23:07:58.697511 after 1.33 seconds
[0m23:07:58.697975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde98200e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde98200250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde98201210>]}
[0m23:07:58.698358 [debug] [MainThread]: Flushing usage events
[0m23:07:59.423282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:25:59.156426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf46211f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4622ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf46457750>]}


============================== 23:25:59.159586 | ba6a6f9c-9b2c-410a-8488-795bfcfd310d ==============================
[0m23:25:59.159586 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:25:59.160184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:25:59.334781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba6a6f9c-9b2c-410a-8488-795bfcfd310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4592d010>]}
[0m23:25:59.393033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba6a6f9c-9b2c-410a-8488-795bfcfd310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf48c5b410>]}
[0m23:25:59.394110 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:25:59.476406 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:25:59.630282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:25:59.630906 [debug] [MainThread]: Partial parsing: added file: airflow_dbt_training://macros/normalize_values.sql
[0m23:25:59.631314 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/stg_location_data.sql
[0m23:26:00.072773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba6a6f9c-9b2c-410a-8488-795bfcfd310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf445696d0>]}
[0m23:26:00.171654 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:26:00.174283 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:26:00.196164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba6a6f9c-9b2c-410a-8488-795bfcfd310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf44160dd0>]}
[0m23:26:00.196658 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 434 macros
[0m23:26:00.196985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba6a6f9c-9b2c-410a-8488-795bfcfd310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4419f450>]}
[0m23:26:00.199783 [info ] [MainThread]: 
[0m23:26:00.200225 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:26:00.200504 [info ] [MainThread]: 
[0m23:26:00.201214 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:26:00.206159 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:26:00.296020 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:26:00.296429 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:26:00.296696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:00.314982 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.018 seconds
[0m23:26:00.316264 [debug] [ThreadPool]: On list_dwh: Close
[0m23:26:00.317985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:26:00.324472 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:26:00.324888 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:26:00.325148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:00.331675 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:26:00.332264 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:26:00.332878 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:26:00.341058 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.008 seconds
[0m23:26:00.342474 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:26:00.342941 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:26:00.349705 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:00.350049 [debug] [MainThread]: On master: BEGIN
[0m23:26:00.350285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:26:00.356854 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:26:00.357204 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:00.357787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:26:00.366318 [debug] [MainThread]: SQL status: SELECT 6 in 0.008 seconds
[0m23:26:00.368865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba6a6f9c-9b2c-410a-8488-795bfcfd310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf42734cd0>]}
[0m23:26:00.369270 [debug] [MainThread]: On master: ROLLBACK
[0m23:26:00.369762 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:00.370025 [debug] [MainThread]: On master: BEGIN
[0m23:26:00.370645 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:26:00.370906 [debug] [MainThread]: On master: COMMIT
[0m23:26:00.371150 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:00.371412 [debug] [MainThread]: On master: COMMIT
[0m23:26:00.371872 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:26:00.372160 [debug] [MainThread]: On master: Close
[0m23:26:00.376097 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:26:00.376825 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:26:00.377351 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m23:26:00.377887 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:26:00.378725 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:26:00.378395 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m23:26:00.379532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:26:00.380230 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m23:26:00.381005 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m23:26:00.381801 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:26:00.382289 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:26:00.382821 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:26:00.383337 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:26:00.383745 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:26:00.393138 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:26:00.393593 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:26:00.394043 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:26:00.396342 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:26:00.398824 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:26:00.399374 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:26:00.402468 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:26:00.413911 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:26:00.440946 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:26:00.458629 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:26:00.461092 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:26:00.463106 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:26:00.463723 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:26:00.464218 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:26:00.464852 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:26:00.465290 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:26:00.469156 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:26:00.469735 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:26:00.470322 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:26:00.470747 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:26:00.471566 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:26:00.472001 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:26:00.472392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:00.472803 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:26:00.473191 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:26:00.473778 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:26:00.477690 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:26:00.478197 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:26:00.478733 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:26:00.479881 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:26:00.480727 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:26:00.481239 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:26:00.481798 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:26:00.482309 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:26:00.482977 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:26:00.483758 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:26:00.484427 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:26:00.484991 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type,
    normalize_values(type, ['URBAN', 'RURAL']) as type_normalized
FROM source
  );
[0m23:26:00.486124 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "["
LINE 17:     normalize_values(type, ['URBAN', 'RURAL']) as type_norma...
                                    ^

[0m23:26:00.486577 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: ROLLBACK
[0m23:26:00.487236 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:26:00.487817 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:26:00.488321 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m23:26:00.488876 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:26:00.505040 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:26:00.511185 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:26:00.515521 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:26:00.516345 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:26:00.517194 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:26:00.517722 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:26:00.519104 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:26:00.519698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:00.520146 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:26:00.525011 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:26:00.530019 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:26:00.535036 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:26:00.535708 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:26:00.536169 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:26:00.536739 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:26:00.537957 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:26:00.543999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:26:00.550002 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m23:26:00.569515 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:26:00.570362 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:26:00.571686 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:26:00.572215 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:26:00.572936 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:26:00.573390 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:26:00.574120 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:26:00.574647 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:26:00.575181 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:26:00.578285 [debug] [Thread-4 (]: Database Error in model stg_location_data (models/airflow_dbt_training/silver/stg_location_data.sql)
  syntax error at or near "["
  LINE 17:     normalize_values(type, ['URBAN', 'RURAL']) as type_norma...
                                      ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/silver/stg_location_data.sql
[0m23:26:00.578777 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:26:00.580624 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m23:26:00.581242 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m23:26:00.589631 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:26:00.592441 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:26:00.595318 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:26:00.601037 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:26:00.601449 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba6a6f9c-9b2c-410a-8488-795bfcfd310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41d85150>]}
[0m23:26:00.602071 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:26:00.602657 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:26:00.603055 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:26:00.603785 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model public.stg_location_data .................. [[31mERROR[0m in 0.20s]
[0m23:26:00.604418 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:26:00.604885 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:26:00.605681 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:26:00.606541 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.stg_location_data' to be skipped because of status 'error'.  Reason: Database Error in model stg_location_data (models/airflow_dbt_training/silver/stg_location_data.sql)
  syntax error at or near "["
  LINE 17:     normalize_values(type, ['URBAN', 'RURAL']) as type_norma...
                                      ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/silver/stg_location_data.sql.
[0m23:26:00.607866 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:26:00.608290 [info ] [Thread-4 (]: 5 of 7 SKIP relation public.region_type_composition ............................ [[33mSKIP[0m]
[0m23:26:00.608771 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:26:00.610415 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:26:00.613958 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:26:00.614641 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m23:26:00.615223 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m23:26:00.617120 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:26:00.618779 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:26:00.619369 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba6a6f9c-9b2c-410a-8488-795bfcfd310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4272c450>]}
[0m23:26:00.619988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba6a6f9c-9b2c-410a-8488-795bfcfd310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41d7a7d0>]}
[0m23:26:00.620548 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba6a6f9c-9b2c-410a-8488-795bfcfd310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4272dd90>]}
[0m23:26:00.621212 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.24s]
[0m23:26:00.621975 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.24s]
[0m23:26:00.623088 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m23:26:00.623894 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:26:00.624528 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:26:00.625118 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:26:00.626263 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:26:00.626767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m23:26:00.627224 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:26:00.630874 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:26:00.631862 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:26:00.632972 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:26:00.633968 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:26:00.633524 [info ] [Thread-1 (]: 6 of 7 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:26:00.634748 [info ] [Thread-4 (]: 7 of 7 SKIP relation public.mart_housing_prices_breakdown ...................... [[33mSKIP[0m]
[0m23:26:00.636294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.incremental_prices)
[0m23:26:00.636817 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:26:00.637288 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:26:00.650150 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:26:00.650743 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:26:00.696531 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:26:00.697053 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp232600680338"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:26:00.697436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:00.734439 [debug] [Thread-1 (]: SQL status: SELECT 10500 in 0.037 seconds
[0m23:26:00.748993 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:26:00.749485 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:26:00.750190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:26:00.750538 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:26:00.750943 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp232600680338'
        
      order by ordinal_position

  
[0m23:26:00.762902 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.011 seconds
[0m23:26:00.768593 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:26:00.769058 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:26:00.773011 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m23:26:00.781687 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:26:00.782143 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:26:00.784800 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:26:00.795406 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:26:00.796030 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:26:00.796421 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp232600680338"
    )


  
[0m23:26:00.803934 [debug] [Thread-1 (]: SQL status: INSERT 0 10500 in 0.007 seconds
[0m23:26:00.805383 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:26:00.805742 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:26:00.806050 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:26:00.810145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:26:00.811166 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:26:00.811819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba6a6f9c-9b2c-410a-8488-795bfcfd310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf41cdf6d0>]}
[0m23:26:00.812477 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 10500[0m in 0.18s]
[0m23:26:00.813061 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:26:00.815116 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:00.815546 [debug] [MainThread]: On master: BEGIN
[0m23:26:00.815955 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:26:00.823602 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:26:00.824111 [debug] [MainThread]: On master: COMMIT
[0m23:26:00.824490 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:00.824800 [debug] [MainThread]: On master: COMMIT
[0m23:26:00.825241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:26:00.825511 [debug] [MainThread]: On master: Close
[0m23:26:00.825948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:00.826186 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:26:00.826408 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m23:26:00.826649 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_example' was properly closed.
[0m23:26:00.826868 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_location_data' was properly closed.
[0m23:26:00.827214 [info ] [MainThread]: 
[0m23:26:00.827523 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m23:26:00.829395 [debug] [MainThread]: Command end result
[0m23:26:00.862617 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:26:00.864201 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:26:00.870183 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:26:00.870525 [info ] [MainThread]: 
[0m23:26:00.870884 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:26:00.871315 [info ] [MainThread]: 
[0m23:26:00.871850 [error] [MainThread]:   Database Error in model stg_location_data (models/airflow_dbt_training/silver/stg_location_data.sql)
  syntax error at or near "["
  LINE 17:     normalize_values(type, ['URBAN', 'RURAL']) as type_norma...
                                      ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/silver/stg_location_data.sql
[0m23:26:00.872317 [info ] [MainThread]: 
[0m23:26:00.872767 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 TOTAL=7
[0m23:26:00.874211 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7682059, "process_in_blocks": "68464", "process_kernel_time": 0.139134, "process_mem_max_rss": "128332", "process_out_blocks": "3336", "process_user_time": 2.822445}
[0m23:26:00.874690 [debug] [MainThread]: Command `dbt run` failed at 23:26:00.874590 after 1.77 seconds
[0m23:26:00.875065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf46521390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4a598350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4a598ed0>]}
[0m23:26:00.875423 [debug] [MainThread]: Flushing usage events
[0m23:26:01.671813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:59.019821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0892259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc089273710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc089225690>]}


============================== 23:26:59.022889 | 8a951e9d-7d89-4a03-9cf9-dcb3925b2977 ==============================
[0m23:26:59.022889 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:26:59.023441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:26:59.181484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a951e9d-7d89-4a03-9cf9-dcb3925b2977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc088dc1350>]}
[0m23:26:59.243025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a951e9d-7d89-4a03-9cf9-dcb3925b2977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08bc63250>]}
[0m23:26:59.243766 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:26:59.322540 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:26:59.458099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:26:59.458849 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/stg_location_data.sql
[0m23:26:59.883438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a951e9d-7d89-4a03-9cf9-dcb3925b2977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc087110690>]}
[0m23:26:59.978143 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:26:59.980659 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:26:59.993190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a951e9d-7d89-4a03-9cf9-dcb3925b2977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc087987b90>]}
[0m23:26:59.993702 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 434 macros
[0m23:26:59.994058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a951e9d-7d89-4a03-9cf9-dcb3925b2977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc087578210>]}
[0m23:26:59.997778 [info ] [MainThread]: 
[0m23:26:59.998496 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:26:59.999060 [info ] [MainThread]: 
[0m23:26:59.999856 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:27:00.007289 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:27:00.091161 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:27:00.091510 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:27:00.091798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:00.099484 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m23:27:00.100741 [debug] [ThreadPool]: On list_dwh: Close
[0m23:27:00.102448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:27:00.108616 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:27:00.108922 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:27:00.109159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:00.115951 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:27:00.116352 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:27:00.116737 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:27:00.119198 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m23:27:00.120545 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:27:00.120991 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:27:00.127307 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:00.127591 [debug] [MainThread]: On master: BEGIN
[0m23:27:00.127893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:00.134402 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:27:00.134758 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:00.135216 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:27:00.139449 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m23:27:00.141448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a951e9d-7d89-4a03-9cf9-dcb3925b2977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0871efc10>]}
[0m23:27:00.141867 [debug] [MainThread]: On master: ROLLBACK
[0m23:27:00.142333 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:00.142589 [debug] [MainThread]: On master: BEGIN
[0m23:27:00.143179 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:27:00.143440 [debug] [MainThread]: On master: COMMIT
[0m23:27:00.143683 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:00.144125 [debug] [MainThread]: On master: COMMIT
[0m23:27:00.144586 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:27:00.144909 [debug] [MainThread]: On master: Close
[0m23:27:00.148267 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:27:00.148921 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:27:00.149822 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:27:00.149448 [info ] [Thread-1 (]: 1 of 7 START sql view model public.housing_prices .............................. [RUN]
[0m23:27:00.151048 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:27:00.150517 [info ] [Thread-2 (]: 2 of 7 START sql view model public.location_data ............................... [RUN]
[0m23:27:00.152425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:27:00.151657 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_example ................................. [RUN]
[0m23:27:00.153393 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_location_data ........................... [RUN]
[0m23:27:00.154274 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:27:00.154897 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:27:00.155640 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:27:00.156309 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:27:00.156756 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:27:00.165653 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:27:00.166136 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:27:00.166550 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:27:00.168876 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:27:00.171235 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:27:00.171677 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:27:00.175054 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:27:00.181324 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:27:00.191798 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:27:00.208307 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:27:00.217622 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:27:00.221355 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:27:00.224972 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:27:00.228637 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:27:00.229482 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:27:00.230137 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:27:00.230587 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:27:00.231181 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:27:00.231677 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:27:00.232108 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:27:00.232517 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:27:00.232927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:00.233323 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:27:00.233726 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:27:00.234137 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:27:00.234964 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:27:00.241069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:27:00.241787 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:27:00.242413 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:27:00.242924 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:27:00.243575 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:27:00.244447 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:27:00.244920 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m23:27:00.245336 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:27:00.245766 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:27:00.246338 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:27:00.246777 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:27:00.247382 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type,
    CASE
        WHEN LOWER("type") = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER("type") = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END as type_normalized
FROM source
  );
[0m23:27:00.247855 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:27:00.248477 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:27:00.254140 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:27:00.256130 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:27:00.259616 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:27:00.262763 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:27:00.263173 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m23:27:00.263608 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:27:00.264055 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:27:00.264491 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:27:00.267803 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:27:00.268531 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m23:27:00.269055 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:27:00.269561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:27:00.270214 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:27:00.273742 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:27:00.274105 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:27:00.277146 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:27:00.281243 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:27:00.281700 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:27:00.284764 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:27:00.285276 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:27:00.285755 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:27:00.286285 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:27:00.286972 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:27:00.287355 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:27:00.292950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:27:00.311124 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:27:00.311625 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m23:27:00.312923 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:27:00.315928 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:27:00.316373 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:27:00.318008 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:27:00.318440 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:27:00.318868 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:27:00.319276 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:27:00.319703 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:27:00.320107 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:27:00.320524 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:27:00.321022 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:27:01.926207 [debug] [Thread-4 (]: SQL status: COMMIT in 1.604 seconds
[0m23:27:01.926946 [debug] [Thread-1 (]: SQL status: COMMIT in 1.605 seconds
[0m23:27:01.927446 [debug] [Thread-2 (]: SQL status: COMMIT in 1.606 seconds
[0m23:27:01.933361 [debug] [Thread-3 (]: SQL status: COMMIT in 1.612 seconds
[0m23:27:01.935412 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:27:01.938043 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:27:01.940546 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:27:01.942958 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:27:01.948356 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:27:01.949017 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:27:01.949595 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:27:01.950233 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:27:01.950655 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:27:01.951141 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:27:01.951593 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:27:01.952038 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:27:01.955719 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:27:01.958202 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:27:01.958760 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:27:01.959138 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m23:27:01.959575 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m23:27:01.960824 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:27:01.963303 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:27:01.963644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a951e9d-7d89-4a03-9cf9-dcb3925b2977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc084ba11d0>]}
[0m23:27:01.964894 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:27:01.965578 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a951e9d-7d89-4a03-9cf9-dcb3925b2977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc084b97250>]}
[0m23:27:01.966343 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a951e9d-7d89-4a03-9cf9-dcb3925b2977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc084a30d50>]}
[0m23:27:01.967221 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 1.81s]
[0m23:27:01.968372 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a951e9d-7d89-4a03-9cf9-dcb3925b2977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08757f410>]}
[0m23:27:01.969598 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 1.81s]
[0m23:27:01.970958 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 1.81s]
[0m23:27:01.972259 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:27:01.973539 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 1.81s]
[0m23:27:01.974712 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:27:01.975778 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:27:01.977197 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:27:01.978058 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:27:01.979677 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:27:01.980653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m23:27:01.981673 [info ] [Thread-3 (]: 5 of 7 START sql view model public.region_type_composition ..................... [RUN]
[0m23:27:01.982572 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:27:01.983441 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m23:27:01.987632 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:27:01.988499 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:27:01.993765 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:27:01.994992 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:27:01.995643 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:27:01.999687 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:27:02.000243 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:27:02.001044 [info ] [Thread-2 (]: 6 of 7 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:27:02.001519 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.incremental_prices)
[0m23:27:02.002080 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:27:02.002503 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:27:02.002954 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:27:02.014798 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:27:02.015291 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:27:02.016097 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:27:02.032514 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m23:27:02.038169 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:27:02.038612 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:27:02.048862 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:27:02.057269 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:27:02.062871 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m23:27:02.069335 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:27:02.069781 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:27:02.070239 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp232702048409"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:27:02.071601 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:27:02.072011 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:27:02.072443 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:27:02.073068 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:27:02.075862 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:27:02.078660 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m23:27:02.079384 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:27:02.079809 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m23:27:02.080404 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:27:02.081694 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:27:02.082243 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a951e9d-7d89-4a03-9cf9-dcb3925b2977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc084a7a8d0>]}
[0m23:27:02.082830 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.10s]
[0m23:27:02.083457 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:27:02.084213 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:27:02.084831 [info ] [Thread-1 (]: 7 of 7 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m23:27:02.085348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m23:27:02.085722 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:27:02.093960 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:27:02.094601 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:27:02.098777 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:27:02.099397 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:27:02.099743 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m23:27:02.100054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:02.105977 [debug] [Thread-2 (]: SQL status: SELECT 10500 in 0.034 seconds
[0m23:27:02.112008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:27:02.112455 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:27:02.112875 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m23:27:02.122233 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:27:02.122695 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m23:27:02.123087 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:27:02.126746 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:27:02.127368 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m23:27:02.127912 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:27:02.128558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:27:02.129118 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:27:02.130816 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:27:02.131378 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp232702048409'
        
      order by ordinal_position

  
[0m23:27:02.131876 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:27:02.132373 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:27:02.135262 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:27:02.138018 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m23:27:02.138680 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:27:02.139108 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.007 seconds
[0m23:27:02.139560 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m23:27:02.145427 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:27:02.145873 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:27:02.146347 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:27:02.147918 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m23:27:02.148537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a951e9d-7d89-4a03-9cf9-dcb3925b2977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc084aabb10>]}
[0m23:27:02.149669 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:27:02.149169 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.06s]
[0m23:27:02.161454 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:27:02.162118 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:27:02.162583 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:27:02.165641 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:27:02.174427 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:27:02.175027 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:27:02.175381 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp232702048409"
    )


  
[0m23:27:02.182036 [debug] [Thread-2 (]: SQL status: INSERT 0 10500 in 0.006 seconds
[0m23:27:02.183436 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:27:02.183790 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:27:02.184096 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:27:02.187743 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:27:02.188655 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:27:02.189197 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a951e9d-7d89-4a03-9cf9-dcb3925b2977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc084ae5250>]}
[0m23:27:02.189805 [info ] [Thread-2 (]: 6 of 7 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 10500[0m in 0.19s]
[0m23:27:02.190376 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:27:02.192602 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:02.193026 [debug] [MainThread]: On master: BEGIN
[0m23:27:02.193321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:27:02.200411 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:27:02.200844 [debug] [MainThread]: On master: COMMIT
[0m23:27:02.201150 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:02.201572 [debug] [MainThread]: On master: COMMIT
[0m23:27:02.202040 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:27:02.202337 [debug] [MainThread]: On master: Close
[0m23:27:02.202746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:02.203006 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m23:27:02.203247 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:27:02.203472 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:27:02.203690 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_location_data' was properly closed.
[0m23:27:02.204028 [info ] [MainThread]: 
[0m23:27:02.204348 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m23:27:02.206172 [debug] [MainThread]: Command end result
[0m23:27:02.242694 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:27:02.244311 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:27:02.250319 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:27:02.250642 [info ] [MainThread]: 
[0m23:27:02.250990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:27:02.251288 [info ] [MainThread]: 
[0m23:27:02.251665 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:27:02.252690 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2844043, "process_in_blocks": "0", "process_kernel_time": 0.215847, "process_mem_max_rss": "129440", "process_out_blocks": "3392", "process_user_time": 2.75696}
[0m23:27:02.253125 [debug] [MainThread]: Command `dbt run` succeeded at 23:27:02.253031 after 3.29 seconds
[0m23:27:02.253479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08927bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc089279210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc084a76050>]}
[0m23:27:02.253844 [debug] [MainThread]: Flushing usage events
[0m23:27:02.992406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:12.406296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad9aae450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad9aae590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad9aad090>]}


============================== 23:29:12.408940 | 40e1df26-3ade-4169-8075-b242af1d9c0c ==============================
[0m23:29:12.408940 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:29:12.409614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:29:12.559903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad91b0f10>]}
[0m23:29:12.617335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6adc319c50>]}
[0m23:29:12.618041 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:29:12.698972 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:29:12.827299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m23:29:12.827951 [debug] [MainThread]: Partial parsing: added file: airflow_dbt_training://models/airflow_dbt_training/gold/region_type_composition_with_macro.sql
[0m23:29:12.828268 [debug] [MainThread]: Partial parsing: added file: airflow_dbt_training://macros/pivot_enum_values.sql
[0m23:29:13.131048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad7d9fcd0>]}
[0m23:29:13.241682 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:29:13.244953 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:29:13.259607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad797d3d0>]}
[0m23:29:13.260137 [info ] [MainThread]: Found 9 models, 34 data tests, 2 sources, 435 macros
[0m23:29:13.260521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad8936210>]}
[0m23:29:13.263383 [info ] [MainThread]: 
[0m23:29:13.264000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:29:13.264553 [info ] [MainThread]: 
[0m23:29:13.265504 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:29:13.271821 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:29:13.310984 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:29:13.311385 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:29:13.311645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:13.320480 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m23:29:13.321841 [debug] [ThreadPool]: On list_dwh: Close
[0m23:29:13.323803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:29:13.376695 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:29:13.377064 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:29:13.377311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:13.383891 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:29:13.384285 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:29:13.384757 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:29:13.387486 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m23:29:13.388910 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:29:13.389349 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:29:13.396293 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:13.396636 [debug] [MainThread]: On master: BEGIN
[0m23:29:13.396877 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:13.403448 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:29:13.403812 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:13.404298 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:29:13.408827 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m23:29:13.411396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad79bd390>]}
[0m23:29:13.411805 [debug] [MainThread]: On master: ROLLBACK
[0m23:29:13.412289 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:13.412550 [debug] [MainThread]: On master: BEGIN
[0m23:29:13.413183 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:29:13.413458 [debug] [MainThread]: On master: COMMIT
[0m23:29:13.413741 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:13.414082 [debug] [MainThread]: On master: COMMIT
[0m23:29:13.414742 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:13.415149 [debug] [MainThread]: On master: Close
[0m23:29:13.418686 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:29:13.419277 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m23:29:13.419795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:29:13.420215 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:29:13.420733 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:29:13.421171 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:29:13.421607 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:29:13.422270 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m23:29:13.423232 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m23:29:13.433519 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:29:13.434306 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m23:29:13.435070 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:29:13.435634 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:29:13.436375 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:29:13.436826 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:29:13.437174 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:29:13.437550 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:29:13.437917 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:29:13.440540 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:29:13.453508 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:29:13.465491 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:29:13.490204 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:29:13.491253 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:29:13.491962 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:29:13.492507 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:29:13.496459 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:29:13.497047 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:29:13.502150 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:29:13.505861 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:29:13.506549 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:29:13.507326 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:29:13.507897 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:29:13.508373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:13.508805 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:29:13.509216 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:29:13.509614 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:29:13.510249 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:29:13.510706 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:29:13.511103 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:29:13.511507 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:29:13.516692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:29:13.517260 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:29:13.517815 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:29:13.519141 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:29:13.519821 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:29:13.520300 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:29:13.520928 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:29:13.521579 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:29:13.522077 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:29:13.522563 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:29:13.523026 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:29:13.523473 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:29:13.531758 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:29:13.532300 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type,
    CASE
        WHEN LOWER("type") = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER("type") = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END as type_normalized
FROM source
  );
[0m23:29:13.532773 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:29:13.533316 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:29:13.536967 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:29:13.537558 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:29:13.538091 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:29:13.538510 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:29:13.538903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:13.542508 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:29:13.546108 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:29:13.549561 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:29:13.550080 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:29:13.550560 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:29:13.550991 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m23:29:13.551472 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:29:13.554891 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:29:13.555611 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:29:13.556258 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:29:13.556657 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:13.557050 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:29:13.560373 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:29:13.569274 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:29:13.569693 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m23:29:13.575386 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:29:13.584955 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:29:13.585556 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:29:13.586956 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:29:13.587507 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:29:13.588049 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:13.588480 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:13.588861 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:29:13.589289 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:29:13.590578 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:29:13.591846 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:29:13.592275 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:29:13.592780 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:29:13.593214 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:29:13.593713 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:29:13.594122 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:29:13.716473 [debug] [Thread-3 (]: SQL status: COMMIT in 0.123 seconds
[0m23:29:13.717162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.124 seconds
[0m23:29:13.722867 [debug] [Thread-4 (]: SQL status: COMMIT in 0.128 seconds
[0m23:29:13.729063 [debug] [Thread-2 (]: SQL status: COMMIT in 0.134 seconds
[0m23:29:13.733649 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:29:13.735464 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:29:13.737502 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:29:13.740246 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:29:13.746332 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:29:13.747014 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:29:13.747616 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:29:13.748223 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:29:13.748855 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:29:13.749372 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:29:13.749828 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:29:13.750271 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:29:13.758734 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m23:29:13.761608 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:29:13.762320 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.011 seconds
[0m23:29:13.762709 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.012 seconds
[0m23:29:13.764839 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad53de9d0>]}
[0m23:29:13.766201 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:29:13.766573 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.016 seconds
[0m23:29:13.767978 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:29:13.768736 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.33s]
[0m23:29:13.771207 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:29:13.771902 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad79aa410>]}
[0m23:29:13.773061 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:29:13.774067 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad5392650>]}
[0m23:29:13.776822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad53d7f50>]}
[0m23:29:13.775670 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.34s]
[0m23:29:13.779326 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.34s]
[0m23:29:13.781264 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.36s]
[0m23:29:13.782775 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:29:13.784061 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:29:13.785142 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:29:13.787126 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:29:13.788016 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:29:13.789481 [info ] [Thread-3 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m23:29:13.791631 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:29:13.790970 [info ] [Thread-2 (]: 6 of 8 START sql view model public.region_type_composition_with_macro .......... [RUN]
[0m23:29:13.793157 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m23:29:13.793862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m23:29:13.794352 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition_with_macro)
[0m23:29:13.794819 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:29:13.795244 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:29:13.795691 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:29:13.799628 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:29:13.803423 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:29:13.807680 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:29:13.808473 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:29:13.809447 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:29:13.813675 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:29:13.814203 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:29:13.815260 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:29:13.819320 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:29:13.819827 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:29:13.820464 [info ] [Thread-4 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:29:13.821282 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:29:13.821929 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m23:29:13.822402 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:29:13.822844 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:29:13.823297 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:29:13.823718 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: BEGIN
[0m23:29:13.836426 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:29:13.836913 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:29:13.837802 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m23:29:13.838395 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:29:13.839069 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:29:13.839776 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:29:13.847403 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:29:13.858863 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:29:13.864732 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m23:29:13.865239 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m23:29:13.880755 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:29:13.895759 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:13.896468 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */

  create view "dwh"."public"."region_type_composition_with_macro__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        ELSE 'UNKNOWN'
    END = 'URBAN') AS urban_count,
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'RURAL') AS rural_count
  ,
    COUNT(*) AS total_count

  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:29:13.897017 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:13.897471 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp232913878763"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:29:13.899094 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:29:13.899755 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "total_locations" does not exist
LINE 32:   ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
                                     ^

[0m23:29:13.900341 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:29:13.901071 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:29:13.901641 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: ROLLBACK
[0m23:29:13.902384 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:29:13.903577 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: Close
[0m23:29:13.906754 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m23:29:13.912106 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m23:29:13.913436 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:29:13.914287 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m23:29:13.915628 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:29:13.917495 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:29:13.918895 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad854d410>]}
[0m23:29:13.919926 [info ] [Thread-3 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:29:13.921443 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:29:13.926069 [debug] [Thread-2 (]: Database Error in model region_type_composition_with_macro (models/airflow_dbt_training/gold/region_type_composition_with_macro.sql)
  column "total_locations" does not exist
  LINE 32:   ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
                                       ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/region_type_composition_with_macro.sql
[0m23:29:13.927173 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad91ecc90>]}
[0m23:29:13.927960 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:29:13.928915 [error] [Thread-2 (]: 6 of 8 ERROR creating sql view model public.region_type_composition_with_macro . [[31mERROR[0m in 0.13s]
[0m23:29:13.929818 [info ] [Thread-1 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m23:29:13.931068 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:29:13.932031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m23:29:13.933041 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:29:13.933880 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.region_type_composition_with_macro' to be skipped because of status 'error'.  Reason: Database Error in model region_type_composition_with_macro (models/airflow_dbt_training/gold/region_type_composition_with_macro.sql)
  column "total_locations" does not exist
  LINE 32:   ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
                                       ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/region_type_composition_with_macro.sql.
[0m23:29:13.951397 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:13.952776 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:29:13.958045 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:13.958697 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:13.959033 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m23:29:13.959360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:13.961370 [debug] [Thread-4 (]: SQL status: SELECT 10500 in 0.061 seconds
[0m23:29:13.977633 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:13.978198 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m23:29:13.978672 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:29:13.979170 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:13.979747 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m23:29:13.980313 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:29:13.980988 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:13.981473 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp232913878763'
        
      order by ordinal_position

  
[0m23:29:13.982815 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:29:13.986175 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:13.986620 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m23:29:13.987088 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:29:13.992663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:29:13.993964 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:29:13.994563 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:13.994966 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:13.995435 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:29:13.995927 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:29:13.998815 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:29:14.007589 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:14.008073 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m23:29:14.008515 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:29:14.011325 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m23:29:14.012183 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:14.012567 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m23:29:14.013128 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:29:14.014441 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m23:29:14.014850 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:29:14.020645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad4192410>]}
[0m23:29:14.025121 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:29:14.025905 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.09s]
[0m23:29:14.026757 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:29:14.027523 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:14.027982 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp232913878763"
    )


  
[0m23:29:14.035406 [debug] [Thread-4 (]: SQL status: INSERT 0 10500 in 0.007 seconds
[0m23:29:14.036917 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:29:14.037490 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:14.037839 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:29:14.044128 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m23:29:14.045067 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:29:14.045825 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e1df26-3ade-4169-8075-b242af1d9c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad85edfd0>]}
[0m23:29:14.046494 [info ] [Thread-4 (]: 7 of 8 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 10500[0m in 0.22s]
[0m23:29:14.047071 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:29:14.049014 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:14.049340 [debug] [MainThread]: On master: BEGIN
[0m23:29:14.049576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:29:14.056111 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:29:14.056490 [debug] [MainThread]: On master: COMMIT
[0m23:29:14.056772 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:14.057153 [debug] [MainThread]: On master: COMMIT
[0m23:29:14.057696 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:14.058127 [debug] [MainThread]: On master: Close
[0m23:29:14.058797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:14.059292 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m23:29:14.059638 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition_with_macro' was properly closed.
[0m23:29:14.059991 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:29:14.060303 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:29:14.060803 [info ] [MainThread]: 
[0m23:29:14.061243 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m23:29:14.063868 [debug] [MainThread]: Command end result
[0m23:29:14.100034 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:29:14.101758 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:29:14.110742 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:29:14.111168 [info ] [MainThread]: 
[0m23:29:14.111654 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:29:14.112070 [info ] [MainThread]: 
[0m23:29:14.112754 [error] [MainThread]:   Database Error in model region_type_composition_with_macro (models/airflow_dbt_training/gold/region_type_composition_with_macro.sql)
  column "total_locations" does not exist
  LINE 32:   ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
                                       ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/region_type_composition_with_macro.sql
[0m23:29:14.113391 [info ] [MainThread]: 
[0m23:29:14.113880 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m23:29:14.115187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7590364, "process_in_blocks": "0", "process_kernel_time": 0.210151, "process_mem_max_rss": "127904", "process_out_blocks": "3456", "process_user_time": 2.711952}
[0m23:29:14.115804 [debug] [MainThread]: Command `dbt run` failed at 23:29:14.115676 after 1.76 seconds
[0m23:29:14.116244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad9905b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad9aa1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6addc6cb50>]}
[0m23:29:14.116617 [debug] [MainThread]: Flushing usage events
[0m23:29:14.816513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:30.920886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f725f51e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f725f73f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f725f815490>]}


============================== 23:29:30.923509 | 1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0 ==============================
[0m23:29:30.923509 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:29:30.924106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:29:31.075657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7261a8fa90>]}
[0m23:29:31.132519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7261f534d0>]}
[0m23:29:31.133226 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:29:31.210847 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:29:31.335847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:29:31.336574 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/gold/region_type_composition_with_macro.sql
[0m23:29:31.631321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f725d512910>]}
[0m23:29:31.727329 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:29:31.729709 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:29:31.742365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f725ddf1410>]}
[0m23:29:31.743269 [info ] [MainThread]: Found 9 models, 34 data tests, 2 sources, 435 macros
[0m23:29:31.743724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f725e94a2d0>]}
[0m23:29:31.747235 [info ] [MainThread]: 
[0m23:29:31.747942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:29:31.748570 [info ] [MainThread]: 
[0m23:29:31.749390 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:29:31.756295 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:29:31.798348 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:29:31.798793 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:29:31.799068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:31.806976 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m23:29:31.808263 [debug] [ThreadPool]: On list_dwh: Close
[0m23:29:31.810226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:29:31.863708 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:29:31.864094 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:29:31.864340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:31.871095 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:29:31.871510 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:29:31.871952 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:29:31.874543 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m23:29:31.875961 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:29:31.876406 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:29:31.883321 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:31.883674 [debug] [MainThread]: On master: BEGIN
[0m23:29:31.883928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:31.890219 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:29:31.890583 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:31.891175 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:29:31.895594 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m23:29:31.898063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f725c11d950>]}
[0m23:29:31.898450 [debug] [MainThread]: On master: ROLLBACK
[0m23:29:31.898909 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:31.899166 [debug] [MainThread]: On master: BEGIN
[0m23:29:31.899749 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:29:31.900025 [debug] [MainThread]: On master: COMMIT
[0m23:29:31.900267 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:31.900530 [debug] [MainThread]: On master: COMMIT
[0m23:29:31.901031 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:31.901308 [debug] [MainThread]: On master: Close
[0m23:29:31.904729 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:29:31.905286 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m23:29:31.905746 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:29:31.906221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:29:31.906650 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:29:31.907129 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:29:31.907637 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m23:29:31.908230 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:29:31.908837 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m23:29:31.909730 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m23:29:31.910629 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:29:31.919933 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:29:31.920698 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:29:31.921271 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:29:31.921666 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:29:31.922276 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:29:31.922804 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:29:31.923187 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:29:31.925563 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:29:31.927833 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:29:31.941775 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:29:31.964800 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:29:31.971175 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:29:31.971604 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:29:31.975636 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:29:31.976135 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:29:31.979931 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:29:31.980445 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:29:31.981063 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:29:31.986184 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:29:31.986815 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:29:31.987308 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:29:31.987722 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:29:31.988311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:31.988772 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:29:31.989201 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:29:31.989602 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:29:31.990215 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:29:31.990749 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:29:31.991399 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:29:31.996840 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:29:31.997849 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:29:31.998594 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:29:31.999162 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:29:31.999763 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:29:32.000174 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:29:32.000739 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:29:32.001477 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:29:32.002070 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:29:32.002470 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:29:32.002906 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:29:32.003425 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type,
    CASE
        WHEN LOWER("type") = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER("type") = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END as type_normalized
FROM source
  );
[0m23:29:32.003916 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:29:32.011049 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:29:32.011800 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:29:32.012484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:29:32.012954 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:29:32.016431 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:29:32.016826 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:29:32.017248 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:29:32.020647 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:29:32.021083 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:29:32.024242 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:29:32.027552 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:29:32.027985 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:29:32.028562 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:29:32.029022 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:32.029432 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m23:29:32.045871 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m23:29:32.046421 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m23:29:32.049142 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:29:32.052373 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:29:32.052812 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m23:29:32.055777 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:29:32.056206 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:29:32.056743 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:29:32.059689 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:29:32.060122 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:29:32.060605 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:29:32.061121 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:29:32.061740 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:32.063146 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:29:32.063621 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:29:32.064040 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:29:32.064431 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:29:32.064811 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:29:32.065234 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:29:32.066480 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:29:32.067856 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:29:32.073642 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:29:32.075391 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:29:32.075806 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m23:29:32.076237 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:29:32.076662 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:29:32.084096 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:29:32.086875 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:29:32.087345 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:29:32.087971 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:29:32.088634 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:29:32.089346 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:29:32.091384 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:29:32.094119 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:29:32.094583 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m23:29:32.095249 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:29:32.095667 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:29:32.098466 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:29:32.098866 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m23:29:32.099284 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:29:32.101733 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:29:32.102468 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:29:32.103865 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:29:32.104511 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:29:32.106240 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723ed56c50>]}
[0m23:29:32.107015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723ed864d0>]}
[0m23:29:32.107659 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:29:32.108496 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.18s]
[0m23:29:32.109303 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.20s]
[0m23:29:32.110968 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:29:32.111468 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:29:32.112042 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:29:32.112634 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:29:32.114462 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:29:32.115111 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723edc3050>]}
[0m23:29:32.116503 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:29:32.117248 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723eef0b90>]}
[0m23:29:32.117993 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m23:29:32.118748 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.stg_housing_prices)
[0m23:29:32.119654 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m23:29:32.120757 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:29:32.121287 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:29:32.122057 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:29:32.126674 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:29:32.128057 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:29:32.128553 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:29:32.129828 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:29:32.129226 [info ] [Thread-1 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m23:29:32.130632 [info ] [Thread-2 (]: 6 of 8 START sql view model public.region_type_composition_with_macro .......... [RUN]
[0m23:29:32.132432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.region_type_composition)
[0m23:29:32.133347 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:29:32.133867 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition_with_macro)
[0m23:29:32.134487 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:29:32.135074 [info ] [Thread-4 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:29:32.135692 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:29:32.139099 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:29:32.139735 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m23:29:32.143848 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:29:32.144764 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:29:32.150987 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:29:32.160024 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:29:32.162126 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:29:32.162818 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:29:32.163762 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:29:32.164357 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:29:32.168166 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:29:32.168671 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:29:32.200354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:32.206421 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:29:32.217448 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: BEGIN
[0m23:29:32.217983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m23:29:32.218490 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:29:32.220997 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:32.221445 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:29:32.222103 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp232932198780"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:29:32.222783 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:29:32.223360 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:29:32.225456 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:29:32.229183 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:29:32.229914 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m23:29:32.230757 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m23:29:32.231258 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:29:32.231806 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */

  create view "dwh"."public"."region_type_composition_with_macro__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        ELSE 'UNKNOWN'
    END = 'URBAN') AS urban_count,
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'RURAL') AS rural_count
  ,
    COUNT(*) AS total_count

  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_count, 2) AS pct_urban
FROM type_counts
  );
[0m23:29:32.232353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:29:32.233738 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:29:32.234124 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:29:32.234512 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:29:32.235096 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:29:32.238597 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:29:32.239029 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:29:32.239496 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
alter table "dwh"."public"."region_type_composition_with_macro__dbt_tmp" rename to "region_type_composition_with_macro"
[0m23:29:32.242721 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m23:29:32.243790 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:29:32.244330 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m23:29:32.244725 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:32.246224 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:29:32.246668 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:29:32.247138 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:29:32.247782 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:29:32.249447 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:29:32.250078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723edc5010>]}
[0m23:29:32.251113 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:29:32.250736 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.12s]
[0m23:29:32.254611 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."region_type_composition_with_macro__dbt_backup"
[0m23:29:32.255558 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:29:32.256488 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:29:32.257383 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
drop view if exists "dwh"."public"."region_type_composition_with_macro__dbt_backup" cascade
[0m23:29:32.258292 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:29:32.260332 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: Close
[0m23:29:32.261129 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:29:32.261953 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723ed12090>]}
[0m23:29:32.262427 [debug] [Thread-4 (]: SQL status: SELECT 10500 in 0.039 seconds
[0m23:29:32.263067 [info ] [Thread-3 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m23:29:32.264112 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.region_type_composition_with_macro ..... [[32mCREATE VIEW[0m in 0.13s]
[0m23:29:32.270364 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m23:29:32.282425 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:32.283119 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:29:32.283621 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:29:32.284115 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:29:32.292154 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:32.292881 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:29:32.293300 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:29:32.297428 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:32.297903 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:32.298528 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp232932198780'
        
      order by ordinal_position

  
[0m23:29:32.299069 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:32.299421 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m23:29:32.299726 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:29:32.304113 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:29:32.309778 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:32.310341 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:29:32.310866 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:29:32.311334 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:32.311913 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m23:29:32.313631 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:29:32.319415 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:29:32.322548 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:32.325581 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:32.326059 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:29:32.326544 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m23:29:32.327497 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:29:32.328631 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:29:32.328964 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:32.329311 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:29:32.329706 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:29:32.337910 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m23:29:32.340429 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m23:29:32.341095 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:29:32.341470 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m23:29:32.344000 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:29:32.344520 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:29:32.345763 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m23:29:32.346364 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723ec78f90>]}
[0m23:29:32.346974 [info ] [Thread-3 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.08s]
[0m23:29:32.347469 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:32.348099 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:29:32.348542 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp232932198780"
    )


  
[0m23:29:32.356091 [debug] [Thread-4 (]: SQL status: INSERT 0 10500 in 0.007 seconds
[0m23:29:32.357868 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:29:32.358293 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:29:32.358611 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:29:32.364619 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m23:29:32.365482 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:29:32.366027 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb53d0e-665d-4f6e-bb5b-f248c1f1a6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f723ec7be90>]}
[0m23:29:32.366616 [info ] [Thread-4 (]: 7 of 8 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 10500[0m in 0.23s]
[0m23:29:32.367187 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:29:32.369238 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:32.369654 [debug] [MainThread]: On master: BEGIN
[0m23:29:32.369950 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:29:32.376889 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:29:32.377271 [debug] [MainThread]: On master: COMMIT
[0m23:29:32.377600 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:32.377863 [debug] [MainThread]: On master: COMMIT
[0m23:29:32.378300 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:32.378562 [debug] [MainThread]: On master: Close
[0m23:29:32.378977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:32.379219 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:29:32.379466 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition_with_macro' was properly closed.
[0m23:29:32.379695 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m23:29:32.379933 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:29:32.380299 [info ] [MainThread]: 
[0m23:29:32.380755 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m23:29:32.383110 [debug] [MainThread]: Command end result
[0m23:29:32.417101 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:29:32.418737 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:29:32.424823 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:29:32.425113 [info ] [MainThread]: 
[0m23:29:32.425477 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:29:32.425766 [info ] [MainThread]: 
[0m23:29:32.426115 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m23:29:32.427266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5569794, "process_in_blocks": "0", "process_kernel_time": 0.244541, "process_mem_max_rss": "129468", "process_out_blocks": "3448", "process_user_time": 2.608439}
[0m23:29:32.427739 [debug] [MainThread]: Command `dbt run` succeeded at 23:29:32.427614 after 1.56 seconds
[0m23:29:32.428106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f725f74f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7263890310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7263890d90>]}
[0m23:29:32.428479 [debug] [MainThread]: Flushing usage events
[0m23:29:33.115202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:32:53.676525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09500e2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09500e2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09500e1e90>]}


============================== 23:32:53.679322 | 2b0a0165-91c1-484e-a757-4d8977b9599b ==============================
[0m23:32:53.679322 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:32:53.679864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:32:53.832914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094f52eb90>]}
[0m23:32:53.889994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0952b2f850>]}
[0m23:32:53.890700 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:32:53.968874 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:32:54.093549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:32:54.094112 [debug] [MainThread]: Partial parsing: added file: airflow_dbt_training://tests/generic/test_valid_values.sql
[0m23:32:54.193652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095012fd90>]}
[0m23:32:54.289886 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:32:54.292281 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:32:54.304497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094e5e7f90>]}
[0m23:32:54.304993 [info ] [MainThread]: Found 9 models, 34 data tests, 2 sources, 436 macros
[0m23:32:54.305310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095014bd50>]}
[0m23:32:54.308903 [info ] [MainThread]: 
[0m23:32:54.309359 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:32:54.310111 [info ] [MainThread]: 
[0m23:32:54.311935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:54.319422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:32:54.362070 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:32:54.362575 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:32:54.362845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:54.370513 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m23:32:54.371888 [debug] [ThreadPool]: On list_dwh: Close
[0m23:32:54.374532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:32:54.381152 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:32:54.381501 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:32:54.381737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:54.389660 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m23:32:54.390614 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:32:54.391511 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:32:54.394473 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:32:54.396118 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:32:54.396705 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:32:54.404535 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:54.404956 [debug] [MainThread]: On master: BEGIN
[0m23:32:54.405226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:54.412672 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:32:54.413126 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:54.413937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:32:54.418738 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m23:32:54.421589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094e5e84d0>]}
[0m23:32:54.422049 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:54.422609 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:54.422914 [debug] [MainThread]: On master: BEGIN
[0m23:32:54.423511 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:32:54.423815 [debug] [MainThread]: On master: COMMIT
[0m23:32:54.424164 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:54.424525 [debug] [MainThread]: On master: COMMIT
[0m23:32:54.425059 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:54.425350 [debug] [MainThread]: On master: Close
[0m23:32:54.428911 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:32:54.429417 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:32:54.430327 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:32:54.431332 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:32:54.429958 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m23:32:54.431005 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m23:32:54.432216 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m23:32:54.433579 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m23:32:54.434482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:32:54.435420 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:32:54.436140 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:32:54.436762 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:32:54.437255 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:32:54.437711 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:32:54.438132 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:32:54.438621 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:32:54.448818 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:32:54.451102 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:32:54.454090 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:32:54.459441 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:32:54.460421 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:32:54.460888 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:32:54.461673 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:32:54.472711 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:32:54.519957 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:32:54.520543 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:32:54.524329 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:32:54.528050 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:32:54.529235 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:32:54.530054 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:32:54.530506 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:32:54.530955 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:32:54.531457 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:32:54.531850 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:32:54.532252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:54.532760 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:32:54.533164 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:32:54.533560 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:32:54.534170 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:32:54.534538 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:32:54.541185 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m23:32:54.541993 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:32:54.542586 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:32:54.543236 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:32:54.543880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:32:54.544493 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type,
    CASE
        WHEN LOWER("type") = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER("type") = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END as type_normalized
FROM source
  );
[0m23:32:54.545236 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:32:54.545868 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m23:32:54.546479 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:32:54.547261 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:32:54.547742 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:32:54.548324 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:32:54.548900 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:32:54.549387 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:32:54.560543 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m23:32:54.561106 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m23:32:54.563207 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:32:54.613333 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:32:54.617169 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:32:54.617726 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:32:54.618207 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:32:54.618670 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m23:32:54.619122 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:32:54.619566 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:32:54.620397 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:32:54.620930 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:32:54.621329 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:32:54.621698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:32:54.624858 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:32:54.628072 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:32:54.631229 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:32:54.634281 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:32:54.634748 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:32:54.635194 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:32:54.635648 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:32:54.636095 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:32:54.636898 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:32:54.637291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:32:54.642911 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:32:54.653268 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m23:32:54.656920 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:32:54.658471 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:32:54.659881 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:32:54.661275 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:32:54.661729 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:32:54.662178 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:32:54.662606 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:32:54.663038 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:32:54.663449 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:32:54.663883 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:32:54.664323 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:32:54.664732 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:32:54.694918 [debug] [Thread-3 (]: SQL status: COMMIT in 0.030 seconds
[0m23:32:54.701868 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:32:54.707717 [debug] [Thread-2 (]: SQL status: COMMIT in 0.042 seconds
[0m23:32:54.708272 [debug] [Thread-4 (]: SQL status: COMMIT in 0.043 seconds
[0m23:32:54.710976 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:32:54.707357 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:32:54.711505 [debug] [Thread-1 (]: SQL status: COMMIT in 0.046 seconds
[0m23:32:54.714267 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:32:54.714878 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:32:54.715323 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:32:54.717862 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:32:54.718540 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:32:54.718971 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:32:54.719699 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:32:54.720164 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:32:54.720734 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:32:54.722481 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:32:54.724872 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:32:54.725545 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:32:54.727494 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:32:54.728086 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m23:32:54.729432 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:32:54.729823 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094c270910>]}
[0m23:32:54.731222 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:32:54.732486 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:32:54.733304 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.29s]
[0m23:32:54.733928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094d3db0d0>]}
[0m23:32:54.734657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094e5e6850>]}
[0m23:32:54.735485 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094e59a110>]}
[0m23:32:54.736326 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:32:54.737411 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.30s]
[0m23:32:54.738835 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m23:32:54.740541 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.30s]
[0m23:32:54.741857 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:32:54.742768 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:32:54.743589 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:32:54.744979 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:32:54.745934 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.stg_housing_prices)
[0m23:32:54.746686 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:32:54.751025 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:32:54.751644 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:32:54.752347 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:32:54.753176 [info ] [Thread-1 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m23:32:54.754176 [info ] [Thread-4 (]: 6 of 8 START sql view model public.region_type_composition_with_macro .......... [RUN]
[0m23:32:54.759082 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:32:54.759614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.region_type_composition)
[0m23:32:54.760161 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.region_type_composition_with_macro)
[0m23:32:54.760995 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:32:54.762410 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:32:54.763064 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:32:54.766610 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:32:54.767642 [info ] [Thread-2 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:32:54.776269 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:32:54.777155 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.incremental_prices)
[0m23:32:54.777898 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:32:54.778420 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:32:54.784229 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:32:54.783802 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:32:54.794376 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:32:54.802361 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:32:54.804206 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:32:54.804986 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:32:54.805438 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:32:54.805954 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition_with_macro: BEGIN
[0m23:32:54.806455 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:32:54.806843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:54.807215 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:32:54.836834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m23:32:54.848481 [debug] [Thread-4 (]: SQL status: BEGIN in 0.041 seconds
[0m23:32:54.858786 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:32:54.861614 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:32:54.862256 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:32:54.862920 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:32:54.863572 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp233254842344"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:32:54.864201 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */

  create view "dwh"."public"."region_type_composition_with_macro__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        ELSE 'UNKNOWN'
    END = 'URBAN') AS urban_count,
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'RURAL') AS rural_count
  ,
    COUNT(*) AS total_count

  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_count, 2) AS pct_urban
FROM type_counts
  );
[0m23:32:54.864837 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:32:54.866553 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:32:54.870239 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:32:54.870774 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m23:32:54.871228 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:32:54.874898 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:32:54.875366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:32:54.875868 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
alter table "dwh"."public"."region_type_composition_with_macro__dbt_tmp" rename to "region_type_composition_with_macro"
[0m23:32:54.877339 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:32:54.877868 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:32:54.878240 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:32:54.878627 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:32:54.879840 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:32:54.880362 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:32:54.880695 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:32:54.883199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:32:54.885900 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m23:32:54.886331 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m23:32:54.886971 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:32:54.890921 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."region_type_composition_with_macro__dbt_backup"
[0m23:32:54.891448 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m23:32:54.892151 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:32:54.892709 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
drop view if exists "dwh"."public"."region_type_composition_with_macro__dbt_backup" cascade
[0m23:32:54.893218 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:32:54.894706 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:32:54.895135 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:32:54.896403 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition_with_macro: Close
[0m23:32:54.896993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094ed20350>]}
[0m23:32:54.897639 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.14s]
[0m23:32:54.898356 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:32:54.898967 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094f9be2d0>]}
[0m23:32:54.900945 [debug] [Thread-2 (]: SQL status: SELECT 10500 in 0.036 seconds
[0m23:32:54.900131 [info ] [Thread-4 (]: 6 of 8 OK created sql view model public.region_type_composition_with_macro ..... [[32mCREATE VIEW[0m in 0.14s]
[0m23:32:54.907375 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:32:54.918148 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:32:54.919052 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:32:54.919788 [info ] [Thread-3 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m23:32:54.920372 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:32:54.921090 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m23:32:54.921782 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:32:54.922282 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:32:54.928257 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:32:54.932912 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:32:54.933464 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp233254842344'
        
      order by ordinal_position

  
[0m23:32:54.934301 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:32:54.939551 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:32:54.940212 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:32:54.945856 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:32:54.946360 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m23:32:54.947109 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:32:54.947538 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:32:54.948010 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:32:54.951636 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:32:54.960926 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:32:54.961701 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m23:32:54.962461 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:32:54.963056 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:32:54.963799 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m23:32:54.965957 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:32:54.966377 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:32:54.975602 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:32:54.979405 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:32:54.980207 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m23:32:54.980833 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:32:54.981242 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp233254842344"
    )


  
[0m23:32:54.981681 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:32:54.983093 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:32:54.983481 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:32:54.983819 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:32:54.988464 [debug] [Thread-2 (]: SQL status: INSERT 0 10500 in 0.006 seconds
[0m23:32:54.989862 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:32:54.990212 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:32:54.990543 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:32:54.991798 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m23:32:54.994585 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m23:32:54.994993 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m23:32:54.995787 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:32:54.996628 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:32:54.997166 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m23:32:54.997959 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094d30dfd0>]}
[0m23:32:54.998408 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:32:54.999071 [info ] [Thread-2 (]: 7 of 8 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 10500[0m in 0.22s]
[0m23:32:55.000719 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m23:32:55.001506 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:32:55.002520 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b0a0165-91c1-484e-a757-4d8977b9599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f094e93e5d0>]}
[0m23:32:55.003785 [info ] [Thread-3 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.08s]
[0m23:32:55.004703 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:32:55.007045 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:55.007384 [debug] [MainThread]: On master: BEGIN
[0m23:32:55.007676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:55.014953 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:32:55.015596 [debug] [MainThread]: On master: COMMIT
[0m23:32:55.016239 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:55.016855 [debug] [MainThread]: On master: COMMIT
[0m23:32:55.017455 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:55.017778 [debug] [MainThread]: On master: Close
[0m23:32:55.018241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:55.018487 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:32:55.018710 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:32:55.018928 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m23:32:55.019145 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition_with_macro' was properly closed.
[0m23:32:55.019522 [info ] [MainThread]: 
[0m23:32:55.019834 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m23:32:55.021712 [debug] [MainThread]: Command end result
[0m23:32:55.057350 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:32:55.059029 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:32:55.065267 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:32:55.065585 [info ] [MainThread]: 
[0m23:32:55.065963 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:32:55.066383 [info ] [MainThread]: 
[0m23:32:55.066749 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m23:32:55.067876 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.441751, "process_in_blocks": "0", "process_kernel_time": 0.170605, "process_mem_max_rss": "123856", "process_out_blocks": "3456", "process_user_time": 2.559084}
[0m23:32:55.068339 [debug] [MainThread]: Command `dbt run` succeeded at 23:32:55.068242 after 1.44 seconds
[0m23:32:55.068715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0950445990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095446c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f095446c450>]}
[0m23:32:55.069045 [debug] [MainThread]: Flushing usage events
[0m23:32:55.844629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:39:42.822042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c35462450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c35765490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c35461c50>]}


============================== 23:39:42.824823 | 0af15577-defd-4c95-b011-55cba0216b66 ==============================
[0m23:39:42.824823 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:39:42.825488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:39:42.984389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c354bbed0>]}
[0m23:39:43.040284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c37ea2fd0>]}
[0m23:39:43.041025 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:39:43.122611 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:39:43.256371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:39:43.257153 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/gold/schema.yml
[0m23:39:43.257756 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/schema.yml
[0m23:39:43.732247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c31a47650>]}
[0m23:39:43.831148 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:39:43.833566 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:39:43.891206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c31b6e1d0>]}
[0m23:39:43.891853 [info ] [MainThread]: Found 9 models, 40 data tests, 2 sources, 436 macros
[0m23:39:43.892226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c31960790>]}
[0m23:39:43.895524 [info ] [MainThread]: 
[0m23:39:43.895958 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:39:43.896292 [info ] [MainThread]: 
[0m23:39:43.897385 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:39:43.902784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:39:43.942667 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:39:43.943038 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:39:43.943364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:43.950852 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m23:39:43.952179 [debug] [ThreadPool]: On list_dwh: Close
[0m23:39:43.954081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:39:43.960431 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:39:43.960780 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:39:43.961044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:43.967490 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:39:43.967898 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:39:43.968360 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:39:43.970873 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:39:43.972293 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:39:43.972762 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:39:43.979610 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:43.979921 [debug] [MainThread]: On master: BEGIN
[0m23:39:43.980178 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:39:43.986646 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:39:43.986993 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:43.987487 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:39:43.992428 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m23:39:43.995112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c31a72e90>]}
[0m23:39:43.995554 [debug] [MainThread]: On master: ROLLBACK
[0m23:39:43.995988 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:43.996272 [debug] [MainThread]: On master: BEGIN
[0m23:39:43.996862 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:39:43.997169 [debug] [MainThread]: On master: COMMIT
[0m23:39:43.997454 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:43.997711 [debug] [MainThread]: On master: COMMIT
[0m23:39:43.998116 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:39:43.998485 [debug] [MainThread]: On master: Close
[0m23:39:44.001980 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:39:44.002451 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:39:44.002889 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:39:44.003417 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m23:39:44.003913 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:39:44.004390 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m23:39:44.005008 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m23:39:44.005705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:39:44.006381 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m23:39:44.007234 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:39:44.007873 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:39:44.008361 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:39:44.008945 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:39:44.009467 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:39:44.009965 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:39:44.019278 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:39:44.019837 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:39:44.022266 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:39:44.024492 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:39:44.029592 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:39:44.030598 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:39:44.031438 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:39:44.031905 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:39:44.048219 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:39:44.078719 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:39:44.082520 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:39:44.084031 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:39:44.087770 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:39:44.088755 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:39:44.089215 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:39:44.090013 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:39:44.090409 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:39:44.090876 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:39:44.091316 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:39:44.091731 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:39:44.092174 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:39:44.092611 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:39:44.093004 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:39:44.093658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:44.094077 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:39:44.099670 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:39:44.100210 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:39:44.100946 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:39:44.101624 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:39:44.102104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:39:44.102677 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:39:44.103070 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:39:44.103711 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:39:44.104164 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:39:44.104623 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:39:44.105002 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:39:44.105461 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:39:44.105969 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type,
    CASE
        WHEN LOWER("type") = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER("type") = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END as type_normalized
FROM source
  );
[0m23:39:44.113451 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:39:44.113873 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:39:44.114469 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:39:44.117872 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:39:44.118290 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:39:44.118677 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:39:44.119162 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:39:44.119600 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:39:44.122982 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:39:44.126386 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:39:44.130442 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:39:44.130878 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:39:44.131287 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m23:39:44.131743 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:39:44.132214 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:39:44.135445 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:39:44.136337 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:39:44.136855 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:39:44.137283 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:39:44.137723 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:39:44.140925 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:39:44.141303 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:39:44.144338 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:39:44.155304 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:39:44.162696 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:39:44.164159 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:39:44.164655 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:39:44.165348 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:39:44.165779 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:39:44.166197 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:39:44.166722 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:39:44.167124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:39:44.168460 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:39:44.168889 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:39:44.170341 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:39:44.170811 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:39:44.171337 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:39:44.171733 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:39:44.172187 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:39:44.172754 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:39:44.179751 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:39:44.180260 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m23:39:44.180604 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m23:39:44.180951 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m23:39:44.186435 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:39:44.189320 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:39:44.191973 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:39:44.194673 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:39:44.195117 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:39:44.195843 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:39:44.196428 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:39:44.197023 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:39:44.197515 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:39:44.197945 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:39:44.198395 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:39:44.200865 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:39:44.203330 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:39:44.204974 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c30f74c50>]}
[0m23:39:44.205629 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m23:39:44.206179 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m23:39:44.206695 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m23:39:44.207390 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:39:44.208945 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:39:44.209498 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.010 seconds
[0m23:39:44.211076 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:39:44.212126 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c30f12b50>]}
[0m23:39:44.214145 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:39:44.215067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c30ecfd10>]}
[0m23:39:44.215792 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m23:39:44.216664 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c30ecfb10>]}
[0m23:39:44.217380 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m23:39:44.218109 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:39:44.218992 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.21s]
[0m23:39:44.219999 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:39:44.220998 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:39:44.222035 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:39:44.222970 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m23:39:44.223489 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:39:44.223896 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:39:44.224399 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:39:44.228549 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:39:44.229224 [info ] [Thread-3 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m23:39:44.229839 [info ] [Thread-1 (]: 6 of 8 START sql view model public.region_type_composition_with_macro .......... [RUN]
[0m23:39:44.230724 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m23:39:44.231809 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:39:44.232276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.region_type_composition_with_macro)
[0m23:39:44.232730 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:39:44.233689 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:39:44.234221 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:39:44.237750 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:39:44.247166 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:39:44.247802 [info ] [Thread-2 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:39:44.249098 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.incremental_prices)
[0m23:39:44.249766 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:39:44.250274 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:39:44.250661 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:39:44.254595 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:39:44.267061 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:39:44.271428 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:39:44.272580 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:39:44.273384 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:39:44.274009 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:39:44.274622 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition_with_macro: BEGIN
[0m23:39:44.280438 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:39:44.301109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:44.321825 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:39:44.322784 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:39:44.323744 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp233944305855"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:39:44.324172 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:39:44.329881 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m23:39:44.330615 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:39:44.331410 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */

  create view "dwh"."public"."region_type_composition_with_macro__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        ELSE 'UNKNOWN'
    END = 'URBAN') AS urban_count,
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'RURAL') AS rural_count
  ,
    COUNT(*) AS total_count

  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_count, 2) AS pct_urban
FROM type_counts
  );
[0m23:39:44.332377 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:39:44.332928 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:39:44.333525 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:39:44.335018 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:39:44.338351 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:39:44.338731 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:39:44.339121 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
alter table "dwh"."public"."region_type_composition_with_macro__dbt_tmp" rename to "region_type_composition_with_macro"
[0m23:39:44.342159 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:39:44.342677 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m23:39:44.343052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:39:44.344387 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:39:44.344758 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:39:44.345171 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:39:44.346388 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:39:44.346806 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:39:44.347249 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:39:44.347737 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:39:44.350699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:39:44.353368 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."region_type_composition_with_macro__dbt_backup"
[0m23:39:44.353762 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m23:39:44.354371 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:39:44.357122 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m23:39:44.357620 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
drop view if exists "dwh"."public"."region_type_composition_with_macro__dbt_backup" cascade
[0m23:39:44.358365 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:39:44.358980 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m23:39:44.359541 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:39:44.359949 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:39:44.361411 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition_with_macro: Close
[0m23:39:44.362688 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:39:44.363416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c30fc2710>]}
[0m23:39:44.363862 [debug] [Thread-2 (]: SQL status: SELECT 10500 in 0.040 seconds
[0m23:39:44.364596 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c319552d0>]}
[0m23:39:44.365359 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public.region_type_composition_with_macro ..... [[32mCREATE VIEW[0m in 0.13s]
[0m23:39:44.383273 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:39:44.384136 [info ] [Thread-3 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:39:44.384903 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:39:44.385366 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:39:44.386016 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:39:44.387019 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:39:44.387640 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:39:44.388167 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp233944305855'
        
      order by ordinal_position

  
[0m23:39:44.388797 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:39:44.389715 [info ] [Thread-4 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m23:39:44.390419 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m23:39:44.391057 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:39:44.401463 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:39:44.402065 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.013 seconds
[0m23:39:44.408202 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:39:44.408807 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:39:44.409323 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:39:44.413327 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:39:44.413831 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:39:44.422860 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:39:44.423345 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:39:44.423785 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:39:44.424275 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m23:39:44.424609 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:39:44.426656 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:39:44.435226 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:39:44.436061 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:39:44.436493 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:39:44.436985 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp233944305855"
    )


  
[0m23:39:44.437567 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:39:44.438196 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m23:39:44.440416 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:39:44.443819 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:39:44.444272 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m23:39:44.444657 [debug] [Thread-2 (]: SQL status: INSERT 0 10500 in 0.007 seconds
[0m23:39:44.446007 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:39:44.446383 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:39:44.446770 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:39:44.448008 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:39:44.448434 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:39:44.448881 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:39:44.449456 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:39:44.457617 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m23:39:44.458447 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:39:44.459024 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3050ae90>]}
[0m23:39:44.459619 [info ] [Thread-2 (]: 7 of 8 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 10500[0m in 0.21s]
[0m23:39:44.460080 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m23:39:44.460655 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:39:44.463599 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m23:39:44.464722 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:39:44.465160 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m23:39:44.465790 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:39:44.467083 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m23:39:44.467737 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af15577-defd-4c95-b011-55cba0216b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c305096d0>]}
[0m23:39:44.468472 [info ] [Thread-4 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.08s]
[0m23:39:44.469138 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:39:44.471330 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:44.471763 [debug] [MainThread]: On master: BEGIN
[0m23:39:44.472028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:39:44.478958 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:39:44.479376 [debug] [MainThread]: On master: COMMIT
[0m23:39:44.479827 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:44.480280 [debug] [MainThread]: On master: COMMIT
[0m23:39:44.480839 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:39:44.481125 [debug] [MainThread]: On master: Close
[0m23:39:44.481567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:44.481826 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition_with_macro' was properly closed.
[0m23:39:44.482080 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:39:44.482336 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:39:44.482761 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m23:39:44.483359 [info ] [MainThread]: 
[0m23:39:44.483736 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m23:39:44.485633 [debug] [MainThread]: Command end result
[0m23:39:44.523209 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:39:44.524738 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:39:44.530648 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:39:44.530950 [info ] [MainThread]: 
[0m23:39:44.531315 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:39:44.531638 [info ] [MainThread]: 
[0m23:39:44.532070 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m23:39:44.533265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7609559, "process_in_blocks": "0", "process_kernel_time": 0.19998, "process_mem_max_rss": "129140", "process_out_blocks": "3552", "process_user_time": 2.869716}
[0m23:39:44.533896 [debug] [MainThread]: Command `dbt run` succeeded at 23:39:44.533767 after 1.76 seconds
[0m23:39:44.534388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3549d950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3549dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c397e0310>]}
[0m23:39:44.534805 [debug] [MainThread]: Flushing usage events
[0m23:39:45.281581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:39:55.410725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a281ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9af98710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a276250>]}


============================== 23:39:55.413350 | 7bd0da3a-a8d0-4bb2-8ca7-086c42437ac4 ==============================
[0m23:39:55.413350 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:39:55.413940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:39:55.563304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bd0da3a-a8d0-4bb2-8ca7-086c42437ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a997b3310>]}
[0m23:39:55.619562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bd0da3a-a8d0-4bb2-8ca7-086c42437ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9ccb5610>]}
[0m23:39:55.620263 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:39:55.701761 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:39:55.829714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:39:55.830175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:39:55.880811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bd0da3a-a8d0-4bb2-8ca7-086c42437ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a98bf4f50>]}
[0m23:39:55.981492 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:39:55.984007 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:39:56.011181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bd0da3a-a8d0-4bb2-8ca7-086c42437ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a97f8bdd0>]}
[0m23:39:56.011665 [info ] [MainThread]: Found 9 models, 40 data tests, 2 sources, 436 macros
[0m23:39:56.012014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bd0da3a-a8d0-4bb2-8ca7-086c42437ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a98372ed0>]}
[0m23:39:56.016905 [info ] [MainThread]: 
[0m23:39:56.017550 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:39:56.018028 [info ] [MainThread]: 
[0m23:39:56.019049 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:39:56.025931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m23:39:56.069188 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:39:56.069581 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:39:56.069837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:56.076957 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:39:56.077474 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:39:56.078258 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:39:56.080958 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:39:56.082466 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:39:56.082939 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:39:56.089740 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:56.090040 [debug] [MainThread]: On master: BEGIN
[0m23:39:56.090302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:39:56.096758 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:39:56.097176 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:56.097815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:39:56.102951 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m23:39:56.105813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bd0da3a-a8d0-4bb2-8ca7-086c42437ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a2ebf90>]}
[0m23:39:56.106275 [debug] [MainThread]: On master: ROLLBACK
[0m23:39:56.106749 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:56.107028 [debug] [MainThread]: On master: BEGIN
[0m23:39:56.107603 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:39:56.107937 [debug] [MainThread]: On master: COMMIT
[0m23:39:56.108462 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:56.108938 [debug] [MainThread]: On master: COMMIT
[0m23:39:56.109535 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:39:56.109867 [debug] [MainThread]: On master: Close
[0m23:39:56.113932 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:39:56.114438 [info ] [Thread-1 (]: 1 of 40 START test accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [RUN]
[0m23:39:56.115020 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:39:56.115516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m23:39:56.116024 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:39:56.116493 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:39:56.117020 [info ] [Thread-2 (]: 2 of 40 START test accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [RUN]
[0m23:39:56.117575 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:39:56.118122 [info ] [Thread-3 (]: 3 of 40 START test not_null_mart_housing_prices_breakdown_avg_price ............ [RUN]
[0m23:39:56.118729 [info ] [Thread-4 (]: 4 of 40 START test not_null_mart_housing_prices_breakdown_n_sales .............. [RUN]
[0m23:39:56.119560 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e'
[0m23:39:56.130783 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d'
[0m23:39:56.143536 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:39:56.144149 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7'
[0m23:39:56.144680 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:39:56.145123 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:39:56.145722 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:39:56.154216 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:39:56.163299 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:39:56.171157 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:39:56.173031 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:39:56.174100 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:39:56.174921 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:39:56.175377 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:39:56.175807 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:39:56.204112 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:39:56.205661 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:39:56.209546 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:39:56.218759 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:39:56.219422 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:39:56.220278 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:39:56.220775 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:39:56.221301 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: BEGIN
[0m23:39:56.221808 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:39:56.222238 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: BEGIN
[0m23:39:56.222681 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: BEGIN
[0m23:39:56.223122 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:39:56.223585 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: BEGIN
[0m23:39:56.224010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:56.224522 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:39:56.225168 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:39:56.231347 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:39:56.232285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:39:56.233107 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:39:56.233831 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:39:56.234307 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:39:56.234764 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:39:56.235272 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_price
from "dwh"."public"."mart_housing_prices_breakdown"
where avg_price is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.235762 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:39:56.236210 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:39:56.236718 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        day_of_week as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by day_of_week

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m23:39:56.237386 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select n_sales
from "dwh"."public"."mart_housing_prices_breakdown"
where n_sales is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.237926 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        month as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by month

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','7','8','9','10','11','12'
)



  
  
      
    ) dbt_internal_test
[0m23:39:56.243448 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:39:56.247485 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: ROLLBACK
[0m23:39:56.248107 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:39:56.248521 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:39:56.249005 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:39:56.250379 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: ROLLBACK
[0m23:39:56.250758 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: Close
[0m23:39:56.252073 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: ROLLBACK
[0m23:39:56.253484 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: ROLLBACK
[0m23:39:56.254295 [info ] [Thread-4 (]: 4 of 40 PASS not_null_mart_housing_prices_breakdown_n_sales .................... [[32mPASS[0m in 0.11s]
[0m23:39:56.254767 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: Close
[0m23:39:56.255698 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:39:56.256240 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: Close
[0m23:39:56.256857 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: Close
[0m23:39:56.258147 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:39:56.257602 [info ] [Thread-3 (]: 3 of 40 PASS not_null_mart_housing_prices_breakdown_avg_price .................. [[32mPASS[0m in 0.13s]
[0m23:39:56.259765 [info ] [Thread-1 (]: 1 of 40 PASS accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [[32mPASS[0m in 0.14s]
[0m23:39:56.261043 [info ] [Thread-2 (]: 2 of 40 PASS accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [[32mPASS[0m in 0.14s]
[0m23:39:56.263425 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:39:56.261825 [info ] [Thread-4 (]: 5 of 40 START test not_null_mart_housing_prices_breakdown_pct_urban ............ [RUN]
[0m23:39:56.264385 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:39:56.265093 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:39:56.265778 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:39:56.266687 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e)
[0m23:39:56.267270 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:39:56.267975 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:39:56.268556 [info ] [Thread-3 (]: 6 of 40 START test not_null_mart_housing_prices_breakdown_region ............... [RUN]
[0m23:39:56.269200 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:39:56.269694 [info ] [Thread-1 (]: 7 of 40 START test not_null_mart_housing_prices_breakdown_rural_count .......... [RUN]
[0m23:39:56.270234 [info ] [Thread-2 (]: 8 of 40 START test not_null_mart_housing_prices_breakdown_urban_count .......... [RUN]
[0m23:39:56.270929 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m23:39:56.316261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281)
[0m23:39:56.319773 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:39:56.320301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de)
[0m23:39:56.320756 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:39:56.321187 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:39:56.321830 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:39:56.325824 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:39:56.326271 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:39:56.330085 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:39:56.334065 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:39:56.336922 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:39:56.337544 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:39:56.338376 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:39:56.338929 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:39:56.339421 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:39:56.341987 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:39:56.344528 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:39:56.346976 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:39:56.347439 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: BEGIN
[0m23:39:56.348431 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:39:56.348886 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:39:56.349460 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:39:56.349981 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:39:56.350419 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: BEGIN
[0m23:39:56.350856 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: BEGIN
[0m23:39:56.351508 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: BEGIN
[0m23:39:56.351936 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:39:56.352368 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:39:56.352791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:56.357609 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:39:56.358062 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:39:56.358599 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."mart_housing_prices_breakdown"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.359714 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:39:56.360282 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:39:56.360947 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."mart_housing_prices_breakdown"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.361554 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:39:56.362160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:39:56.362878 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:39:56.363510 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:39:56.364009 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."mart_housing_prices_breakdown"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.364502 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."mart_housing_prices_breakdown"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.367202 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:39:56.368721 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: ROLLBACK
[0m23:39:56.369277 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: Close
[0m23:39:56.369926 [info ] [Thread-3 (]: 6 of 40 PASS not_null_mart_housing_prices_breakdown_region ..................... [[32mPASS[0m in 0.10s]
[0m23:39:56.370588 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:39:56.371188 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:39:56.371850 [info ] [Thread-3 (]: 9 of 40 START test not_null_region_type_composition_pct_urban .................. [RUN]
[0m23:39:56.372462 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m23:39:56.373016 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:39:56.379339 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:39:56.380199 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m23:39:56.380724 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.018 seconds
[0m23:39:56.382550 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: ROLLBACK
[0m23:39:56.383227 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m23:39:56.384729 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: ROLLBACK
[0m23:39:56.385209 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:39:56.386804 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: ROLLBACK
[0m23:39:56.387408 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: Close
[0m23:39:56.390243 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:39:56.390727 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: Close
[0m23:39:56.391656 [error] [Thread-4 (]: 5 of 40 FAIL 5 not_null_mart_housing_prices_breakdown_pct_urban ................ [[31mFAIL 5[0m in 0.12s]
[0m23:39:56.392362 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: Close
[0m23:39:56.393323 [error] [Thread-2 (]: 8 of 40 FAIL 5 not_null_mart_housing_prices_breakdown_urban_count .............. [[31mFAIL 5[0m in 0.07s]
[0m23:39:56.394068 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:39:56.394578 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:39:56.395587 [error] [Thread-1 (]: 7 of 40 FAIL 5 not_null_mart_housing_prices_breakdown_rural_count .............. [[31mFAIL 5[0m in 0.08s]
[0m23:39:56.396635 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:39:56.397263 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:39:56.397894 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: BEGIN
[0m23:39:56.398610 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:39:56.399195 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:39:56.399865 [info ] [Thread-4 (]: 10 of 40 START test not_null_region_type_composition_region .................... [RUN]
[0m23:39:56.400524 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:39:56.401251 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m23:39:56.401956 [info ] [Thread-2 (]: 11 of 40 START test not_null_region_type_composition_rural_count ............... [RUN]
[0m23:39:56.402814 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m23:39:56.403616 [info ] [Thread-1 (]: 12 of 40 START test not_null_region_type_composition_total_locations ........... [RUN]
[0m23:39:56.404378 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m23:39:56.405150 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:39:56.405856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281, now test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a)
[0m23:39:56.406541 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:39:56.411527 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:39:56.412250 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m23:39:56.412766 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m23:39:56.419408 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:39:56.424222 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a"
[0m23:39:56.424805 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:39:56.425275 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:39:56.429033 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:39:56.429522 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m23:39:56.429988 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:39:56.430489 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.433558 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a"
[0m23:39:56.434032 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:39:56.436633 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:39:56.437366 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: BEGIN
[0m23:39:56.438041 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a"
[0m23:39:56.438538 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:39:56.439022 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a: BEGIN
[0m23:39:56.439449 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:39:56.440083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:56.440517 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: BEGIN
[0m23:39:56.441081 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:39:56.446552 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:39:56.447408 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:39:56.448004 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:39:56.448431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:39:56.448991 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.449436 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:39:56.449869 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:39:56.450311 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a"
[0m23:39:56.451942 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: ROLLBACK
[0m23:39:56.452464 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.452953 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_locations
from "dwh"."public"."region_type_composition"
where total_locations is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.453593 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: Close
[0m23:39:56.454884 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "total_locations" does not exist
LINE 16: select total_locations
                ^

[0m23:39:56.454429 [info ] [Thread-3 (]: 9 of 40 PASS not_null_region_type_composition_pct_urban ........................ [[32mPASS[0m in 0.08s]
[0m23:39:56.455857 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a: ROLLBACK
[0m23:39:56.456463 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:39:56.457299 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:39:56.459659 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: ROLLBACK
[0m23:39:56.460523 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a: Close
[0m23:39:56.461172 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:39:56.462417 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: Close
[0m23:39:56.463033 [info ] [Thread-3 (]: 13 of 40 START test not_null_region_type_composition_urban_count ............... [RUN]
[0m23:39:56.466786 [info ] [Thread-4 (]: 10 of 40 PASS not_null_region_type_composition_region .......................... [[32mPASS[0m in 0.06s]
[0m23:39:56.467714 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m23:39:56.469371 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:39:56.470203 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:39:56.470823 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:39:56.471618 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:39:56.477468 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:39:56.479635 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: ROLLBACK
[0m23:39:56.481059 [info ] [Thread-4 (]: 14 of 40 START test not_null_region_type_composition_with_macro_pct_urban ...... [RUN]
[0m23:39:56.483205 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:39:56.484626 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91)
[0m23:39:56.485171 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: Close
[0m23:39:56.488717 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:39:56.489949 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:39:56.492349 [debug] [Thread-1 (]: Database Error in test not_null_region_type_composition_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_locations.sql
[0m23:39:56.493329 [info ] [Thread-2 (]: 11 of 40 PASS not_null_region_type_composition_rural_count ..................... [[32mPASS[0m in 0.09s]
[0m23:39:56.498749 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:39:56.499772 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:39:56.500416 [error] [Thread-1 (]: 12 of 40 ERROR not_null_region_type_composition_total_locations ................ [[31mERROR[0m in 0.09s]
[0m23:39:56.501236 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:39:56.502018 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: BEGIN
[0m23:39:56.502573 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:39:56.503242 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a
[0m23:39:56.503773 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:39:56.504313 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:39:56.507433 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:39:56.508066 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:39:56.508670 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_locations.sql.
[0m23:39:56.509206 [info ] [Thread-2 (]: 15 of 40 START test not_null_region_type_composition_with_macro_region ......... [RUN]
[0m23:39:56.510317 [info ] [Thread-1 (]: 16 of 40 START test not_null_region_type_composition_with_macro_rural_count .... [RUN]
[0m23:39:56.512216 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:39:56.513081 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192)
[0m23:39:56.513828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_locations.305632336a, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797)
[0m23:39:56.514382 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: BEGIN
[0m23:39:56.514902 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:39:56.515429 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:39:56.515848 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:39:56.520457 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:39:56.525266 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:39:56.525872 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m23:39:56.526989 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:39:56.527478 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:39:56.527962 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.528397 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:39:56.533191 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:39:56.536426 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:39:56.537464 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m23:39:56.538106 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:39:56.538637 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:39:56.539074 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:39:56.539514 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: BEGIN
[0m23:39:56.539926 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: BEGIN
[0m23:39:56.540369 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition_with_macro"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.540853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:56.541289 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:39:56.545011 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:39:56.547079 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: ROLLBACK
[0m23:39:56.547741 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: Close
[0m23:39:56.548979 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:39:56.548495 [info ] [Thread-3 (]: 13 of 40 PASS not_null_region_type_composition_urban_count ..................... [[32mPASS[0m in 0.08s]
[0m23:39:56.550029 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:39:56.550690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:39:56.551496 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:39:56.552034 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition_with_macro"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.552556 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:39:56.553176 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:39:56.553897 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition_with_macro"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.554419 [info ] [Thread-3 (]: 17 of 40 START test not_null_region_type_composition_with_macro_total_locations  [RUN]
[0m23:39:56.555227 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae)
[0m23:39:56.555766 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:39:56.560478 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:39:56.561164 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m23:39:56.563141 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: ROLLBACK
[0m23:39:56.563941 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:39:56.564433 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:39:56.564809 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: Close
[0m23:39:56.567890 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:39:56.569474 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: ROLLBACK
[0m23:39:56.570313 [info ] [Thread-4 (]: 14 of 40 PASS not_null_region_type_composition_with_macro_pct_urban ............ [[32mPASS[0m in 0.09s]
[0m23:39:56.570903 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:39:56.571665 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:39:56.572534 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:39:56.573081 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: Close
[0m23:39:56.574685 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: ROLLBACK
[0m23:39:56.575211 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: BEGIN
[0m23:39:56.575735 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:39:56.577146 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:39:56.576589 [info ] [Thread-2 (]: 15 of 40 PASS not_null_region_type_composition_with_macro_region ............... [[32mPASS[0m in 0.06s]
[0m23:39:56.578013 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: Close
[0m23:39:56.578526 [info ] [Thread-4 (]: 18 of 40 START test not_null_region_type_composition_with_macro_urban_count .... [RUN]
[0m23:39:56.579645 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:39:56.580366 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224)
[0m23:39:56.581317 [info ] [Thread-1 (]: 16 of 40 PASS not_null_region_type_composition_with_macro_rural_count .......... [[32mPASS[0m in 0.07s]
[0m23:39:56.582248 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:39:56.582921 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:39:56.583795 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:39:56.584371 [info ] [Thread-2 (]: 19 of 40 START test not_null_stg_housing_prices_date ........................... [RUN]
[0m23:39:56.589243 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:39:56.590150 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:39:56.590728 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m23:39:56.591517 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m23:39:56.592434 [info ] [Thread-1 (]: 20 of 40 START test not_null_stg_housing_prices_day_of_week .................... [RUN]
[0m23:39:56.593221 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:39:56.593747 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:39:56.594278 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:39:56.594818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m23:39:56.598003 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:39:56.598651 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_locations
from "dwh"."public"."region_type_composition_with_macro"
where total_locations is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.604391 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:39:56.604929 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:39:56.605977 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:39:56.606503 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "total_locations" does not exist
LINE 16: select total_locations
                ^

[0m23:39:56.606919 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:39:56.612831 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:39:56.613393 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: BEGIN
[0m23:39:56.614151 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: ROLLBACK
[0m23:39:56.617472 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:39:56.618065 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:39:56.618681 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:39:56.619177 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: Close
[0m23:39:56.620315 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:39:56.623840 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:39:56.624497 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: BEGIN
[0m23:39:56.628310 [debug] [Thread-3 (]: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:39:56.628897 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:39:56.629346 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m23:39:56.629864 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:39:56.630408 [error] [Thread-3 (]: 17 of 40 ERROR not_null_region_type_composition_with_macro_total_locations ..... [[31mERROR[0m in 0.08s]
[0m23:39:56.631367 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:39:56.632125 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: BEGIN
[0m23:39:56.633167 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:39:56.633812 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition_with_macro"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.634704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:56.635491 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:39:56.636325 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql.
[0m23:39:56.637437 [info ] [Thread-3 (]: 21 of 40 START test not_null_stg_housing_prices_id ............................. [RUN]
[0m23:39:56.638766 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m23:39:56.639530 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:39:56.645752 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m23:39:56.649395 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:39:56.650474 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:39:56.651450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m23:39:56.652474 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select date
from __dbt__cte__stg_housing_prices
where date is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.653377 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:39:56.654071 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:39:56.660612 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.024 seconds
[0m23:39:56.661177 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select day_of_week
from __dbt__cte__stg_housing_prices
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.661672 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:39:56.663334 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: ROLLBACK
[0m23:39:56.663959 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:39:56.665384 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: ROLLBACK
[0m23:39:56.665988 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: Close
[0m23:39:56.666648 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: Close
[0m23:39:56.667361 [info ] [Thread-4 (]: 18 of 40 PASS not_null_region_type_composition_with_macro_urban_count .......... [[32mPASS[0m in 0.09s]
[0m23:39:56.667917 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:39:56.668881 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:39:56.669580 [info ] [Thread-2 (]: 19 of 40 PASS not_null_stg_housing_prices_date ................................. [[32mPASS[0m in 0.08s]
[0m23:39:56.670170 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: BEGIN
[0m23:39:56.670769 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:39:56.671456 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:39:56.672064 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:39:56.672567 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:39:56.675038 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: ROLLBACK
[0m23:39:56.673085 [info ] [Thread-4 (]: 22 of 40 START test not_null_stg_housing_prices_month .......................... [RUN]
[0m23:39:56.675848 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:39:56.676893 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m23:39:56.677373 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: Close
[0m23:39:56.677911 [info ] [Thread-2 (]: 23 of 40 START test not_null_stg_housing_prices_price .......................... [RUN]
[0m23:39:56.678496 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:39:56.679700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m23:39:56.679271 [info ] [Thread-1 (]: 20 of 40 PASS not_null_stg_housing_prices_day_of_week .......................... [[32mPASS[0m in 0.08s]
[0m23:39:56.686212 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:39:56.686893 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m23:39:56.687381 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:39:56.688098 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:39:56.688694 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:39:56.689190 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:39:56.694801 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:39:56.695408 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:39:56.696105 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select id
from __dbt__cte__stg_housing_prices
where id is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.699018 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:39:56.699782 [info ] [Thread-1 (]: 24 of 40 START test not_null_stg_housing_prices_region ......................... [RUN]
[0m23:39:56.700578 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:39:56.701374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m23:39:56.701975 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:39:56.704752 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:39:56.705242 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:39:56.705728 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:39:56.706174 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: BEGIN
[0m23:39:56.707838 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: ROLLBACK
[0m23:39:56.708508 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:39:56.714272 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:39:56.714776 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:39:56.715338 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: BEGIN
[0m23:39:56.715747 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: Close
[0m23:39:56.716511 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:39:56.716942 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:39:56.721008 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:39:56.717702 [info ] [Thread-3 (]: 21 of 40 PASS not_null_stg_housing_prices_id ................................... [[32mPASS[0m in 0.08s]
[0m23:39:56.722150 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:39:56.722780 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:39:56.723654 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: BEGIN
[0m23:39:56.724245 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:39:56.724890 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:39:56.725499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:56.725951 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:39:56.726446 [info ] [Thread-3 (]: 25 of 40 START test not_null_stg_housing_prices_year ........................... [RUN]
[0m23:39:56.727396 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select month
from __dbt__cte__stg_housing_prices
where month is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.728067 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m23:39:56.728658 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:39:56.734613 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m23:39:56.736102 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:39:56.736821 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:39:56.737516 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:39:56.737970 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:39:56.738698 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select price
from __dbt__cte__stg_housing_prices
where price is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.739249 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:39:56.739656 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:39:56.741092 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: ROLLBACK
[0m23:39:56.741833 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select region
from __dbt__cte__stg_housing_prices
where region is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.745040 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:39:56.745548 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:39:56.746227 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: Close
[0m23:39:56.747950 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: ROLLBACK
[0m23:39:56.748705 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:39:56.749417 [info ] [Thread-4 (]: 22 of 40 PASS not_null_stg_housing_prices_month ................................ [[32mPASS[0m in 0.07s]
[0m23:39:56.750144 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: Close
[0m23:39:56.750644 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:39:56.752134 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: ROLLBACK
[0m23:39:56.752782 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:39:56.754141 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: BEGIN
[0m23:39:56.753662 [info ] [Thread-2 (]: 23 of 40 PASS not_null_stg_housing_prices_price ................................ [[32mPASS[0m in 0.07s]
[0m23:39:56.755175 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:39:56.755932 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: Close
[0m23:39:56.756379 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:39:56.757054 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:39:56.757576 [info ] [Thread-4 (]: 26 of 40 START test not_null_stg_location_data_postcode ........................ [RUN]
[0m23:39:56.758436 [info ] [Thread-1 (]: 24 of 40 PASS not_null_stg_housing_prices_region ............................... [[32mPASS[0m in 0.06s]
[0m23:39:56.759267 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:39:56.760316 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m23:39:56.761065 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:39:56.761584 [info ] [Thread-2 (]: 27 of 40 START test not_null_stg_location_data_region .......................... [RUN]
[0m23:39:56.762211 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:39:56.762888 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:39:56.763717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m23:39:56.768450 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:39:56.769222 [info ] [Thread-1 (]: 28 of 40 START test not_null_stg_location_data_type ............................ [RUN]
[0m23:39:56.769869 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:39:56.770518 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:39:56.771374 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:39:56.771958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m23:39:56.772465 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:39:56.776860 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:39:56.780015 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:39:56.780601 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:39:56.781172 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select year
from __dbt__cte__stg_housing_prices
where year is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.782283 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:39:56.782808 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:39:56.789702 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:39:56.793382 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:39:56.793978 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: BEGIN
[0m23:39:56.794985 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:39:56.795607 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:39:56.796673 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:39:56.797292 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:39:56.800318 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:39:56.801980 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: ROLLBACK
[0m23:39:56.802754 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: BEGIN
[0m23:39:56.803288 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:39:56.804203 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:39:56.805020 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:39:56.805396 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: Close
[0m23:39:56.805773 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:39:56.806371 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: BEGIN
[0m23:39:56.807125 [info ] [Thread-3 (]: 25 of 40 PASS not_null_stg_housing_prices_year ................................. [[32mPASS[0m in 0.08s]
[0m23:39:56.807670 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."stg_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.808328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:56.809100 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:39:56.809985 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:39:56.810531 [info ] [Thread-3 (]: 29 of 40 START test source_not_null_public_raw_housing_prices_date ............. [RUN]
[0m23:39:56.811054 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m23:39:56.811630 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:39:56.812139 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:39:56.814344 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: ROLLBACK
[0m23:39:56.814993 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:39:56.820090 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:39:56.820958 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:39:56.821756 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: Close
[0m23:39:56.822797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:39:56.823329 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."stg_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.824185 [info ] [Thread-4 (]: 26 of 40 PASS not_null_stg_location_data_postcode .............................. [[32mPASS[0m in 0.06s]
[0m23:39:56.824805 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:39:56.825262 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:39:56.826258 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:39:56.826983 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."stg_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.830238 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:39:56.830815 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:39:56.831301 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:39:56.833872 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: ROLLBACK
[0m23:39:56.834680 [info ] [Thread-4 (]: 30 of 40 START test source_not_null_public_raw_housing_prices_id ............... [RUN]
[0m23:39:56.835633 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:39:56.836141 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: Close
[0m23:39:56.836586 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m23:39:56.837072 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: BEGIN
[0m23:39:56.837510 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:39:56.838849 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:39:56.838290 [info ] [Thread-2 (]: 27 of 40 PASS not_null_stg_location_data_region ................................ [[32mPASS[0m in 0.07s]
[0m23:39:56.839697 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:39:56.841388 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: ROLLBACK
[0m23:39:56.846492 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:39:56.847268 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:39:56.848179 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: Close
[0m23:39:56.848786 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:39:56.849177 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:39:56.850033 [info ] [Thread-1 (]: 28 of 40 PASS not_null_stg_location_data_type .................................. [[32mPASS[0m in 0.08s]
[0m23:39:56.850597 [info ] [Thread-2 (]: 31 of 40 START test source_not_null_public_raw_housing_prices_price ............ [RUN]
[0m23:39:56.854464 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:39:56.855374 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:39:56.855822 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m23:39:56.856325 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m23:39:56.857305 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:39:56.857863 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:39:56.858434 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:39:56.858946 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:39:56.859428 [info ] [Thread-1 (]: 32 of 40 START test source_not_null_public_raw_housing_prices_region ........... [RUN]
[0m23:39:56.860013 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: BEGIN
[0m23:39:56.860535 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "dwh"."public"."raw_housing_prices"
where date is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.865461 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:39:56.866075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m23:39:56.866587 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:39:56.867295 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:39:56.868140 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:39:56.868752 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:39:56.873361 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:39:56.876419 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:39:56.878136 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: ROLLBACK
[0m23:39:56.878671 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:39:56.879264 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:39:56.880030 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:39:56.880431 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: Close
[0m23:39:56.880877 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:39:56.883883 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:39:56.884383 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: BEGIN
[0m23:39:56.884983 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dwh"."public"."raw_housing_prices"
where id is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.885585 [info ] [Thread-3 (]: 29 of 40 PASS source_not_null_public_raw_housing_prices_date ................... [[32mPASS[0m in 0.07s]
[0m23:39:56.886253 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:39:56.887040 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:39:56.887828 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:39:56.888339 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:39:56.889027 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: BEGIN
[0m23:39:56.889576 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:39:56.891412 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: ROLLBACK
[0m23:39:56.891904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:56.892373 [info ] [Thread-3 (]: 33 of 40 START test source_not_null_public_raw_location_data_postcode .......... [RUN]
[0m23:39:56.893661 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: Close
[0m23:39:56.894303 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m23:39:56.895752 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:39:56.895237 [info ] [Thread-4 (]: 30 of 40 PASS source_not_null_public_raw_housing_prices_id ..................... [[32mPASS[0m in 0.06s]
[0m23:39:56.901794 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m23:39:56.904254 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:39:56.905095 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:39:56.905850 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:39:56.906536 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:39:56.907363 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:39:56.907891 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:39:56.908435 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:39:56.908930 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dwh"."public"."raw_housing_prices"
where price is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.911737 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:39:56.912324 [info ] [Thread-4 (]: 34 of 40 START test source_not_null_public_raw_location_data_region ............ [RUN]
[0m23:39:56.912934 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_housing_prices"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.914102 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m23:39:56.914708 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:39:56.915217 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:39:56.915720 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:39:56.916158 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: BEGIN
[0m23:39:56.917815 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: ROLLBACK
[0m23:39:56.918387 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:39:56.922926 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:39:56.923608 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:39:56.925309 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: ROLLBACK
[0m23:39:56.925797 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: Close
[0m23:39:56.926917 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:39:56.927331 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: Close
[0m23:39:56.927979 [info ] [Thread-2 (]: 31 of 40 PASS source_not_null_public_raw_housing_prices_price .................. [[32mPASS[0m in 0.07s]
[0m23:39:56.931548 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:39:56.932407 [info ] [Thread-1 (]: 32 of 40 PASS source_not_null_public_raw_housing_prices_region ................. [[32mPASS[0m in 0.07s]
[0m23:39:56.933209 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:39:56.934390 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:39:56.934853 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:39:56.935391 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:39:56.935962 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:39:56.936639 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m23:39:56.937212 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:39:56.937661 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: BEGIN
[0m23:39:56.938129 [info ] [Thread-2 (]: 35 of 40 START test source_not_null_public_raw_location_data_type .............. [RUN]
[0m23:39:56.938666 [info ] [Thread-1 (]: 36 of 40 START test source_unique_public_raw_housing_prices_id ................. [RUN]
[0m23:39:56.939349 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."raw_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.939869 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:39:56.940413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m23:39:56.940887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68)
[0m23:39:56.941802 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:39:56.942390 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m23:39:56.942948 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:39:56.947799 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:39:56.953850 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m23:39:56.955920 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m23:39:56.957458 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: ROLLBACK
[0m23:39:56.958046 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:39:56.958578 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:39:56.959186 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m23:39:56.959619 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: Close
[0m23:39:56.960078 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.963004 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:39:56.965691 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m23:39:56.966608 [info ] [Thread-3 (]: 33 of 40 PASS source_not_null_public_raw_location_data_postcode ................ [[32mPASS[0m in 0.07s]
[0m23:39:56.967853 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:39:56.968823 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:39:56.969264 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m23:39:56.969664 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:39:56.970136 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: BEGIN
[0m23:39:56.970618 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m23:39:56.971195 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68: BEGIN
[0m23:39:56.972753 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: ROLLBACK
[0m23:39:56.973295 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:39:56.973789 [info ] [Thread-3 (]: 37 of 40 START test source_unique_public_raw_location_data_postcode ............ [RUN]
[0m23:39:56.974357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:56.975159 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: Close
[0m23:39:56.975673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c, now test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175)
[0m23:39:56.976659 [info ] [Thread-4 (]: 34 of 40 PASS source_not_null_public_raw_location_data_region .................. [[32mPASS[0m in 0.06s]
[0m23:39:56.977179 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m23:39:56.978053 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:39:56.983005 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m23:39:56.983895 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m23:39:56.984635 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:39:56.985488 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:39:56.986373 [info ] [Thread-4 (]: 38 of 40 START test unique_stg_housing_prices_id ............................... [RUN]
[0m23:39:56.987338 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m23:39:56.988044 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:39:56.988575 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m23:39:56.989069 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e, now test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905)
[0m23:39:56.992095 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m23:39:56.992706 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."raw_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:39:56.993301 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dwh"."public"."raw_housing_prices"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:39:56.993880 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m23:39:56.994879 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m23:39:57.002236 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m23:39:57.002786 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:39:57.003310 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:39:57.003731 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175: BEGIN
[0m23:39:57.005426 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: ROLLBACK
[0m23:39:57.006834 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68: ROLLBACK
[0m23:39:57.007251 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m23:39:57.007700 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:39:57.012550 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m23:39:57.013255 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68: Close
[0m23:39:57.013709 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: Close
[0m23:39:57.015093 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m23:39:57.015966 [error] [Thread-1 (]: 36 of 40 FAIL 1500 source_unique_public_raw_housing_prices_id .................. [[31mFAIL 1500[0m in 0.08s]
[0m23:39:57.017554 [debug] [Thread-4 (]: On test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905: BEGIN
[0m23:39:57.016921 [info ] [Thread-2 (]: 35 of 40 PASS source_not_null_public_raw_location_data_type .................... [[32mPASS[0m in 0.08s]
[0m23:39:57.018713 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m23:39:57.019292 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:39:57.019973 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:39:57.020709 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m23:39:57.022130 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:39:57.023269 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m23:39:57.023880 [info ] [Thread-1 (]: 39 of 40 START test unique_stg_location_data_postcode .......................... [RUN]
[0m23:39:57.024530 [info ] [Thread-2 (]: 40 of 40 START test valid_values_stg_location_data_type__URBAN__RURAL .......... [RUN]
[0m23:39:57.025389 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m23:39:57.026312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68, now test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2)
[0m23:39:57.027198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522, now test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91)
[0m23:39:57.027839 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    postcode as unique_field,
    count(*) as n_records

from "dwh"."public"."raw_location_data"
where postcode is not null
group by postcode
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:39:57.028469 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m23:39:57.028923 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:39:57.034130 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m23:39:57.040399 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:39:57.040855 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m23:39:57.044015 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:39:57.045950 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175: ROLLBACK
[0m23:39:57.046623 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m23:39:57.047091 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m23:39:57.047970 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:39:57.048446 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175: Close
[0m23:39:57.048917 [debug] [Thread-4 (]: On test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select
    id as unique_field,
    count(*) as n_records

from __dbt__cte__stg_housing_prices
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:39:57.051933 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m23:39:57.054722 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:39:57.055537 [error] [Thread-3 (]: 37 of 40 FAIL 1500 source_unique_public_raw_location_data_postcode ............. [[31mFAIL 1500[0m in 0.08s]
[0m23:39:57.057162 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m23:39:57.058258 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m23:39:57.058806 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:39:57.059217 [debug] [Thread-1 (]: On test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2: BEGIN
[0m23:39:57.059736 [debug] [Thread-2 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: BEGIN
[0m23:39:57.060146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:57.060623 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:39:57.061202 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:39:57.063529 [debug] [Thread-4 (]: On test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905: ROLLBACK
[0m23:39:57.064222 [debug] [Thread-4 (]: On test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905: Close
[0m23:39:57.064903 [error] [Thread-4 (]: 38 of 40 FAIL 1500 unique_stg_housing_prices_id ................................ [[31mFAIL 1500[0m in 0.08s]
[0m23:39:57.065716 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m23:39:57.068766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:39:57.069501 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:39:57.069943 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m23:39:57.070519 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:39:57.071283 [debug] [Thread-1 (]: On test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    postcode as unique_field,
    count(*) as n_records

from "dwh"."public"."stg_location_data"
where postcode is not null
group by postcode
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:39:57.072161 [debug] [Thread-2 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    SELECT *
    FROM "dwh"."public"."stg_location_data"
    WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'UNKNOWN'

  
  
      
    ) dbt_internal_test
[0m23:39:57.077825 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:39:57.079359 [debug] [Thread-1 (]: On test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2: ROLLBACK
[0m23:39:57.079915 [debug] [Thread-1 (]: On test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2: Close
[0m23:39:57.080531 [error] [Thread-1 (]: 39 of 40 FAIL 1500 unique_stg_location_data_postcode ........................... [[31mFAIL 1500[0m in 0.05s]
[0m23:39:57.081224 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m23:39:57.086524 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:39:57.088193 [debug] [Thread-2 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: ROLLBACK
[0m23:39:57.088858 [debug] [Thread-2 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: Close
[0m23:39:57.089551 [error] [Thread-2 (]: 40 of 40 FAIL 3766 valid_values_stg_location_data_type__URBAN__RURAL ........... [[31mFAIL 3766[0m in 0.06s]
[0m23:39:57.090195 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:39:57.092255 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:57.092647 [debug] [MainThread]: On master: BEGIN
[0m23:39:57.092960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:39:57.100224 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:39:57.100727 [debug] [MainThread]: On master: COMMIT
[0m23:39:57.101079 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:57.101493 [debug] [MainThread]: On master: COMMIT
[0m23:39:57.102025 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:39:57.102345 [debug] [MainThread]: On master: Close
[0m23:39:57.102791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:57.103052 [debug] [MainThread]: Connection 'test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2' was properly closed.
[0m23:39:57.103351 [debug] [MainThread]: Connection 'test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91' was properly closed.
[0m23:39:57.103605 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175' was properly closed.
[0m23:39:57.103867 [debug] [MainThread]: Connection 'test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905' was properly closed.
[0m23:39:57.104216 [info ] [MainThread]: 
[0m23:39:57.104559 [info ] [MainThread]: Finished running 40 data tests in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m23:39:57.112130 [debug] [MainThread]: Command end result
[0m23:39:57.150290 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:39:57.151848 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:39:57.160331 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:39:57.160719 [info ] [MainThread]: 
[0m23:39:57.161113 [info ] [MainThread]: [31mCompleted with 10 errors, 0 partial successes, and 0 warnings:[0m
[0m23:39:57.161425 [info ] [MainThread]: 
[0m23:39:57.161980 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_pct_urban (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:39:57.162463 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:39:57.162831 [info ] [MainThread]: 
[0m23:39:57.163454 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_pct_urban.sql
[0m23:39:57.163897 [info ] [MainThread]: 
[0m23:39:57.164479 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_urban_count (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:39:57.164976 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:39:57.165421 [info ] [MainThread]: 
[0m23:39:57.166193 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_urban_count.sql
[0m23:39:57.166808 [info ] [MainThread]: 
[0m23:39:57.167437 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_rural_count (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:39:57.167999 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:39:57.168424 [info ] [MainThread]: 
[0m23:39:57.169022 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_rural_count.sql
[0m23:39:57.169495 [info ] [MainThread]: 
[0m23:39:57.169986 [error] [MainThread]:   Database Error in test not_null_region_type_composition_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_locations.sql
[0m23:39:57.170607 [info ] [MainThread]: 
[0m23:39:57.171253 [error] [MainThread]:   Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:39:57.171875 [info ] [MainThread]: 
[0m23:39:57.172647 [error] [MainThread]: [31mFailure in test source_unique_public_raw_housing_prices_id (models/airflow_dbt_training/bronze/schema.yml)[0m
[0m23:39:57.173221 [error] [MainThread]:   Got 1500 results, configured to fail if != 0
[0m23:39:57.173663 [info ] [MainThread]: 
[0m23:39:57.174163 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/bronze/schema.yml/source_unique_public_raw_housing_prices_id.sql
[0m23:39:57.174538 [info ] [MainThread]: 
[0m23:39:57.175053 [error] [MainThread]: [31mFailure in test source_unique_public_raw_location_data_postcode (models/airflow_dbt_training/bronze/schema.yml)[0m
[0m23:39:57.175467 [error] [MainThread]:   Got 1500 results, configured to fail if != 0
[0m23:39:57.175804 [info ] [MainThread]: 
[0m23:39:57.176281 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/bronze/schema.yml/source_unique_public_raw_location_data_postcode.sql
[0m23:39:57.176621 [info ] [MainThread]: 
[0m23:39:57.177232 [error] [MainThread]: [31mFailure in test unique_stg_housing_prices_id (models/airflow_dbt_training/silver/schema.yml)[0m
[0m23:39:57.177672 [error] [MainThread]:   Got 1500 results, configured to fail if != 0
[0m23:39:57.178160 [info ] [MainThread]: 
[0m23:39:57.178913 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/silver/schema.yml/unique_stg_housing_prices_id.sql
[0m23:39:57.179316 [info ] [MainThread]: 
[0m23:39:57.179792 [error] [MainThread]: [31mFailure in test unique_stg_location_data_postcode (models/airflow_dbt_training/silver/schema.yml)[0m
[0m23:39:57.180229 [error] [MainThread]:   Got 1500 results, configured to fail if != 0
[0m23:39:57.180565 [info ] [MainThread]: 
[0m23:39:57.181072 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/silver/schema.yml/unique_stg_location_data_postcode.sql
[0m23:39:57.181416 [info ] [MainThread]: 
[0m23:39:57.181969 [error] [MainThread]: [31mFailure in test valid_values_stg_location_data_type__URBAN__RURAL (models/airflow_dbt_training/silver/schema.yml)[0m
[0m23:39:57.182473 [error] [MainThread]:   Got 3766 results, configured to fail if != 0
[0m23:39:57.182819 [info ] [MainThread]: 
[0m23:39:57.183383 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/silver/schema.yml/valid_values_stg_location_data_type__URBAN__RURAL.sql
[0m23:39:57.183907 [info ] [MainThread]: 
[0m23:39:57.184449 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=10 SKIP=0 TOTAL=40
[0m23:39:57.185771 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.8245448, "process_in_blocks": "1264", "process_kernel_time": 0.181619, "process_mem_max_rss": "121720", "process_out_blocks": "3336", "process_user_time": 3.037086}
[0m23:39:57.186281 [debug] [MainThread]: Command `dbt test` failed at 23:39:57.186182 after 1.83 seconds
[0m23:39:57.186686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9e5f4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9e5f4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a276490>]}
[0m23:39:57.187100 [debug] [MainThread]: Flushing usage events
[0m23:39:57.766922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:40:24.076635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e6380ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e6380ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e6380b510>]}


============================== 23:40:24.079416 | 7b24faf4-1d30-454e-8923-744fc31aaf69 ==============================
[0m23:40:24.079416 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:40:24.079968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m23:40:24.230271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b24faf4-1d30-454e-8923-744fc31aaf69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e639ef8d0>]}
[0m23:40:24.287438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b24faf4-1d30-454e-8923-744fc31aaf69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e62ba6650>]}
[0m23:40:24.288173 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:40:24.368107 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:40:24.499824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:40:24.500789 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/gold/schema.yml
[0m23:40:24.933304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b24faf4-1d30-454e-8923-744fc31aaf69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e627eefd0>]}
[0m23:40:25.035295 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:40:25.037792 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:40:25.102390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b24faf4-1d30-454e-8923-744fc31aaf69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e61b82150>]}
[0m23:40:25.102888 [info ] [MainThread]: Found 9 models, 40 data tests, 2 sources, 436 macros
[0m23:40:25.103293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b24faf4-1d30-454e-8923-744fc31aaf69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e623b2890>]}
[0m23:40:25.108447 [info ] [MainThread]: 
[0m23:40:25.109167 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:40:25.109844 [info ] [MainThread]: 
[0m23:40:25.110947 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:40:25.117184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m23:40:25.157647 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:40:25.158021 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:40:25.158289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:25.167362 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m23:40:25.167968 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:40:25.168547 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:40:25.171620 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m23:40:25.173075 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:40:25.173528 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:40:25.180528 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:25.181039 [debug] [MainThread]: On master: BEGIN
[0m23:40:25.181302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:40:25.187740 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:40:25.188200 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:25.189095 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:40:25.193570 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m23:40:25.196295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b24faf4-1d30-454e-8923-744fc31aaf69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e627f0cd0>]}
[0m23:40:25.196715 [debug] [MainThread]: On master: ROLLBACK
[0m23:40:25.197186 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:25.197468 [debug] [MainThread]: On master: BEGIN
[0m23:40:25.198091 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:40:25.198400 [debug] [MainThread]: On master: COMMIT
[0m23:40:25.198710 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:25.199006 [debug] [MainThread]: On master: COMMIT
[0m23:40:25.199472 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:40:25.199792 [debug] [MainThread]: On master: Close
[0m23:40:25.203835 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:40:25.204329 [info ] [Thread-1 (]: 1 of 40 START test accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [RUN]
[0m23:40:25.204953 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:40:25.205488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m23:40:25.205943 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:40:25.206394 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:40:25.206891 [info ] [Thread-2 (]: 2 of 40 START test accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [RUN]
[0m23:40:25.207493 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:40:25.208015 [info ] [Thread-3 (]: 3 of 40 START test not_null_mart_housing_prices_breakdown_avg_price ............ [RUN]
[0m23:40:25.208661 [info ] [Thread-4 (]: 4 of 40 START test not_null_mart_housing_prices_breakdown_n_sales .............. [RUN]
[0m23:40:25.209604 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e'
[0m23:40:25.226114 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d'
[0m23:40:25.232244 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:40:25.232934 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7'
[0m23:40:25.233408 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:40:25.233859 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:40:25.234439 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:40:25.238319 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:40:25.246578 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:40:25.260969 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:40:25.263169 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:40:25.264342 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:40:25.264956 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:40:25.265371 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:40:25.271100 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:40:25.301853 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:40:25.302671 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:40:25.305404 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:40:25.308094 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:40:25.309113 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:40:25.309633 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:40:25.310643 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:40:25.311171 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:40:25.311593 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: BEGIN
[0m23:40:25.312045 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: BEGIN
[0m23:40:25.312517 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: BEGIN
[0m23:40:25.313093 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: BEGIN
[0m23:40:25.313550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:25.313983 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:40:25.314405 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:40:25.314842 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:40:25.321534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:40:25.322165 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:40:25.322849 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:40:25.323441 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:40:25.324112 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m23:40:25.324691 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:40:25.325312 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        day_of_week as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by day_of_week

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m23:40:25.325856 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:40:25.326293 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:40:25.326801 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_price
from "dwh"."public"."mart_housing_prices_breakdown"
where avg_price is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.327466 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        month as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by month

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','7','8','9','10','11','12'
)



  
  
      
    ) dbt_internal_test
[0m23:40:25.328023 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select n_sales
from "dwh"."public"."mart_housing_prices_breakdown"
where n_sales is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.333876 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:40:25.338099 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: ROLLBACK
[0m23:40:25.338572 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:40:25.339070 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:40:25.339480 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:40:25.341087 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: ROLLBACK
[0m23:40:25.341522 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: Close
[0m23:40:25.342841 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: ROLLBACK
[0m23:40:25.344170 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: ROLLBACK
[0m23:40:25.344818 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: Close
[0m23:40:25.345445 [info ] [Thread-4 (]: 4 of 40 PASS not_null_mart_housing_prices_breakdown_n_sales .................... [[32mPASS[0m in 0.11s]
[0m23:40:25.346110 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: Close
[0m23:40:25.346580 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: Close
[0m23:40:25.347287 [info ] [Thread-3 (]: 3 of 40 PASS not_null_mart_housing_prices_breakdown_avg_price .................. [[32mPASS[0m in 0.12s]
[0m23:40:25.348046 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:40:25.348886 [info ] [Thread-2 (]: 2 of 40 PASS accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [[32mPASS[0m in 0.14s]
[0m23:40:25.350592 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:40:25.349825 [info ] [Thread-1 (]: 1 of 40 PASS accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [[32mPASS[0m in 0.14s]
[0m23:40:25.351705 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:40:25.352561 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:40:25.353101 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:40:25.353971 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:40:25.354564 [info ] [Thread-4 (]: 5 of 40 START test not_null_mart_housing_prices_breakdown_pct_urban ............ [RUN]
[0m23:40:25.355369 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:40:25.356095 [info ] [Thread-3 (]: 6 of 40 START test not_null_mart_housing_prices_breakdown_region ............... [RUN]
[0m23:40:25.356787 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:40:25.357717 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e)
[0m23:40:25.358417 [info ] [Thread-2 (]: 7 of 40 START test not_null_mart_housing_prices_breakdown_rural_count .......... [RUN]
[0m23:40:25.359125 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m23:40:25.359711 [info ] [Thread-1 (]: 8 of 40 START test not_null_mart_housing_prices_breakdown_urban_count .......... [RUN]
[0m23:40:25.360439 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:40:25.361059 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281)
[0m23:40:25.361570 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:40:25.362084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de)
[0m23:40:25.367099 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:40:25.367715 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:40:25.372322 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:40:25.372876 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:40:25.377658 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:40:25.378639 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:40:25.383087 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:40:25.383543 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:40:25.386674 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:40:25.387363 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:40:25.390380 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:40:25.391065 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:40:25.393772 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:40:25.394265 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:40:25.397072 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:40:25.397787 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:40:25.398185 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: BEGIN
[0m23:40:25.398884 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:40:25.399366 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: BEGIN
[0m23:40:25.399859 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:25.400308 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:40:25.400805 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: BEGIN
[0m23:40:25.401233 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:40:25.401917 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: BEGIN
[0m23:40:25.402348 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:40:25.402954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:25.408028 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:40:25.408835 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:40:25.409742 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."mart_housing_prices_breakdown"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.410311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:40:25.410946 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m23:40:25.411412 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:40:25.412062 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:40:25.412534 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:40:25.412973 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:40:25.413454 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."mart_housing_prices_breakdown"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.413968 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."mart_housing_prices_breakdown"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.414426 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:40:25.414852 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."mart_housing_prices_breakdown"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.416601 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: ROLLBACK
[0m23:40:25.417328 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: Close
[0m23:40:25.418043 [info ] [Thread-3 (]: 6 of 40 PASS not_null_mart_housing_prices_breakdown_region ..................... [[32mPASS[0m in 0.06s]
[0m23:40:25.418728 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:40:25.419189 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:40:25.419744 [info ] [Thread-3 (]: 9 of 40 START test not_null_region_type_composition_pct_urban .................. [RUN]
[0m23:40:25.420312 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m23:40:25.420787 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:40:25.427403 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:40:25.428067 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:40:25.431070 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:40:25.431624 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:40:25.432806 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:40:25.434280 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: ROLLBACK
[0m23:40:25.434775 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:40:25.435183 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.018 seconds
[0m23:40:25.436756 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: ROLLBACK
[0m23:40:25.437427 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: BEGIN
[0m23:40:25.437894 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: Close
[0m23:40:25.439325 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: ROLLBACK
[0m23:40:25.439852 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:25.440259 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: Close
[0m23:40:25.440987 [error] [Thread-1 (]: 8 of 40 FAIL 5 not_null_mart_housing_prices_breakdown_urban_count .............. [[31mFAIL 5[0m in 0.08s]
[0m23:40:25.441993 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: Close
[0m23:40:25.443171 [error] [Thread-4 (]: 5 of 40 FAIL 5 not_null_mart_housing_prices_breakdown_pct_urban ................ [[31mFAIL 5[0m in 0.09s]
[0m23:40:25.444038 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:40:25.445609 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:40:25.444993 [error] [Thread-2 (]: 7 of 40 FAIL 5 not_null_mart_housing_prices_breakdown_rural_count .............. [[31mFAIL 5[0m in 0.08s]
[0m23:40:25.446297 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:40:25.446952 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:40:25.447759 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:40:25.448690 [info ] [Thread-1 (]: 10 of 40 START test not_null_region_type_composition_region .................... [RUN]
[0m23:40:25.450024 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m23:40:25.449380 [info ] [Thread-4 (]: 11 of 40 START test not_null_region_type_composition_rural_count ............... [RUN]
[0m23:40:25.450954 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:40:25.451753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m23:40:25.452330 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:40:25.452846 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m23:40:25.453319 [info ] [Thread-2 (]: 12 of 40 START test not_null_region_type_composition_total_count ............... [RUN]
[0m23:40:25.454066 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:40:25.454773 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.455280 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:40:25.455820 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281, now test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7)
[0m23:40:25.460587 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:40:25.465715 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:40:25.466365 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:40:25.467505 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:40:25.471848 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:40:25.472388 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:40:25.472953 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:40:25.475786 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:40:25.478747 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:40:25.480463 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: ROLLBACK
[0m23:40:25.480944 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:40:25.482101 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:40:25.484860 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:40:25.485335 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: Close
[0m23:40:25.485828 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:40:25.486276 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: BEGIN
[0m23:40:25.487029 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: BEGIN
[0m23:40:25.487466 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:40:25.488064 [info ] [Thread-3 (]: 9 of 40 PASS not_null_region_type_composition_pct_urban ........................ [[32mPASS[0m in 0.07s]
[0m23:40:25.488517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:25.488928 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:40:25.489391 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: BEGIN
[0m23:40:25.490035 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:40:25.491021 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:40:25.491620 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:40:25.492433 [info ] [Thread-3 (]: 13 of 40 START test not_null_region_type_composition_urban_count ............... [RUN]
[0m23:40:25.493135 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m23:40:25.493754 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:40:25.499651 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:40:25.500934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:40:25.501574 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:40:25.502250 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m23:40:25.503058 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:40:25.504030 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:40:25.504566 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:40:25.505114 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:40:25.505759 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.506341 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_count
from "dwh"."public"."region_type_composition"
where total_count is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.509326 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:40:25.509972 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.511188 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:40:25.511724 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "total_count" does not exist
LINE 16: select total_count
                ^
HINT:  Perhaps you meant to reference the column "region_type_composition.rural_count".

[0m23:40:25.512240 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: BEGIN
[0m23:40:25.512774 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: ROLLBACK
[0m23:40:25.513325 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:25.514321 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: Close
[0m23:40:25.520039 [debug] [Thread-2 (]: Database Error in test not_null_region_type_composition_total_count (models/airflow_dbt_training/gold/schema.yml)
  column "total_count" does not exist
  LINE 16: select total_count
                  ^
  HINT:  Perhaps you meant to reference the column "region_type_composition.rural_count".
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_count.sql
[0m23:40:25.520835 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:40:25.521935 [error] [Thread-2 (]: 12 of 40 ERROR not_null_region_type_composition_total_count .................... [[31mERROR[0m in 0.07s]
[0m23:40:25.524192 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: ROLLBACK
[0m23:40:25.524704 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:40:25.525533 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:40:25.526230 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:40:25.526896 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: Close
[0m23:40:25.527560 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:40:25.528100 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:40:25.528808 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_total_count (models/airflow_dbt_training/gold/schema.yml)
  column "total_count" does not exist
  LINE 16: select total_count
                  ^
  HINT:  Perhaps you meant to reference the column "region_type_composition.rural_count".
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_count.sql.
[0m23:40:25.529460 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.531863 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: ROLLBACK
[0m23:40:25.532822 [info ] [Thread-1 (]: 10 of 40 PASS not_null_region_type_composition_region .......................... [[32mPASS[0m in 0.08s]
[0m23:40:25.533692 [info ] [Thread-2 (]: 14 of 40 START test not_null_region_type_composition_with_macro_pct_urban ...... [RUN]
[0m23:40:25.536177 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:40:25.537039 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: Close
[0m23:40:25.537663 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91)
[0m23:40:25.538274 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:40:25.539684 [info ] [Thread-4 (]: 11 of 40 PASS not_null_region_type_composition_rural_count ..................... [[32mPASS[0m in 0.09s]
[0m23:40:25.540448 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:40:25.541288 [info ] [Thread-1 (]: 15 of 40 START test not_null_region_type_composition_with_macro_region ......... [RUN]
[0m23:40:25.542298 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:40:25.549385 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:40:25.550151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192)
[0m23:40:25.551062 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:40:25.551798 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:40:25.552424 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:40:25.552981 [info ] [Thread-4 (]: 16 of 40 START test not_null_region_type_composition_with_macro_rural_count .... [RUN]
[0m23:40:25.554787 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: ROLLBACK
[0m23:40:25.555216 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:40:25.561738 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:40:25.562297 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797)
[0m23:40:25.565355 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:40:25.565903 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: Close
[0m23:40:25.566609 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:40:25.566958 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:40:25.571886 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:40:25.576151 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:40:25.576689 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:40:25.572847 [info ] [Thread-3 (]: 13 of 40 PASS not_null_region_type_composition_urban_count ..................... [[32mPASS[0m in 0.08s]
[0m23:40:25.577945 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: BEGIN
[0m23:40:25.578365 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:40:25.578838 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:40:25.579491 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:40:25.579930 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:40:25.582888 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:40:25.583504 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: BEGIN
[0m23:40:25.584068 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:40:25.585019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:25.585583 [info ] [Thread-3 (]: 17 of 40 START test not_null_region_type_composition_with_macro_total_locations  [RUN]
[0m23:40:25.586152 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:40:25.586833 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae)
[0m23:40:25.587434 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: BEGIN
[0m23:40:25.588080 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:40:25.588552 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:40:25.593001 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:40:25.594719 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m23:40:25.595442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:40:25.596193 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:40:25.596828 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:40:25.597310 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:40:25.597797 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition_with_macro"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.600896 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:40:25.601662 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition_with_macro"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.602197 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m23:40:25.603311 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:40:25.603803 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:40:25.604264 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: BEGIN
[0m23:40:25.604748 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition_with_macro"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.605261 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:25.609730 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:40:25.611276 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: ROLLBACK
[0m23:40:25.611947 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: Close
[0m23:40:25.613276 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:40:25.612774 [info ] [Thread-1 (]: 15 of 40 PASS not_null_region_type_composition_with_macro_region ............... [[32mPASS[0m in 0.06s]
[0m23:40:25.614199 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:40:25.615159 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:40:25.615795 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_locations
from "dwh"."public"."region_type_composition_with_macro"
where total_locations is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.616405 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:40:25.617167 [info ] [Thread-1 (]: 18 of 40 START test not_null_region_type_composition_with_macro_urban_count .... [RUN]
[0m23:40:25.618739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224)
[0m23:40:25.619821 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "total_locations" does not exist
LINE 16: select total_locations
                ^

[0m23:40:25.620744 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:40:25.621369 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: ROLLBACK
[0m23:40:25.626678 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:40:25.627476 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.022 seconds
[0m23:40:25.628077 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.025 seconds
[0m23:40:25.629175 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: Close
[0m23:40:25.632122 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: ROLLBACK
[0m23:40:25.632838 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:40:25.634373 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: ROLLBACK
[0m23:40:25.636552 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: Close
[0m23:40:25.639873 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:40:25.641813 [debug] [Thread-3 (]: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:40:25.643273 [info ] [Thread-4 (]: 16 of 40 PASS not_null_region_type_composition_with_macro_rural_count .......... [[32mPASS[0m in 0.08s]
[0m23:40:25.644387 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: Close
[0m23:40:25.645982 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:40:25.645177 [error] [Thread-3 (]: 17 of 40 ERROR not_null_region_type_composition_with_macro_total_locations ..... [[31mERROR[0m in 0.06s]
[0m23:40:25.647118 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:40:25.648936 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: BEGIN
[0m23:40:25.648179 [info ] [Thread-2 (]: 14 of 40 PASS not_null_region_type_composition_with_macro_pct_urban ............ [[32mPASS[0m in 0.11s]
[0m23:40:25.650153 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:40:25.650889 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:40:25.651572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:25.652275 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:40:25.652746 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:40:25.653392 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql.
[0m23:40:25.653917 [info ] [Thread-4 (]: 19 of 40 START test not_null_stg_housing_prices_date ........................... [RUN]
[0m23:40:25.655039 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:40:25.655633 [info ] [Thread-3 (]: 20 of 40 START test not_null_stg_housing_prices_day_of_week .................... [RUN]
[0m23:40:25.656586 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m23:40:25.657187 [info ] [Thread-2 (]: 21 of 40 START test not_null_stg_housing_prices_id ............................. [RUN]
[0m23:40:25.657852 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m23:40:25.658508 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:40:25.659069 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m23:40:25.659551 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:40:25.665577 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:40:25.666456 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:40:25.667335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m23:40:25.673636 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:40:25.679251 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:40:25.680015 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:40:25.680493 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:40:25.681355 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:40:25.681782 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:40:25.682270 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition_with_macro"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.686903 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:40:25.689567 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:40:25.692130 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:40:25.693404 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:40:25.694172 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:40:25.694583 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: BEGIN
[0m23:40:25.694982 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:40:25.695419 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: BEGIN
[0m23:40:25.695831 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:40:25.696306 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: BEGIN
[0m23:40:25.696733 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:25.697414 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:40:25.703683 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:40:25.704423 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:40:25.704817 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:40:25.705232 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:40:25.705715 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:40:25.706186 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:40:25.706705 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select date
from __dbt__cte__stg_housing_prices
where date is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.707364 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select id
from __dbt__cte__stg_housing_prices
where id is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.707889 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m23:40:25.708442 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select day_of_week
from __dbt__cte__stg_housing_prices
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.710354 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: ROLLBACK
[0m23:40:25.710783 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:40:25.712299 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: ROLLBACK
[0m23:40:25.712678 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: Close
[0m23:40:25.713188 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: Close
[0m23:40:25.713838 [info ] [Thread-1 (]: 18 of 40 PASS not_null_region_type_composition_with_macro_urban_count .......... [[32mPASS[0m in 0.10s]
[0m23:40:25.714455 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:40:25.715116 [info ] [Thread-2 (]: 21 of 40 PASS not_null_stg_housing_prices_id ................................... [[32mPASS[0m in 0.06s]
[0m23:40:25.716066 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:40:25.717654 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: ROLLBACK
[0m23:40:25.718185 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:40:25.718794 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:40:25.719355 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:40:25.720033 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: Close
[0m23:40:25.721642 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: ROLLBACK
[0m23:40:25.722284 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:40:25.722886 [info ] [Thread-1 (]: 22 of 40 START test not_null_stg_housing_prices_month .......................... [RUN]
[0m23:40:25.723919 [info ] [Thread-4 (]: 19 of 40 PASS not_null_stg_housing_prices_date ................................. [[32mPASS[0m in 0.07s]
[0m23:40:25.724670 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: Close
[0m23:40:25.725141 [info ] [Thread-2 (]: 23 of 40 START test not_null_stg_housing_prices_price .......................... [RUN]
[0m23:40:25.725825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m23:40:25.726514 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:40:25.727350 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m23:40:25.728001 [info ] [Thread-3 (]: 20 of 40 PASS not_null_stg_housing_prices_day_of_week .......................... [[32mPASS[0m in 0.07s]
[0m23:40:25.728643 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:40:25.729196 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:40:25.729846 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:40:25.730502 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:40:25.736533 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:40:25.737039 [info ] [Thread-4 (]: 24 of 40 START test not_null_stg_housing_prices_region ......................... [RUN]
[0m23:40:25.742814 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:40:25.743413 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:40:25.744245 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m23:40:25.744790 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:40:25.745535 [info ] [Thread-3 (]: 25 of 40 START test not_null_stg_housing_prices_year ........................... [RUN]
[0m23:40:25.746192 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:40:25.746614 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:40:25.749724 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:40:25.750289 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m23:40:25.755586 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:40:25.758606 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:40:25.759398 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:40:25.760400 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:40:25.761124 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:40:25.766731 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:40:25.767320 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: BEGIN
[0m23:40:25.767873 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:40:25.770663 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:40:25.771417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:25.771927 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: BEGIN
[0m23:40:25.772343 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:40:25.773203 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:40:25.773638 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:40:25.776549 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:40:25.777319 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: BEGIN
[0m23:40:25.777895 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:40:25.778541 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:40:25.778949 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: BEGIN
[0m23:40:25.779385 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:25.779779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:40:25.780443 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:40:25.781062 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select month
from __dbt__cte__stg_housing_prices
where month is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.784074 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:40:25.784611 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:40:25.785470 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select price
from __dbt__cte__stg_housing_prices
where price is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.786211 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:40:25.786697 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:40:25.787261 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:40:25.787966 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select region
from __dbt__cte__stg_housing_prices
where region is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.788514 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:40:25.789000 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:40:25.789405 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:40:25.791093 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: ROLLBACK
[0m23:40:25.792490 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: ROLLBACK
[0m23:40:25.792889 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:40:25.793383 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select year
from __dbt__cte__stg_housing_prices
where year is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.794943 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: ROLLBACK
[0m23:40:25.795452 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: Close
[0m23:40:25.795847 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: Close
[0m23:40:25.796680 [info ] [Thread-2 (]: 23 of 40 PASS not_null_stg_housing_prices_price ................................ [[32mPASS[0m in 0.07s]
[0m23:40:25.797191 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: Close
[0m23:40:25.797849 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:40:25.798475 [info ] [Thread-1 (]: 22 of 40 PASS not_null_stg_housing_prices_month ................................ [[32mPASS[0m in 0.07s]
[0m23:40:25.800128 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:40:25.799443 [info ] [Thread-4 (]: 24 of 40 PASS not_null_stg_housing_prices_region ............................... [[32mPASS[0m in 0.06s]
[0m23:40:25.801158 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:40:25.801677 [info ] [Thread-2 (]: 26 of 40 START test not_null_stg_location_data_postcode ........................ [RUN]
[0m23:40:25.802679 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:40:25.803242 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:40:25.803820 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:40:25.804536 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m23:40:25.805059 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:40:25.806790 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: ROLLBACK
[0m23:40:25.807516 [info ] [Thread-1 (]: 27 of 40 START test not_null_stg_location_data_region .......................... [RUN]
[0m23:40:25.808127 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:40:25.808624 [info ] [Thread-4 (]: 28 of 40 START test not_null_stg_location_data_type ............................ [RUN]
[0m23:40:25.809354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m23:40:25.809801 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: Close
[0m23:40:25.817026 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:40:25.817536 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m23:40:25.818135 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:40:25.819616 [info ] [Thread-3 (]: 25 of 40 PASS not_null_stg_housing_prices_year ................................. [[32mPASS[0m in 0.07s]
[0m23:40:25.820375 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:40:25.820859 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:40:25.825567 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:40:25.826329 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:40:25.829178 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:40:25.833666 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:40:25.834450 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:40:25.835079 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:40:25.836076 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:40:25.836799 [info ] [Thread-3 (]: 29 of 40 START test source_not_null_public_raw_housing_prices_date ............. [RUN]
[0m23:40:25.839982 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:40:25.840451 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:40:25.840977 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: BEGIN
[0m23:40:25.841476 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m23:40:25.844768 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:40:25.845466 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:40:25.846017 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:40:25.846524 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:40:25.852843 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:40:25.853359 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: BEGIN
[0m23:40:25.852226 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:40:25.854116 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: BEGIN
[0m23:40:25.854812 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:40:25.855587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:25.856506 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:40:25.857048 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:40:25.857466 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:40:25.861426 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:40:25.862179 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."stg_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.863228 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:40:25.863624 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: BEGIN
[0m23:40:25.863960 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:25.864538 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:40:25.865978 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: ROLLBACK
[0m23:40:25.866912 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: Close
[0m23:40:25.867885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:40:25.869465 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:40:25.869064 [info ] [Thread-2 (]: 26 of 40 PASS not_null_stg_location_data_postcode .............................. [[32mPASS[0m in 0.06s]
[0m23:40:25.870275 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m23:40:25.870846 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."stg_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.871534 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:40:25.872106 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:40:25.872874 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:40:25.873896 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:40:25.874680 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."stg_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.875262 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:40:25.875824 [info ] [Thread-2 (]: 30 of 40 START test source_not_null_public_raw_housing_prices_id ............... [RUN]
[0m23:40:25.876758 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "dwh"."public"."raw_housing_prices"
where date is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.877644 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m23:40:25.878422 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:40:25.879035 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:40:25.880722 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: ROLLBACK
[0m23:40:25.881247 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:40:25.887059 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:40:25.887438 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:40:25.888965 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: ROLLBACK
[0m23:40:25.889402 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: Close
[0m23:40:25.890795 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: ROLLBACK
[0m23:40:25.891882 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: Close
[0m23:40:25.892896 [info ] [Thread-1 (]: 27 of 40 PASS not_null_stg_location_data_region ................................ [[32mPASS[0m in 0.08s]
[0m23:40:25.893671 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:40:25.894710 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:40:25.895334 [info ] [Thread-3 (]: 29 of 40 PASS source_not_null_public_raw_housing_prices_date ................... [[32mPASS[0m in 0.05s]
[0m23:40:25.895840 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: Close
[0m23:40:25.899947 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:40:25.900662 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:40:25.901569 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:40:25.902668 [info ] [Thread-4 (]: 28 of 40 PASS not_null_stg_location_data_type .................................. [[32mPASS[0m in 0.08s]
[0m23:40:25.903798 [info ] [Thread-1 (]: 31 of 40 START test source_not_null_public_raw_housing_prices_price ............ [RUN]
[0m23:40:25.904752 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:40:25.905722 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:40:25.906355 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:40:25.906907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m23:40:25.907380 [info ] [Thread-3 (]: 32 of 40 START test source_not_null_public_raw_housing_prices_region ........... [RUN]
[0m23:40:25.907948 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: BEGIN
[0m23:40:25.908614 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:40:25.909427 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:40:25.910038 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m23:40:25.910564 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:40:25.911105 [info ] [Thread-4 (]: 33 of 40 START test source_not_null_public_raw_location_data_postcode .......... [RUN]
[0m23:40:25.916344 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:40:25.916947 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:40:25.917726 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m23:40:25.925214 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:40:25.926022 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:40:25.926502 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m23:40:25.927067 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:40:25.931085 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:40:25.931569 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:40:25.932061 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:40:25.936829 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:40:25.939948 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:40:25.940688 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dwh"."public"."raw_housing_prices"
where id is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.941316 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:40:25.942169 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:40:25.942804 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:40:25.943263 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: BEGIN
[0m23:40:25.946199 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:40:25.946782 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:40:25.947207 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: BEGIN
[0m23:40:25.947655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:25.949329 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: ROLLBACK
[0m23:40:25.949842 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:25.950594 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:40:25.951524 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: BEGIN
[0m23:40:25.952183 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: Close
[0m23:40:25.952693 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:40:25.953453 [info ] [Thread-2 (]: 30 of 40 PASS source_not_null_public_raw_housing_prices_id ..................... [[32mPASS[0m in 0.08s]
[0m23:40:25.954670 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:40:25.955301 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:40:25.956057 [info ] [Thread-2 (]: 34 of 40 START test source_not_null_public_raw_location_data_region ............ [RUN]
[0m23:40:25.956822 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m23:40:25.957494 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:40:25.962967 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:40:25.964073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m23:40:25.964711 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m23:40:25.965580 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:40:25.966093 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:40:25.966544 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m23:40:25.967050 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:40:25.967578 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dwh"."public"."raw_housing_prices"
where price is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.970455 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:40:25.971070 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:40:25.971621 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_housing_prices"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.972454 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."raw_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.973197 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:40:25.973787 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:40:25.974182 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: BEGIN
[0m23:40:25.974641 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:40:25.976162 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: ROLLBACK
[0m23:40:25.976624 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:40:25.977112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:40:25.978665 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: ROLLBACK
[0m23:40:25.980188 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: ROLLBACK
[0m23:40:25.980619 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: Close
[0m23:40:25.981494 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: Close
[0m23:40:25.982001 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: Close
[0m23:40:25.982857 [info ] [Thread-1 (]: 31 of 40 PASS source_not_null_public_raw_housing_prices_price .................. [[32mPASS[0m in 0.08s]
[0m23:40:25.983875 [info ] [Thread-3 (]: 32 of 40 PASS source_not_null_public_raw_housing_prices_region ................. [[32mPASS[0m in 0.07s]
[0m23:40:25.985612 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:40:25.984973 [info ] [Thread-4 (]: 33 of 40 PASS source_not_null_public_raw_location_data_postcode ................ [[32mPASS[0m in 0.07s]
[0m23:40:25.986379 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:40:25.986878 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:40:25.987574 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:40:25.988295 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m23:40:25.989055 [info ] [Thread-1 (]: 35 of 40 START test source_not_null_public_raw_location_data_type .............. [RUN]
[0m23:40:25.989808 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m23:40:25.990270 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m23:40:25.990931 [info ] [Thread-3 (]: 36 of 40 START test source_unique_public_raw_housing_prices_id ................. [RUN]
[0m23:40:25.991635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m23:40:25.992165 [info ] [Thread-4 (]: 37 of 40 START test source_unique_public_raw_location_data_postcode ............ [RUN]
[0m23:40:25.992698 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:40:25.993181 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68)
[0m23:40:25.993638 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:40:25.994193 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c, now test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175)
[0m23:40:25.994752 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:40:25.995222 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m23:40:25.999876 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:40:26.000516 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m23:40:26.006461 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:40:26.008487 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m23:40:26.009257 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:40:26.013651 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m23:40:26.015240 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: ROLLBACK
[0m23:40:26.018069 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:40:26.018772 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m23:40:26.019356 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m23:40:26.019776 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: Close
[0m23:40:26.022612 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m23:40:26.023003 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:40:26.027264 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m23:40:26.028125 [info ] [Thread-2 (]: 34 of 40 PASS source_not_null_public_raw_location_data_region .................. [[32mPASS[0m in 0.07s]
[0m23:40:26.028762 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m23:40:26.029190 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: BEGIN
[0m23:40:26.030024 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:40:26.030603 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m23:40:26.031090 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68: BEGIN
[0m23:40:26.031546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:26.032018 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m23:40:26.032588 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175: BEGIN
[0m23:40:26.033003 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:40:26.033665 [info ] [Thread-2 (]: 38 of 40 START test unique_stg_housing_prices_id ............................... [RUN]
[0m23:40:26.034196 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:40:26.035022 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e, now test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905)
[0m23:40:26.035771 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m23:40:26.043612 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m23:40:26.045048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:40:26.045812 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:40:26.046268 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:40:26.046665 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m23:40:26.047075 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:40:26.047532 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"
[0m23:40:26.047952 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"
[0m23:40:26.050999 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m23:40:26.051589 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."raw_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:40:26.052137 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    postcode as unique_field,
    count(*) as n_records

from "dwh"."public"."raw_location_data"
where postcode is not null
group by postcode
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:40:26.052636 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "dwh"."public"."raw_housing_prices"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:40:26.053475 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m23:40:26.054166 [debug] [Thread-2 (]: On test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905: BEGIN
[0m23:40:26.054679 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:40:26.055274 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:40:26.057482 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: ROLLBACK
[0m23:40:26.058039 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:40:26.058593 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:40:26.058981 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: Close
[0m23:40:26.060411 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175: ROLLBACK
[0m23:40:26.061916 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68: ROLLBACK
[0m23:40:26.062738 [info ] [Thread-1 (]: 35 of 40 PASS source_not_null_public_raw_location_data_type .................... [[32mPASS[0m in 0.07s]
[0m23:40:26.063278 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:40:26.063937 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175: Close
[0m23:40:26.064625 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:40:26.065058 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68: Close
[0m23:40:26.065524 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"
[0m23:40:26.066766 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m23:40:26.066255 [error] [Thread-4 (]: 37 of 40 FAIL 1500 source_unique_public_raw_location_data_postcode ............. [[31mFAIL 1500[0m in 0.07s]
[0m23:40:26.068001 [debug] [Thread-2 (]: On test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select
    id as unique_field,
    count(*) as n_records

from __dbt__cte__stg_housing_prices
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:40:26.068877 [error] [Thread-3 (]: 36 of 40 FAIL 1500 source_unique_public_raw_housing_prices_id .................. [[31mFAIL 1500[0m in 0.08s]
[0m23:40:26.069572 [info ] [Thread-1 (]: 39 of 40 START test unique_stg_location_data_postcode .......................... [RUN]
[0m23:40:26.070474 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175
[0m23:40:26.071326 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68
[0m23:40:26.071875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522, now test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2)
[0m23:40:26.072415 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:40:26.073342 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m23:40:26.074821 [info ] [Thread-4 (]: 40 of 40 START test valid_values_stg_location_data_type__URBAN__RURAL .......... [RUN]
[0m23:40:26.080972 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:40:26.080305 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m23:40:26.081620 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_unique_public_raw_location_data_postcode.383a494175, now test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91)
[0m23:40:26.083101 [debug] [Thread-2 (]: On test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905: ROLLBACK
[0m23:40:26.083856 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:40:26.089801 [debug] [Thread-2 (]: On test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905: Close
[0m23:40:26.093858 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:40:26.094350 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m23:40:26.095067 [error] [Thread-2 (]: 38 of 40 FAIL 1500 unique_stg_housing_prices_id ................................ [[31mFAIL 1500[0m in 0.06s]
[0m23:40:26.098548 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m23:40:26.099371 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905
[0m23:40:26.099828 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:40:26.103596 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:40:26.104322 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m23:40:26.104945 [debug] [Thread-1 (]: On test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2: BEGIN
[0m23:40:26.105385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:26.106008 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:40:26.106427 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: BEGIN
[0m23:40:26.106781 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:40:26.112502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:40:26.112991 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"
[0m23:40:26.113487 [debug] [Thread-1 (]: On test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    postcode as unique_field,
    count(*) as n_records

from "dwh"."public"."stg_location_data"
where postcode is not null
group by postcode
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:40:26.113913 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m23:40:26.114487 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:40:26.114884 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    SELECT *
    FROM "dwh"."public"."stg_location_data"
    WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'UNKNOWN'

  
  
      
    ) dbt_internal_test
[0m23:40:26.119214 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:40:26.120740 [debug] [Thread-1 (]: On test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2: ROLLBACK
[0m23:40:26.121387 [debug] [Thread-1 (]: On test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2: Close
[0m23:40:26.122158 [error] [Thread-1 (]: 39 of 40 FAIL 1500 unique_stg_location_data_postcode ........................... [[31mFAIL 1500[0m in 0.05s]
[0m23:40:26.122794 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2
[0m23:40:26.128591 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:40:26.130194 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: ROLLBACK
[0m23:40:26.130951 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: Close
[0m23:40:26.131934 [error] [Thread-4 (]: 40 of 40 FAIL 3766 valid_values_stg_location_data_type__URBAN__RURAL ........... [[31mFAIL 3766[0m in 0.05s]
[0m23:40:26.132594 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:40:26.134835 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:26.135208 [debug] [MainThread]: On master: BEGIN
[0m23:40:26.135491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:40:26.142166 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:40:26.142575 [debug] [MainThread]: On master: COMMIT
[0m23:40:26.142859 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:26.143122 [debug] [MainThread]: On master: COMMIT
[0m23:40:26.143525 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:40:26.143805 [debug] [MainThread]: On master: Close
[0m23:40:26.144219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:26.144483 [debug] [MainThread]: Connection 'test.airflow_dbt_training.unique_stg_location_data_postcode.64b31f64c2' was properly closed.
[0m23:40:26.144732 [debug] [MainThread]: Connection 'test.airflow_dbt_training.unique_stg_housing_prices_id.6f2dbea905' was properly closed.
[0m23:40:26.144978 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_unique_public_raw_housing_prices_id.f3c2a34e68' was properly closed.
[0m23:40:26.145255 [debug] [MainThread]: Connection 'test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91' was properly closed.
[0m23:40:26.145693 [info ] [MainThread]: 
[0m23:40:26.146072 [info ] [MainThread]: Finished running 40 data tests in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m23:40:26.153151 [debug] [MainThread]: Command end result
[0m23:40:26.191294 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:40:26.192827 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:40:26.201077 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:40:26.201437 [info ] [MainThread]: 
[0m23:40:26.201817 [info ] [MainThread]: [31mCompleted with 10 errors, 0 partial successes, and 0 warnings:[0m
[0m23:40:26.202158 [info ] [MainThread]: 
[0m23:40:26.202818 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_urban_count (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:40:26.203384 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:40:26.203808 [info ] [MainThread]: 
[0m23:40:26.204381 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_urban_count.sql
[0m23:40:26.204785 [info ] [MainThread]: 
[0m23:40:26.205308 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_pct_urban (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:40:26.205859 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:40:26.206562 [info ] [MainThread]: 
[0m23:40:26.207384 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_pct_urban.sql
[0m23:40:26.207984 [info ] [MainThread]: 
[0m23:40:26.208553 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_rural_count (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:40:26.209050 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:40:26.209518 [info ] [MainThread]: 
[0m23:40:26.210318 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_rural_count.sql
[0m23:40:26.210893 [info ] [MainThread]: 
[0m23:40:26.211533 [error] [MainThread]:   Database Error in test not_null_region_type_composition_total_count (models/airflow_dbt_training/gold/schema.yml)
  column "total_count" does not exist
  LINE 16: select total_count
                  ^
  HINT:  Perhaps you meant to reference the column "region_type_composition.rural_count".
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_count.sql
[0m23:40:26.212193 [info ] [MainThread]: 
[0m23:40:26.213245 [error] [MainThread]:   Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:40:26.213882 [info ] [MainThread]: 
[0m23:40:26.214558 [error] [MainThread]: [31mFailure in test source_unique_public_raw_location_data_postcode (models/airflow_dbt_training/bronze/schema.yml)[0m
[0m23:40:26.215056 [error] [MainThread]:   Got 1500 results, configured to fail if != 0
[0m23:40:26.215431 [info ] [MainThread]: 
[0m23:40:26.215997 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/bronze/schema.yml/source_unique_public_raw_location_data_postcode.sql
[0m23:40:26.216455 [info ] [MainThread]: 
[0m23:40:26.217007 [error] [MainThread]: [31mFailure in test source_unique_public_raw_housing_prices_id (models/airflow_dbt_training/bronze/schema.yml)[0m
[0m23:40:26.217454 [error] [MainThread]:   Got 1500 results, configured to fail if != 0
[0m23:40:26.217948 [info ] [MainThread]: 
[0m23:40:26.218639 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/bronze/schema.yml/source_unique_public_raw_housing_prices_id.sql
[0m23:40:26.219407 [info ] [MainThread]: 
[0m23:40:26.220101 [error] [MainThread]: [31mFailure in test unique_stg_housing_prices_id (models/airflow_dbt_training/silver/schema.yml)[0m
[0m23:40:26.220608 [error] [MainThread]:   Got 1500 results, configured to fail if != 0
[0m23:40:26.221016 [info ] [MainThread]: 
[0m23:40:26.221600 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/silver/schema.yml/unique_stg_housing_prices_id.sql
[0m23:40:26.221979 [info ] [MainThread]: 
[0m23:40:26.222460 [error] [MainThread]: [31mFailure in test unique_stg_location_data_postcode (models/airflow_dbt_training/silver/schema.yml)[0m
[0m23:40:26.222991 [error] [MainThread]:   Got 1500 results, configured to fail if != 0
[0m23:40:26.223334 [info ] [MainThread]: 
[0m23:40:26.223855 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/silver/schema.yml/unique_stg_location_data_postcode.sql
[0m23:40:26.224393 [info ] [MainThread]: 
[0m23:40:26.225196 [error] [MainThread]: [31mFailure in test valid_values_stg_location_data_type__URBAN__RURAL (models/airflow_dbt_training/silver/schema.yml)[0m
[0m23:40:26.225773 [error] [MainThread]:   Got 3766 results, configured to fail if != 0
[0m23:40:26.226306 [info ] [MainThread]: 
[0m23:40:26.226862 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/silver/schema.yml/valid_values_stg_location_data_type__URBAN__RURAL.sql
[0m23:40:26.227371 [info ] [MainThread]: 
[0m23:40:26.227877 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=10 SKIP=0 TOTAL=40
[0m23:40:26.229028 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.2066684, "process_in_blocks": "0", "process_kernel_time": 0.310768, "process_mem_max_rss": "132000", "process_out_blocks": "4360", "process_user_time": 3.348281}
[0m23:40:26.229546 [debug] [MainThread]: Command `dbt test` failed at 23:40:26.229424 after 2.21 seconds
[0m23:40:26.229976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e637ed0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e637eda10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e637edc10>]}
[0m23:40:26.230393 [debug] [MainThread]: Flushing usage events
[0m23:40:26.831777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:00.606486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fe0f6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fe0f5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fe0f6210>]}


============================== 23:41:00.609061 | 3e9550ca-2413-47a2-9ce2-86ee49662d4f ==============================
[0m23:41:00.609061 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:41:00.609664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:41:00.769373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e9550ca-2413-47a2-9ce2-86ee49662d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fe0ea150>]}
[0m23:41:00.847185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e9550ca-2413-47a2-9ce2-86ee49662d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe900b1b650>]}
[0m23:41:00.848365 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:41:00.941889 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:41:01.092637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:41:01.094108 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/bronze/schema.yml
[0m23:41:01.094683 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/schema.yml
[0m23:41:01.874125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e9550ca-2413-47a2-9ce2-86ee49662d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fc136190>]}
[0m23:41:01.972256 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:41:01.974811 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:41:01.995985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e9550ca-2413-47a2-9ce2-86ee49662d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fa4f9050>]}
[0m23:41:01.996507 [info ] [MainThread]: Found 9 models, 36 data tests, 2 sources, 436 macros
[0m23:41:01.996916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e9550ca-2413-47a2-9ce2-86ee49662d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fa5eee90>]}
[0m23:41:02.002778 [info ] [MainThread]: 
[0m23:41:02.003529 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:41:02.004307 [info ] [MainThread]: 
[0m23:41:02.005175 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:02.012981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m23:41:02.055223 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:41:02.055612 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:41:02.055873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:02.062983 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:41:02.063617 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:41:02.064541 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:41:02.067435 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:41:02.068875 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:41:02.069429 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:41:02.076201 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:02.076534 [debug] [MainThread]: On master: BEGIN
[0m23:41:02.076786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:02.083593 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:41:02.084135 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:02.084872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:41:02.089469 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m23:41:02.092274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e9550ca-2413-47a2-9ce2-86ee49662d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ff2d75d0>]}
[0m23:41:02.092687 [debug] [MainThread]: On master: ROLLBACK
[0m23:41:02.093152 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:02.093446 [debug] [MainThread]: On master: BEGIN
[0m23:41:02.094174 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:41:02.094564 [debug] [MainThread]: On master: COMMIT
[0m23:41:02.094833 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:02.095091 [debug] [MainThread]: On master: COMMIT
[0m23:41:02.095524 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:02.095818 [debug] [MainThread]: On master: Close
[0m23:41:02.099441 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:41:02.099947 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:41:02.100390 [info ] [Thread-1 (]: 1 of 36 START test accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [RUN]
[0m23:41:02.100996 [info ] [Thread-2 (]: 2 of 36 START test accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [RUN]
[0m23:41:02.101628 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:41:02.102140 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:41:02.102663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m23:41:02.103286 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e'
[0m23:41:02.103765 [info ] [Thread-3 (]: 3 of 36 START test not_null_mart_housing_prices_breakdown_avg_price ............ [RUN]
[0m23:41:02.104361 [info ] [Thread-4 (]: 4 of 36 START test not_null_mart_housing_prices_breakdown_n_sales .............. [RUN]
[0m23:41:02.105014 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:41:02.105534 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:41:02.106183 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d'
[0m23:41:02.106789 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7'
[0m23:41:02.126069 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:41:02.131229 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:41:02.131734 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:41:02.132213 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:41:02.136535 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:41:02.142411 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:41:02.146550 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:41:02.150714 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:41:02.167312 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:41:02.171922 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:41:02.172839 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:41:02.173256 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:41:02.175990 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:41:02.178807 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:41:02.181455 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:41:02.181974 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:41:02.182998 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:41:02.183656 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:41:02.184154 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:41:02.184590 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: BEGIN
[0m23:41:02.185029 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: BEGIN
[0m23:41:02.185477 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: BEGIN
[0m23:41:02.185891 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: BEGIN
[0m23:41:02.186331 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:41:02.186737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:02.187164 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:41:02.187579 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:41:02.194750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:41:02.195487 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:41:02.196076 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:41:02.196466 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:41:02.196846 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:41:02.197294 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:41:02.197829 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        day_of_week as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by day_of_week

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m23:41:02.198384 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:41:02.198823 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:41:02.199302 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_price
from "dwh"."public"."mart_housing_prices_breakdown"
where avg_price is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.200092 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        month as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by month

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','7','8','9','10','11','12'
)



  
  
      
    ) dbt_internal_test
[0m23:41:02.200635 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select n_sales
from "dwh"."public"."mart_housing_prices_breakdown"
where n_sales is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.206197 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:41:02.211290 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: ROLLBACK
[0m23:41:02.211959 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:41:02.213004 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:41:02.213689 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:41:02.214161 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: Close
[0m23:41:02.215972 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: ROLLBACK
[0m23:41:02.217434 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: ROLLBACK
[0m23:41:02.218902 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: ROLLBACK
[0m23:41:02.219960 [info ] [Thread-4 (]: 4 of 36 PASS not_null_mart_housing_prices_breakdown_n_sales .................... [[32mPASS[0m in 0.11s]
[0m23:41:02.220433 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: Close
[0m23:41:02.221000 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: Close
[0m23:41:02.221804 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:41:02.222318 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: Close
[0m23:41:02.223162 [info ] [Thread-3 (]: 3 of 36 PASS not_null_mart_housing_prices_breakdown_avg_price .................. [[32mPASS[0m in 0.12s]
[0m23:41:02.223865 [info ] [Thread-2 (]: 2 of 36 PASS accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [[32mPASS[0m in 0.12s]
[0m23:41:02.224813 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:41:02.226031 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:41:02.227069 [info ] [Thread-1 (]: 1 of 36 PASS accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [[32mPASS[0m in 0.12s]
[0m23:41:02.228089 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:41:02.228702 [info ] [Thread-4 (]: 5 of 36 START test not_null_mart_housing_prices_breakdown_pct_urban ............ [RUN]
[0m23:41:02.229375 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:41:02.230220 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:41:02.230967 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:41:02.231741 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e)
[0m23:41:02.232293 [info ] [Thread-3 (]: 6 of 36 START test not_null_mart_housing_prices_breakdown_region ............... [RUN]
[0m23:41:02.232892 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:41:02.233570 [info ] [Thread-2 (]: 7 of 36 START test not_null_mart_housing_prices_breakdown_rural_count .......... [RUN]
[0m23:41:02.234220 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:41:02.234790 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m23:41:02.235293 [info ] [Thread-1 (]: 8 of 36 START test not_null_mart_housing_prices_breakdown_urban_count .......... [RUN]
[0m23:41:02.235865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281)
[0m23:41:02.241222 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:41:02.241932 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:41:02.242670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de)
[0m23:41:02.243407 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:41:02.248174 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:41:02.248958 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:41:02.249556 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:41:02.255849 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:41:02.260262 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:41:02.263232 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:41:02.263747 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:41:02.265148 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:41:02.265588 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:41:02.268826 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:41:02.269295 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:41:02.271897 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:41:02.272367 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: BEGIN
[0m23:41:02.275055 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:41:02.275804 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:41:02.276273 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:41:02.276708 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:02.277321 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: BEGIN
[0m23:41:02.277826 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: BEGIN
[0m23:41:02.278250 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:41:02.278899 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:02.279408 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:02.279865 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: BEGIN
[0m23:41:02.280754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:02.286424 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:41:02.286952 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m23:41:02.287349 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:41:02.287909 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:41:02.288345 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:41:02.288928 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."mart_housing_prices_breakdown"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.289461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:41:02.290008 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."mart_housing_prices_breakdown"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.290494 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:41:02.291029 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:41:02.291662 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."mart_housing_prices_breakdown"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.292171 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."mart_housing_prices_breakdown"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.293220 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:41:02.294726 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: ROLLBACK
[0m23:41:02.295268 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: Close
[0m23:41:02.295907 [info ] [Thread-3 (]: 6 of 36 PASS not_null_mart_housing_prices_breakdown_region ..................... [[32mPASS[0m in 0.06s]
[0m23:41:02.296630 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:41:02.297157 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:41:02.297872 [info ] [Thread-3 (]: 9 of 36 START test not_null_region_type_composition_pct_urban .................. [RUN]
[0m23:41:02.298496 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m23:41:02.299066 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:41:02.304295 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:41:02.305145 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:41:02.308717 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:41:02.309399 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.018 seconds
[0m23:41:02.310500 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m23:41:02.311115 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.018 seconds
[0m23:41:02.312785 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: ROLLBACK
[0m23:41:02.313264 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:41:02.314690 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: ROLLBACK
[0m23:41:02.316174 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: ROLLBACK
[0m23:41:02.316841 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: BEGIN
[0m23:41:02.317318 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: Close
[0m23:41:02.317976 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:02.318464 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: Close
[0m23:41:02.318835 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: Close
[0m23:41:02.319589 [error] [Thread-4 (]: 5 of 36 FAIL 5 not_null_mart_housing_prices_breakdown_pct_urban ................ [[31mFAIL 5[0m in 0.09s]
[0m23:41:02.321211 [error] [Thread-2 (]: 7 of 36 FAIL 5 not_null_mart_housing_prices_breakdown_rural_count .............. [[31mFAIL 5[0m in 0.09s]
[0m23:41:02.322561 [error] [Thread-1 (]: 8 of 36 FAIL 5 not_null_mart_housing_prices_breakdown_urban_count .............. [[31mFAIL 5[0m in 0.08s]
[0m23:41:02.323469 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:41:02.324264 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:41:02.324971 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:41:02.325536 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:41:02.326398 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:41:02.327302 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:41:02.328206 [info ] [Thread-4 (]: 10 of 36 START test not_null_region_type_composition_region .................... [RUN]
[0m23:41:02.328883 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:41:02.329495 [info ] [Thread-2 (]: 11 of 36 START test not_null_region_type_composition_rural_count ............... [RUN]
[0m23:41:02.330255 [info ] [Thread-1 (]: 12 of 36 START test not_null_region_type_composition_total_count ............... [RUN]
[0m23:41:02.331076 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m23:41:02.331682 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:41:02.332275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m23:41:02.332850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de, now test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7)
[0m23:41:02.333541 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:41:02.334339 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.334919 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:41:02.335393 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:41:02.340834 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:41:02.345560 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:41:02.350231 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:41:02.351350 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:41:02.351950 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:41:02.354998 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:41:02.355456 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:41:02.355841 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:41:02.360034 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:41:02.362938 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:41:02.364538 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: ROLLBACK
[0m23:41:02.364991 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:41:02.366048 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:41:02.366556 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:41:02.366988 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: Close
[0m23:41:02.367360 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: BEGIN
[0m23:41:02.367843 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: BEGIN
[0m23:41:02.368274 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: BEGIN
[0m23:41:02.368743 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:02.369277 [info ] [Thread-3 (]: 9 of 36 PASS not_null_region_type_composition_pct_urban ........................ [[32mPASS[0m in 0.07s]
[0m23:41:02.369853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:02.370336 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:02.371221 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:41:02.372273 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:41:02.372921 [info ] [Thread-3 (]: 13 of 36 START test not_null_region_type_composition_urban_count ............... [RUN]
[0m23:41:02.373550 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m23:41:02.374158 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:41:02.379002 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:41:02.380077 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:41:02.380929 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:41:02.384299 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:41:02.385030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m23:41:02.385501 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:41:02.386007 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m23:41:02.386633 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:41:02.387169 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.387626 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:41:02.388190 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:41:02.388695 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_count
from "dwh"."public"."region_type_composition"
where total_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.389368 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: BEGIN
[0m23:41:02.389904 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.390510 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:02.391077 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "total_count" does not exist
LINE 16: select total_count
                ^
HINT:  Perhaps you meant to reference the column "region_type_composition.rural_count".

[0m23:41:02.391812 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: ROLLBACK
[0m23:41:02.392481 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: Close
[0m23:41:02.395262 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:41:02.397290 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: ROLLBACK
[0m23:41:02.398082 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: Close
[0m23:41:02.398726 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:41:02.399777 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:41:02.399424 [info ] [Thread-4 (]: 10 of 36 PASS not_null_region_type_composition_region .......................... [[32mPASS[0m in 0.07s]
[0m23:41:02.400642 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.401787 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:41:02.403099 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:41:02.404044 [info ] [Thread-4 (]: 14 of 36 START test not_null_region_type_composition_with_macro_pct_urban ...... [RUN]
[0m23:41:02.405171 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:41:02.405925 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91)
[0m23:41:02.408413 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: ROLLBACK
[0m23:41:02.409224 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:41:02.415150 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:41:02.415788 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: Close
[0m23:41:02.417802 [debug] [Thread-1 (]: Database Error in test not_null_region_type_composition_total_count (models/airflow_dbt_training/gold/schema.yml)
  column "total_count" does not exist
  LINE 16: select total_count
                  ^
  HINT:  Perhaps you meant to reference the column "region_type_composition.rural_count".
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_count.sql
[0m23:41:02.418431 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:41:02.419192 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:41:02.420017 [info ] [Thread-2 (]: 11 of 36 PASS not_null_region_type_composition_rural_count ..................... [[32mPASS[0m in 0.09s]
[0m23:41:02.420729 [error] [Thread-1 (]: 12 of 36 ERROR not_null_region_type_composition_total_count .................... [[31mERROR[0m in 0.09s]
[0m23:41:02.422753 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: ROLLBACK
[0m23:41:02.425885 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:41:02.426638 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:41:02.427327 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:41:02.428107 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: Close
[0m23:41:02.428635 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:41:02.429404 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:41:02.429947 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:41:02.430655 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_total_count (models/airflow_dbt_training/gold/schema.yml)
  column "total_count" does not exist
  LINE 16: select total_count
                  ^
  HINT:  Perhaps you meant to reference the column "region_type_composition.rural_count".
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_count.sql.
[0m23:41:02.431346 [info ] [Thread-2 (]: 15 of 36 START test not_null_region_type_composition_with_macro_region ......... [RUN]
[0m23:41:02.432075 [info ] [Thread-1 (]: 16 of 36 START test not_null_region_type_composition_with_macro_rural_count .... [RUN]
[0m23:41:02.433657 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: BEGIN
[0m23:41:02.432889 [info ] [Thread-3 (]: 13 of 36 PASS not_null_region_type_composition_urban_count ..................... [[32mPASS[0m in 0.06s]
[0m23:41:02.435082 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192)
[0m23:41:02.435606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797)
[0m23:41:02.436033 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:02.436783 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:41:02.437313 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:41:02.437755 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:41:02.438607 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:41:02.443901 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:41:02.448448 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:41:02.450060 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m23:41:02.449258 [info ] [Thread-3 (]: 17 of 36 START test not_null_region_type_composition_with_macro_total_locations  [RUN]
[0m23:41:02.451461 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:41:02.452140 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae)
[0m23:41:02.452612 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:41:02.453045 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:41:02.453513 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition_with_macro"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.454014 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:41:02.457094 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:41:02.460131 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:41:02.465252 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:41:02.466298 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:41:02.467089 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: BEGIN
[0m23:41:02.467958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:02.469096 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:41:02.473807 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:41:02.474499 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:41:02.475436 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:41:02.475837 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: BEGIN
[0m23:41:02.476219 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:41:02.476651 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: BEGIN
[0m23:41:02.477077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:02.477448 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:41:02.477881 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:41:02.478264 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:02.480174 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: ROLLBACK
[0m23:41:02.480793 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition_with_macro"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.481688 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: Close
[0m23:41:02.482373 [info ] [Thread-4 (]: 14 of 36 PASS not_null_region_type_composition_with_macro_pct_urban ............ [[32mPASS[0m in 0.08s]
[0m23:41:02.483110 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:41:02.483666 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:41:02.484379 [info ] [Thread-4 (]: 18 of 36 START test not_null_region_type_composition_with_macro_urban_count .... [RUN]
[0m23:41:02.485193 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224)
[0m23:41:02.485977 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:41:02.486507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:41:02.491590 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:41:02.492392 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:41:02.493093 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:41:02.493618 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m23:41:02.494252 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition_with_macro"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.496012 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: ROLLBACK
[0m23:41:02.496442 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:41:02.496894 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:41:02.500924 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:41:02.501526 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: Close
[0m23:41:02.502036 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_locations
from "dwh"."public"."region_type_composition_with_macro"
where total_locations is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.502913 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:41:02.503890 [info ] [Thread-2 (]: 15 of 36 PASS not_null_region_type_composition_with_macro_region ............... [[32mPASS[0m in 0.07s]
[0m23:41:02.504983 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: BEGIN
[0m23:41:02.505929 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "total_locations" does not exist
LINE 16: select total_locations
                ^

[0m23:41:02.506624 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:41:02.507145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:02.507675 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: ROLLBACK
[0m23:41:02.508201 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:41:02.509858 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: Close
[0m23:41:02.509102 [info ] [Thread-2 (]: 19 of 36 START test not_null_stg_housing_prices_date ........................... [RUN]
[0m23:41:02.511109 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m23:41:02.513120 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:41:02.519779 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:41:02.520760 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.023 seconds
[0m23:41:02.523100 [debug] [Thread-3 (]: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:41:02.523682 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m23:41:02.525244 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: ROLLBACK
[0m23:41:02.525925 [error] [Thread-3 (]: 17 of 36 ERROR not_null_region_type_composition_with_macro_total_locations ..... [[31mERROR[0m in 0.07s]
[0m23:41:02.526406 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:41:02.526834 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:41:02.527667 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:41:02.528314 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: Close
[0m23:41:02.531586 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:41:02.532227 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition_with_macro"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.532803 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:41:02.533321 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql.
[0m23:41:02.534681 [info ] [Thread-1 (]: 16 of 36 PASS not_null_region_type_composition_with_macro_rural_count .......... [[32mPASS[0m in 0.10s]
[0m23:41:02.536076 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:41:02.536680 [info ] [Thread-3 (]: 20 of 36 START test not_null_stg_housing_prices_day_of_week .................... [RUN]
[0m23:41:02.537695 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:41:02.538147 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: BEGIN
[0m23:41:02.538678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m23:41:02.539181 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:41:02.539842 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:02.540448 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:41:02.541082 [info ] [Thread-1 (]: 21 of 36 START test not_null_stg_housing_prices_id ............................. [RUN]
[0m23:41:02.547642 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:41:02.548354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m23:41:02.548992 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:41:02.549628 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:41:02.550196 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:41:02.550578 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:41:02.556380 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:41:02.556934 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m23:41:02.557408 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select date
from __dbt__cte__stg_housing_prices
where date is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.560639 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:41:02.561458 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:41:02.562917 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: ROLLBACK
[0m23:41:02.566202 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:41:02.566872 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:41:02.567487 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: Close
[0m23:41:02.567977 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: BEGIN
[0m23:41:02.568412 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:41:02.568842 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:41:02.569977 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:02.569583 [info ] [Thread-4 (]: 18 of 36 PASS not_null_region_type_composition_with_macro_urban_count .......... [[32mPASS[0m in 0.08s]
[0m23:41:02.572101 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: ROLLBACK
[0m23:41:02.572638 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: BEGIN
[0m23:41:02.573617 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:41:02.574121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:02.574531 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: Close
[0m23:41:02.575061 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:41:02.576045 [info ] [Thread-4 (]: 22 of 36 START test not_null_stg_housing_prices_month .......................... [RUN]
[0m23:41:02.576944 [info ] [Thread-2 (]: 19 of 36 PASS not_null_stg_housing_prices_date ................................. [[32mPASS[0m in 0.07s]
[0m23:41:02.577965 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m23:41:02.578701 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:41:02.579167 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:41:02.579725 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:41:02.586120 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:41:02.586801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:41:02.587612 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m23:41:02.587220 [info ] [Thread-2 (]: 23 of 36 START test not_null_stg_housing_prices_price .......................... [RUN]
[0m23:41:02.588486 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:41:02.589261 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:41:02.589952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m23:41:02.590393 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:41:02.590943 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select id
from __dbt__cte__stg_housing_prices
where id is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.591550 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select day_of_week
from __dbt__cte__stg_housing_prices
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.592044 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:41:02.594871 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:41:02.600956 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:41:02.600563 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:41:02.603042 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: ROLLBACK
[0m23:41:02.603519 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:41:02.603984 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:41:02.604802 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:41:02.605238 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: Close
[0m23:41:02.605602 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: BEGIN
[0m23:41:02.607101 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: ROLLBACK
[0m23:41:02.611747 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:41:02.612398 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:02.613119 [info ] [Thread-1 (]: 21 of 36 PASS not_null_stg_housing_prices_id ................................... [[32mPASS[0m in 0.06s]
[0m23:41:02.614188 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: Close
[0m23:41:02.615325 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:41:02.615824 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:41:02.616995 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:41:02.616554 [info ] [Thread-3 (]: 20 of 36 PASS not_null_stg_housing_prices_day_of_week .......................... [[32mPASS[0m in 0.08s]
[0m23:41:02.617672 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: BEGIN
[0m23:41:02.618244 [info ] [Thread-1 (]: 24 of 36 START test not_null_stg_housing_prices_region ......................... [RUN]
[0m23:41:02.619250 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:41:02.619855 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:02.620387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m23:41:02.620960 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:41:02.622056 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:41:02.623384 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m23:41:02.622859 [info ] [Thread-3 (]: 25 of 36 START test not_null_stg_housing_prices_year ........................... [RUN]
[0m23:41:02.630144 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:41:02.630872 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:41:02.631528 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m23:41:02.632065 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m23:41:02.632844 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select month
from __dbt__cte__stg_housing_prices
where month is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.633519 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:41:02.633985 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:41:02.634444 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:41:02.635038 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select price
from __dbt__cte__stg_housing_prices
where price is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.638128 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:41:02.644015 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:41:02.643491 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:41:02.645163 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:41:02.646620 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: ROLLBACK
[0m23:41:02.647222 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:41:02.647653 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: BEGIN
[0m23:41:02.649129 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: ROLLBACK
[0m23:41:02.649712 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:41:02.650127 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: Close
[0m23:41:02.650572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:02.653454 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:41:02.653913 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: Close
[0m23:41:02.654723 [info ] [Thread-4 (]: 22 of 36 PASS not_null_stg_housing_prices_month ................................ [[32mPASS[0m in 0.08s]
[0m23:41:02.656099 [info ] [Thread-2 (]: 23 of 36 PASS not_null_stg_housing_prices_price ................................ [[32mPASS[0m in 0.07s]
[0m23:41:02.657181 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:41:02.657689 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:41:02.658335 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:41:02.658840 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:41:02.659291 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: BEGIN
[0m23:41:02.659899 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:41:02.660418 [info ] [Thread-4 (]: 26 of 36 START test not_null_stg_location_data_postcode ........................ [RUN]
[0m23:41:02.661093 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:02.661799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:41:02.662275 [info ] [Thread-2 (]: 27 of 36 START test not_null_stg_location_data_region .......................... [RUN]
[0m23:41:02.662994 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m23:41:02.663718 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:41:02.664461 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m23:41:02.665022 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:41:02.665635 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select region
from __dbt__cte__stg_housing_prices
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.666231 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:41:02.671301 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:41:02.676383 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:41:02.677246 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m23:41:02.678100 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:41:02.678754 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:41:02.679216 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select year
from __dbt__cte__stg_housing_prices
where year is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.679846 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:41:02.680236 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:41:02.681775 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: ROLLBACK
[0m23:41:02.684801 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:41:02.688501 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:41:02.689528 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: Close
[0m23:41:02.689958 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:41:02.691196 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:41:02.692299 [info ] [Thread-1 (]: 24 of 36 PASS not_null_stg_housing_prices_region ............................... [[32mPASS[0m in 0.07s]
[0m23:41:02.692984 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:41:02.694597 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: ROLLBACK
[0m23:41:02.695093 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: BEGIN
[0m23:41:02.695744 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:41:02.696189 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: BEGIN
[0m23:41:02.696719 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:02.697177 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: Close
[0m23:41:02.697856 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:41:02.698478 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:02.699711 [info ] [Thread-3 (]: 25 of 36 PASS not_null_stg_housing_prices_year ................................. [[32mPASS[0m in 0.07s]
[0m23:41:02.700491 [info ] [Thread-1 (]: 28 of 36 START test not_null_stg_location_data_type ............................ [RUN]
[0m23:41:02.702005 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:41:02.702605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m23:41:02.703154 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:41:02.703805 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:41:02.704500 [info ] [Thread-3 (]: 29 of 36 START test source_not_null_public_raw_housing_prices_date ............. [RUN]
[0m23:41:02.709929 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:41:02.710884 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m23:41:02.711491 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m23:41:02.712005 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m23:41:02.712576 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:41:02.713238 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:41:02.713618 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:41:02.714083 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:41:02.718778 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:41:02.719429 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."stg_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.724095 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:41:02.724679 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."stg_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.725550 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:41:02.728805 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:41:02.729480 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:41:02.729947 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:41:02.730492 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: BEGIN
[0m23:41:02.730901 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:41:02.731387 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:41:02.732756 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: ROLLBACK
[0m23:41:02.733216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:02.734603 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: ROLLBACK
[0m23:41:02.735093 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: BEGIN
[0m23:41:02.735819 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: Close
[0m23:41:02.736346 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:02.736753 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: Close
[0m23:41:02.737394 [info ] [Thread-4 (]: 26 of 36 PASS not_null_stg_location_data_postcode .............................. [[32mPASS[0m in 0.07s]
[0m23:41:02.739433 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:41:02.738578 [info ] [Thread-2 (]: 27 of 36 PASS not_null_stg_location_data_region ................................ [[32mPASS[0m in 0.07s]
[0m23:41:02.740339 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:41:02.741095 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:41:02.742158 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:41:02.741613 [info ] [Thread-4 (]: 30 of 36 START test source_not_null_public_raw_housing_prices_id ............... [RUN]
[0m23:41:02.743103 [info ] [Thread-2 (]: 31 of 36 START test source_not_null_public_raw_housing_prices_price ............ [RUN]
[0m23:41:02.743963 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m23:41:02.744635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:41:02.745172 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m23:41:02.745824 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:41:02.746750 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:41:02.747502 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:41:02.747976 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:41:02.752874 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:41:02.753585 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."stg_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.754153 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:41:02.758570 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:41:02.759752 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "dwh"."public"."raw_housing_prices"
where date is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.760495 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:41:02.763694 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:41:02.764482 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:41:02.765226 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:41:02.765947 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:41:02.767446 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: ROLLBACK
[0m23:41:02.767923 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:41:02.771017 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:41:02.772636 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: ROLLBACK
[0m23:41:02.773255 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: BEGIN
[0m23:41:02.773687 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: Close
[0m23:41:02.774554 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:41:02.775032 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:02.775388 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: Close
[0m23:41:02.776594 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: BEGIN
[0m23:41:02.776115 [info ] [Thread-3 (]: 29 of 36 PASS source_not_null_public_raw_housing_prices_date ................... [[32mPASS[0m in 0.07s]
[0m23:41:02.777968 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:02.778989 [info ] [Thread-1 (]: 28 of 36 PASS not_null_stg_location_data_type .................................. [[32mPASS[0m in 0.08s]
[0m23:41:02.780163 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:41:02.781351 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:41:02.781960 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:41:02.782889 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:41:02.783787 [info ] [Thread-3 (]: 32 of 36 START test source_not_null_public_raw_housing_prices_region ........... [RUN]
[0m23:41:02.784561 [info ] [Thread-1 (]: 33 of 36 START test source_not_null_public_raw_location_data_postcode .......... [RUN]
[0m23:41:02.785649 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m23:41:02.786341 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m23:41:02.787019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m23:41:02.787572 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:41:02.788284 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:41:02.789097 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:41:02.789745 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m23:41:02.794475 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:41:02.795282 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dwh"."public"."raw_housing_prices"
where id is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.799992 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:41:02.800595 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:41:02.801739 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:41:02.802341 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dwh"."public"."raw_housing_prices"
where price is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.805902 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:41:02.806534 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:41:02.807154 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:41:02.810667 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:41:02.811273 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:41:02.811779 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:41:02.813598 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: ROLLBACK
[0m23:41:02.815337 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: ROLLBACK
[0m23:41:02.815913 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: BEGIN
[0m23:41:02.816394 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:41:02.816967 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: Close
[0m23:41:02.817323 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:02.817733 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: Close
[0m23:41:02.818218 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: BEGIN
[0m23:41:02.819106 [info ] [Thread-4 (]: 30 of 36 PASS source_not_null_public_raw_housing_prices_id ..................... [[32mPASS[0m in 0.08s]
[0m23:41:02.821306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:02.820611 [info ] [Thread-2 (]: 31 of 36 PASS source_not_null_public_raw_housing_prices_price .................. [[32mPASS[0m in 0.08s]
[0m23:41:02.822333 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:41:02.823365 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:41:02.823962 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:41:02.824840 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:41:02.825778 [info ] [Thread-4 (]: 34 of 36 START test source_not_null_public_raw_location_data_region ............ [RUN]
[0m23:41:02.826587 [info ] [Thread-2 (]: 35 of 36 START test source_not_null_public_raw_location_data_type .............. [RUN]
[0m23:41:02.827520 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m23:41:02.828155 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:41:02.828960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m23:41:02.829704 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:41:02.830409 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:41:02.830949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:41:02.831561 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:41:02.836641 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:41:02.837361 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_housing_prices"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.838097 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:41:02.845334 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:41:02.846507 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."raw_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.846992 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:41:02.850595 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:41:02.851234 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:41:02.851714 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:41:02.852113 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:41:02.854938 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:41:02.855798 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:41:02.857359 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: ROLLBACK
[0m23:41:02.858729 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: ROLLBACK
[0m23:41:02.859376 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: BEGIN
[0m23:41:02.859972 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:41:02.860354 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: Close
[0m23:41:02.860860 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:02.861397 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: Close
[0m23:41:02.861864 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: BEGIN
[0m23:41:02.862921 [info ] [Thread-1 (]: 33 of 36 PASS source_not_null_public_raw_location_data_postcode ................ [[32mPASS[0m in 0.08s]
[0m23:41:02.863786 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:02.864682 [info ] [Thread-3 (]: 32 of 36 PASS source_not_null_public_raw_housing_prices_region ................. [[32mPASS[0m in 0.08s]
[0m23:41:02.865616 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:41:02.866692 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:41:02.867297 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:41:02.868350 [info ] [Thread-1 (]: 36 of 36 START test valid_values_stg_location_data_type__URBAN__RURAL .......... [RUN]
[0m23:41:02.868959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c, now test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91)
[0m23:41:02.869509 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:41:02.874688 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:41:02.875813 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m23:41:02.876417 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:41:02.877007 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m23:41:02.877607 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.878337 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:41:02.878822 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:41:02.882322 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:41:02.882932 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:41:02.883382 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."raw_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:41:02.885059 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: ROLLBACK
[0m23:41:02.885891 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:41:02.886729 [debug] [Thread-1 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: BEGIN
[0m23:41:02.887153 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: Close
[0m23:41:02.887569 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:41:02.887974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:02.890642 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: ROLLBACK
[0m23:41:02.888739 [info ] [Thread-4 (]: 34 of 36 PASS source_not_null_public_raw_location_data_region .................. [[32mPASS[0m in 0.06s]
[0m23:41:02.892292 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:41:02.893127 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: Close
[0m23:41:02.894254 [info ] [Thread-2 (]: 35 of 36 PASS source_not_null_public_raw_location_data_type .................... [[32mPASS[0m in 0.07s]
[0m23:41:02.894951 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:41:02.899569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:41:02.900101 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:41:02.900580 [debug] [Thread-1 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    SELECT *
    FROM "dwh"."public"."stg_location_data"
    WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'UNKNOWN'

  
  
      
    ) dbt_internal_test
[0m23:41:02.914494 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:41:02.916113 [debug] [Thread-1 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: ROLLBACK
[0m23:41:02.916953 [debug] [Thread-1 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: Close
[0m23:41:02.917798 [error] [Thread-1 (]: 36 of 36 FAIL 3766 valid_values_stg_location_data_type__URBAN__RURAL ........... [[31mFAIL 3766[0m in 0.05s]
[0m23:41:02.918535 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:41:02.920628 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:02.921008 [debug] [MainThread]: On master: BEGIN
[0m23:41:02.921275 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:02.928796 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:41:02.929286 [debug] [MainThread]: On master: COMMIT
[0m23:41:02.929701 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:02.930006 [debug] [MainThread]: On master: COMMIT
[0m23:41:02.930579 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:02.930956 [debug] [MainThread]: On master: Close
[0m23:41:02.931455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:02.931737 [debug] [MainThread]: Connection 'test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91' was properly closed.
[0m23:41:02.932013 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522' was properly closed.
[0m23:41:02.932268 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d' was properly closed.
[0m23:41:02.932554 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e' was properly closed.
[0m23:41:02.932998 [info ] [MainThread]: 
[0m23:41:02.933337 [info ] [MainThread]: Finished running 36 data tests in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m23:41:02.940266 [debug] [MainThread]: Command end result
[0m23:41:02.977144 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:41:02.978727 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:41:02.986894 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:41:02.987264 [info ] [MainThread]: 
[0m23:41:02.987641 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m23:41:02.988006 [info ] [MainThread]: 
[0m23:41:02.988755 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_pct_urban (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:41:02.989424 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:41:02.989975 [info ] [MainThread]: 
[0m23:41:02.990609 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_pct_urban.sql
[0m23:41:02.991633 [info ] [MainThread]: 
[0m23:41:02.992227 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_rural_count (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:41:02.993088 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:41:02.993612 [info ] [MainThread]: 
[0m23:41:02.994151 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_rural_count.sql
[0m23:41:02.994663 [info ] [MainThread]: 
[0m23:41:02.995354 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_urban_count (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:41:02.996127 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:41:02.996525 [info ] [MainThread]: 
[0m23:41:02.997064 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_urban_count.sql
[0m23:41:02.997529 [info ] [MainThread]: 
[0m23:41:02.998093 [error] [MainThread]:   Database Error in test not_null_region_type_composition_total_count (models/airflow_dbt_training/gold/schema.yml)
  column "total_count" does not exist
  LINE 16: select total_count
                  ^
  HINT:  Perhaps you meant to reference the column "region_type_composition.rural_count".
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_count.sql
[0m23:41:02.998562 [info ] [MainThread]: 
[0m23:41:02.999252 [error] [MainThread]:   Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:41:02.999715 [info ] [MainThread]: 
[0m23:41:03.000252 [error] [MainThread]: [31mFailure in test valid_values_stg_location_data_type__URBAN__RURAL (models/airflow_dbt_training/silver/schema.yml)[0m
[0m23:41:03.000842 [error] [MainThread]:   Got 3766 results, configured to fail if != 0
[0m23:41:03.001423 [info ] [MainThread]: 
[0m23:41:03.002038 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/silver/schema.yml/valid_values_stg_location_data_type__URBAN__RURAL.sql
[0m23:41:03.002578 [info ] [MainThread]: 
[0m23:41:03.003042 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=6 SKIP=0 TOTAL=36
[0m23:41:03.004320 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.447827, "process_in_blocks": "0", "process_kernel_time": 0.261711, "process_mem_max_rss": "131132", "process_out_blocks": "4184", "process_user_time": 3.633765}
[0m23:41:03.004946 [debug] [MainThread]: Command `dbt test` failed at 23:41:03.004813 after 2.45 seconds
[0m23:41:03.005502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fe142810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fe125890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fc5ccfd0>]}
[0m23:41:03.006155 [debug] [MainThread]: Flushing usage events
[0m23:41:03.590004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:35.439587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9852b205d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9850317890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98500da610>]}


============================== 23:41:35.442427 | 6eb36fc5-4c37-4353-81cc-d71a394ad957 ==============================
[0m23:41:35.442427 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:41:35.442987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:41:35.595006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6eb36fc5-4c37-4353-81cc-d71a394ad957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9850138110>]}
[0m23:41:35.652154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6eb36fc5-4c37-4353-81cc-d71a394ad957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9852b333d0>]}
[0m23:41:35.652918 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:41:35.728744 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:41:35.857499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:41:35.858466 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/gold/region_type_composition.sql
[0m23:41:36.300597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6eb36fc5-4c37-4353-81cc-d71a394ad957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984e161c50>]}
[0m23:41:36.404962 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:41:36.407651 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:41:36.476721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6eb36fc5-4c37-4353-81cc-d71a394ad957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984e5a4410>]}
[0m23:41:36.477310 [info ] [MainThread]: Found 9 models, 36 data tests, 2 sources, 436 macros
[0m23:41:36.477654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eb36fc5-4c37-4353-81cc-d71a394ad957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984e144450>]}
[0m23:41:36.481743 [info ] [MainThread]: 
[0m23:41:36.482400 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:41:36.482945 [info ] [MainThread]: 
[0m23:41:36.483715 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:36.489328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m23:41:36.527833 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:41:36.528217 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:41:36.528482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:36.535572 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:41:36.535985 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:41:36.536315 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:41:36.538937 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:41:36.540423 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:41:36.540901 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:41:36.547863 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:36.548194 [debug] [MainThread]: On master: BEGIN
[0m23:41:36.548452 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:36.554922 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:41:36.555295 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:36.555771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:41:36.560305 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m23:41:36.563064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eb36fc5-4c37-4353-81cc-d71a394ad957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984c5e9210>]}
[0m23:41:36.563504 [debug] [MainThread]: On master: ROLLBACK
[0m23:41:36.563979 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:36.564263 [debug] [MainThread]: On master: BEGIN
[0m23:41:36.564881 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:41:36.565170 [debug] [MainThread]: On master: COMMIT
[0m23:41:36.565444 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:36.565722 [debug] [MainThread]: On master: COMMIT
[0m23:41:36.566143 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:36.566436 [debug] [MainThread]: On master: Close
[0m23:41:36.569995 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:41:36.570442 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:41:36.570929 [info ] [Thread-1 (]: 1 of 36 START test accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [RUN]
[0m23:41:36.571501 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:41:36.572007 [info ] [Thread-2 (]: 2 of 36 START test accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [RUN]
[0m23:41:36.572603 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:41:36.573156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m23:41:36.573719 [info ] [Thread-3 (]: 3 of 36 START test not_null_mart_housing_prices_breakdown_avg_price ............ [RUN]
[0m23:41:36.574522 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e'
[0m23:41:36.575061 [info ] [Thread-4 (]: 4 of 36 START test not_null_mart_housing_prices_breakdown_n_sales .............. [RUN]
[0m23:41:36.575691 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:41:36.576377 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d'
[0m23:41:36.576852 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:41:36.577439 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7'
[0m23:41:36.588418 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:41:36.600769 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:41:36.609159 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:41:36.609766 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:41:36.619237 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:41:36.623563 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:41:36.624084 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:41:36.628814 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:41:36.645485 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:41:36.645943 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:41:36.651760 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:41:36.652318 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:41:36.655128 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:41:36.658070 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:41:36.661068 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:41:36.662041 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:41:36.662830 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:41:36.663586 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:41:36.664042 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:41:36.664514 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: BEGIN
[0m23:41:36.664971 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: BEGIN
[0m23:41:36.665405 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: BEGIN
[0m23:41:36.665847 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: BEGIN
[0m23:41:36.666269 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:41:36.666693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:36.667084 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:41:36.667652 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:41:36.674766 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:41:36.675395 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:41:36.675835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:41:36.676229 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:41:36.676669 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m23:41:36.677128 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:41:36.677593 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:41:36.678140 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        month as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by month

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','7','8','9','10','11','12'
)



  
  
      
    ) dbt_internal_test
[0m23:41:36.678660 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:41:36.679135 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select n_sales
from "dwh"."public"."mart_housing_prices_breakdown"
where n_sales is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.679692 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        day_of_week as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by day_of_week

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m23:41:36.680395 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_price
from "dwh"."public"."mart_housing_prices_breakdown"
where avg_price is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.687558 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:41:36.688253 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:41:36.688753 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:41:36.689175 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:41:36.693488 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: ROLLBACK
[0m23:41:36.695149 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: ROLLBACK
[0m23:41:36.696713 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: ROLLBACK
[0m23:41:36.698169 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: ROLLBACK
[0m23:41:36.698887 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: Close
[0m23:41:36.699452 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: Close
[0m23:41:36.699982 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: Close
[0m23:41:36.701332 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: Close
[0m23:41:36.700947 [info ] [Thread-2 (]: 2 of 36 PASS accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [[32mPASS[0m in 0.13s]
[0m23:41:36.702159 [info ] [Thread-4 (]: 4 of 36 PASS not_null_mart_housing_prices_breakdown_n_sales .................... [[32mPASS[0m in 0.12s]
[0m23:41:36.703312 [info ] [Thread-1 (]: 1 of 36 PASS accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [[32mPASS[0m in 0.13s]
[0m23:41:36.704423 [info ] [Thread-3 (]: 3 of 36 PASS not_null_mart_housing_prices_breakdown_avg_price .................. [[32mPASS[0m in 0.13s]
[0m23:41:36.705459 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:41:36.706328 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:41:36.707248 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:41:36.707997 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:41:36.708537 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:41:36.709183 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:41:36.709809 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:41:36.710480 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:41:36.711196 [info ] [Thread-2 (]: 5 of 36 START test not_null_mart_housing_prices_breakdown_pct_urban ............ [RUN]
[0m23:41:36.711791 [info ] [Thread-4 (]: 6 of 36 START test not_null_mart_housing_prices_breakdown_region ............... [RUN]
[0m23:41:36.712434 [info ] [Thread-1 (]: 7 of 36 START test not_null_mart_housing_prices_breakdown_rural_count .......... [RUN]
[0m23:41:36.713333 [info ] [Thread-3 (]: 8 of 36 START test not_null_mart_housing_prices_breakdown_urban_count .......... [RUN]
[0m23:41:36.714270 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e)
[0m23:41:36.714938 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m23:41:36.715563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281)
[0m23:41:36.716107 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de)
[0m23:41:36.716598 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:41:36.717037 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:41:36.717507 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:41:36.717942 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:41:36.728025 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:41:36.729346 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:41:36.734238 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:41:36.738737 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:41:36.739844 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:41:36.740601 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:41:36.743647 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:41:36.744143 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:41:36.746909 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:41:36.747350 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:41:36.750087 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:41:36.750871 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:41:36.751305 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:41:36.753850 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:41:36.754484 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: BEGIN
[0m23:41:36.755006 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: BEGIN
[0m23:41:36.755564 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:41:36.756202 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:36.756708 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:41:36.757119 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:36.757582 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: BEGIN
[0m23:41:36.758266 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: BEGIN
[0m23:41:36.758908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:36.759423 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:36.764702 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m23:41:36.765209 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:41:36.765672 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:41:36.766366 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:41:36.766894 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:41:36.767380 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."mart_housing_prices_breakdown"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.767824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:41:36.768308 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."mart_housing_prices_breakdown"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.768779 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:41:36.769328 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:41:36.769865 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."mart_housing_prices_breakdown"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.770410 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."mart_housing_prices_breakdown"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.771442 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:41:36.772885 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: ROLLBACK
[0m23:41:36.773432 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: Close
[0m23:41:36.774096 [info ] [Thread-4 (]: 6 of 36 PASS not_null_mart_housing_prices_breakdown_region ..................... [[32mPASS[0m in 0.06s]
[0m23:41:36.774919 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:41:36.775568 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:41:36.776148 [info ] [Thread-4 (]: 9 of 36 START test not_null_region_type_composition_pct_urban .................. [RUN]
[0m23:41:36.776721 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m23:41:36.777274 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:41:36.782318 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:41:36.782943 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:41:36.785936 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:41:36.786505 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:41:36.787915 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:41:36.788342 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:41:36.788815 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:41:36.790303 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: ROLLBACK
[0m23:41:36.791980 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: ROLLBACK
[0m23:41:36.793558 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: ROLLBACK
[0m23:41:36.794047 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: BEGIN
[0m23:41:36.794811 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: Close
[0m23:41:36.795265 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: Close
[0m23:41:36.795632 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: Close
[0m23:41:36.796028 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:36.796828 [error] [Thread-2 (]: 5 of 36 FAIL 5 not_null_mart_housing_prices_breakdown_pct_urban ................ [[31mFAIL 5[0m in 0.08s]
[0m23:41:36.798182 [error] [Thread-1 (]: 7 of 36 FAIL 5 not_null_mart_housing_prices_breakdown_rural_count .............. [[31mFAIL 5[0m in 0.08s]
[0m23:41:36.799479 [error] [Thread-3 (]: 8 of 36 FAIL 5 not_null_mart_housing_prices_breakdown_urban_count .............. [[31mFAIL 5[0m in 0.08s]
[0m23:41:36.801153 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:41:36.801951 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:41:36.802603 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:41:36.803101 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:41:36.803696 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:41:36.804394 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:41:36.804979 [info ] [Thread-2 (]: 10 of 36 START test not_null_region_type_composition_region .................... [RUN]
[0m23:41:36.805605 [info ] [Thread-1 (]: 11 of 36 START test not_null_region_type_composition_rural_count ............... [RUN]
[0m23:41:36.806266 [info ] [Thread-3 (]: 12 of 36 START test not_null_region_type_composition_total_count ............... [RUN]
[0m23:41:36.807238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m23:41:36.807931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m23:41:36.808455 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:41:36.808922 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de, now test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7)
[0m23:41:36.809375 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:41:36.809848 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:41:36.810329 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:41:36.810817 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:41:36.815413 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:41:36.820020 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:41:36.820623 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.827356 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:41:36.828273 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:41:36.829061 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:41:36.832110 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:41:36.832503 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:41:36.835186 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:41:36.838027 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:41:36.838889 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:41:36.839695 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:41:36.840234 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: BEGIN
[0m23:41:36.840723 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:41:36.841161 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:41:36.841549 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: BEGIN
[0m23:41:36.841984 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:36.842425 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: BEGIN
[0m23:41:36.843854 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: ROLLBACK
[0m23:41:36.844278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:36.844911 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:36.845704 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: Close
[0m23:41:36.846902 [info ] [Thread-4 (]: 9 of 36 PASS not_null_region_type_composition_pct_urban ........................ [[32mPASS[0m in 0.07s]
[0m23:41:36.847793 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:41:36.848299 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:41:36.848923 [info ] [Thread-4 (]: 13 of 36 START test not_null_region_type_composition_urban_count ............... [RUN]
[0m23:41:36.849611 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m23:41:36.850131 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:41:36.855823 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:41:36.857061 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:41:36.857795 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m23:41:36.861097 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:41:36.861573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m23:41:36.862091 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m23:41:36.862497 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:41:36.863150 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:41:36.863666 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:41:36.864099 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:41:36.864610 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.865226 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.865812 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_count
from "dwh"."public"."region_type_composition"
where total_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.866301 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: BEGIN
[0m23:41:36.867005 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:36.867517 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "total_count" does not exist
LINE 16: select total_count
                ^
HINT:  Perhaps you meant to reference the column "region_type_composition.rural_count".

[0m23:41:36.868300 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: ROLLBACK
[0m23:41:36.868926 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: Close
[0m23:41:36.873056 [debug] [Thread-3 (]: Database Error in test not_null_region_type_composition_total_count (models/airflow_dbt_training/gold/schema.yml)
  column "total_count" does not exist
  LINE 16: select total_count
                  ^
  HINT:  Perhaps you meant to reference the column "region_type_composition.rural_count".
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_count.sql
[0m23:41:36.873587 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:41:36.874134 [error] [Thread-3 (]: 12 of 36 ERROR not_null_region_type_composition_total_count .................... [[31mERROR[0m in 0.07s]
[0m23:41:36.875746 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: ROLLBACK
[0m23:41:36.876543 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:41:36.877591 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:41:36.878145 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m23:41:36.878711 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_total_count (models/airflow_dbt_training/gold/schema.yml)
  column "total_count" does not exist
  LINE 16: select total_count
                  ^
  HINT:  Perhaps you meant to reference the column "region_type_composition.rural_count".
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_count.sql.
[0m23:41:36.879175 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: Close
[0m23:41:36.880038 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:41:36.879622 [info ] [Thread-3 (]: 14 of 36 START test not_null_region_type_composition_with_macro_pct_urban ...... [RUN]
[0m23:41:36.880676 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:41:36.884162 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: ROLLBACK
[0m23:41:36.882160 [info ] [Thread-2 (]: 10 of 36 PASS not_null_region_type_composition_region .......................... [[32mPASS[0m in 0.07s]
[0m23:41:36.884932 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91)
[0m23:41:36.885520 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.886376 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:41:36.886980 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:41:36.887414 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: Close
[0m23:41:36.888073 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:41:36.893357 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:41:36.894240 [info ] [Thread-2 (]: 15 of 36 START test not_null_region_type_composition_with_macro_region ......... [RUN]
[0m23:41:36.896536 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192)
[0m23:41:36.895076 [info ] [Thread-1 (]: 11 of 36 PASS not_null_region_type_composition_rural_count ..................... [[32mPASS[0m in 0.09s]
[0m23:41:36.897554 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:41:36.898119 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:41:36.898709 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:41:36.903576 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:41:36.904213 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:41:36.907337 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:41:36.908297 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:41:36.910102 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: ROLLBACK
[0m23:41:36.911034 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:41:36.911542 [info ] [Thread-1 (]: 16 of 36 START test not_null_region_type_composition_with_macro_rural_count .... [RUN]
[0m23:41:36.912089 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:41:36.915443 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:41:36.916143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797)
[0m23:41:36.916565 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: Close
[0m23:41:36.917014 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: BEGIN
[0m23:41:36.917764 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:41:36.918289 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:41:36.918830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:36.919661 [info ] [Thread-4 (]: 13 of 36 PASS not_null_region_type_composition_urban_count ..................... [[32mPASS[0m in 0.07s]
[0m23:41:36.924595 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:41:36.925209 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: BEGIN
[0m23:41:36.926484 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:41:36.927206 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:36.927856 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:41:36.928381 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:41:36.932976 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:41:36.933804 [info ] [Thread-4 (]: 17 of 36 START test not_null_region_type_composition_with_macro_total_locations  [RUN]
[0m23:41:36.934349 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m23:41:36.935245 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae)
[0m23:41:36.936073 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:41:36.936501 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:41:36.939644 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:41:36.940078 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m23:41:36.940576 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition_with_macro"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.941072 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: BEGIN
[0m23:41:36.945675 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:41:36.946243 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:41:36.946791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:36.947498 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition_with_macro"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.948198 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:41:36.951682 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:41:36.952385 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:41:36.952751 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: BEGIN
[0m23:41:36.953085 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:36.953614 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:41:36.955022 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: ROLLBACK
[0m23:41:36.955874 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: Close
[0m23:41:36.956566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:41:36.957085 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:41:36.958149 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition_with_macro"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.957739 [info ] [Thread-2 (]: 15 of 36 PASS not_null_region_type_composition_with_macro_region ............... [[32mPASS[0m in 0.06s]
[0m23:41:36.959202 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:41:36.959663 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:41:36.960407 [info ] [Thread-2 (]: 18 of 36 START test not_null_region_type_composition_with_macro_urban_count .... [RUN]
[0m23:41:36.961021 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224)
[0m23:41:36.961652 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:41:36.962586 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:41:36.963398 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:41:36.963852 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:41:36.968955 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:41:36.969615 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_locations
from "dwh"."public"."region_type_composition_with_macro"
where total_locations is null



  
  
      
    ) dbt_internal_test
[0m23:41:36.971252 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: ROLLBACK
[0m23:41:36.972103 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:41:36.972508 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: Close
[0m23:41:36.972967 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "total_locations" does not exist
LINE 16: select total_locations
                ^

[0m23:41:36.976110 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:41:36.976741 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m23:41:36.977334 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: ROLLBACK
[0m23:41:36.977921 [info ] [Thread-3 (]: 14 of 36 PASS not_null_region_type_composition_with_macro_pct_urban ............ [[32mPASS[0m in 0.09s]
[0m23:41:36.980173 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: ROLLBACK
[0m23:41:36.980945 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:41:36.981753 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:41:36.982261 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: Close
[0m23:41:36.982829 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: BEGIN
[0m23:41:36.983378 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:41:36.983764 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: Close
[0m23:41:36.985395 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:36.986086 [info ] [Thread-3 (]: 19 of 36 START test not_null_stg_housing_prices_date ........................... [RUN]
[0m23:41:36.988277 [debug] [Thread-4 (]: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:41:36.989385 [info ] [Thread-1 (]: 16 of 36 PASS not_null_region_type_composition_with_macro_rural_count .......... [[32mPASS[0m in 0.07s]
[0m23:41:36.990074 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m23:41:36.990821 [error] [Thread-4 (]: 17 of 36 ERROR not_null_region_type_composition_with_macro_total_locations ..... [[31mERROR[0m in 0.06s]
[0m23:41:36.991591 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:41:36.992203 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:41:36.993100 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:41:36.993720 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:41:37.000027 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:41:37.000850 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:41:37.001489 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql.
[0m23:41:37.002000 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m23:41:37.002469 [info ] [Thread-1 (]: 20 of 36 START test not_null_stg_housing_prices_day_of_week .................... [RUN]
[0m23:41:37.003158 [info ] [Thread-4 (]: 21 of 36 START test not_null_stg_housing_prices_id ............................. [RUN]
[0m23:41:37.004209 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:41:37.005036 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:41:37.005615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m23:41:37.006108 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m23:41:37.009180 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:41:37.009783 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition_with_macro"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.010444 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:41:37.010983 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:41:37.017332 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:41:37.017871 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:41:37.023532 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:41:37.024111 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: BEGIN
[0m23:41:37.025187 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:37.025851 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:41:37.026382 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:41:37.029444 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:41:37.029976 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.018 seconds
[0m23:41:37.032655 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:41:37.034436 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: ROLLBACK
[0m23:41:37.035116 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m23:41:37.035635 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:41:37.036518 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:41:37.036963 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:41:37.037426 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: Close
[0m23:41:37.037801 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: BEGIN
[0m23:41:37.038312 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select date
from __dbt__cte__stg_housing_prices
where date is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.038825 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: BEGIN
[0m23:41:37.039606 [info ] [Thread-2 (]: 18 of 36 PASS not_null_region_type_composition_with_macro_urban_count .......... [[32mPASS[0m in 0.08s]
[0m23:41:37.040144 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:37.040972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:37.041939 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:41:37.042981 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:41:37.043752 [info ] [Thread-2 (]: 22 of 36 START test not_null_stg_housing_prices_month .......................... [RUN]
[0m23:41:37.044411 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m23:41:37.044966 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:41:37.051439 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:41:37.053556 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: ROLLBACK
[0m23:41:37.054442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:41:37.055061 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m23:41:37.056244 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:41:37.056814 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:41:37.057280 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: Close
[0m23:41:37.057725 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:41:37.058394 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select day_of_week
from __dbt__cte__stg_housing_prices
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.060090 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select id
from __dbt__cte__stg_housing_prices
where id is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.060789 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:41:37.059549 [info ] [Thread-3 (]: 19 of 36 PASS not_null_stg_housing_prices_date ................................. [[32mPASS[0m in 0.07s]
[0m23:41:37.066724 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:41:37.067546 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:41:37.068383 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:41:37.068953 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:41:37.070649 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: ROLLBACK
[0m23:41:37.071532 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:41:37.072485 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:41:37.074268 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: ROLLBACK
[0m23:41:37.074952 [info ] [Thread-3 (]: 23 of 36 START test not_null_stg_housing_prices_price .......................... [RUN]
[0m23:41:37.075405 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: Close
[0m23:41:37.075880 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: BEGIN
[0m23:41:37.076466 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m23:41:37.076905 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: Close
[0m23:41:37.078239 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:37.077746 [info ] [Thread-4 (]: 21 of 36 PASS not_null_stg_housing_prices_id ................................... [[32mPASS[0m in 0.07s]
[0m23:41:37.079063 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:41:37.080203 [info ] [Thread-1 (]: 20 of 36 PASS not_null_stg_housing_prices_day_of_week .......................... [[32mPASS[0m in 0.07s]
[0m23:41:37.081069 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:41:37.087356 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:41:37.087930 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:41:37.088629 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:41:37.089178 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:41:37.089914 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:41:37.090598 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:41:37.090973 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:41:37.091497 [info ] [Thread-4 (]: 24 of 36 START test not_null_stg_housing_prices_region ......................... [RUN]
[0m23:41:37.092224 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select month
from __dbt__cte__stg_housing_prices
where month is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.092786 [info ] [Thread-1 (]: 25 of 36 START test not_null_stg_housing_prices_year ........................... [RUN]
[0m23:41:37.095863 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:41:37.096485 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m23:41:37.097190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m23:41:37.097854 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:41:37.098486 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:41:37.098938 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:41:37.105091 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:41:37.105574 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:41:37.106014 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: BEGIN
[0m23:41:37.111346 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:41:37.113169 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: ROLLBACK
[0m23:41:37.113973 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:37.114487 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:41:37.115159 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:41:37.118339 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:41:37.118790 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: Close
[0m23:41:37.121611 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:41:37.122745 [info ] [Thread-2 (]: 22 of 36 PASS not_null_stg_housing_prices_month ................................ [[32mPASS[0m in 0.08s]
[0m23:41:37.123251 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:41:37.123929 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:41:37.124733 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:41:37.125365 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:41:37.125878 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:41:37.126370 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: BEGIN
[0m23:41:37.126858 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: BEGIN
[0m23:41:37.127517 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:41:37.128212 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select price
from __dbt__cte__stg_housing_prices
where price is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.128764 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:37.129217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:37.129687 [info ] [Thread-2 (]: 26 of 36 START test not_null_stg_location_data_postcode ........................ [RUN]
[0m23:41:37.130859 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m23:41:37.131383 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:41:37.137890 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:41:37.137306 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:41:37.139883 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: ROLLBACK
[0m23:41:37.140971 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:41:37.141518 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: Close
[0m23:41:37.141916 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:41:37.142302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:41:37.142874 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:41:37.143427 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select region
from __dbt__cte__stg_housing_prices
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.144271 [info ] [Thread-3 (]: 23 of 36 PASS not_null_stg_housing_prices_price ................................ [[32mPASS[0m in 0.07s]
[0m23:41:37.144893 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:41:37.147958 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:41:37.148822 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:41:37.149376 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select year
from __dbt__cte__stg_housing_prices
where year is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.150338 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:41:37.150908 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:41:37.151937 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:41:37.153573 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: ROLLBACK
[0m23:41:37.154090 [info ] [Thread-3 (]: 27 of 36 START test not_null_stg_location_data_region .......................... [RUN]
[0m23:41:37.154654 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: BEGIN
[0m23:41:37.155329 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m23:41:37.155909 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: Close
[0m23:41:37.156596 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:37.157128 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:41:37.158221 [info ] [Thread-4 (]: 24 of 36 PASS not_null_stg_housing_prices_region ............................... [[32mPASS[0m in 0.06s]
[0m23:41:37.158797 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:41:37.164755 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:41:37.165718 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:41:37.166513 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:41:37.168418 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: ROLLBACK
[0m23:41:37.169315 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:41:37.169950 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:41:37.170443 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:41:37.171193 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."stg_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.171633 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: Close
[0m23:41:37.174636 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:41:37.175262 [info ] [Thread-4 (]: 28 of 36 START test not_null_stg_location_data_type ............................ [RUN]
[0m23:41:37.176585 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m23:41:37.177478 [info ] [Thread-1 (]: 25 of 36 PASS not_null_stg_housing_prices_year ................................. [[32mPASS[0m in 0.08s]
[0m23:41:37.178157 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:41:37.178575 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:41:37.179412 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:41:37.179972 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:41:37.181748 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: ROLLBACK
[0m23:41:37.188762 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:41:37.189297 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:41:37.189870 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: BEGIN
[0m23:41:37.190532 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: Close
[0m23:41:37.190950 [info ] [Thread-1 (]: 29 of 36 START test source_not_null_public_raw_housing_prices_date ............. [RUN]
[0m23:41:37.191504 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:37.192272 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:41:37.193097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m23:41:37.193978 [info ] [Thread-2 (]: 26 of 36 PASS not_null_stg_location_data_postcode .............................. [[32mPASS[0m in 0.06s]
[0m23:41:37.197377 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:41:37.197949 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:41:37.198783 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:41:37.203901 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:41:37.204886 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:41:37.205515 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m23:41:37.206108 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:41:37.206783 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: BEGIN
[0m23:41:37.207303 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:41:37.207675 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:41:37.208163 [info ] [Thread-2 (]: 30 of 36 START test source_not_null_public_raw_housing_prices_id ............... [RUN]
[0m23:41:37.208650 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:37.209141 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."stg_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.212933 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:41:37.213594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m23:41:37.214647 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:41:37.219694 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:41:37.220390 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:41:37.220874 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:41:37.221532 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: BEGIN
[0m23:41:37.223310 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: ROLLBACK
[0m23:41:37.223845 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:41:37.224296 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m23:41:37.224792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:37.227759 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:41:37.228216 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: Close
[0m23:41:37.228725 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:41:37.230161 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."stg_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.230974 [info ] [Thread-3 (]: 27 of 36 PASS not_null_stg_location_data_region ................................ [[32mPASS[0m in 0.08s]
[0m23:41:37.231566 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:41:37.232383 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:41:37.232839 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: BEGIN
[0m23:41:37.233394 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:41:37.233974 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:37.234594 [info ] [Thread-3 (]: 31 of 36 START test source_not_null_public_raw_housing_prices_price ............ [RUN]
[0m23:41:37.235869 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m23:41:37.236610 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:41:37.237128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:41:37.237685 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:41:37.242773 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:41:37.243468 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:41:37.245198 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: ROLLBACK
[0m23:41:37.245719 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m23:41:37.246419 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "dwh"."public"."raw_housing_prices"
where date is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.247049 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:41:37.247821 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:41:37.248400 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: Close
[0m23:41:37.251398 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:41:37.251925 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:41:37.252351 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dwh"."public"."raw_housing_prices"
where id is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.253405 [info ] [Thread-4 (]: 28 of 36 PASS not_null_stg_location_data_type .................................. [[32mPASS[0m in 0.08s]
[0m23:41:37.255366 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: ROLLBACK
[0m23:41:37.255915 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:41:37.256807 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:41:37.257434 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: BEGIN
[0m23:41:37.258048 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: Close
[0m23:41:37.258534 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:41:37.259015 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:41:37.259801 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:37.260422 [info ] [Thread-4 (]: 32 of 36 START test source_not_null_public_raw_housing_prices_region ........... [RUN]
[0m23:41:37.262935 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: ROLLBACK
[0m23:41:37.261108 [info ] [Thread-1 (]: 29 of 36 PASS source_not_null_public_raw_housing_prices_date ................... [[32mPASS[0m in 0.07s]
[0m23:41:37.263973 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m23:41:37.264801 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:41:37.265375 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: Close
[0m23:41:37.266045 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:41:37.266610 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:41:37.273186 [info ] [Thread-2 (]: 30 of 36 PASS source_not_null_public_raw_housing_prices_id ..................... [[32mPASS[0m in 0.06s]
[0m23:41:37.274433 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m23:41:37.271940 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:41:37.273931 [info ] [Thread-1 (]: 33 of 36 START test source_not_null_public_raw_location_data_postcode .......... [RUN]
[0m23:41:37.275460 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:41:37.275982 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:41:37.276656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m23:41:37.277617 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:41:37.278520 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:41:37.279322 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dwh"."public"."raw_housing_prices"
where price is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.279915 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:41:37.280506 [info ] [Thread-2 (]: 34 of 36 START test source_not_null_public_raw_location_data_region ............ [RUN]
[0m23:41:37.284134 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:41:37.289375 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:41:37.290091 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:41:37.290834 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m23:41:37.292093 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:41:37.293799 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: ROLLBACK
[0m23:41:37.294396 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:41:37.294839 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:41:37.295449 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: BEGIN
[0m23:41:37.302724 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:41:37.303363 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: Close
[0m23:41:37.306802 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:41:37.307488 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:37.309202 [info ] [Thread-3 (]: 31 of 36 PASS source_not_null_public_raw_housing_prices_price .................. [[32mPASS[0m in 0.07s]
[0m23:41:37.309723 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:41:37.310775 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:41:37.311620 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:41:37.315637 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:41:37.316505 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:41:37.317476 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: BEGIN
[0m23:41:37.318712 [info ] [Thread-3 (]: 35 of 36 START test source_not_null_public_raw_location_data_type .............. [RUN]
[0m23:41:37.319718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:37.320689 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m23:41:37.321602 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m23:41:37.322583 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:41:37.323207 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:41:37.323759 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:41:37.324287 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: BEGIN
[0m23:41:37.329409 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:41:37.330208 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_housing_prices"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.330778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:41:37.331219 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:37.332147 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:41:37.332656 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:41:37.336162 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:41:37.336731 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:41:37.337242 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."raw_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.339306 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: ROLLBACK
[0m23:41:37.340763 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:41:37.341351 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: Close
[0m23:41:37.341741 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:41:37.342147 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:41:37.342540 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: BEGIN
[0m23:41:37.343258 [info ] [Thread-4 (]: 32 of 36 PASS source_not_null_public_raw_housing_prices_region ................. [[32mPASS[0m in 0.08s]
[0m23:41:37.343898 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:41:37.345974 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: ROLLBACK
[0m23:41:37.346533 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:41:37.347245 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:41:37.347773 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.348674 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:41:37.349067 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: Close
[0m23:41:37.349996 [info ] [Thread-4 (]: 36 of 36 START test valid_values_stg_location_data_type__URBAN__RURAL .......... [RUN]
[0m23:41:37.351070 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91)
[0m23:41:37.351578 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:41:37.352295 [info ] [Thread-1 (]: 33 of 36 PASS source_not_null_public_raw_location_data_postcode ................ [[32mPASS[0m in 0.08s]
[0m23:41:37.361729 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:41:37.362606 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:41:37.363306 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:41:37.363737 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m23:41:37.365724 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: ROLLBACK
[0m23:41:37.366556 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:41:37.366993 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:41:37.370316 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:41:37.370906 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: Close
[0m23:41:37.371453 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."raw_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:41:37.372445 [info ] [Thread-2 (]: 34 of 36 PASS source_not_null_public_raw_location_data_region .................. [[32mPASS[0m in 0.08s]
[0m23:41:37.373291 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:41:37.374061 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:41:37.374638 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: BEGIN
[0m23:41:37.375221 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:41:37.375994 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:41:37.377678 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: ROLLBACK
[0m23:41:37.378509 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: Close
[0m23:41:37.379249 [info ] [Thread-3 (]: 35 of 36 PASS source_not_null_public_raw_location_data_type .................... [[32mPASS[0m in 0.06s]
[0m23:41:37.379962 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:41:37.385211 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:41:37.385712 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:41:37.386198 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    SELECT *
    FROM "dwh"."public"."stg_location_data"
    WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'UNKNOWN'

  
  
      
    ) dbt_internal_test
[0m23:41:37.400102 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:41:37.401747 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: ROLLBACK
[0m23:41:37.402371 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: Close
[0m23:41:37.403003 [error] [Thread-4 (]: 36 of 36 FAIL 3766 valid_values_stg_location_data_type__URBAN__RURAL ........... [[31mFAIL 3766[0m in 0.05s]
[0m23:41:37.403623 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:41:37.406176 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:37.406618 [debug] [MainThread]: On master: BEGIN
[0m23:41:37.406907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:37.413965 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:41:37.414436 [debug] [MainThread]: On master: COMMIT
[0m23:41:37.414734 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:37.415036 [debug] [MainThread]: On master: COMMIT
[0m23:41:37.415446 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:37.415758 [debug] [MainThread]: On master: Close
[0m23:41:37.416211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:37.416506 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c' was properly closed.
[0m23:41:37.416861 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e' was properly closed.
[0m23:41:37.417217 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522' was properly closed.
[0m23:41:37.417495 [debug] [MainThread]: Connection 'test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91' was properly closed.
[0m23:41:37.417911 [info ] [MainThread]: 
[0m23:41:37.418282 [info ] [MainThread]: Finished running 36 data tests in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m23:41:37.425243 [debug] [MainThread]: Command end result
[0m23:41:37.464951 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:41:37.466557 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:41:37.474801 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:41:37.475264 [info ] [MainThread]: 
[0m23:41:37.475640 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m23:41:37.476016 [info ] [MainThread]: 
[0m23:41:37.476603 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_pct_urban (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:41:37.477226 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:41:37.477704 [info ] [MainThread]: 
[0m23:41:37.478313 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_pct_urban.sql
[0m23:41:37.478773 [info ] [MainThread]: 
[0m23:41:37.479745 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_rural_count (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:41:37.480253 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:41:37.480811 [info ] [MainThread]: 
[0m23:41:37.481610 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_rural_count.sql
[0m23:41:37.482296 [info ] [MainThread]: 
[0m23:41:37.483011 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_urban_count (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:41:37.483833 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:41:37.484329 [info ] [MainThread]: 
[0m23:41:37.485002 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_urban_count.sql
[0m23:41:37.485427 [info ] [MainThread]: 
[0m23:41:37.486209 [error] [MainThread]:   Database Error in test not_null_region_type_composition_total_count (models/airflow_dbt_training/gold/schema.yml)
  column "total_count" does not exist
  LINE 16: select total_count
                  ^
  HINT:  Perhaps you meant to reference the column "region_type_composition.rural_count".
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_count.sql
[0m23:41:37.486765 [info ] [MainThread]: 
[0m23:41:37.487546 [error] [MainThread]:   Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:41:37.488177 [info ] [MainThread]: 
[0m23:41:37.488919 [error] [MainThread]: [31mFailure in test valid_values_stg_location_data_type__URBAN__RURAL (models/airflow_dbt_training/silver/schema.yml)[0m
[0m23:41:37.489990 [error] [MainThread]:   Got 3766 results, configured to fail if != 0
[0m23:41:37.490890 [info ] [MainThread]: 
[0m23:41:37.491460 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/silver/schema.yml/valid_values_stg_location_data_type__URBAN__RURAL.sql
[0m23:41:37.492118 [info ] [MainThread]: 
[0m23:41:37.492834 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=6 SKIP=0 TOTAL=36
[0m23:41:37.494481 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.1069603, "process_in_blocks": "0", "process_kernel_time": 0.254048, "process_mem_max_rss": "128632", "process_out_blocks": "4200", "process_user_time": 3.272147}
[0m23:41:37.495027 [debug] [MainThread]: Command `dbt test` failed at 23:41:37.494926 after 2.11 seconds
[0m23:41:37.495578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9854484b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9854485090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98500da690>]}
[0m23:41:37.496108 [debug] [MainThread]: Flushing usage events
[0m23:41:38.038416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:42:29.950782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0c0219d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0c14bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0c06f990>]}


============================== 23:42:29.953393 | 4cda80bf-2fb5-459a-a84e-fc3d972c4383 ==============================
[0m23:42:29.953393 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:42:29.954083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:42:30.107029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cda80bf-2fb5-459a-a84e-fc3d972c4383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0bba6e50>]}
[0m23:42:30.163350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cda80bf-2fb5-459a-a84e-fc3d972c4383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0ea5d410>]}
[0m23:42:30.164116 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:42:30.244114 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:42:30.370227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:42:30.370925 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/gold/region_type_composition_with_macro.sql
[0m23:42:30.371425 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://tests/generic/test_valid_values.sql
[0m23:42:30.477734 [error] [MainThread]: Encountered an error:

[0m23:42:30.485985 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2069, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 312, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 417, in load
    self.parse_project(
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 740, in parse_project
    parser.parse_file(block)
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/base.py", line 507, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/base.py", line 470, in parse_node
    node = self._create_parsetime_node(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/base.py", line 248, in _create_parsetime_node
    return self.parse_from_dict(dct, validate=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/models.py", line 177, in parse_from_dict
    ModelNode.validate(dct)
  File "/usr/local/lib/python3.11/site-packages/dbt_common/dataclass_schema.py", line 95, in validate
    json_schema = cls.json_schema()
                  ^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/dataclass_schema.py", line 89, in json_schema
    json_schema_obj = build_json_schema(cls)
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/mashumaro/jsonschema/builder.py", line 45, in build_json_schema
    schema = get_schema(instance, context, with_dialect_uri=with_dialect_uri)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/mashumaro/jsonschema/schema.py", line 268, in get_schema
    schema = schema_creator(instance, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/mashumaro/jsonschema/schema.py", line 353, in on_dataclass
    for f_name, f_type, has_default, f_default in instance.fields():
  File "/usr/local/lib/python3.11/site-packages/mashumaro/jsonschema/schema.py", line 188, in fields
    f_default = _default(f_type, f_default, self.get_self_config())
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/mashumaro/jsonschema/schema.py", line 296, in _default
    return CC(f_value).to_dict()["x"]
           ^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in __mashumaro_to_dict__
  File "/usr/local/lib/python3.11/site-packages/mashumaro/core/meta/code/builder.py", line 1116, in add_pack_method
    self.reset()
  File "/usr/local/lib/python3.11/site-packages/mashumaro/core/meta/code/builder.py", line 161, in reset
    self.resolved_type_params = resolve_type_params(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/mashumaro/core/meta/helpers.py", line 631, in resolve_type_params
    result.update(resolve_type_params(base, base_type_args))
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/mashumaro/core/meta/helpers.py", line 631, in resolve_type_params
    result.update(resolve_type_params(base, base_type_args))
KeyboardInterrupt

[0m23:42:30.488574 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.58867055, "process_in_blocks": "352", "process_kernel_time": 0.120401, "process_mem_max_rss": "109376", "process_out_blocks": "16", "process_user_time": 1.765886}
[0m23:42:30.489301 [debug] [MainThread]: Command `dbt test` failed at 23:42:30.489176 after 0.59 seconds
[0m23:42:30.489805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0c022cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0c06ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0c25b050>]}
[0m23:42:30.490181 [debug] [MainThread]: Flushing usage events
[0m23:42:31.072062 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:42:32.936272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b21acac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b21dcd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b21acafd0>]}


============================== 23:42:32.938990 | ab4b9b8f-f662-474e-8f8a-8fa33b144c12 ==============================
[0m23:42:32.938990 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:42:32.939591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:42:33.103153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab4b9b8f-f662-474e-8f8a-8fa33b144c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b211a8c50>]}
[0m23:42:33.175301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab4b9b8f-f662-474e-8f8a-8fa33b144c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b20d2b650>]}
[0m23:42:33.176083 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:42:33.268046 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:42:33.412288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:42:33.413246 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/gold/region_type_composition_with_macro.sql
[0m23:42:33.413953 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://tests/generic/test_valid_values.sql
[0m23:42:33.996179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab4b9b8f-f662-474e-8f8a-8fa33b144c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1fdbaa50>]}
[0m23:42:34.104314 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:42:34.106928 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:42:34.167271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab4b9b8f-f662-474e-8f8a-8fa33b144c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b20179ed0>]}
[0m23:42:34.167790 [info ] [MainThread]: Found 9 models, 36 data tests, 2 sources, 436 macros
[0m23:42:34.168155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab4b9b8f-f662-474e-8f8a-8fa33b144c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1de597d0>]}
[0m23:42:34.172032 [info ] [MainThread]: 
[0m23:42:34.172762 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:42:34.173379 [info ] [MainThread]: 
[0m23:42:34.174351 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:34.181061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:42:34.222268 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:42:34.222659 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:42:34.222947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:34.230532 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m23:42:34.231827 [debug] [ThreadPool]: On list_dwh: Close
[0m23:42:34.233730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:42:34.240624 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:42:34.241003 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:42:34.241266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:34.248026 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:42:34.248481 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:42:34.248958 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:42:34.251521 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:42:34.252937 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:42:34.253412 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:42:34.260491 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:34.260860 [debug] [MainThread]: On master: BEGIN
[0m23:42:34.261125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:34.267616 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:42:34.267986 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:34.268498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:42:34.273193 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m23:42:34.275972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab4b9b8f-f662-474e-8f8a-8fa33b144c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1fd49250>]}
[0m23:42:34.276395 [debug] [MainThread]: On master: ROLLBACK
[0m23:42:34.276870 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:34.277161 [debug] [MainThread]: On master: BEGIN
[0m23:42:34.277774 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:42:34.278068 [debug] [MainThread]: On master: COMMIT
[0m23:42:34.278342 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:34.278632 [debug] [MainThread]: On master: COMMIT
[0m23:42:34.279071 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:34.279378 [debug] [MainThread]: On master: Close
[0m23:42:34.282507 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:42:34.282966 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:42:34.283501 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m23:42:34.284074 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:42:34.284569 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:42:34.285136 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m23:42:34.285798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:42:34.286514 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m23:42:34.287328 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m23:42:34.288329 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:42:34.288974 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:42:34.289746 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:42:34.290515 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:42:34.291250 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:42:34.300491 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:42:34.301046 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:42:34.301486 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:42:34.305063 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:42:34.307766 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:42:34.308288 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:42:34.312234 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:42:34.313295 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:42:34.319049 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:42:34.360277 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:42:34.363661 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:42:34.364059 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:42:34.368029 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:42:34.372361 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:42:34.373011 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:42:34.373475 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:42:34.374413 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:42:34.375014 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:42:34.375457 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:42:34.375845 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:42:34.376268 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:42:34.376706 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:42:34.377129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:34.377585 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:42:34.378225 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:42:34.378884 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:42:34.385131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:34.385832 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:42:34.386424 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:42:34.387334 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:42:34.387981 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:42:34.388514 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:42:34.389080 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m23:42:34.389522 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:42:34.389930 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:42:34.395695 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:42:34.397672 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:42:34.398115 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:42:34.398758 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type,
    CASE
        WHEN LOWER("type") = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER("type") = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END as type_normalized
FROM source
  );
[0m23:42:34.399290 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:42:34.399711 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:42:34.400136 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:42:34.403880 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:42:34.404472 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:42:34.404940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:42:34.405380 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:42:34.405788 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:42:34.410459 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:42:34.413765 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:42:34.417459 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:42:34.417900 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:42:34.418321 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m23:42:34.418796 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:42:34.419272 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:42:34.422443 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:42:34.423336 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:42:34.423771 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:34.424166 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:34.424542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:42:34.427853 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:42:34.428282 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:42:34.431855 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:42:34.442722 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:42:34.450471 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:42:34.451941 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:42:34.452479 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:42:34.453050 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:42:34.453537 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:34.453929 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:42:34.454534 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:42:34.455021 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:34.456435 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:42:34.456887 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:42:34.458319 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:42:34.458770 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:42:34.459312 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:42:34.459760 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:42:34.460243 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:42:34.460676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:42:34.468019 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m23:42:34.467644 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:42:34.468887 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m23:42:34.469265 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m23:42:34.471884 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:42:34.479961 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:42:34.477234 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:42:34.482928 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:42:34.483682 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:42:34.484295 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:42:34.484739 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:42:34.485422 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:42:34.485891 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:42:34.486356 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:42:34.486911 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:42:34.490419 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:42:34.493100 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:42:34.493643 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:42:34.494081 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m23:42:34.496867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4b9b8f-f662-474e-8f8a-8fa33b144c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1c2feb90>]}
[0m23:42:34.498316 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:42:34.498721 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.011 seconds
[0m23:42:34.500017 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:42:34.500740 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m23:42:34.502387 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:42:34.503015 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4b9b8f-f662-474e-8f8a-8fa33b144c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1c3836d0>]}
[0m23:42:34.503927 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4b9b8f-f662-474e-8f8a-8fa33b144c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1c383c90>]}
[0m23:42:34.504555 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:42:34.505318 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4b9b8f-f662-474e-8f8a-8fa33b144c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1d58bc10>]}
[0m23:42:34.506100 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.21s]
[0m23:42:34.506976 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m23:42:34.508478 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.21s]
[0m23:42:34.509134 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:42:34.509912 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:42:34.510692 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:42:34.511439 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:42:34.512010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m23:42:34.513453 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:42:34.517761 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:42:34.518295 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:42:34.518911 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:42:34.519647 [info ] [Thread-3 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m23:42:34.521559 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:42:34.520532 [info ] [Thread-2 (]: 6 of 8 START sql view model public.region_type_composition_with_macro .......... [RUN]
[0m23:42:34.525416 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition)
[0m23:42:34.526498 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:42:34.526969 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition_with_macro)
[0m23:42:34.527604 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:42:34.528511 [info ] [Thread-4 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:42:34.529085 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:42:34.532510 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:42:34.533290 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m23:42:34.537731 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:34.538466 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:42:34.544609 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:42:34.554585 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:42:34.558774 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:42:34.559736 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:42:34.563998 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:34.564696 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:42:34.565254 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:42:34.576529 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:34.582314 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:42:34.598456 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: BEGIN
[0m23:42:34.614002 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:34.616169 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:34.616682 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:34.617460 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp234234598022"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:42:34.618192 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:34.623516 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:42:34.624147 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:42:34.624657 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:34.625119 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  total_locations as total_count
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:42:34.625661 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:34.626288 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */

  create view "dwh"."public"."region_type_composition_with_macro__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        ELSE 'UNKNOWN'
    END = 'URBAN') AS urban_count,
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'RURAL') AS rural_count
  ,
    COUNT(*) AS total_count

  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_count, 2) AS pct_urban
FROM type_counts
  );
[0m23:42:34.626789 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "ROUND"
LINE 22:   ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
           ^

[0m23:42:34.627285 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: ROLLBACK
[0m23:42:34.627884 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:42:34.629272 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:42:34.633251 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:34.633902 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
alter table "dwh"."public"."region_type_composition_with_macro__dbt_tmp" rename to "region_type_composition_with_macro"
[0m23:42:34.634744 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:34.635957 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:42:34.636452 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:34.636853 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:42:34.638950 [debug] [Thread-3 (]: Database Error in model region_type_composition (models/airflow_dbt_training/gold/region_type_composition.sql)
  syntax error at or near "ROUND"
  LINE 22:   ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
             ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/region_type_composition.sql
[0m23:42:34.639471 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4b9b8f-f662-474e-8f8a-8fa33b144c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1c31b850>]}
[0m23:42:34.640508 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:42:34.640122 [error] [Thread-3 (]: 5 of 8 ERROR creating sql view model public.region_type_composition ............ [[31mERROR[0m in 0.12s]
[0m23:42:34.643829 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."region_type_composition_with_macro__dbt_backup"
[0m23:42:34.644640 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:42:34.645314 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:34.645983 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.region_type_composition' to be skipped because of status 'error'.  Reason: Database Error in model region_type_composition (models/airflow_dbt_training/gold/region_type_composition.sql)
  syntax error at or near "ROUND"
  LINE 22:   ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
             ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/region_type_composition.sql.
[0m23:42:34.646474 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
drop view if exists "dwh"."public"."region_type_composition_with_macro__dbt_backup" cascade
[0m23:42:34.647908 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:42:34.648454 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:42:34.648909 [info ] [Thread-1 (]: 8 of 8 SKIP relation public.mart_housing_prices_breakdown ...................... [[33mSKIP[0m]
[0m23:42:34.650599 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition_with_macro: Close
[0m23:42:34.651185 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:42:34.652143 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4b9b8f-f662-474e-8f8a-8fa33b144c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1d4e36d0>]}
[0m23:42:34.652938 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.region_type_composition_with_macro ..... [[32mCREATE VIEW[0m in 0.13s]
[0m23:42:34.653607 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:42:34.653994 [debug] [Thread-4 (]: SQL status: SELECT 10500 in 0.036 seconds
[0m23:42:34.672338 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:34.672891 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:42:34.673811 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:42:34.674270 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:34.674677 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp234234598022'
        
      order by ordinal_position

  
[0m23:42:34.680408 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:42:34.686322 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:34.686811 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:42:34.689911 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:42:34.698402 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:34.698962 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:42:34.701678 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:42:34.710316 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:42:34.710974 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:34.711364 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp234234598022"
    )


  
[0m23:42:34.718112 [debug] [Thread-4 (]: SQL status: INSERT 0 10500 in 0.006 seconds
[0m23:42:34.719738 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:42:34.720239 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:34.720600 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:42:34.730067 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m23:42:34.731007 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:42:34.731621 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4b9b8f-f662-474e-8f8a-8fa33b144c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1fdab750>]}
[0m23:42:34.732287 [info ] [Thread-4 (]: 7 of 8 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 10500[0m in 0.20s]
[0m23:42:34.732887 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:42:34.735023 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:34.735395 [debug] [MainThread]: On master: BEGIN
[0m23:42:34.735661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:42:34.742428 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:42:34.742833 [debug] [MainThread]: On master: COMMIT
[0m23:42:34.743159 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:34.743424 [debug] [MainThread]: On master: COMMIT
[0m23:42:34.743844 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:34.744136 [debug] [MainThread]: On master: Close
[0m23:42:34.744593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:34.744859 [debug] [MainThread]: Connection 'model.airflow_dbt_training.stg_housing_prices' was properly closed.
[0m23:42:34.745102 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition_with_macro' was properly closed.
[0m23:42:34.745354 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:42:34.745632 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:42:34.746048 [info ] [MainThread]: 
[0m23:42:34.746394 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m23:42:34.748604 [debug] [MainThread]: Command end result
[0m23:42:34.784668 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:42:34.786223 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:42:34.792216 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:42:34.792531 [info ] [MainThread]: 
[0m23:42:34.792896 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:42:34.793245 [info ] [MainThread]: 
[0m23:42:34.793752 [error] [MainThread]:   Database Error in model region_type_composition (models/airflow_dbt_training/gold/region_type_composition.sql)
  syntax error at or near "ROUND"
  LINE 22:   ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
             ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/region_type_composition.sql
[0m23:42:34.794205 [info ] [MainThread]: 
[0m23:42:34.794674 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m23:42:34.795722 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9112115, "process_in_blocks": "0", "process_kernel_time": 0.148637, "process_mem_max_rss": "129980", "process_out_blocks": "3464", "process_user_time": 3.151119}
[0m23:42:34.796207 [debug] [MainThread]: Command `dbt run` failed at 23:42:34.796078 after 1.91 seconds
[0m23:42:34.796581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b25c94290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b25c94b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1fd60d10>]}
[0m23:42:34.796993 [debug] [MainThread]: Flushing usage events
[0m23:42:35.478177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:42:37.407786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24de85b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24e0b7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24dfabbd0>]}


============================== 23:42:37.410433 | f2322330-19fb-44cd-bc82-a72356e57262 ==============================
[0m23:42:37.410433 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:42:37.411009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:42:37.562901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2322330-19fb-44cd-bc82-a72356e57262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2505826d0>]}
[0m23:42:37.619921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2322330-19fb-44cd-bc82-a72356e57262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2508d1810>]}
[0m23:42:37.620751 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:42:37.706054 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:42:37.831901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:42:37.832341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:42:37.883403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2322330-19fb-44cd-bc82-a72356e57262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24c720fd0>]}
[0m23:42:37.982461 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:42:37.985013 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:42:38.005559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2322330-19fb-44cd-bc82-a72356e57262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24bf57a50>]}
[0m23:42:38.006059 [info ] [MainThread]: Found 9 models, 36 data tests, 2 sources, 436 macros
[0m23:42:38.006402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2322330-19fb-44cd-bc82-a72356e57262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24cfd5010>]}
[0m23:42:38.010925 [info ] [MainThread]: 
[0m23:42:38.011639 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:42:38.012153 [info ] [MainThread]: 
[0m23:42:38.013565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:38.020169 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m23:42:38.060989 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:42:38.061373 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:42:38.061633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:38.068790 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:42:38.069187 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:42:38.069502 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:42:38.071976 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m23:42:38.073394 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:42:38.073866 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:42:38.080526 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:38.080867 [debug] [MainThread]: On master: BEGIN
[0m23:42:38.081121 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:38.087670 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:42:38.088036 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:38.088579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:42:38.092677 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m23:42:38.094879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2322330-19fb-44cd-bc82-a72356e57262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24e60a410>]}
[0m23:42:38.095320 [debug] [MainThread]: On master: ROLLBACK
[0m23:42:38.095788 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:38.096082 [debug] [MainThread]: On master: BEGIN
[0m23:42:38.096684 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:42:38.096965 [debug] [MainThread]: On master: COMMIT
[0m23:42:38.097245 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:38.097498 [debug] [MainThread]: On master: COMMIT
[0m23:42:38.097912 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:38.098212 [debug] [MainThread]: On master: Close
[0m23:42:38.102532 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:42:38.103019 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:42:38.103505 [info ] [Thread-1 (]: 1 of 36 START test accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [RUN]
[0m23:42:38.104042 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:42:38.104484 [info ] [Thread-2 (]: 2 of 36 START test accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [RUN]
[0m23:42:38.105005 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:42:38.105563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m23:42:38.106079 [info ] [Thread-3 (]: 3 of 36 START test not_null_mart_housing_prices_breakdown_avg_price ............ [RUN]
[0m23:42:38.106828 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e'
[0m23:42:38.107417 [info ] [Thread-4 (]: 4 of 36 START test not_null_mart_housing_prices_breakdown_n_sales .............. [RUN]
[0m23:42:38.108056 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:42:38.108780 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d'
[0m23:42:38.109345 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:42:38.110191 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7'
[0m23:42:38.121221 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:42:38.133417 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:42:38.141833 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:42:38.142338 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:42:38.151837 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:42:38.155839 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:42:38.156404 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:42:38.160638 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:42:38.161324 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:42:38.182378 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:42:38.185353 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:42:38.185773 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:42:38.186152 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:42:38.187239 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:42:38.189791 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:42:38.190263 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:42:38.192760 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:42:38.193278 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: BEGIN
[0m23:42:38.193898 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: BEGIN
[0m23:42:38.194598 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:42:38.195107 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:42:38.195553 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:42:38.195995 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:42:38.196440 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: BEGIN
[0m23:42:38.197093 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: BEGIN
[0m23:42:38.197803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:38.198250 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:42:38.203270 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:38.203854 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:42:38.204404 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:38.204912 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        month as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by month

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','7','8','9','10','11','12'
)



  
  
      
    ) dbt_internal_test
[0m23:42:38.205682 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:42:38.206386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:42:38.206800 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:42:38.207231 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_price
from "dwh"."public"."mart_housing_prices_breakdown"
where avg_price is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.207710 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:42:38.208155 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:42:38.208780 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        day_of_week as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by day_of_week

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m23:42:38.209375 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.mart_housing_prices_breakdown" does not exist
LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
              ^

[0m23:42:38.209817 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select n_sales
from "dwh"."public"."mart_housing_prices_breakdown"
where n_sales is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.210492 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: ROLLBACK
[0m23:42:38.211348 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: Close
[0m23:42:38.211755 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.mart_housing_prices_breakdown" does not exist
LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
              ^

[0m23:42:38.213337 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:42:38.214050 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: ROLLBACK
[0m23:42:38.218448 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: ROLLBACK
[0m23:42:38.219163 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:42:38.220106 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: Close
[0m23:42:38.221607 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: ROLLBACK
[0m23:42:38.222189 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: Close
[0m23:42:38.224990 [info ] [Thread-2 (]: 2 of 36 PASS accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [[32mPASS[0m in 0.12s]
[0m23:42:38.225918 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:42:38.227131 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: Close
[0m23:42:38.228766 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:42:38.231263 [info ] [Thread-1 (]: 1 of 36 PASS accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [[32mPASS[0m in 0.13s]
[0m23:42:38.233910 [debug] [Thread-3 (]: Database Error in test not_null_mart_housing_prices_breakdown_avg_price (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_avg_price.sql
[0m23:42:38.234629 [info ] [Thread-2 (]: 5 of 36 START test not_null_mart_housing_prices_breakdown_pct_urban ............ [RUN]
[0m23:42:38.236990 [debug] [Thread-4 (]: Database Error in test not_null_mart_housing_prices_breakdown_n_sales (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_n_sales.sql
[0m23:42:38.237757 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:42:38.238424 [error] [Thread-3 (]: 3 of 36 ERROR not_null_mart_housing_prices_breakdown_avg_price ................. [[31mERROR[0m in 0.13s]
[0m23:42:38.239067 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e)
[0m23:42:38.239694 [error] [Thread-4 (]: 4 of 36 ERROR not_null_mart_housing_prices_breakdown_n_sales ................... [[31mERROR[0m in 0.13s]
[0m23:42:38.240537 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:42:38.241719 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:42:38.242247 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:42:38.242935 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:42:38.243509 [info ] [Thread-1 (]: 6 of 36 START test not_null_mart_housing_prices_breakdown_region ............... [RUN]
[0m23:42:38.244139 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:42:38.244732 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mart_housing_prices_breakdown_avg_price (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_avg_price.sql.
[0m23:42:38.249817 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:42:38.250450 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:42:38.250990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m23:42:38.251571 [info ] [Thread-3 (]: 7 of 36 START test not_null_mart_housing_prices_breakdown_rural_count .......... [RUN]
[0m23:42:38.253283 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mart_housing_prices_breakdown_n_sales (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_n_sales.sql.
[0m23:42:38.254186 [info ] [Thread-4 (]: 8 of 36 START test not_null_mart_housing_prices_breakdown_urban_count .......... [RUN]
[0m23:42:38.254835 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:42:38.255538 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281)
[0m23:42:38.255999 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:42:38.256713 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de)
[0m23:42:38.263050 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:42:38.263565 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:42:38.311282 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:42:38.311746 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:42:38.316146 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:42:38.316722 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:42:38.320846 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:42:38.321423 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:42:38.324211 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:42:38.325000 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: BEGIN
[0m23:42:38.325449 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:42:38.325863 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:42:38.326476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:38.329105 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:42:38.329617 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:42:38.332092 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:42:38.332997 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: BEGIN
[0m23:42:38.333729 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:42:38.334202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:38.334737 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: BEGIN
[0m23:42:38.335167 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:42:38.335834 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:38.336292 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: BEGIN
[0m23:42:38.336972 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:38.338925 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m23:42:38.339411 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:42:38.339823 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."mart_housing_prices_breakdown"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.340645 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.mart_housing_prices_breakdown" does not exist
LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
              ^

[0m23:42:38.341255 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: ROLLBACK
[0m23:42:38.342008 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: Close
[0m23:42:38.342460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:38.342976 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:42:38.345114 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."mart_housing_prices_breakdown"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.347114 [debug] [Thread-2 (]: Database Error in test not_null_mart_housing_prices_breakdown_pct_urban (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_pct_urban.sql
[0m23:42:38.347565 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m23:42:38.347944 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m23:42:38.349262 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.mart_housing_prices_breakdown" does not exist
LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
              ^

[0m23:42:38.348758 [error] [Thread-2 (]: 5 of 36 ERROR not_null_mart_housing_prices_breakdown_pct_urban ................. [[31mERROR[0m in 0.11s]
[0m23:42:38.350204 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:42:38.350703 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:42:38.351203 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: ROLLBACK
[0m23:42:38.351916 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:42:38.352457 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."mart_housing_prices_breakdown"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.353016 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."mart_housing_prices_breakdown"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.353861 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:42:38.354544 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mart_housing_prices_breakdown_pct_urban (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_pct_urban.sql.
[0m23:42:38.355179 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: Close
[0m23:42:38.355972 [info ] [Thread-2 (]: 9 of 36 START test not_null_region_type_composition_pct_urban .................. [RUN]
[0m23:42:38.356623 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.mart_housing_prices_breakdown" does not exist
LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
              ^

[0m23:42:38.357192 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.mart_housing_prices_breakdown" does not exist
LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
              ^

[0m23:42:38.358095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m23:42:38.361021 [debug] [Thread-1 (]: Database Error in test not_null_mart_housing_prices_breakdown_region (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_region.sql
[0m23:42:38.361545 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: ROLLBACK
[0m23:42:38.362066 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: ROLLBACK
[0m23:42:38.362570 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:42:38.363256 [error] [Thread-1 (]: 6 of 36 ERROR not_null_mart_housing_prices_breakdown_region .................... [[31mERROR[0m in 0.11s]
[0m23:42:38.364254 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: Close
[0m23:42:38.368961 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:42:38.369652 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: Close
[0m23:42:38.370397 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:42:38.374240 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:42:38.374793 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:42:38.375593 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mart_housing_prices_breakdown_region (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_region.sql.
[0m23:42:38.378519 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:42:38.380492 [debug] [Thread-3 (]: Database Error in test not_null_mart_housing_prices_breakdown_rural_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_rural_count.sql
[0m23:42:38.382425 [debug] [Thread-4 (]: Database Error in test not_null_mart_housing_prices_breakdown_urban_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_urban_count.sql
[0m23:42:38.383014 [info ] [Thread-1 (]: 10 of 36 START test not_null_region_type_composition_region .................... [RUN]
[0m23:42:38.384229 [error] [Thread-3 (]: 7 of 36 ERROR not_null_mart_housing_prices_breakdown_rural_count ............... [[31mERROR[0m in 0.13s]
[0m23:42:38.385008 [error] [Thread-4 (]: 8 of 36 ERROR not_null_mart_housing_prices_breakdown_urban_count ............... [[31mERROR[0m in 0.13s]
[0m23:42:38.385835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m23:42:38.386521 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:42:38.387280 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:42:38.387997 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:42:38.388463 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:42:38.388956 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: BEGIN
[0m23:42:38.389477 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:42:38.390080 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mart_housing_prices_breakdown_rural_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_rural_count.sql.
[0m23:42:38.390658 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:42:38.395713 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:42:38.396307 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:38.396802 [info ] [Thread-3 (]: 11 of 36 START test not_null_region_type_composition_rural_count ............... [RUN]
[0m23:42:38.397557 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mart_housing_prices_breakdown_urban_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_urban_count.sql.
[0m23:42:38.398193 [info ] [Thread-4 (]: 12 of 36 START test not_null_region_type_composition_total_count ............... [RUN]
[0m23:42:38.399622 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m23:42:38.400326 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:42:38.401160 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de, now test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7)
[0m23:42:38.401634 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:42:38.404608 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:42:38.405249 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:42:38.409871 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:42:38.410664 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m23:42:38.417516 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:42:38.418396 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:42:38.418918 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:42:38.419613 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:42:38.420119 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: BEGIN
[0m23:42:38.420522 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:42:38.421011 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.424085 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:42:38.424632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:38.427268 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:42:38.428351 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.region_type_composition" does not exist
LINE 17: from "dwh"."public"."region_type_composition"
              ^

[0m23:42:38.429661 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: ROLLBACK
[0m23:42:38.430189 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:42:38.430673 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:42:38.431157 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: BEGIN
[0m23:42:38.431657 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: BEGIN
[0m23:42:38.432114 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: Close
[0m23:42:38.432539 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:38.432958 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:38.436539 [debug] [Thread-2 (]: Database Error in test not_null_region_type_composition_pct_urban (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_pct_urban.sql
[0m23:42:38.437096 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:42:38.437869 [error] [Thread-2 (]: 9 of 36 ERROR not_null_region_type_composition_pct_urban ....................... [[31mERROR[0m in 0.08s]
[0m23:42:38.438412 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:42:38.439048 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:42:38.439566 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.440143 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:42:38.440794 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_pct_urban (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_pct_urban.sql.
[0m23:42:38.442224 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.region_type_composition" does not exist
LINE 17: from "dwh"."public"."region_type_composition"
              ^

[0m23:42:38.441457 [info ] [Thread-2 (]: 13 of 36 START test not_null_region_type_composition_urban_count ............... [RUN]
[0m23:42:38.443407 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:42:38.444105 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: ROLLBACK
[0m23:42:38.444607 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:42:38.445159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m23:42:38.445669 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:42:38.446252 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:42:38.446830 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: Close
[0m23:42:38.447302 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:42:38.447848 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.448401 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_count
from "dwh"."public"."region_type_composition"
where total_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.453507 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:42:38.456228 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.region_type_composition" does not exist
LINE 17: from "dwh"."public"."region_type_composition"
              ^

[0m23:42:38.457973 [debug] [Thread-1 (]: Database Error in test not_null_region_type_composition_region (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_region.sql
[0m23:42:38.458511 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:42:38.459023 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.region_type_composition" does not exist
LINE 17: from "dwh"."public"."region_type_composition"
              ^

[0m23:42:38.459567 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: ROLLBACK
[0m23:42:38.460205 [error] [Thread-1 (]: 10 of 36 ERROR not_null_region_type_composition_region ......................... [[31mERROR[0m in 0.07s]
[0m23:42:38.463281 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:42:38.463767 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: ROLLBACK
[0m23:42:38.464452 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:42:38.464994 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: Close
[0m23:42:38.465915 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:42:38.466408 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:42:38.466844 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: Close
[0m23:42:38.467352 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_region (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_region.sql.
[0m23:42:38.467967 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: BEGIN
[0m23:42:38.471801 [debug] [Thread-3 (]: Database Error in test not_null_region_type_composition_rural_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_rural_count.sql
[0m23:42:38.469489 [info ] [Thread-1 (]: 14 of 36 START test not_null_region_type_composition_with_macro_pct_urban ...... [RUN]
[0m23:42:38.475401 [debug] [Thread-4 (]: Database Error in test not_null_region_type_composition_total_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_count.sql
[0m23:42:38.475901 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:38.476629 [error] [Thread-3 (]: 11 of 36 ERROR not_null_region_type_composition_rural_count .................... [[31mERROR[0m in 0.08s]
[0m23:42:38.477390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91)
[0m23:42:38.478158 [error] [Thread-4 (]: 12 of 36 ERROR not_null_region_type_composition_total_count .................... [[31mERROR[0m in 0.08s]
[0m23:42:38.479389 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:42:38.480011 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:42:38.480759 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:42:38.481290 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:42:38.481829 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_rural_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_rural_count.sql.
[0m23:42:38.486792 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:42:38.487507 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:42:38.488021 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m23:42:38.489312 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_total_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_count.sql.
[0m23:42:38.488491 [info ] [Thread-3 (]: 15 of 36 START test not_null_region_type_composition_with_macro_region ......... [RUN]
[0m23:42:38.490366 [info ] [Thread-4 (]: 16 of 36 START test not_null_region_type_composition_with_macro_rural_count .... [RUN]
[0m23:42:38.491039 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:42:38.491555 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:42:38.492404 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192)
[0m23:42:38.492901 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797)
[0m23:42:38.493448 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.496592 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:42:38.497170 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:42:38.497684 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:42:38.502546 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:42:38.503301 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.region_type_composition" does not exist
LINE 17: from "dwh"."public"."region_type_composition"
              ^

[0m23:42:38.503882 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:42:38.508284 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:42:38.509046 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: ROLLBACK
[0m23:42:38.509590 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: BEGIN
[0m23:42:38.510348 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:42:38.510944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:38.511306 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:42:38.511724 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: Close
[0m23:42:38.515546 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:42:38.518745 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:42:38.521390 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:42:38.521996 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: BEGIN
[0m23:42:38.522609 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:42:38.524336 [debug] [Thread-2 (]: Database Error in test not_null_region_type_composition_urban_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_urban_count.sql
[0m23:42:38.524872 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:38.525252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:42:38.525691 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: BEGIN
[0m23:42:38.526286 [error] [Thread-2 (]: 13 of 36 ERROR not_null_region_type_composition_urban_count .................... [[31mERROR[0m in 0.08s]
[0m23:42:38.527056 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:42:38.527517 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:38.528265 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:42:38.528776 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition_with_macro"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.529556 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:42:38.530123 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_urban_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_urban_count.sql.
[0m23:42:38.530786 [info ] [Thread-2 (]: 17 of 36 START test not_null_region_type_composition_with_macro_total_locations  [RUN]
[0m23:42:38.531754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae)
[0m23:42:38.532344 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:42:38.537011 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:42:38.538434 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:42:38.539083 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:42:38.539551 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m23:42:38.545341 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:42:38.546222 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:42:38.546755 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:42:38.547177 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:42:38.547656 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition_with_macro"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.549344 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: ROLLBACK
[0m23:42:38.549966 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition_with_macro"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.550716 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:42:38.551516 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: Close
[0m23:42:38.552061 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: BEGIN
[0m23:42:38.552583 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:38.553410 [info ] [Thread-1 (]: 14 of 36 PASS not_null_region_type_composition_with_macro_pct_urban ............ [[32mPASS[0m in 0.08s]
[0m23:42:38.554040 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:42:38.554516 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:42:38.555076 [info ] [Thread-1 (]: 18 of 36 START test not_null_region_type_composition_with_macro_urban_count .... [RUN]
[0m23:42:38.555681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224)
[0m23:42:38.556281 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:42:38.561081 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:42:38.561739 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:42:38.563787 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: ROLLBACK
[0m23:42:38.564517 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m23:42:38.565094 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: Close
[0m23:42:38.565661 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:42:38.566323 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:42:38.566893 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_locations
from "dwh"."public"."region_type_composition_with_macro"
where total_locations is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.567566 [info ] [Thread-3 (]: 15 of 36 PASS not_null_region_type_composition_with_macro_region ............... [[32mPASS[0m in 0.08s]
[0m23:42:38.568197 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:42:38.571567 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:42:38.572503 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:42:38.573042 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "total_locations" does not exist
LINE 16: select total_locations
                ^

[0m23:42:38.574671 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: ROLLBACK
[0m23:42:38.575523 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:42:38.576341 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:42:38.576883 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: ROLLBACK
[0m23:42:38.577618 [info ] [Thread-3 (]: 19 of 36 START test not_null_stg_housing_prices_date ........................... [RUN]
[0m23:42:38.578136 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: Close
[0m23:42:38.578635 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: BEGIN
[0m23:42:38.579277 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m23:42:38.579903 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: Close
[0m23:42:38.581155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:38.580756 [info ] [Thread-4 (]: 16 of 36 PASS not_null_region_type_composition_with_macro_rural_count .......... [[32mPASS[0m in 0.09s]
[0m23:42:38.581947 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:42:38.584485 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:42:38.586469 [debug] [Thread-2 (]: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:42:38.593574 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:42:38.594262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:42:38.594742 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:42:38.595460 [error] [Thread-2 (]: 17 of 36 ERROR not_null_region_type_composition_with_macro_total_locations ..... [[31mERROR[0m in 0.06s]
[0m23:42:38.596205 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:42:38.596826 [info ] [Thread-4 (]: 20 of 36 START test not_null_stg_housing_prices_day_of_week .................... [RUN]
[0m23:42:38.597679 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:42:38.598287 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:42:38.598899 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition_with_macro"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.599476 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m23:42:38.600030 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:42:38.600583 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql.
[0m23:42:38.603771 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:42:38.604619 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:42:38.605230 [info ] [Thread-2 (]: 21 of 36 START test not_null_stg_housing_prices_id ............................. [RUN]
[0m23:42:38.613077 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:42:38.613869 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m23:42:38.614368 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:42:38.615008 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:42:38.615547 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: BEGIN
[0m23:42:38.615987 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:42:38.621374 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:42:38.622066 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m23:42:38.622452 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:38.625664 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:42:38.627393 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: ROLLBACK
[0m23:42:38.628149 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:42:38.629289 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:42:38.629900 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: Close
[0m23:42:38.632704 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:42:38.633219 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: BEGIN
[0m23:42:38.634163 [info ] [Thread-1 (]: 18 of 36 PASS not_null_region_type_composition_with_macro_urban_count .......... [[32mPASS[0m in 0.08s]
[0m23:42:38.635422 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:42:38.635912 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:38.636344 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m23:42:38.637154 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:42:38.637599 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: BEGIN
[0m23:42:38.638273 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:42:38.638843 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:42:38.639420 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:38.639958 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select date
from __dbt__cte__stg_housing_prices
where date is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.640566 [info ] [Thread-1 (]: 22 of 36 START test not_null_stg_housing_prices_month .......................... [RUN]
[0m23:42:38.641869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m23:42:38.642415 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:42:38.648348 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:42:38.649091 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:42:38.649839 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m23:42:38.650619 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:42:38.652280 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: ROLLBACK
[0m23:42:38.652868 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:42:38.653347 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:42:38.653867 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:42:38.654522 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select day_of_week
from __dbt__cte__stg_housing_prices
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.655048 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: Close
[0m23:42:38.657933 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:42:38.658458 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select id
from __dbt__cte__stg_housing_prices
where id is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.659656 [info ] [Thread-3 (]: 19 of 36 PASS not_null_stg_housing_prices_date ................................. [[32mPASS[0m in 0.08s]
[0m23:42:38.661163 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:42:38.661848 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:42:38.662364 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:42:38.662876 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:42:38.663444 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: BEGIN
[0m23:42:38.663904 [info ] [Thread-3 (]: 23 of 36 START test not_null_stg_housing_prices_price .......................... [RUN]
[0m23:42:38.666030 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: ROLLBACK
[0m23:42:38.666690 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:42:38.667088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:38.667643 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m23:42:38.669425 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: ROLLBACK
[0m23:42:38.670324 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: Close
[0m23:42:38.670834 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:42:38.671667 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: Close
[0m23:42:38.672379 [info ] [Thread-2 (]: 21 of 36 PASS not_null_stg_housing_prices_id ................................... [[32mPASS[0m in 0.06s]
[0m23:42:38.681442 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:42:38.682272 [info ] [Thread-4 (]: 20 of 36 PASS not_null_stg_housing_prices_day_of_week .......................... [[32mPASS[0m in 0.08s]
[0m23:42:38.682825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m23:42:38.683850 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:42:38.684757 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:42:38.685409 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:42:38.685956 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:42:38.686411 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:42:38.687020 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:42:38.687626 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select month
from __dbt__cte__stg_housing_prices
where month is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.690862 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:42:38.691483 [info ] [Thread-2 (]: 24 of 36 START test not_null_stg_housing_prices_region ......................... [RUN]
[0m23:42:38.692121 [info ] [Thread-4 (]: 25 of 36 START test not_null_stg_housing_prices_year ........................... [RUN]
[0m23:42:38.693257 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m23:42:38.693975 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m23:42:38.694417 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:42:38.694878 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:42:38.695396 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:42:38.695970 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: BEGIN
[0m23:42:38.701787 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:42:38.702309 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:42:38.708075 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:42:38.708637 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:38.710306 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: ROLLBACK
[0m23:42:38.711221 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:42:38.711663 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:42:38.715351 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:42:38.715902 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: Close
[0m23:42:38.718624 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:42:38.719624 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:42:38.720168 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m23:42:38.720887 [info ] [Thread-1 (]: 22 of 36 PASS not_null_stg_housing_prices_month ................................ [[32mPASS[0m in 0.08s]
[0m23:42:38.721610 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: BEGIN
[0m23:42:38.722113 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:42:38.722567 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:42:38.723264 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:42:38.723715 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:38.724147 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: BEGIN
[0m23:42:38.724653 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select price
from __dbt__cte__stg_housing_prices
where price is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.725227 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:42:38.726207 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:38.726891 [info ] [Thread-1 (]: 26 of 36 START test not_null_stg_location_data_postcode ........................ [RUN]
[0m23:42:38.728110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m23:42:38.728694 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:42:38.729150 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:42:38.736406 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: ROLLBACK
[0m23:42:38.734276 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:42:38.737695 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m23:42:38.738367 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:42:38.738963 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: Close
[0m23:42:38.739422 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:42:38.739922 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:42:38.740440 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:42:38.741047 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select region
from __dbt__cte__stg_housing_prices
where region is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.741744 [info ] [Thread-3 (]: 23 of 36 PASS not_null_stg_housing_prices_price ................................ [[32mPASS[0m in 0.07s]
[0m23:42:38.745526 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:42:38.746179 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select year
from __dbt__cte__stg_housing_prices
where year is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.747187 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:42:38.748173 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:42:38.748744 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:42:38.749468 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: BEGIN
[0m23:42:38.749960 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:42:38.750549 [info ] [Thread-3 (]: 27 of 36 START test not_null_stg_location_data_region .......................... [RUN]
[0m23:42:38.751119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:38.752970 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: ROLLBACK
[0m23:42:38.753643 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m23:42:38.754102 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:42:38.754845 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:42:38.756608 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: ROLLBACK
[0m23:42:38.757108 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: Close
[0m23:42:38.761894 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:42:38.763246 [info ] [Thread-2 (]: 24 of 36 PASS not_null_stg_housing_prices_region ............................... [[32mPASS[0m in 0.07s]
[0m23:42:38.763813 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: Close
[0m23:42:38.764779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:42:38.765477 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:42:38.765963 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:42:38.766736 [info ] [Thread-4 (]: 25 of 36 PASS not_null_stg_housing_prices_year ................................. [[32mPASS[0m in 0.07s]
[0m23:42:38.767229 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:42:38.767848 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:42:38.771238 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:42:38.772155 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:42:38.772671 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."stg_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.773247 [info ] [Thread-2 (]: 28 of 36 START test not_null_stg_location_data_type ............................ [RUN]
[0m23:42:38.774058 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:42:38.775360 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:42:38.775988 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m23:42:38.776459 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:42:38.776898 [info ] [Thread-4 (]: 29 of 36 START test source_not_null_public_raw_housing_prices_date ............. [RUN]
[0m23:42:38.777575 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: BEGIN
[0m23:42:38.778113 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:42:38.779767 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: ROLLBACK
[0m23:42:38.780369 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m23:42:38.780898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:38.785545 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:42:38.786232 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:42:38.786749 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: Close
[0m23:42:38.791605 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:42:38.792641 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:42:38.793489 [info ] [Thread-1 (]: 26 of 36 PASS not_null_stg_location_data_postcode .............................. [[32mPASS[0m in 0.07s]
[0m23:42:38.794632 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m23:42:38.799964 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:42:38.800932 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:42:38.801577 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:42:38.802045 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:42:38.802760 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:42:38.803437 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."stg_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.803930 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:42:38.807018 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:42:38.807614 [info ] [Thread-1 (]: 30 of 36 START test source_not_null_public_raw_housing_prices_id ............... [RUN]
[0m23:42:38.808360 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: BEGIN
[0m23:42:38.809457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m23:42:38.810022 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:38.810648 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:42:38.811227 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:42:38.816739 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:42:38.817648 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:42:38.818229 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: BEGIN
[0m23:42:38.820495 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: ROLLBACK
[0m23:42:38.821310 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:42:38.821722 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:38.822176 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:42:38.822747 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:42:38.823304 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: Close
[0m23:42:38.826519 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:42:38.827117 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."stg_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.827872 [info ] [Thread-3 (]: 27 of 36 PASS not_null_stg_location_data_region ................................ [[32mPASS[0m in 0.07s]
[0m23:42:38.829037 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:42:38.830165 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:42:38.830915 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: BEGIN
[0m23:42:38.831591 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:42:38.831980 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m23:42:38.832705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:38.833232 [info ] [Thread-3 (]: 31 of 36 START test source_not_null_public_raw_housing_prices_price ............ [RUN]
[0m23:42:38.833815 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:42:38.834281 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:42:38.835125 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m23:42:38.835850 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "dwh"."public"."raw_housing_prices"
where date is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.837509 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: ROLLBACK
[0m23:42:38.838108 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:42:38.844063 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: Close
[0m23:42:38.843674 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:42:38.844797 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:42:38.845577 [info ] [Thread-2 (]: 28 of 36 PASS not_null_stg_location_data_type .................................. [[32mPASS[0m in 0.07s]
[0m23:42:38.846033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:42:38.847874 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: ROLLBACK
[0m23:42:38.848728 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:42:38.849469 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:42:38.849949 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:42:38.852994 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:42:38.853582 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: Close
[0m23:42:38.854107 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:42:38.854727 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dwh"."public"."raw_housing_prices"
where id is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.856336 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:42:38.855770 [info ] [Thread-4 (]: 29 of 36 PASS source_not_null_public_raw_housing_prices_date ................... [[32mPASS[0m in 0.08s]
[0m23:42:38.857141 [info ] [Thread-2 (]: 32 of 36 START test source_not_null_public_raw_housing_prices_region ........... [RUN]
[0m23:42:38.857882 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: BEGIN
[0m23:42:38.858604 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:42:38.859277 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m23:42:38.860000 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:42:38.860516 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:38.861091 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:42:38.861670 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:42:38.863270 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: ROLLBACK
[0m23:42:38.864004 [info ] [Thread-4 (]: 33 of 36 START test source_not_null_public_raw_location_data_postcode .......... [RUN]
[0m23:42:38.869254 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:42:38.869950 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m23:42:38.870438 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: Close
[0m23:42:38.871407 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:42:38.872056 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m23:42:38.872468 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:42:38.878106 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:42:38.873235 [info ] [Thread-1 (]: 30 of 36 PASS source_not_null_public_raw_housing_prices_id ..................... [[32mPASS[0m in 0.06s]
[0m23:42:38.878858 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:42:38.881832 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:42:38.882801 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:42:38.883435 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dwh"."public"."raw_housing_prices"
where price is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.884431 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:42:38.884933 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:42:38.885465 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:42:38.888426 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:42:38.889325 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:42:38.888919 [info ] [Thread-1 (]: 34 of 36 START test source_not_null_public_raw_location_data_region ............ [RUN]
[0m23:42:38.890037 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: BEGIN
[0m23:42:38.892002 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: ROLLBACK
[0m23:42:38.892684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m23:42:38.893309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:38.893855 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:42:38.894407 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:42:38.894871 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: Close
[0m23:42:38.895686 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: BEGIN
[0m23:42:38.900539 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:42:38.901193 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:38.901883 [info ] [Thread-3 (]: 31 of 36 PASS source_not_null_public_raw_housing_prices_price .................. [[32mPASS[0m in 0.07s]
[0m23:42:38.903264 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:42:38.904196 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:42:38.904666 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:42:38.905187 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:42:38.905748 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:42:38.911370 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:42:38.912200 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_housing_prices"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.912710 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:42:38.913189 [info ] [Thread-3 (]: 35 of 36 START test source_not_null_public_raw_location_data_type .............. [RUN]
[0m23:42:38.914442 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:42:38.915023 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:42:38.915622 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m23:42:38.916214 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."raw_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.916703 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:42:38.917172 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: BEGIN
[0m23:42:38.917650 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:42:38.919275 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: ROLLBACK
[0m23:42:38.919860 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:42:38.920388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:38.925553 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:42:38.927336 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: ROLLBACK
[0m23:42:38.927889 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: Close
[0m23:42:38.928904 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:42:38.929514 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: Close
[0m23:42:38.932495 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:42:38.933272 [info ] [Thread-2 (]: 32 of 36 PASS source_not_null_public_raw_housing_prices_region ................. [[32mPASS[0m in 0.07s]
[0m23:42:38.934471 [info ] [Thread-4 (]: 33 of 36 PASS source_not_null_public_raw_location_data_postcode ................ [[32mPASS[0m in 0.06s]
[0m23:42:38.935843 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:42:38.936526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m23:42:38.937048 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:42:38.937644 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:42:38.938242 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:42:38.939017 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:42:38.939497 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: BEGIN
[0m23:42:38.940199 [info ] [Thread-2 (]: 36 of 36 START test valid_values_stg_location_data_type__URBAN__RURAL .......... [RUN]
[0m23:42:38.940796 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.941405 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:38.941935 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91)
[0m23:42:38.942761 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:42:38.951755 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:42:38.952478 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:42:38.952893 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:42:38.953546 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:42:38.955075 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: ROLLBACK
[0m23:42:38.955472 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:42:38.955980 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."raw_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:42:38.959148 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:42:38.959701 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: Close
[0m23:42:38.960688 [info ] [Thread-1 (]: 34 of 36 PASS source_not_null_public_raw_location_data_region .................. [[32mPASS[0m in 0.07s]
[0m23:42:38.961445 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:42:38.962318 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:42:38.963155 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:42:38.964946 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: ROLLBACK
[0m23:42:38.965440 [debug] [Thread-2 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: BEGIN
[0m23:42:38.965971 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:38.966368 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: Close
[0m23:42:38.967323 [info ] [Thread-3 (]: 35 of 36 PASS source_not_null_public_raw_location_data_type .................... [[32mPASS[0m in 0.05s]
[0m23:42:38.968360 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:42:38.974508 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:38.975102 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:42:38.975597 [debug] [Thread-2 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    SELECT *
    FROM "dwh"."public"."stg_location_data"
    WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = ''

  
  
      
    ) dbt_internal_test
[0m23:42:38.989070 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:42:38.990649 [debug] [Thread-2 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: ROLLBACK
[0m23:42:38.991285 [debug] [Thread-2 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: Close
[0m23:42:38.991966 [info ] [Thread-2 (]: 36 of 36 PASS valid_values_stg_location_data_type__URBAN__RURAL ................ [[32mPASS[0m in 0.05s]
[0m23:42:38.992816 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:42:38.995115 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:38.995545 [debug] [MainThread]: On master: BEGIN
[0m23:42:38.995820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:42:39.003459 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:42:39.003915 [debug] [MainThread]: On master: COMMIT
[0m23:42:39.004206 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:39.004521 [debug] [MainThread]: On master: COMMIT
[0m23:42:39.005033 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:39.005411 [debug] [MainThread]: On master: Close
[0m23:42:39.005907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:39.006195 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e' was properly closed.
[0m23:42:39.006479 [debug] [MainThread]: Connection 'test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91' was properly closed.
[0m23:42:39.006742 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522' was properly closed.
[0m23:42:39.006999 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c' was properly closed.
[0m23:42:39.007401 [info ] [MainThread]: 
[0m23:42:39.007752 [info ] [MainThread]: Finished running 36 data tests in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m23:42:39.015393 [debug] [MainThread]: Command end result
[0m23:42:39.058401 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:42:39.060112 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:42:39.068447 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:42:39.068819 [info ] [MainThread]: 
[0m23:42:39.069185 [info ] [MainThread]: [31mCompleted with 12 errors, 0 partial successes, and 0 warnings:[0m
[0m23:42:39.069504 [info ] [MainThread]: 
[0m23:42:39.070087 [error] [MainThread]:   Database Error in test not_null_mart_housing_prices_breakdown_avg_price (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_avg_price.sql
[0m23:42:39.070605 [info ] [MainThread]: 
[0m23:42:39.071206 [error] [MainThread]:   Database Error in test not_null_mart_housing_prices_breakdown_n_sales (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_n_sales.sql
[0m23:42:39.071629 [info ] [MainThread]: 
[0m23:42:39.072160 [error] [MainThread]:   Database Error in test not_null_mart_housing_prices_breakdown_pct_urban (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_pct_urban.sql
[0m23:42:39.072599 [info ] [MainThread]: 
[0m23:42:39.073051 [error] [MainThread]:   Database Error in test not_null_mart_housing_prices_breakdown_region (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_region.sql
[0m23:42:39.073531 [info ] [MainThread]: 
[0m23:42:39.074157 [error] [MainThread]:   Database Error in test not_null_mart_housing_prices_breakdown_rural_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_rural_count.sql
[0m23:42:39.074639 [info ] [MainThread]: 
[0m23:42:39.075145 [error] [MainThread]:   Database Error in test not_null_mart_housing_prices_breakdown_urban_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.mart_housing_prices_breakdown" does not exist
  LINE 17: from "dwh"."public"."mart_housing_prices_breakdown"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_urban_count.sql
[0m23:42:39.075705 [info ] [MainThread]: 
[0m23:42:39.076149 [error] [MainThread]:   Database Error in test not_null_region_type_composition_pct_urban (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_pct_urban.sql
[0m23:42:39.076672 [info ] [MainThread]: 
[0m23:42:39.077245 [error] [MainThread]:   Database Error in test not_null_region_type_composition_region (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_region.sql
[0m23:42:39.077720 [info ] [MainThread]: 
[0m23:42:39.078209 [error] [MainThread]:   Database Error in test not_null_region_type_composition_rural_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_rural_count.sql
[0m23:42:39.078664 [info ] [MainThread]: 
[0m23:42:39.079403 [error] [MainThread]:   Database Error in test not_null_region_type_composition_total_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_total_count.sql
[0m23:42:39.079975 [info ] [MainThread]: 
[0m23:42:39.080640 [error] [MainThread]:   Database Error in test not_null_region_type_composition_urban_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition" does not exist
  LINE 17: from "dwh"."public"."region_type_composition"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_urban_count.sql
[0m23:42:39.081072 [info ] [MainThread]: 
[0m23:42:39.081686 [error] [MainThread]:   Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:42:39.082206 [info ] [MainThread]: 
[0m23:42:39.082789 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=12 SKIP=0 TOTAL=36
[0m23:42:39.084672 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.7268803, "process_in_blocks": "0", "process_kernel_time": 0.250512, "process_mem_max_rss": "125748", "process_out_blocks": "3224", "process_user_time": 2.865864}
[0m23:42:39.085295 [debug] [MainThread]: Command `dbt test` failed at 23:42:39.085182 after 1.73 seconds
[0m23:42:39.085789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24eeb6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb252224290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2487de490>]}
[0m23:42:39.086207 [debug] [MainThread]: Flushing usage events
[0m23:42:39.607596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:42:54.751492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aaece2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aaecd5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aaece2750>]}


============================== 23:42:54.754188 | b4b7996e-e7cd-4587-93cd-866ba6d4d761 ==============================
[0m23:42:54.754188 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:42:54.754952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:42:54.907143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aae5c93d0>]}
[0m23:42:54.963438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab1735ad0>]}
[0m23:42:54.964173 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:42:55.042740 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:42:55.168454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:42:55.169200 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/gold/region_type_composition.sql
[0m23:42:55.607719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aae1282d0>]}
[0m23:42:55.708737 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:42:55.711325 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:42:55.723983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aacd4f9d0>]}
[0m23:42:55.724499 [info ] [MainThread]: Found 9 models, 36 data tests, 2 sources, 436 macros
[0m23:42:55.724841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aadd92890>]}
[0m23:42:55.727553 [info ] [MainThread]: 
[0m23:42:55.728029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:42:55.728319 [info ] [MainThread]: 
[0m23:42:55.729057 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:55.734618 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:42:55.819386 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:42:55.819770 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:42:55.820070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:55.827585 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m23:42:55.829035 [debug] [ThreadPool]: On list_dwh: Close
[0m23:42:55.830899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:42:55.837093 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:42:55.837410 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:42:55.837672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:55.844125 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:42:55.844489 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:42:55.844844 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:42:55.847301 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m23:42:55.848677 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:42:55.849154 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:42:55.855764 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:55.856091 [debug] [MainThread]: On master: BEGIN
[0m23:42:55.856351 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:55.863101 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:42:55.863504 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:55.863982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:42:55.868310 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m23:42:55.870474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa67be790>]}
[0m23:42:55.870944 [debug] [MainThread]: On master: ROLLBACK
[0m23:42:55.871401 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:55.871692 [debug] [MainThread]: On master: BEGIN
[0m23:42:55.872302 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:42:55.872589 [debug] [MainThread]: On master: COMMIT
[0m23:42:55.872872 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:55.873142 [debug] [MainThread]: On master: COMMIT
[0m23:42:55.873568 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:55.873878 [debug] [MainThread]: On master: Close
[0m23:42:55.877551 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:42:55.878225 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:42:55.878757 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:42:55.879282 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m23:42:55.879952 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m23:42:55.880477 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:42:55.881652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:42:55.881085 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m23:42:55.882426 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:42:55.883727 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:42:55.883119 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m23:42:55.884922 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:42:55.885497 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:42:55.894592 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:42:55.895384 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:42:55.896011 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:42:55.898535 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:42:55.899247 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:42:55.899688 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:42:55.902057 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:42:55.907366 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:42:55.913283 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:42:55.944867 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:42:55.949272 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:42:55.953327 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:42:55.953799 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:42:55.957308 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:42:55.958213 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:42:55.961888 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:42:55.962324 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:42:55.962932 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:42:55.963620 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:42:55.964121 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:42:55.964568 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:42:55.964997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:55.965431 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:42:55.965841 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:42:55.966286 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:42:55.966919 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:42:55.967544 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:42:55.973282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:55.974113 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:42:55.974777 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:42:55.975897 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:55.976383 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:42:55.976859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:42:55.977252 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:42:55.977631 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:42:55.978094 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type,
    CASE
        WHEN LOWER("type") = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER("type") = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END as type_normalized
FROM source
  );
[0m23:42:55.978598 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:42:55.985516 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:42:55.985992 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:42:55.986560 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:42:55.987039 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:42:55.987523 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:42:55.988057 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:42:55.992010 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:42:55.992594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:42:55.993018 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m23:42:55.993517 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:42:55.993950 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:42:55.997161 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:42:56.000721 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:42:56.004020 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:42:56.004438 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m23:42:56.004908 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:42:56.005388 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:42:56.005846 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:42:56.008906 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:42:56.009690 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:42:56.010281 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:56.010662 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:56.011109 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:42:56.016761 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:42:56.029383 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:42:56.033902 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:42:56.037033 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:42:56.038453 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:42:56.038920 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:42:56.039376 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:42:56.039846 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:42:56.040301 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:42:56.040756 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:42:56.041405 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:42:56.041943 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:56.042388 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:56.043852 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:42:56.045110 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:42:56.045562 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:42:56.045999 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:42:56.046441 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:42:56.046894 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:42:56.048596 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:42:56.056123 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m23:42:56.056711 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m23:42:56.057100 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m23:42:56.057354 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:42:56.059965 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:42:56.062540 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:42:56.065193 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:42:56.070516 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:42:56.071232 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:42:56.071863 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:42:56.072483 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:42:56.072968 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:42:56.073472 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:42:56.073952 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:42:56.074429 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:42:56.082081 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m23:42:56.084712 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:42:56.085303 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.010 seconds
[0m23:42:56.087563 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.013 seconds
[0m23:42:56.087937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa6754750>]}
[0m23:42:56.088339 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.013 seconds
[0m23:42:56.089647 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:42:56.090935 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:42:56.091653 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.20s]
[0m23:42:56.093021 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:42:56.093835 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aac1f7150>]}
[0m23:42:56.094552 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa675e9d0>]}
[0m23:42:56.095346 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:42:56.096400 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa68a2d10>]}
[0m23:42:56.097591 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m23:42:56.099236 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.21s]
[0m23:42:56.100397 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:42:56.101147 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m23:42:56.102482 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:42:56.103497 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:42:56.104079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m23:42:56.104713 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:42:56.105927 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:42:56.106366 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:42:56.106974 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:42:56.108417 [info ] [Thread-4 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m23:42:56.109474 [info ] [Thread-3 (]: 6 of 8 START sql view model public.region_type_composition_with_macro .......... [RUN]
[0m23:42:56.113308 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:42:56.114132 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.region_type_composition)
[0m23:42:56.114776 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition_with_macro)
[0m23:42:56.115697 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:42:56.117309 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:42:56.117729 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:42:56.121692 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:42:56.127999 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:42:56.130696 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:56.131712 [info ] [Thread-2 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:42:56.133360 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:42:56.134281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.incremental_prices)
[0m23:42:56.134761 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:42:56.139544 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:42:56.140314 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:42:56.145141 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:56.160308 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:42:56.161140 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:42:56.162061 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:42:56.162890 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:42:56.163614 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:56.174636 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:56.190183 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: BEGIN
[0m23:42:56.212156 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:56.212737 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:56.213319 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp234256195283"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:42:56.213863 [debug] [Thread-4 (]: SQL status: BEGIN in 0.039 seconds
[0m23:42:56.214445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:56.214896 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:42:56.215586 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  total_locations as total_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:42:56.217685 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:42:56.221051 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:42:56.221723 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m23:42:56.222468 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m23:42:56.222796 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:56.223303 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:56.224653 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:42:56.225162 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */

  create view "dwh"."public"."region_type_composition_with_macro__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        ELSE 'UNKNOWN'
    END = 'URBAN') AS urban_count,
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'RURAL') AS rural_count
  ,
    COUNT(*) AS total_count

  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_count, 2) AS pct_urban
FROM type_counts
  );
[0m23:42:56.225699 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:42:56.226196 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:42:56.227822 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:42:56.230997 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:56.231403 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
alter table "dwh"."public"."region_type_composition_with_macro__dbt_tmp" rename to "region_type_composition_with_macro"
[0m23:42:56.232153 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:42:56.233373 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:42:56.233745 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m23:42:56.234142 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:56.236798 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m23:42:56.237264 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:42:56.237883 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:42:56.238415 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m23:42:56.239027 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:42:56.240284 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:42:56.240843 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa6625890>]}
[0m23:42:56.241257 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m23:42:56.241908 [info ] [Thread-4 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:42:56.245016 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition_with_macro__dbt_backup"
[0m23:42:56.245857 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:42:56.246593 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:42:56.247930 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:42:56.248470 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
drop view if exists "dwh"."public"."region_type_composition_with_macro__dbt_backup" cascade
[0m23:42:56.249173 [info ] [Thread-1 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m23:42:56.249910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m23:42:56.250510 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:42:56.251021 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:42:56.252686 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: Close
[0m23:42:56.258727 [debug] [Thread-2 (]: SQL status: SELECT 10500 in 0.044 seconds
[0m23:42:56.262635 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:42:56.268652 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aad5e1f90>]}
[0m23:42:56.279490 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:56.280529 [info ] [Thread-3 (]: 6 of 8 OK created sql view model public.region_type_composition_with_macro ..... [[32mCREATE VIEW[0m in 0.15s]
[0m23:42:56.281194 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:42:56.281687 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:42:56.282346 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:42:56.286724 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:42:56.287285 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m23:42:56.288134 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:56.288591 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp234256195283'
        
      order by ordinal_position

  
[0m23:42:56.289341 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:42:56.289910 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m23:42:56.290402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:56.295080 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.006 seconds
[0m23:42:56.302899 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:56.303525 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:42:56.303986 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:42:56.304501 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:42:56.304968 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m23:42:56.307042 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:42:56.307457 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:42:56.316143 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:56.319257 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:42:56.319745 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:42:56.320316 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m23:42:56.321447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:42:56.322681 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:42:56.323109 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:42:56.323512 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:42:56.323897 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:42:56.332524 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:42:56.333350 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:56.333759 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp234256195283"
    )


  
[0m23:42:56.340313 [debug] [Thread-2 (]: SQL status: INSERT 0 10500 in 0.006 seconds
[0m23:42:56.340740 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m23:42:56.342269 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:42:56.345161 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m23:42:56.345687 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:42:56.346352 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:42:56.346789 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:42:56.347257 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m23:42:56.348029 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:42:56.349351 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m23:42:56.349906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa66f6190>]}
[0m23:42:56.350513 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.10s]
[0m23:42:56.351125 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:42:56.353307 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m23:42:56.354226 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:42:56.354900 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b7996e-e7cd-4587-93cd-866ba6d4d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa6881c90>]}
[0m23:42:56.355618 [info ] [Thread-2 (]: 7 of 8 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 10500[0m in 0.22s]
[0m23:42:56.356371 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:42:56.358343 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:56.358891 [debug] [MainThread]: On master: BEGIN
[0m23:42:56.359193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:42:56.366205 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:42:56.366631 [debug] [MainThread]: On master: COMMIT
[0m23:42:56.366964 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:56.367228 [debug] [MainThread]: On master: COMMIT
[0m23:42:56.367672 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:56.367977 [debug] [MainThread]: On master: Close
[0m23:42:56.368596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:56.369021 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m23:42:56.369327 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:42:56.369595 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition_with_macro' was properly closed.
[0m23:42:56.369853 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:42:56.370294 [info ] [MainThread]: 
[0m23:42:56.370723 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m23:42:56.372601 [debug] [MainThread]: Command end result
[0m23:42:56.409692 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:42:56.411320 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:42:56.417472 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:42:56.417824 [info ] [MainThread]: 
[0m23:42:56.418203 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:42:56.418517 [info ] [MainThread]: 
[0m23:42:56.419040 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m23:42:56.420136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7192686, "process_in_blocks": "0", "process_kernel_time": 0.180085, "process_mem_max_rss": "131092", "process_out_blocks": "3512", "process_user_time": 2.831342}
[0m23:42:56.420629 [debug] [MainThread]: Command `dbt run` succeeded at 23:42:56.420530 after 1.72 seconds
[0m23:42:56.421078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aaed17e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aaef17810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab3074390>]}
[0m23:42:56.421465 [debug] [MainThread]: Flushing usage events
[0m23:42:57.118275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:42:58.719209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea7ad010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea7af710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea7ad1d0>]}


============================== 23:42:58.722057 | c546e827-d336-4993-b10b-89a3c8e9cd00 ==============================
[0m23:42:58.722057 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:42:58.722585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:42:58.872586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c546e827-d336-4993-b10b-89a3c8e9cd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea7a3e10>]}
[0m23:42:58.931647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c546e827-d336-4993-b10b-89a3c8e9cd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ed1f9150>]}
[0m23:42:58.932387 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:42:59.013328 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:42:59.143320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:42:59.143744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:42:59.195097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c546e827-d336-4993-b10b-89a3c8e9cd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e933c210>]}
[0m23:42:59.299315 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:42:59.301948 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:42:59.322657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c546e827-d336-4993-b10b-89a3c8e9cd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e8b6fc10>]}
[0m23:42:59.323175 [info ] [MainThread]: Found 9 models, 36 data tests, 2 sources, 436 macros
[0m23:42:59.323512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c546e827-d336-4993-b10b-89a3c8e9cd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea800a90>]}
[0m23:42:59.327929 [info ] [MainThread]: 
[0m23:42:59.328419 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:42:59.328744 [info ] [MainThread]: 
[0m23:42:59.329514 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:59.336002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m23:42:59.376398 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:42:59.376773 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:42:59.377054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:59.384168 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:42:59.384555 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:42:59.384927 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:42:59.387386 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:42:59.388771 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:42:59.389229 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:42:59.396532 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:59.396892 [debug] [MainThread]: On master: BEGIN
[0m23:42:59.397259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:59.404038 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:42:59.404448 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:59.404947 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:42:59.409603 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m23:42:59.412308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c546e827-d336-4993-b10b-89a3c8e9cd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e8ba1110>]}
[0m23:42:59.412743 [debug] [MainThread]: On master: ROLLBACK
[0m23:42:59.413208 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:59.413502 [debug] [MainThread]: On master: BEGIN
[0m23:42:59.414179 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:42:59.414488 [debug] [MainThread]: On master: COMMIT
[0m23:42:59.414763 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:59.415026 [debug] [MainThread]: On master: COMMIT
[0m23:42:59.415468 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:42:59.415768 [debug] [MainThread]: On master: Close
[0m23:42:59.419456 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:42:59.419956 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:42:59.420402 [info ] [Thread-1 (]: 1 of 36 START test accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [RUN]
[0m23:42:59.420946 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:42:59.421409 [info ] [Thread-2 (]: 2 of 36 START test accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [RUN]
[0m23:42:59.422087 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:42:59.422682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m23:42:59.423228 [info ] [Thread-3 (]: 3 of 36 START test not_null_mart_housing_prices_breakdown_avg_price ............ [RUN]
[0m23:42:59.423973 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e'
[0m23:42:59.424634 [info ] [Thread-4 (]: 4 of 36 START test not_null_mart_housing_prices_breakdown_n_sales .............. [RUN]
[0m23:42:59.425460 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:42:59.426345 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d'
[0m23:42:59.426927 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:42:59.427766 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7'
[0m23:42:59.438736 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:42:59.452285 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:42:59.460688 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:42:59.461224 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:42:59.470286 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:42:59.474822 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:42:59.475798 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:42:59.476972 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:42:59.500222 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:42:59.500862 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:42:59.504715 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:42:59.505476 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:42:59.508488 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:42:59.509382 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:42:59.510151 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:42:59.510752 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: BEGIN
[0m23:42:59.513680 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:42:59.514221 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:42:59.514695 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:42:59.515140 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:42:59.515706 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: BEGIN
[0m23:42:59.516485 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:42:59.516931 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: BEGIN
[0m23:42:59.517377 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:42:59.517820 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: BEGIN
[0m23:42:59.518268 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:42:59.518933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:59.522395 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:59.522798 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:42:59.523193 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select n_sales
from "dwh"."public"."mart_housing_prices_breakdown"
where n_sales is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.525109 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:59.525871 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:42:59.526404 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:59.526826 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_price
from "dwh"."public"."mart_housing_prices_breakdown"
where avg_price is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.527240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:59.527656 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:42:59.528169 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:42:59.528701 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        month as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by month

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','7','8','9','10','11','12'
)



  
  
      
    ) dbt_internal_test
[0m23:42:59.529293 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:42:59.529906 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        day_of_week as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by day_of_week

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m23:42:59.534438 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: ROLLBACK
[0m23:42:59.535024 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:42:59.536944 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: ROLLBACK
[0m23:42:59.537527 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: Close
[0m23:42:59.537947 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:42:59.540213 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: ROLLBACK
[0m23:42:59.540864 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: Close
[0m23:42:59.541736 [info ] [Thread-4 (]: 4 of 36 PASS not_null_mart_housing_prices_breakdown_n_sales .................... [[32mPASS[0m in 0.11s]
[0m23:42:59.542621 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: Close
[0m23:42:59.544459 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:42:59.545229 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:42:59.543598 [info ] [Thread-3 (]: 3 of 36 PASS not_null_mart_housing_prices_breakdown_avg_price .................. [[32mPASS[0m in 0.12s]
[0m23:42:59.547241 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:42:59.546519 [info ] [Thread-2 (]: 2 of 36 PASS accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [[32mPASS[0m in 0.12s]
[0m23:42:59.550081 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: ROLLBACK
[0m23:42:59.551155 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:42:59.551854 [info ] [Thread-4 (]: 5 of 36 START test not_null_mart_housing_prices_breakdown_pct_urban ............ [RUN]
[0m23:42:59.552829 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:42:59.553650 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:42:59.554333 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: Close
[0m23:42:59.555335 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e)
[0m23:42:59.556064 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:42:59.556738 [info ] [Thread-3 (]: 6 of 36 START test not_null_mart_housing_prices_breakdown_region ............... [RUN]
[0m23:42:59.557494 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:42:59.558542 [info ] [Thread-1 (]: 1 of 36 PASS accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [[32mPASS[0m in 0.14s]
[0m23:42:59.559315 [info ] [Thread-2 (]: 7 of 36 START test not_null_mart_housing_prices_breakdown_rural_count .......... [RUN]
[0m23:42:59.560057 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m23:42:59.565437 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:42:59.566287 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:42:59.566951 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281)
[0m23:42:59.567569 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:42:59.568304 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:42:59.569021 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:42:59.569487 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:42:59.575772 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:42:59.576266 [info ] [Thread-1 (]: 8 of 36 START test not_null_mart_housing_prices_breakdown_urban_count .......... [RUN]
[0m23:42:59.636114 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:42:59.642586 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:42:59.643476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de)
[0m23:42:59.644274 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:42:59.645339 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:42:59.646086 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:42:59.646595 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:42:59.650242 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:42:59.655507 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:42:59.656133 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: BEGIN
[0m23:42:59.659206 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:42:59.660525 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:59.660941 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:42:59.661467 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:42:59.662411 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:42:59.665500 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:42:59.666200 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: BEGIN
[0m23:42:59.666740 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: BEGIN
[0m23:42:59.667480 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:59.668107 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:59.668661 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:42:59.669811 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: BEGIN
[0m23:42:59.670398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:59.671419 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m23:42:59.672043 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"
[0m23:42:59.672599 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."mart_housing_prices_breakdown"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.676207 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:42:59.676925 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:42:59.677392 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:42:59.677925 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."mart_housing_prices_breakdown"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.678454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:59.678852 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"
[0m23:42:59.679424 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"
[0m23:42:59.679907 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."mart_housing_prices_breakdown"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.680399 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."mart_housing_prices_breakdown"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.681528 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:42:59.683153 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: ROLLBACK
[0m23:42:59.683724 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: Close
[0m23:42:59.684415 [info ] [Thread-3 (]: 6 of 36 PASS not_null_mart_housing_prices_breakdown_region ..................... [[32mPASS[0m in 0.12s]
[0m23:42:59.685115 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:42:59.685590 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:42:59.686319 [info ] [Thread-3 (]: 9 of 36 START test not_null_region_type_composition_pct_urban .................. [RUN]
[0m23:42:59.687063 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m23:42:59.687728 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:42:59.692786 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:42:59.693308 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.020 seconds
[0m23:42:59.695300 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: ROLLBACK
[0m23:42:59.696037 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:42:59.696551 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e: Close
[0m23:42:59.699511 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:42:59.700407 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m23:42:59.701095 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.020 seconds
[0m23:42:59.702084 [error] [Thread-4 (]: 5 of 36 FAIL 5 not_null_mart_housing_prices_breakdown_pct_urban ................ [[31mFAIL 5[0m in 0.15s]
[0m23:42:59.704557 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: ROLLBACK
[0m23:42:59.706730 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: ROLLBACK
[0m23:42:59.707758 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:42:59.708504 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e
[0m23:42:59.709396 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de: Close
[0m23:42:59.709862 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: BEGIN
[0m23:42:59.710257 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281: Close
[0m23:42:59.710793 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:42:59.712333 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:59.711662 [error] [Thread-1 (]: 8 of 36 FAIL 5 not_null_mart_housing_prices_breakdown_urban_count .............. [[31mFAIL 5[0m in 0.07s]
[0m23:42:59.713736 [error] [Thread-2 (]: 7 of 36 FAIL 5 not_null_mart_housing_prices_breakdown_rural_count .............. [[31mFAIL 5[0m in 0.15s]
[0m23:42:59.714352 [info ] [Thread-4 (]: 10 of 36 START test not_null_region_type_composition_region .................... [RUN]
[0m23:42:59.716283 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de
[0m23:42:59.717014 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281
[0m23:42:59.717574 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_pct_urban.3717800b7e, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m23:42:59.718405 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:42:59.719552 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:42:59.720186 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:42:59.720687 [info ] [Thread-1 (]: 11 of 36 START test not_null_region_type_composition_rural_count ............... [RUN]
[0m23:42:59.721298 [info ] [Thread-2 (]: 12 of 36 START test not_null_region_type_composition_total_count ............... [RUN]
[0m23:42:59.726823 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:42:59.727693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_urban_count.ff0f5088de, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m23:42:59.728183 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m23:42:59.728658 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_rural_count.787f487281, now test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7)
[0m23:42:59.729256 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:42:59.729783 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:42:59.730447 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:42:59.731281 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:42:59.736109 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:42:59.736893 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.741444 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:42:59.746220 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:42:59.746990 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:42:59.750680 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:42:59.751193 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:42:59.751743 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:42:59.754771 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:42:59.755508 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:42:59.755909 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: BEGIN
[0m23:42:59.756487 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: BEGIN
[0m23:42:59.757033 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:59.757536 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:42:59.757884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:59.758489 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: BEGIN
[0m23:42:59.758993 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:42:59.759625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:59.761176 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: ROLLBACK
[0m23:42:59.761989 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: Close
[0m23:42:59.762672 [info ] [Thread-3 (]: 9 of 36 PASS not_null_region_type_composition_pct_urban ........................ [[32mPASS[0m in 0.08s]
[0m23:42:59.763460 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:42:59.764203 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:42:59.765392 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:42:59.764920 [info ] [Thread-3 (]: 13 of 36 START test not_null_region_type_composition_urban_count ............... [RUN]
[0m23:42:59.766329 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:42:59.767009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:42:59.767598 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m23:42:59.768183 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.768906 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:42:59.769427 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:42:59.769887 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:42:59.770564 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.771078 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:42:59.776013 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:42:59.776606 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:42:59.777190 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_count
from "dwh"."public"."region_type_composition"
where total_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.778938 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: ROLLBACK
[0m23:42:59.779970 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:42:59.783271 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:42:59.783723 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: Close
[0m23:42:59.785291 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:42:59.784676 [info ] [Thread-4 (]: 10 of 36 PASS not_null_region_type_composition_region .......................... [[32mPASS[0m in 0.07s]
[0m23:42:59.786166 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: BEGIN
[0m23:42:59.787040 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:42:59.787494 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:59.787959 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:42:59.788424 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:42:59.789119 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:42:59.790692 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: ROLLBACK
[0m23:42:59.791359 [info ] [Thread-4 (]: 14 of 36 START test not_null_region_type_composition_with_macro_pct_urban ...... [RUN]
[0m23:42:59.793147 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: ROLLBACK
[0m23:42:59.794005 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91)
[0m23:42:59.794715 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: Close
[0m23:42:59.795599 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:42:59.796171 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:42:59.801929 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:42:59.796947 [info ] [Thread-2 (]: 12 of 36 PASS not_null_region_type_composition_total_count ..................... [[32mPASS[0m in 0.07s]
[0m23:42:59.802579 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: Close
[0m23:42:59.803125 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:42:59.804266 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:42:59.804889 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:42:59.805509 [info ] [Thread-1 (]: 11 of 36 PASS not_null_region_type_composition_rural_count ..................... [[32mPASS[0m in 0.08s]
[0m23:42:59.806209 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.807001 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:42:59.810199 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:42:59.810933 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:42:59.811655 [info ] [Thread-2 (]: 15 of 36 START test not_null_region_type_composition_with_macro_region ......... [RUN]
[0m23:42:59.812770 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:42:59.813624 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192)
[0m23:42:59.814261 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:42:59.814715 [info ] [Thread-1 (]: 16 of 36 START test not_null_region_type_composition_with_macro_rural_count .... [RUN]
[0m23:42:59.815332 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:42:59.816084 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: BEGIN
[0m23:42:59.816655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797)
[0m23:42:59.821398 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:42:59.822018 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:59.822549 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:42:59.827917 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:42:59.828576 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:42:59.829108 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:42:59.830888 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: ROLLBACK
[0m23:42:59.831379 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:42:59.834677 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:42:59.835311 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:42:59.835922 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:42:59.836418 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: Close
[0m23:42:59.839340 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:42:59.840030 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition_with_macro"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.840708 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:42:59.841461 [info ] [Thread-3 (]: 13 of 36 PASS not_null_region_type_composition_urban_count ..................... [[32mPASS[0m in 0.07s]
[0m23:42:59.842465 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: BEGIN
[0m23:42:59.843083 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:42:59.843714 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:42:59.844255 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:59.844777 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: BEGIN
[0m23:42:59.845381 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:42:59.846563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:59.847209 [info ] [Thread-3 (]: 17 of 36 START test not_null_region_type_composition_with_macro_total_locations  [RUN]
[0m23:42:59.848350 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae)
[0m23:42:59.849150 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:42:59.855375 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:42:59.856720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:42:59.857467 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:42:59.858124 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:42:59.858773 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m23:42:59.859307 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition_with_macro"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.864777 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:42:59.865547 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m23:42:59.866168 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:42:59.868245 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: ROLLBACK
[0m23:42:59.868896 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:42:59.869375 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition_with_macro"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.870207 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: BEGIN
[0m23:42:59.871008 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: Close
[0m23:42:59.871793 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:59.872647 [info ] [Thread-4 (]: 14 of 36 PASS not_null_region_type_composition_with_macro_pct_urban ............ [[32mPASS[0m in 0.08s]
[0m23:42:59.873800 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:42:59.874608 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:42:59.875339 [info ] [Thread-4 (]: 18 of 36 START test not_null_region_type_composition_with_macro_urban_count .... [RUN]
[0m23:42:59.876036 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224)
[0m23:42:59.876870 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:42:59.883049 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:42:59.885094 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: ROLLBACK
[0m23:42:59.885886 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m23:42:59.886769 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: Close
[0m23:42:59.882436 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:42:59.887326 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:42:59.887792 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m23:42:59.889215 [info ] [Thread-2 (]: 15 of 36 PASS not_null_region_type_composition_with_macro_region ............... [[32mPASS[0m in 0.08s]
[0m23:42:59.889886 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:42:59.890560 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_locations
from "dwh"."public"."region_type_composition_with_macro"
where total_locations is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.892417 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: ROLLBACK
[0m23:42:59.893124 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:42:59.896425 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:42:59.897389 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:42:59.898059 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "total_locations" does not exist
LINE 16: select total_locations
                ^

[0m23:42:59.898514 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: Close
[0m23:42:59.899314 [info ] [Thread-2 (]: 19 of 36 START test not_null_stg_housing_prices_date ........................... [RUN]
[0m23:42:59.900222 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: ROLLBACK
[0m23:42:59.900904 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:42:59.901701 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m23:42:59.902686 [info ] [Thread-1 (]: 16 of 36 PASS not_null_region_type_composition_with_macro_rural_count .......... [[32mPASS[0m in 0.09s]
[0m23:42:59.903396 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: BEGIN
[0m23:42:59.904053 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: Close
[0m23:42:59.904541 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:42:59.905200 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:42:59.905637 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:42:59.912216 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:42:59.914396 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:42:59.916699 [info ] [Thread-1 (]: 20 of 36 START test not_null_stg_housing_prices_day_of_week .................... [RUN]
[0m23:42:59.917838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m23:42:59.919012 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:42:59.919571 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:42:59.923140 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:42:59.930052 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:42:59.930581 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m23:42:59.933390 [debug] [Thread-3 (]: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:42:59.934219 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:42:59.934701 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:42:59.935332 [error] [Thread-3 (]: 17 of 36 ERROR not_null_region_type_composition_with_macro_total_locations ..... [[31mERROR[0m in 0.09s]
[0m23:42:59.935954 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition_with_macro"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.936428 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:42:59.936966 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: BEGIN
[0m23:42:59.937739 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:42:59.940783 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:42:59.941238 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:42:59.941756 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:42:59.942341 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql.
[0m23:42:59.943379 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:42:59.943841 [info ] [Thread-3 (]: 21 of 36 START test not_null_stg_housing_prices_id ............................. [RUN]
[0m23:42:59.945423 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: BEGIN
[0m23:42:59.946145 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m23:42:59.946663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:59.947159 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:42:59.953373 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:42:59.954501 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:42:59.955272 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m23:42:59.957152 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: ROLLBACK
[0m23:42:59.957783 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:42:59.958305 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:42:59.958694 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:42:59.959266 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:42:59.959698 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: Close
[0m23:42:59.962727 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:42:59.963395 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select date
from __dbt__cte__stg_housing_prices
where date is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.964026 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select day_of_week
from __dbt__cte__stg_housing_prices
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.964996 [info ] [Thread-4 (]: 18 of 36 PASS not_null_region_type_composition_with_macro_urban_count .......... [[32mPASS[0m in 0.09s]
[0m23:42:59.965911 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:42:59.967098 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:42:59.967675 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: BEGIN
[0m23:42:59.968205 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:42:59.968701 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:42:59.969288 [info ] [Thread-4 (]: 22 of 36 START test not_null_stg_housing_prices_month .......................... [RUN]
[0m23:42:59.970345 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m23:42:59.970913 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:42:59.977149 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:42:59.977914 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:42:59.978442 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:42:59.981453 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: ROLLBACK
[0m23:42:59.982187 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m23:42:59.982642 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:42:59.984261 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: ROLLBACK
[0m23:42:59.984945 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:42:59.985433 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: Close
[0m23:42:59.990224 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:42:59.990907 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select id
from __dbt__cte__stg_housing_prices
where id is null



  
  
      
    ) dbt_internal_test
[0m23:42:59.991512 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: Close
[0m23:42:59.992513 [info ] [Thread-1 (]: 20 of 36 PASS not_null_stg_housing_prices_day_of_week .......................... [[32mPASS[0m in 0.07s]
[0m23:42:59.993601 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:42:59.994634 [info ] [Thread-2 (]: 19 of 36 PASS not_null_stg_housing_prices_date ................................. [[32mPASS[0m in 0.09s]
[0m23:42:59.995329 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:42:59.996003 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:42:59.996480 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: BEGIN
[0m23:42:59.997145 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:42:59.998860 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: ROLLBACK
[0m23:42:59.999472 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:43:00.000091 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:43:00.000608 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:43:00.001472 [info ] [Thread-1 (]: 23 of 36 START test not_null_stg_housing_prices_price .......................... [RUN]
[0m23:43:00.001998 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: Close
[0m23:43:00.002675 [info ] [Thread-2 (]: 24 of 36 START test not_null_stg_housing_prices_region ......................... [RUN]
[0m23:43:00.003452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m23:43:00.005149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m23:43:00.004639 [info ] [Thread-3 (]: 21 of 36 PASS not_null_stg_housing_prices_id ................................... [[32mPASS[0m in 0.06s]
[0m23:43:00.005847 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:43:00.006323 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:43:00.006966 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:43:00.014379 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:43:00.015038 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m23:43:00.021046 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:43:00.021841 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:43:00.022752 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:43:00.023584 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:43:00.024217 [info ] [Thread-3 (]: 25 of 36 START test not_null_stg_housing_prices_year ........................... [RUN]
[0m23:43:00.024988 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select month
from __dbt__cte__stg_housing_prices
where month is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.025606 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:43:00.028712 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:43:00.029372 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m23:43:00.032648 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:43:00.033371 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:43:00.034344 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:43:00.035036 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:43:00.041099 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:43:00.041798 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:43:00.042429 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: BEGIN
[0m23:43:00.042908 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: BEGIN
[0m23:43:00.044603 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: ROLLBACK
[0m23:43:00.045113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:00.045693 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:43:00.046108 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:00.046970 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: Close
[0m23:43:00.049910 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:43:00.050864 [info ] [Thread-4 (]: 22 of 36 PASS not_null_stg_housing_prices_month ................................ [[32mPASS[0m in 0.08s]
[0m23:43:00.051929 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:43:00.052784 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:43:00.053691 [info ] [Thread-4 (]: 26 of 36 START test not_null_stg_location_data_postcode ........................ [RUN]
[0m23:43:00.054546 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:43:00.055289 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m23:43:00.056050 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: BEGIN
[0m23:43:00.056679 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:43:00.057341 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:43:00.058034 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:43:00.058700 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m23:43:00.059275 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:43:00.063782 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:43:00.064846 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:43:00.065631 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select price
from __dbt__cte__stg_housing_prices
where price is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.066524 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select region
from __dbt__cte__stg_housing_prices
where region is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.067186 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:43:00.070158 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:43:00.071025 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:43:00.071866 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:43:00.072768 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:43:00.073159 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m23:43:00.074637 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: ROLLBACK
[0m23:43:00.075941 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: ROLLBACK
[0m23:43:00.076453 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: BEGIN
[0m23:43:00.076945 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:43:00.077615 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: Close
[0m23:43:00.078011 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:43:00.078360 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: Close
[0m23:43:00.078872 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select year
from __dbt__cte__stg_housing_prices
where year is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.079691 [info ] [Thread-1 (]: 23 of 36 PASS not_null_stg_housing_prices_price ................................ [[32mPASS[0m in 0.08s]
[0m23:43:00.081619 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:43:00.080827 [info ] [Thread-2 (]: 24 of 36 PASS not_null_stg_housing_prices_region ............................... [[32mPASS[0m in 0.08s]
[0m23:43:00.082643 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:43:00.083509 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:43:00.084038 [info ] [Thread-1 (]: 27 of 36 START test not_null_stg_location_data_region .......................... [RUN]
[0m23:43:00.084853 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:43:00.085645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m23:43:00.086580 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:43:00.086176 [info ] [Thread-2 (]: 28 of 36 START test not_null_stg_location_data_type ............................ [RUN]
[0m23:43:00.091962 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:43:00.092660 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:43:00.093280 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m23:43:00.093775 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m23:43:00.095768 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: ROLLBACK
[0m23:43:00.096428 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:43:00.096976 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:43:00.097391 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:43:00.102391 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:43:00.103022 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: Close
[0m23:43:00.103465 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."stg_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.106267 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:43:00.107211 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:43:00.107987 [info ] [Thread-3 (]: 25 of 36 PASS not_null_stg_housing_prices_year ................................. [[32mPASS[0m in 0.08s]
[0m23:43:00.113045 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:43:00.113711 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:43:00.114298 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:43:00.114978 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:43:00.116738 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: ROLLBACK
[0m23:43:00.117290 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: BEGIN
[0m23:43:00.117880 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:43:00.118328 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:43:00.119216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:00.119667 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: Close
[0m23:43:00.120117 [info ] [Thread-3 (]: 29 of 36 START test source_not_null_public_raw_housing_prices_date ............. [RUN]
[0m23:43:00.120700 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: BEGIN
[0m23:43:00.121691 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m23:43:00.122415 [info ] [Thread-4 (]: 26 of 36 PASS not_null_stg_location_data_postcode .............................. [[32mPASS[0m in 0.07s]
[0m23:43:00.123040 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:00.123543 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:43:00.124224 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:43:00.130330 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:43:00.131375 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:43:00.132165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:43:00.132764 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:43:00.133458 [info ] [Thread-4 (]: 30 of 36 START test source_not_null_public_raw_housing_prices_id ............... [RUN]
[0m23:43:00.134183 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:43:00.134742 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:43:00.135157 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:43:00.135646 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m23:43:00.136180 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."stg_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.139356 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:43:00.139988 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."stg_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.140569 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:43:00.146152 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:43:00.147086 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:43:00.147849 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:43:00.149831 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: ROLLBACK
[0m23:43:00.151662 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: ROLLBACK
[0m23:43:00.152090 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:43:00.152659 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:43:00.153240 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: Close
[0m23:43:00.156178 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:43:00.156651 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: Close
[0m23:43:00.157134 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: BEGIN
[0m23:43:00.158004 [info ] [Thread-2 (]: 28 of 36 PASS not_null_stg_location_data_type .................................. [[32mPASS[0m in 0.06s]
[0m23:43:00.159013 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:43:00.160303 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:43:00.159890 [info ] [Thread-1 (]: 27 of 36 PASS not_null_stg_location_data_region ................................ [[32mPASS[0m in 0.07s]
[0m23:43:00.161173 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:43:00.161727 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: BEGIN
[0m23:43:00.162736 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:43:00.163361 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:43:00.164046 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:43:00.164747 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:43:00.165530 [info ] [Thread-2 (]: 31 of 36 START test source_not_null_public_raw_housing_prices_price ............ [RUN]
[0m23:43:00.166409 [info ] [Thread-1 (]: 32 of 36 START test source_not_null_public_raw_housing_prices_region ........... [RUN]
[0m23:43:00.167292 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m23:43:00.168142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m23:43:00.168702 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:43:00.169214 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:43:00.175279 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m23:43:00.174704 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:43:00.176067 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:43:00.181316 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:43:00.182014 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:43:00.182804 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:43:00.183546 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:43:00.184259 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "dwh"."public"."raw_housing_prices"
where date is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.184952 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dwh"."public"."raw_housing_prices"
where id is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.185491 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:43:00.188793 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:43:00.192321 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:43:00.193169 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:43:00.193617 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:43:00.194575 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:43:00.195070 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:43:00.196554 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: ROLLBACK
[0m23:43:00.197956 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: ROLLBACK
[0m23:43:00.198499 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: BEGIN
[0m23:43:00.198962 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: BEGIN
[0m23:43:00.199590 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:00.200128 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: Close
[0m23:43:00.200514 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: Close
[0m23:43:00.200899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:00.201828 [info ] [Thread-3 (]: 29 of 36 PASS source_not_null_public_raw_housing_prices_date ................... [[32mPASS[0m in 0.08s]
[0m23:43:00.202790 [info ] [Thread-4 (]: 30 of 36 PASS source_not_null_public_raw_housing_prices_id ..................... [[32mPASS[0m in 0.07s]
[0m23:43:00.204245 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:43:00.205247 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:43:00.205861 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:43:00.206576 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:43:00.207250 [info ] [Thread-3 (]: 33 of 36 START test source_not_null_public_raw_location_data_postcode .......... [RUN]
[0m23:43:00.207829 [info ] [Thread-4 (]: 34 of 36 START test source_not_null_public_raw_location_data_region ............ [RUN]
[0m23:43:00.208739 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m23:43:00.209461 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:43:00.210218 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m23:43:00.211350 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:43:00.212311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:43:00.213101 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:43:00.213929 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:43:00.219989 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:43:00.220620 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:43:00.221151 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dwh"."public"."raw_housing_prices"
where price is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.225996 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:43:00.226870 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_housing_prices"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.227650 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:43:00.228806 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:43:00.233709 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:43:00.234416 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:43:00.237328 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:43:00.237780 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:43:00.239392 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: ROLLBACK
[0m23:43:00.240112 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:43:00.241760 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: ROLLBACK
[0m23:43:00.242704 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:43:00.243171 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: Close
[0m23:43:00.243576 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: BEGIN
[0m23:43:00.244179 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: BEGIN
[0m23:43:00.244646 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: Close
[0m23:43:00.245339 [info ] [Thread-1 (]: 32 of 36 PASS source_not_null_public_raw_housing_prices_region ................. [[32mPASS[0m in 0.08s]
[0m23:43:00.245889 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:43:00.246442 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:43:00.248021 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:43:00.247286 [info ] [Thread-2 (]: 31 of 36 PASS source_not_null_public_raw_housing_prices_price .................. [[32mPASS[0m in 0.08s]
[0m23:43:00.249461 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:43:00.250487 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:43:00.251395 [info ] [Thread-1 (]: 35 of 36 START test source_not_null_public_raw_location_data_type .............. [RUN]
[0m23:43:00.252246 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:43:00.253208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m23:43:00.253983 [info ] [Thread-2 (]: 36 of 36 START test valid_values_stg_location_data_type__URBAN__RURAL .......... [RUN]
[0m23:43:00.254724 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:43:00.255602 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91)
[0m23:43:00.261782 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m23:43:00.263181 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:43:00.263834 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:43:00.264378 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m23:43:00.265017 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:43:00.274149 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:43:00.274717 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:43:00.275209 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:43:00.275673 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."raw_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.276473 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.279771 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:43:00.280312 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:43:00.283720 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:43:00.284358 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:43:00.284903 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:43:00.286884 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: ROLLBACK
[0m23:43:00.287567 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:43:00.289183 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: ROLLBACK
[0m23:43:00.289892 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:43:00.290348 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: Close
[0m23:43:00.290793 [debug] [Thread-2 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: BEGIN
[0m23:43:00.291341 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: BEGIN
[0m23:43:00.291791 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: Close
[0m23:43:00.292435 [info ] [Thread-3 (]: 33 of 36 PASS source_not_null_public_raw_location_data_postcode ................ [[32mPASS[0m in 0.08s]
[0m23:43:00.292966 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:00.293425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:00.294988 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:43:00.294306 [info ] [Thread-4 (]: 34 of 36 PASS source_not_null_public_raw_location_data_region .................. [[32mPASS[0m in 0.08s]
[0m23:43:00.296754 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:43:00.302474 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:43:00.303147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:43:00.303641 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:43:00.304168 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:43:00.304703 [debug] [Thread-2 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    SELECT *
    FROM "dwh"."public"."stg_location_data"
    WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = ''

  
  
      
    ) dbt_internal_test
[0m23:43:00.305318 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."raw_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:43:00.307242 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:43:00.308879 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: ROLLBACK
[0m23:43:00.309484 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: Close
[0m23:43:00.310116 [info ] [Thread-1 (]: 35 of 36 PASS source_not_null_public_raw_location_data_type .................... [[32mPASS[0m in 0.06s]
[0m23:43:00.310809 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:43:00.318685 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:43:00.320467 [debug] [Thread-2 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: ROLLBACK
[0m23:43:00.321170 [debug] [Thread-2 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: Close
[0m23:43:00.321875 [info ] [Thread-2 (]: 36 of 36 PASS valid_values_stg_location_data_type__URBAN__RURAL ................ [[32mPASS[0m in 0.07s]
[0m23:43:00.322489 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:43:00.324370 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:00.324732 [debug] [MainThread]: On master: BEGIN
[0m23:43:00.325063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:00.331931 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:43:00.332374 [debug] [MainThread]: On master: COMMIT
[0m23:43:00.332668 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:00.332965 [debug] [MainThread]: On master: COMMIT
[0m23:43:00.333426 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:43:00.333728 [debug] [MainThread]: On master: Close
[0m23:43:00.334236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:00.334517 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522' was properly closed.
[0m23:43:00.334772 [debug] [MainThread]: Connection 'test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91' was properly closed.
[0m23:43:00.335020 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c' was properly closed.
[0m23:43:00.335267 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e' was properly closed.
[0m23:43:00.335632 [info ] [MainThread]: 
[0m23:43:00.335950 [info ] [MainThread]: Finished running 36 data tests in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m23:43:00.342646 [debug] [MainThread]: Command end result
[0m23:43:00.380988 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:43:00.382627 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:43:00.390806 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:43:00.391165 [info ] [MainThread]: 
[0m23:43:00.391529 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m23:43:00.391858 [info ] [MainThread]: 
[0m23:43:00.392369 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_pct_urban (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:43:00.392870 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:43:00.393217 [info ] [MainThread]: 
[0m23:43:00.393778 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_pct_urban.sql
[0m23:43:00.394206 [info ] [MainThread]: 
[0m23:43:00.394653 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_urban_count (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:43:00.395155 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:43:00.395569 [info ] [MainThread]: 
[0m23:43:00.396613 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_urban_count.sql
[0m23:43:00.397165 [info ] [MainThread]: 
[0m23:43:00.398041 [error] [MainThread]: [31mFailure in test not_null_mart_housing_prices_breakdown_rural_count (models/airflow_dbt_training/gold/schema.yml)[0m
[0m23:43:00.398733 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m23:43:00.399094 [info ] [MainThread]: 
[0m23:43:00.399691 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_mart_housing_prices_breakdown_rural_count.sql
[0m23:43:00.400055 [info ] [MainThread]: 
[0m23:43:00.400663 [error] [MainThread]:   Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:43:00.401269 [info ] [MainThread]: 
[0m23:43:00.401724 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=4 SKIP=0 TOTAL=36
[0m23:43:00.402867 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.7352761, "process_in_blocks": "0", "process_kernel_time": 0.280386, "process_mem_max_rss": "122428", "process_out_blocks": "3184", "process_user_time": 2.914022}
[0m23:43:00.403392 [debug] [MainThread]: Command `dbt test` failed at 23:43:00.403295 after 1.74 seconds
[0m23:43:00.403830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea7aec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ea9e74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96eeb38d10>]}
[0m23:43:00.404368 [debug] [MainThread]: Flushing usage events
[0m23:43:00.893504 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:43:34.207525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0ab2a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0ab77e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0ae5c890>]}


============================== 23:43:34.210124 | a453c716-6787-49cf-b440-5686139a8f17 ==============================
[0m23:43:34.210124 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:43:34.210735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:43:34.368605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0ab35390>]}
[0m23:43:34.427212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0d53f690>]}
[0m23:43:34.427933 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:43:34.512183 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:43:34.649326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:43:34.650280 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/gold/schema.yml
[0m23:43:35.091880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c09bbf5d0>]}
[0m23:43:35.193393 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:43:35.196000 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:43:35.209499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c08fef8d0>]}
[0m23:43:35.210269 [info ] [MainThread]: Found 9 models, 33 data tests, 2 sources, 436 macros
[0m23:43:35.210801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c08b5af50>]}
[0m23:43:35.214973 [info ] [MainThread]: 
[0m23:43:35.215675 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:35.216232 [info ] [MainThread]: 
[0m23:43:35.217088 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:35.223077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:43:35.321859 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:43:35.322257 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:43:35.322554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:35.331887 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m23:43:35.333188 [debug] [ThreadPool]: On list_dwh: Close
[0m23:43:35.335219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:43:35.342105 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:43:35.342538 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:43:35.342824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:35.349482 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:43:35.349954 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:43:35.350302 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:43:35.353228 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:43:35.355150 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:43:35.355725 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:43:35.362800 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:35.363187 [debug] [MainThread]: On master: BEGIN
[0m23:43:35.363451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:35.370438 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:43:35.370841 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:35.371324 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:43:35.376880 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m23:43:35.379890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c08b87410>]}
[0m23:43:35.380361 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:35.380842 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:35.381127 [debug] [MainThread]: On master: BEGIN
[0m23:43:35.381892 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:43:35.382182 [debug] [MainThread]: On master: COMMIT
[0m23:43:35.382486 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:35.382781 [debug] [MainThread]: On master: COMMIT
[0m23:43:35.383212 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:43:35.383502 [debug] [MainThread]: On master: Close
[0m23:43:35.386836 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:43:35.387436 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m23:43:35.387958 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:43:35.388435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:43:35.388964 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:43:35.389582 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:43:35.390197 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m23:43:35.390900 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:43:35.391601 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m23:43:35.392490 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m23:43:35.393720 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:43:35.404005 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:43:35.404737 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:43:35.405337 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:43:35.405811 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:43:35.406477 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:43:35.406989 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:43:35.407381 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:43:35.410126 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:43:35.412630 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:43:35.433317 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:43:35.460851 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:43:35.462056 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:43:35.462518 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:43:35.466578 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:43:35.467144 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:43:35.470994 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:43:35.475196 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:43:35.475840 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:43:35.476374 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:43:35.477329 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:43:35.477874 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:43:35.478413 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:43:35.478817 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:43:35.479302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:35.479750 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:43:35.480170 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:43:35.480559 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:43:35.481228 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:43:35.482004 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:43:35.488102 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:43:35.488596 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:43:35.489074 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:43:35.489539 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:43:35.490137 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:43:35.490670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:43:35.491132 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type,
    CASE
        WHEN LOWER("type") = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER("type") = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END as type_normalized
FROM source
  );
[0m23:43:35.491745 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:43:35.492225 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:43:35.492627 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:43:35.498605 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:43:35.501395 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:43:35.501949 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:43:35.502411 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:43:35.506290 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:43:35.506800 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:43:35.507447 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:43:35.508128 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m23:43:35.508541 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:43:35.513142 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:43:35.513749 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:43:35.514274 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:43:35.514787 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:43:35.515180 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:43:35.518775 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:43:35.522457 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:43:35.526420 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:43:35.526950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:43:35.527384 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:43:35.528112 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:43:35.528549 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:43:35.531935 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:43:35.532734 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:43:35.533289 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:43:35.533708 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:43:35.534102 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:43:35.539990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:43:35.545174 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:43:35.574016 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:43:35.577418 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:43:35.571287 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:43:35.578219 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:43:35.578723 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:43:35.579300 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:43:35.579855 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:43:35.580517 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:43:35.580961 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:43:35.581343 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:43:35.581734 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:43:35.583226 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:43:35.583864 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:43:35.584352 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:43:35.584928 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m23:43:35.592411 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m23:43:35.592882 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m23:43:35.591960 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:43:35.595752 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:43:35.596190 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m23:43:35.598818 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:43:35.604711 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:43:35.605420 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:43:35.608202 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:43:35.608896 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:43:35.609382 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:43:35.609854 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:43:35.610487 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:43:35.610928 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:43:35.611597 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:43:35.615016 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:43:35.617540 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:43:35.618091 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:43:35.618500 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:43:35.620136 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:43:35.622318 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.011 seconds
[0m23:43:35.623728 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:43:35.624166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0251fad0>]}
[0m23:43:35.624843 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c02572250>]}
[0m23:43:35.626171 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:43:35.627161 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.23s]
[0m23:43:35.627766 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c025e11d0>]}
[0m23:43:35.628530 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.23s]
[0m23:43:35.629328 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c09f4c2d0>]}
[0m23:43:35.630019 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:43:35.630761 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.22s]
[0m23:43:35.631502 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:43:35.632337 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m23:43:35.633927 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:43:35.634351 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:43:35.635363 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:43:35.636211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m23:43:35.637241 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:43:35.637654 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:43:35.641241 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:43:35.641799 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:43:35.642580 [info ] [Thread-2 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m23:43:35.643778 [info ] [Thread-3 (]: 6 of 8 START sql view model public.region_type_composition_with_macro .......... [RUN]
[0m23:43:35.645905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition)
[0m23:43:35.646930 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:43:35.647549 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition_with_macro)
[0m23:43:35.648092 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:43:35.648907 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:43:35.649572 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:43:35.653486 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:43:35.659646 [info ] [Thread-4 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:43:35.660704 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m23:43:35.663545 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:43:35.664427 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:43:35.664847 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:43:35.679641 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:43:35.682113 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:43:35.682837 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:43:35.683516 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:43:35.684017 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:43:35.689172 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:43:35.689681 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:43:35.716380 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:43:35.727438 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:35.737934 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:43:35.738381 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: BEGIN
[0m23:43:35.739106 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp234335720933"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:43:35.739607 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:43:35.740038 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:43:35.745145 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m23:43:35.745601 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:43:35.746018 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  total_locations as total_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:43:35.746862 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:43:35.747260 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:43:35.747705 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */

  create view "dwh"."public"."region_type_composition_with_macro__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        ELSE 'UNKNOWN'
    END = 'URBAN') AS urban_count,
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'RURAL') AS rural_count
  ,
    COUNT(*) AS total_count

  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_count, 2) AS pct_urban
FROM type_counts
  );
[0m23:43:35.748256 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:43:35.751668 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:43:35.752053 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:43:35.752471 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m23:43:35.755621 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:43:35.756199 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
alter table "dwh"."public"."region_type_composition_with_macro__dbt_tmp" rename to "region_type_composition_with_macro"
[0m23:43:35.756612 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:43:35.757861 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:43:35.758241 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:43:35.758655 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:43:35.759911 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:43:35.760350 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:43:35.760865 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:43:35.761358 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:43:35.763890 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:43:35.766659 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m23:43:35.767077 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m23:43:35.767682 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:43:35.770226 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition_with_macro__dbt_backup"
[0m23:43:35.770706 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m23:43:35.771359 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:43:35.772194 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
drop view if exists "dwh"."public"."region_type_composition_with_macro__dbt_backup" cascade
[0m23:43:35.772646 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:43:35.774104 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:43:35.774500 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:43:35.775124 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c025798d0>]}
[0m23:43:35.776400 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: Close
[0m23:43:35.777203 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:43:35.778053 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c025ba490>]}
[0m23:43:35.778655 [debug] [Thread-4 (]: SQL status: SELECT 10500 in 0.039 seconds
[0m23:43:35.779629 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:43:35.780432 [info ] [Thread-3 (]: 6 of 8 OK created sql view model public.region_type_composition_with_macro ..... [[32mCREATE VIEW[0m in 0.13s]
[0m23:43:35.797737 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:43:35.799053 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:43:35.799581 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:43:35.800082 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:43:35.800962 [info ] [Thread-1 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m23:43:35.801675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m23:43:35.802233 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:43:35.802656 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:43:35.803155 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:43:35.812264 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:43:35.812903 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp234335720933'
        
      order by ordinal_position

  
[0m23:43:35.813708 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:43:35.817891 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:43:35.818549 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:43:35.818946 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:43:35.819363 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m23:43:35.826764 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:43:35.827309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:35.827846 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:43:35.831217 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:43:35.840983 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:43:35.841550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:43:35.841994 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:43:35.842501 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:43:35.843164 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m23:43:35.845650 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:43:35.846332 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:43:35.856845 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:43:35.862265 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:43:35.863539 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m23:43:35.864607 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:43:35.865407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:43:35.866120 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp234335720933"
    )


  
[0m23:43:35.868780 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:43:35.869899 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:43:35.870494 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:43:35.879437 [debug] [Thread-4 (]: SQL status: INSERT 0 10500 in 0.010 seconds
[0m23:43:35.880094 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m23:43:35.882134 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:43:35.886455 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m23:43:35.887283 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:43:35.888323 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:43:35.888975 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:43:35.889635 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m23:43:35.890666 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:43:35.892570 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m23:43:35.893234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c024ce990>]}
[0m23:43:35.894299 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.09s]
[0m23:43:35.895251 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:43:35.899475 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m23:43:35.901158 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:43:35.902293 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a453c716-6787-49cf-b440-5686139a8f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c09bd3cd0>]}
[0m23:43:35.903510 [info ] [Thread-4 (]: 7 of 8 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 10500[0m in 0.24s]
[0m23:43:35.904548 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:43:35.907935 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:35.908625 [debug] [MainThread]: On master: BEGIN
[0m23:43:35.909076 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:35.919621 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m23:43:35.920169 [debug] [MainThread]: On master: COMMIT
[0m23:43:35.920659 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:35.920959 [debug] [MainThread]: On master: COMMIT
[0m23:43:35.921463 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:43:35.921761 [debug] [MainThread]: On master: Close
[0m23:43:35.922211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:35.922491 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m23:43:35.922744 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:43:35.922995 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition_with_macro' was properly closed.
[0m23:43:35.923295 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:43:35.923832 [info ] [MainThread]: 
[0m23:43:35.924443 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m23:43:35.926829 [debug] [MainThread]: Command end result
[0m23:43:35.969363 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:43:35.971116 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:43:35.978847 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:43:35.979305 [info ] [MainThread]: 
[0m23:43:35.979837 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:43:35.980339 [info ] [MainThread]: 
[0m23:43:35.980842 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m23:43:35.982124 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8248454, "process_in_blocks": "0", "process_kernel_time": 0.249902, "process_mem_max_rss": "130292", "process_out_blocks": "3448", "process_user_time": 2.888874}
[0m23:43:35.982806 [debug] [MainThread]: Command `dbt run` succeeded at 23:43:35.982667 after 1.83 seconds
[0m23:43:35.983319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0ab77a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0ee7ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0ee7cd10>]}
[0m23:43:35.983856 [debug] [MainThread]: Flushing usage events
[0m23:43:36.736049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:43:38.446101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ab33d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ab56f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ab38b210>]}


============================== 23:43:38.448847 | 03559c2b-0879-421d-9edf-5f0ac4ed0d59 ==============================
[0m23:43:38.448847 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:43:38.449405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:43:38.605294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03559c2b-0879-421d-9edf-5f0ac4ed0d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5aa71e750>]}
[0m23:43:38.662724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03559c2b-0879-421d-9edf-5f0ac4ed0d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5add89750>]}
[0m23:43:38.663464 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:43:38.744211 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:43:38.880482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:38.880866 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:38.931818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03559c2b-0879-421d-9edf-5f0ac4ed0d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a9ff7150>]}
[0m23:43:39.046849 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:43:39.050041 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:43:39.074417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03559c2b-0879-421d-9edf-5f0ac4ed0d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a934fe10>]}
[0m23:43:39.074982 [info ] [MainThread]: Found 9 models, 33 data tests, 2 sources, 436 macros
[0m23:43:39.075330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03559c2b-0879-421d-9edf-5f0ac4ed0d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a9fafbd0>]}
[0m23:43:39.079827 [info ] [MainThread]: 
[0m23:43:39.080423 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:39.081017 [info ] [MainThread]: 
[0m23:43:39.082076 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:39.088808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m23:43:39.134205 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:43:39.134709 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:43:39.135125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:39.142749 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m23:43:39.143217 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:43:39.143582 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:43:39.146444 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:43:39.148450 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:43:39.149368 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:43:39.159547 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:39.159986 [debug] [MainThread]: On master: BEGIN
[0m23:43:39.160264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:39.170339 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m23:43:39.170866 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:39.171985 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:43:39.180337 [debug] [MainThread]: SQL status: SELECT 7 in 0.008 seconds
[0m23:43:39.184602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03559c2b-0879-421d-9edf-5f0ac4ed0d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a9341610>]}
[0m23:43:39.185281 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:39.185958 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:39.186319 [debug] [MainThread]: On master: BEGIN
[0m23:43:39.186957 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:43:39.187292 [debug] [MainThread]: On master: COMMIT
[0m23:43:39.187621 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:39.187958 [debug] [MainThread]: On master: COMMIT
[0m23:43:39.188473 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:43:39.188900 [debug] [MainThread]: On master: Close
[0m23:43:39.193971 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:43:39.195225 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:43:39.196419 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:43:39.195909 [info ] [Thread-1 (]: 1 of 33 START test accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [RUN]
[0m23:43:39.197160 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:43:39.197864 [info ] [Thread-2 (]: 2 of 33 START test accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [RUN]
[0m23:43:39.199365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m23:43:39.198607 [info ] [Thread-3 (]: 3 of 33 START test not_null_mart_housing_prices_breakdown_avg_price ............ [RUN]
[0m23:43:39.200255 [info ] [Thread-4 (]: 4 of 33 START test not_null_mart_housing_prices_breakdown_n_sales .............. [RUN]
[0m23:43:39.201235 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e'
[0m23:43:39.201996 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:43:39.203108 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d'
[0m23:43:39.203982 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7'
[0m23:43:39.205129 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:43:39.211188 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:43:39.232062 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:43:39.237277 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:43:39.246647 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:43:39.256817 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:43:39.261872 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:43:39.263012 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:43:39.267379 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:43:39.267882 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:43:39.273456 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:43:39.289477 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:43:39.292583 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:43:39.293215 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:43:39.295828 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:43:39.297029 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:43:39.300071 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:43:39.300603 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:43:39.301294 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: BEGIN
[0m23:43:39.301996 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:43:39.302492 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: BEGIN
[0m23:43:39.302909 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:43:39.303386 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:43:39.303908 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: BEGIN
[0m23:43:39.304397 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:43:39.304901 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: BEGIN
[0m23:43:39.305536 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:43:39.306162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:39.312618 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:43:39.313480 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:43:39.313973 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:43:39.314502 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_price
from "dwh"."public"."mart_housing_prices_breakdown"
where avg_price is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.314941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:43:39.315603 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:43:39.316168 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m23:43:39.316690 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:43:39.317254 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        month as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by month

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','7','8','9','10','11','12'
)



  
  
      
    ) dbt_internal_test
[0m23:43:39.317894 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:43:39.318578 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        day_of_week as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by day_of_week

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m23:43:39.319322 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select n_sales
from "dwh"."public"."mart_housing_prices_breakdown"
where n_sales is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.322900 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:43:39.327013 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: ROLLBACK
[0m23:43:39.327690 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:43:39.328355 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:43:39.328952 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:43:39.329574 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: Close
[0m23:43:39.331178 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: ROLLBACK
[0m23:43:39.332641 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: ROLLBACK
[0m23:43:39.334023 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: ROLLBACK
[0m23:43:39.334774 [info ] [Thread-3 (]: 3 of 33 PASS not_null_mart_housing_prices_breakdown_avg_price .................. [[32mPASS[0m in 0.13s]
[0m23:43:39.335409 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: Close
[0m23:43:39.336002 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: Close
[0m23:43:39.336417 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: Close
[0m23:43:39.337044 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:43:39.337857 [info ] [Thread-2 (]: 2 of 33 PASS accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [[32mPASS[0m in 0.14s]
[0m23:43:39.338658 [info ] [Thread-1 (]: 1 of 33 PASS accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [[32mPASS[0m in 0.14s]
[0m23:43:39.340536 [info ] [Thread-4 (]: 4 of 33 PASS not_null_mart_housing_prices_breakdown_n_sales .................... [[32mPASS[0m in 0.14s]
[0m23:43:39.341711 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:43:39.342908 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:43:39.344032 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:43:39.345166 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:43:39.346209 [info ] [Thread-3 (]: 5 of 33 START test not_null_mart_housing_prices_breakdown_region ............... [RUN]
[0m23:43:39.347332 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:43:39.348180 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:43:39.348847 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:43:39.349697 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m23:43:39.350281 [info ] [Thread-2 (]: 6 of 33 START test not_null_region_type_composition_pct_urban .................. [RUN]
[0m23:43:39.350867 [info ] [Thread-1 (]: 7 of 33 START test not_null_region_type_composition_region ..................... [RUN]
[0m23:43:39.351531 [info ] [Thread-4 (]: 8 of 33 START test not_null_region_type_composition_rural_count ................ [RUN]
[0m23:43:39.352382 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:43:39.353362 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m23:43:39.353950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m23:43:39.354514 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m23:43:39.360382 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:43:39.360949 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:43:39.361447 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:43:39.361889 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:43:39.367305 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:43:39.373538 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:43:39.423511 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:43:39.423957 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:43:39.424816 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:43:39.427800 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:43:39.428197 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:43:39.428603 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:43:39.431097 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:43:39.433852 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:43:39.436486 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:43:39.436977 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:43:39.438231 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:43:39.438766 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:43:39.439126 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: BEGIN
[0m23:43:39.439626 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: BEGIN
[0m23:43:39.440091 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:43:39.440490 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: BEGIN
[0m23:43:39.440879 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:43:39.441310 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:39.441740 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: BEGIN
[0m23:43:39.442226 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:43:39.443289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:39.449547 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:43:39.450636 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m23:43:39.451221 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:43:39.451736 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:43:39.452306 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:43:39.452892 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.453381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:43:39.453809 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:43:39.454323 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."mart_housing_prices_breakdown"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.455053 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:43:39.455657 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.456543 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.460250 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:43:39.462064 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: ROLLBACK
[0m23:43:39.462673 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: Close
[0m23:43:39.463100 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:43:39.463891 [info ] [Thread-3 (]: 5 of 33 PASS not_null_mart_housing_prices_breakdown_region ..................... [[32mPASS[0m in 0.11s]
[0m23:43:39.466602 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: ROLLBACK
[0m23:43:39.467424 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:43:39.468144 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:43:39.468569 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: Close
[0m23:43:39.469341 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:43:39.469877 [info ] [Thread-3 (]: 9 of 33 START test not_null_region_type_composition_total_count ................ [RUN]
[0m23:43:39.472859 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: ROLLBACK
[0m23:43:39.473468 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:43:39.471109 [info ] [Thread-1 (]: 7 of 33 PASS not_null_region_type_composition_region ........................... [[32mPASS[0m in 0.12s]
[0m23:43:39.474656 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c, now test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7)
[0m23:43:39.476444 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: ROLLBACK
[0m23:43:39.476876 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: Close
[0m23:43:39.477660 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:43:39.478122 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:43:39.479621 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:43:39.480345 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: Close
[0m23:43:39.478992 [info ] [Thread-2 (]: 6 of 33 PASS not_null_region_type_composition_pct_urban ........................ [[32mPASS[0m in 0.13s]
[0m23:43:39.485813 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:43:39.486610 [info ] [Thread-1 (]: 10 of 33 START test not_null_region_type_composition_urban_count ............... [RUN]
[0m23:43:39.487564 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:43:39.488252 [info ] [Thread-4 (]: 8 of 33 PASS not_null_region_type_composition_rural_count ...................... [[32mPASS[0m in 0.13s]
[0m23:43:39.489608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m23:43:39.490198 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:43:39.490743 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:43:39.491464 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:43:39.492101 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:43:39.495303 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:43:39.496446 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:43:39.495931 [info ] [Thread-2 (]: 11 of 33 START test not_null_region_type_composition_with_macro_pct_urban ...... [RUN]
[0m23:43:39.501836 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:43:39.502615 [info ] [Thread-4 (]: 12 of 33 START test not_null_region_type_composition_with_macro_region ......... [RUN]
[0m23:43:39.503316 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91)
[0m23:43:39.504084 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:43:39.504898 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192)
[0m23:43:39.505633 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:43:39.506200 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: BEGIN
[0m23:43:39.506606 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:43:39.507022 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:43:39.511933 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:43:39.512666 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:43:39.515876 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:43:39.520650 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:43:39.522674 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:43:39.523626 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:43:39.528803 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:43:39.529306 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:43:39.529921 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: BEGIN
[0m23:43:39.530389 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m23:43:39.533303 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:43:39.533855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:39.534586 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:43:39.535248 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:43:39.536231 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: BEGIN
[0m23:43:39.536866 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:43:39.537404 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_count
from "dwh"."public"."region_type_composition"
where total_count is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.537946 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:39.538482 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: BEGIN
[0m23:43:39.539485 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:43:39.543712 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:43:39.544245 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:43:39.544750 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.545965 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:43:39.546919 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:43:39.547473 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:43:39.548145 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition_with_macro"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.548765 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:43:39.549317 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:43:39.550002 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition_with_macro"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.551661 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: ROLLBACK
[0m23:43:39.552425 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: Close
[0m23:43:39.553152 [info ] [Thread-3 (]: 9 of 33 PASS not_null_region_type_composition_total_count ...................... [[32mPASS[0m in 0.08s]
[0m23:43:39.554076 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:43:39.554833 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:43:39.555447 [info ] [Thread-3 (]: 13 of 33 START test not_null_region_type_composition_with_macro_rural_count .... [RUN]
[0m23:43:39.556084 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797)
[0m23:43:39.556630 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:43:39.562962 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:43:39.563775 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:43:39.566418 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: ROLLBACK
[0m23:43:39.568825 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: ROLLBACK
[0m23:43:39.572578 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:43:39.573471 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: Close
[0m23:43:39.574856 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.025 seconds
[0m23:43:39.578735 [info ] [Thread-1 (]: 10 of 33 PASS not_null_region_type_composition_urban_count ..................... [[32mPASS[0m in 0.09s]
[0m23:43:39.586909 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: Close
[0m23:43:39.588812 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: ROLLBACK
[0m23:43:39.589773 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:43:39.590214 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:43:39.591036 [info ] [Thread-4 (]: 12 of 33 PASS not_null_region_type_composition_with_macro_region ............... [[32mPASS[0m in 0.09s]
[0m23:43:39.591511 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: Close
[0m23:43:39.592098 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:43:39.596755 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:43:39.597723 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:43:39.598418 [info ] [Thread-1 (]: 14 of 33 START test not_null_region_type_composition_with_macro_total_locations  [RUN]
[0m23:43:39.599304 [info ] [Thread-2 (]: 11 of 33 PASS not_null_region_type_composition_with_macro_pct_urban ............ [[32mPASS[0m in 0.10s]
[0m23:43:39.600725 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:43:39.602008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae)
[0m23:43:39.602626 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:43:39.603324 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:43:39.603843 [info ] [Thread-4 (]: 15 of 33 START test not_null_region_type_composition_with_macro_urban_count .... [RUN]
[0m23:43:39.604490 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:43:39.605241 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: BEGIN
[0m23:43:39.605920 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:43:39.606642 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224)
[0m23:43:39.611685 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:43:39.612251 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:43:39.612790 [info ] [Thread-2 (]: 16 of 33 START test not_null_stg_housing_prices_date ........................... [RUN]
[0m23:43:39.613425 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:43:39.614728 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m23:43:39.615251 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:43:39.619846 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:43:39.620467 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:43:39.623862 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:43:39.624497 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m23:43:39.630391 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:43:39.631475 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:43:39.631925 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:43:39.632459 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:43:39.635564 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:43:39.636249 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition_with_macro"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.636759 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:43:39.637304 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: BEGIN
[0m23:43:39.640640 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:43:39.641140 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:43:39.641600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:39.642195 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: BEGIN
[0m23:43:39.642962 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:43:39.643457 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:43:39.644185 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: BEGIN
[0m23:43:39.644878 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:39.649289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:43:39.649807 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:43:39.650350 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_locations
from "dwh"."public"."region_type_composition_with_macro"
where total_locations is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.650952 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:43:39.651418 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:43:39.651888 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "total_locations" does not exist
LINE 16: select total_locations
                ^

[0m23:43:39.652270 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:43:39.652669 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:43:39.653100 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: ROLLBACK
[0m23:43:39.653563 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:43:39.653984 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition_with_macro"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.654512 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select date
from __dbt__cte__stg_housing_prices
where date is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.656130 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: ROLLBACK
[0m23:43:39.656623 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: Close
[0m23:43:39.657389 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: Close
[0m23:43:39.659323 [info ] [Thread-3 (]: 13 of 33 PASS not_null_region_type_composition_with_macro_rural_count .......... [[32mPASS[0m in 0.10s]
[0m23:43:39.660226 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:43:39.660902 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:43:39.661527 [info ] [Thread-3 (]: 17 of 33 START test not_null_stg_housing_prices_day_of_week .................... [RUN]
[0m23:43:39.662535 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m23:43:39.663112 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:43:39.663533 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:43:39.665470 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: ROLLBACK
[0m23:43:39.672096 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:43:39.672816 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:43:39.673918 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: Close
[0m23:43:39.676038 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: ROLLBACK
[0m23:43:39.677219 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:43:39.677846 [info ] [Thread-2 (]: 16 of 33 PASS not_null_stg_housing_prices_date ................................. [[32mPASS[0m in 0.06s]
[0m23:43:39.680322 [debug] [Thread-1 (]: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:43:39.680989 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: Close
[0m23:43:39.684067 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:43:39.684760 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:43:39.685313 [error] [Thread-1 (]: 14 of 33 ERROR not_null_region_type_composition_with_macro_total_locations ..... [[31mERROR[0m in 0.08s]
[0m23:43:39.686668 [info ] [Thread-4 (]: 15 of 33 PASS not_null_region_type_composition_with_macro_urban_count .......... [[32mPASS[0m in 0.08s]
[0m23:43:39.687549 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:43:39.688406 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:43:39.689124 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:43:39.689746 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:43:39.690174 [info ] [Thread-2 (]: 18 of 33 START test not_null_stg_housing_prices_id ............................. [RUN]
[0m23:43:39.690694 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: BEGIN
[0m23:43:39.691163 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:43:39.691809 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql.
[0m23:43:39.692441 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:43:39.693031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m23:43:39.693485 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:43:39.693999 [info ] [Thread-1 (]: 19 of 33 START test not_null_stg_housing_prices_month .......................... [RUN]
[0m23:43:39.695306 [info ] [Thread-4 (]: 20 of 33 START test not_null_stg_housing_prices_price .......................... [RUN]
[0m23:43:39.695853 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:43:39.696552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m23:43:39.697069 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m23:43:39.705452 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:43:39.706014 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:43:39.706438 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:43:39.706868 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:43:39.707634 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:43:39.713258 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:43:39.713793 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:43:39.719622 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:43:39.720219 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select day_of_week
from __dbt__cte__stg_housing_prices
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.723321 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:43:39.724412 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:43:39.724940 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:43:39.727790 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:43:39.730636 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:43:39.731105 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:43:39.731612 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:43:39.732497 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: BEGIN
[0m23:43:39.732895 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:43:39.733335 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:43:39.734810 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: ROLLBACK
[0m23:43:39.735250 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:39.735781 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: BEGIN
[0m23:43:39.736186 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: BEGIN
[0m23:43:39.736837 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: Close
[0m23:43:39.737211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:39.737598 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:43:39.738475 [info ] [Thread-3 (]: 17 of 33 PASS not_null_stg_housing_prices_day_of_week .......................... [[32mPASS[0m in 0.08s]
[0m23:43:39.739617 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:43:39.740305 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:43:39.741001 [info ] [Thread-3 (]: 21 of 33 START test not_null_stg_housing_prices_region ......................... [RUN]
[0m23:43:39.741607 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m23:43:39.742108 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:43:39.749760 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:43:39.750781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:43:39.751797 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m23:43:39.752457 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m23:43:39.753256 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:43:39.753906 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:43:39.754565 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:43:39.755221 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:43:39.755946 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select month
from __dbt__cte__stg_housing_prices
where month is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.759450 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:43:39.760230 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select id
from __dbt__cte__stg_housing_prices
where id is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.761141 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select price
from __dbt__cte__stg_housing_prices
where price is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.762520 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:43:39.763056 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: BEGIN
[0m23:43:39.763406 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:43:39.763851 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:43:39.764832 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:43:39.766987 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: ROLLBACK
[0m23:43:39.768536 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: ROLLBACK
[0m23:43:39.769209 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:43:39.770925 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: ROLLBACK
[0m23:43:39.771659 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: Close
[0m23:43:39.772330 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: Close
[0m23:43:39.772938 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: Close
[0m23:43:39.773341 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m23:43:39.774036 [info ] [Thread-2 (]: 18 of 33 PASS not_null_stg_housing_prices_id ................................... [[32mPASS[0m in 0.08s]
[0m23:43:39.775047 [info ] [Thread-4 (]: 20 of 33 PASS not_null_stg_housing_prices_price ................................ [[32mPASS[0m in 0.08s]
[0m23:43:39.776905 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:43:39.776280 [info ] [Thread-1 (]: 19 of 33 PASS not_null_stg_housing_prices_month ................................ [[32mPASS[0m in 0.08s]
[0m23:43:39.777886 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:43:39.778528 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:43:39.779065 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select region
from __dbt__cte__stg_housing_prices
where region is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.779920 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:43:39.780525 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:43:39.781171 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:43:39.781879 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:43:39.782474 [info ] [Thread-2 (]: 22 of 33 START test not_null_stg_housing_prices_year ........................... [RUN]
[0m23:43:39.783830 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:43:39.783164 [info ] [Thread-4 (]: 23 of 33 START test not_null_stg_location_data_postcode ........................ [RUN]
[0m23:43:39.784531 [info ] [Thread-1 (]: 24 of 33 START test not_null_stg_location_data_region .......................... [RUN]
[0m23:43:39.785373 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m23:43:39.786979 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: ROLLBACK
[0m23:43:39.787528 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m23:43:39.788000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m23:43:39.788492 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:43:39.789137 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:43:39.789888 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:43:39.790406 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: Close
[0m23:43:39.796323 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:43:39.800682 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:43:39.805188 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:43:39.806121 [info ] [Thread-3 (]: 21 of 33 PASS not_null_stg_housing_prices_region ............................... [[32mPASS[0m in 0.06s]
[0m23:43:39.806783 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:43:39.808610 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:43:39.809010 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:43:39.813926 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:43:39.814580 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:43:39.815053 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:43:39.818075 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:43:39.821135 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:43:39.821795 [info ] [Thread-3 (]: 25 of 33 START test not_null_stg_location_data_type ............................ [RUN]
[0m23:43:39.822417 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:43:39.823589 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:43:39.824078 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m23:43:39.824565 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: BEGIN
[0m23:43:39.825066 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:43:39.825697 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: BEGIN
[0m23:43:39.826422 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:43:39.826899 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:39.827365 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: BEGIN
[0m23:43:39.827792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:39.832067 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:43:39.832975 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:43:39.834166 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:43:39.837005 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:43:39.837743 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:43:39.838275 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: BEGIN
[0m23:43:39.838682 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:43:39.839670 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m23:43:39.840255 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:43:39.840719 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:43:39.841130 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:43:39.841588 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:43:39.842036 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:43:39.842523 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select year
from __dbt__cte__stg_housing_prices
where year is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.843062 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."stg_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.843702 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."stg_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.845934 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:43:39.846461 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:43:39.846858 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:43:39.848366 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: ROLLBACK
[0m23:43:39.848783 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:43:39.849201 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."stg_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.850968 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: ROLLBACK
[0m23:43:39.851433 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: Close
[0m23:43:39.851903 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:43:39.852792 [info ] [Thread-4 (]: 23 of 33 PASS not_null_stg_location_data_postcode .............................. [[32mPASS[0m in 0.07s]
[0m23:43:39.854411 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: ROLLBACK
[0m23:43:39.854902 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: Close
[0m23:43:39.855683 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:43:39.856467 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:43:39.857140 [info ] [Thread-1 (]: 24 of 33 PASS not_null_stg_location_data_region ................................ [[32mPASS[0m in 0.07s]
[0m23:43:39.857825 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: Close
[0m23:43:39.858857 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:43:39.858405 [info ] [Thread-4 (]: 26 of 33 START test source_not_null_public_raw_housing_prices_date ............. [RUN]
[0m23:43:39.859851 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:43:39.862586 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: ROLLBACK
[0m23:43:39.860680 [info ] [Thread-2 (]: 22 of 33 PASS not_null_stg_housing_prices_year ................................. [[32mPASS[0m in 0.08s]
[0m23:43:39.863360 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m23:43:39.863977 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:43:39.864947 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:43:39.865493 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:43:39.865916 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: Close
[0m23:43:39.866382 [info ] [Thread-1 (]: 27 of 33 START test source_not_null_public_raw_housing_prices_id ............... [RUN]
[0m23:43:39.866947 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:43:39.872133 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:43:39.872904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m23:43:39.873626 [info ] [Thread-3 (]: 25 of 33 PASS not_null_stg_location_data_type .................................. [[32mPASS[0m in 0.05s]
[0m23:43:39.874402 [info ] [Thread-2 (]: 28 of 33 START test source_not_null_public_raw_housing_prices_price ............ [RUN]
[0m23:43:39.875411 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:43:39.876225 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:43:39.876623 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:43:39.877218 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m23:43:39.882144 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:43:39.882829 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:43:39.886089 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:43:39.886828 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:43:39.887470 [info ] [Thread-3 (]: 29 of 33 START test source_not_null_public_raw_housing_prices_region ........... [RUN]
[0m23:43:39.888592 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:43:39.893321 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:43:39.894024 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:43:39.894548 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m23:43:39.897570 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:43:39.898360 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: BEGIN
[0m23:43:39.899088 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:43:39.899625 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:43:39.900192 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:43:39.904795 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:43:39.905341 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:43:39.909730 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:43:39.910786 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: BEGIN
[0m23:43:39.911842 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:43:39.912438 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:43:39.912856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:39.915538 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:43:39.916017 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: BEGIN
[0m23:43:39.917068 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:39.917558 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m23:43:39.918276 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:43:39.918725 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:43:39.919188 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: BEGIN
[0m23:43:39.919664 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "dwh"."public"."raw_housing_prices"
where date is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.920146 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:43:39.921722 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:43:39.923277 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: ROLLBACK
[0m23:43:39.923912 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: Close
[0m23:43:39.924444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:43:39.924920 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:43:39.925577 [info ] [Thread-4 (]: 26 of 33 PASS source_not_null_public_raw_housing_prices_date ................... [[32mPASS[0m in 0.06s]
[0m23:43:39.926068 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:43:39.926611 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:43:39.927336 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:43:39.927762 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:43:39.928183 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dwh"."public"."raw_housing_prices"
where id is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.928725 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dwh"."public"."raw_housing_prices"
where price is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.929267 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:43:39.929836 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:43:39.930507 [info ] [Thread-4 (]: 30 of 33 START test source_not_null_public_raw_location_data_postcode .......... [RUN]
[0m23:43:39.931240 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_housing_prices"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.931954 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:43:39.932478 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:43:39.932969 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m23:43:39.934772 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: ROLLBACK
[0m23:43:39.935378 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:43:39.937029 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: ROLLBACK
[0m23:43:39.937553 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:43:39.939202 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: ROLLBACK
[0m23:43:39.939678 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: Close
[0m23:43:39.944566 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:43:39.945035 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: Close
[0m23:43:39.946278 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: Close
[0m23:43:39.945918 [info ] [Thread-1 (]: 27 of 33 PASS source_not_null_public_raw_housing_prices_id ..................... [[32mPASS[0m in 0.07s]
[0m23:43:39.947771 [info ] [Thread-2 (]: 28 of 33 PASS source_not_null_public_raw_housing_prices_price .................. [[32mPASS[0m in 0.07s]
[0m23:43:39.948852 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:43:39.949765 [info ] [Thread-3 (]: 29 of 33 PASS source_not_null_public_raw_housing_prices_region ................. [[32mPASS[0m in 0.06s]
[0m23:43:39.950557 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:43:39.951182 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:43:39.954598 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:43:39.955453 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:43:39.956041 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:43:39.956695 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:43:39.957462 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:43:39.957942 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:43:39.958460 [info ] [Thread-1 (]: 31 of 33 START test source_not_null_public_raw_location_data_region ............ [RUN]
[0m23:43:39.959161 [info ] [Thread-2 (]: 32 of 33 START test source_not_null_public_raw_location_data_type .............. [RUN]
[0m23:43:39.959852 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: BEGIN
[0m23:43:39.960416 [info ] [Thread-3 (]: 33 of 33 START test valid_values_stg_location_data_type__URBAN__RURAL .......... [RUN]
[0m23:43:39.961172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m23:43:39.961717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m23:43:39.962173 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:43:39.962603 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91)
[0m23:43:39.963079 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:43:39.963529 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:43:39.964174 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:43:39.968776 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:43:39.973292 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:43:39.979298 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m23:43:39.982188 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:43:39.983295 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:43:39.983906 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:43:39.984352 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:43:39.987327 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:43:39.987801 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:43:39.988282 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."raw_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:43:39.991012 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:43:39.993757 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:43:39.994610 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:43:39.995579 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: BEGIN
[0m23:43:39.996279 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:43:39.996750 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:43:39.997201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:39.997643 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:43:39.999084 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: ROLLBACK
[0m23:43:39.999521 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: BEGIN
[0m23:43:40.000134 [debug] [Thread-3 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: BEGIN
[0m23:43:40.000659 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:40.001115 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: Close
[0m23:43:40.001500 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:43:40.002640 [info ] [Thread-4 (]: 30 of 33 PASS source_not_null_public_raw_location_data_postcode ................ [[32mPASS[0m in 0.07s]
[0m23:43:40.003772 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:43:40.006901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:43:40.007646 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:43:40.008423 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:43:40.009691 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:43:40.010381 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:43:40.010841 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:43:40.011398 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:43:40.011845 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."raw_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:43:40.012457 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:43:40.014554 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: ROLLBACK
[0m23:43:40.015457 [debug] [Thread-3 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    SELECT *
    FROM "dwh"."public"."stg_location_data"
    WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = ''

  
  
      
    ) dbt_internal_test
[0m23:43:40.016192 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: Close
[0m23:43:40.017330 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:43:40.016861 [info ] [Thread-1 (]: 31 of 33 PASS source_not_null_public_raw_location_data_region .................. [[32mPASS[0m in 0.06s]
[0m23:43:40.019070 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: ROLLBACK
[0m23:43:40.020081 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:43:40.021067 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: Close
[0m23:43:40.021813 [info ] [Thread-2 (]: 32 of 33 PASS source_not_null_public_raw_location_data_type .................... [[32mPASS[0m in 0.06s]
[0m23:43:40.022640 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:43:40.029775 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:43:40.031653 [debug] [Thread-3 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: ROLLBACK
[0m23:43:40.032704 [debug] [Thread-3 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: Close
[0m23:43:40.033724 [info ] [Thread-3 (]: 33 of 33 PASS valid_values_stg_location_data_type__URBAN__RURAL ................ [[32mPASS[0m in 0.07s]
[0m23:43:40.034761 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:43:40.037087 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:40.037521 [debug] [MainThread]: On master: BEGIN
[0m23:43:40.038034 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:40.047713 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m23:43:40.048194 [debug] [MainThread]: On master: COMMIT
[0m23:43:40.048570 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:40.048836 [debug] [MainThread]: On master: COMMIT
[0m23:43:40.049311 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:43:40.049873 [debug] [MainThread]: On master: Close
[0m23:43:40.050714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:40.051205 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e' was properly closed.
[0m23:43:40.051510 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522' was properly closed.
[0m23:43:40.051774 [debug] [MainThread]: Connection 'test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91' was properly closed.
[0m23:43:40.052045 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c' was properly closed.
[0m23:43:40.052414 [info ] [MainThread]: 
[0m23:43:40.052780 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m23:43:40.061362 [debug] [MainThread]: Command end result
[0m23:43:40.105662 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:43:40.107373 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:43:40.118887 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:43:40.119468 [info ] [MainThread]: 
[0m23:43:40.119983 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:43:40.120423 [info ] [MainThread]: 
[0m23:43:40.121136 [error] [MainThread]:   Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:43:40.121851 [info ] [MainThread]: 
[0m23:43:40.122684 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=1 SKIP=0 TOTAL=33
[0m23:43:40.124122 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.729469, "process_in_blocks": "0", "process_kernel_time": 0.316866, "process_mem_max_rss": "123072", "process_out_blocks": "3064", "process_user_time": 2.931013}
[0m23:43:40.124766 [debug] [MainThread]: Command `dbt test` failed at 23:43:40.124582 after 1.73 seconds
[0m23:43:40.125332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ab670850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5af6dd090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a83a9490>]}
[0m23:43:40.125901 [debug] [MainThread]: Flushing usage events
[0m23:43:40.638717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:14.622993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff435a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff43a6ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff476d9d0>]}


============================== 23:45:14.625678 | 551daea4-ccef-48e5-8c4a-739820ccf886 ==============================
[0m23:45:14.625678 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:45:14.626268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:45:14.776486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff3ba5d90>]}
[0m23:45:14.833172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff6d9af50>]}
[0m23:45:14.833910 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:45:14.920965 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:45:15.050312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m23:45:15.051372 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/gold/region_type_composition_with_macro.sql
[0m23:45:15.051829 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/stg_location_data.sql
[0m23:45:15.052234 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://tests/generic/test_valid_values.sql
[0m23:45:15.052707 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://macros/normalize_values.sql
[0m23:45:15.511814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff0726010>]}
[0m23:45:15.613462 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:45:15.616192 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:45:15.677129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff2358a50>]}
[0m23:45:15.677715 [info ] [MainThread]: Found 9 models, 33 data tests, 2 sources, 436 macros
[0m23:45:15.678113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff07b7c90>]}
[0m23:45:15.682164 [info ] [MainThread]: 
[0m23:45:15.682760 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:15.683385 [info ] [MainThread]: 
[0m23:45:15.684387 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:45:15.691324 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:45:15.731406 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:45:15.731796 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:45:15.732079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:15.741161 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m23:45:15.742588 [debug] [ThreadPool]: On list_dwh: Close
[0m23:45:15.744476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:45:15.750951 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:45:15.751322 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:45:15.751646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:15.758242 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:45:15.758724 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:45:15.759104 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:45:15.761645 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:45:15.763042 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:45:15.763507 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:45:15.770510 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:15.770843 [debug] [MainThread]: On master: BEGIN
[0m23:45:15.771103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:15.777563 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:45:15.777937 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:15.778421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:45:15.783098 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m23:45:15.785787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff0747f50>]}
[0m23:45:15.786203 [debug] [MainThread]: On master: ROLLBACK
[0m23:45:15.786670 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:15.786952 [debug] [MainThread]: On master: BEGIN
[0m23:45:15.787527 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:45:15.787810 [debug] [MainThread]: On master: COMMIT
[0m23:45:15.788075 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:15.788329 [debug] [MainThread]: On master: COMMIT
[0m23:45:15.788760 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:45:15.789057 [debug] [MainThread]: On master: Close
[0m23:45:15.792314 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:45:15.792820 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:45:15.793397 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m23:45:15.794071 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m23:45:15.794625 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:45:15.795268 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:45:15.795967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:45:15.796595 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:45:15.797198 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m23:45:15.797990 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m23:45:15.798751 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:45:15.799327 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:45:15.799963 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:45:15.800525 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:45:15.810583 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:45:15.812948 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:45:15.813505 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:45:15.813955 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:45:15.815105 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:45:15.815559 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:45:15.818688 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:45:15.822729 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:45:15.885366 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:45:15.886742 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:45:15.887278 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:45:15.888103 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:45:15.888780 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:45:15.892835 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:45:15.893426 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:45:15.897327 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:45:15.897779 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:45:15.898422 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:45:15.899128 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:45:15.899718 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:45:15.900138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:15.900541 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:45:15.901197 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:45:15.901835 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:45:15.902245 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:45:15.902653 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:45:15.907294 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:45:15.907886 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:45:15.908375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:45:15.908951 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:45:15.909650 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:45:15.910098 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:45:15.910494 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:45:15.911042 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:45:15.911503 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:45:15.911878 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:45:15.912243 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:45:15.912795 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:45:15.918896 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:45:15.919425 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type,
    CASE
        WHEN LOWER("type") = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER("type") = LOWER('RURAL') THEN 'RURAL'
        ELSE 'RURAL'
    END as type_normalized
FROM source
  );
[0m23:45:15.921466 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:45:15.925238 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:45:15.925685 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:45:15.926201 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:45:15.926659 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:45:15.930934 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:45:15.931435 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:45:15.932073 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:45:15.932637 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:45:15.933036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:45:15.936434 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:45:15.939755 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:45:15.940251 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:45:15.943250 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:45:15.943701 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m23:45:15.944268 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:45:15.947279 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:45:15.947738 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:45:15.948495 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:45:15.949080 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:45:15.949455 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:45:15.952948 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:45:15.953517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:45:15.953888 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:45:15.964716 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:45:15.974726 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:45:15.976205 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:45:15.977580 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:45:15.978141 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:45:15.978577 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:45:15.978967 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:45:15.979398 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:45:15.979851 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:45:15.981091 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:45:15.981515 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:45:15.981963 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:45:15.982500 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:45:15.983179 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:45:15.985754 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:45:15.992548 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:45:15.993177 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m23:45:15.993550 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m23:45:15.998880 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:45:15.999517 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m23:45:16.002350 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:45:16.005014 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:45:16.005488 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:45:16.007992 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:45:16.008694 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:45:16.009322 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:45:16.010028 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:45:16.010481 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:45:16.010942 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:45:16.011442 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:45:16.012820 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:45:16.015393 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:45:16.015787 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:45:16.018489 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:45:16.019111 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m23:45:16.020169 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m23:45:16.021523 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:45:16.021928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff04360d0>]}
[0m23:45:16.022377 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff0440c10>]}
[0m23:45:16.023652 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:45:16.024277 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff044ecd0>]}
[0m23:45:16.025168 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m23:45:16.026062 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.22s]
[0m23:45:16.027094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff05bf090>]}
[0m23:45:16.027854 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m23:45:16.028660 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:45:16.029311 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:45:16.030112 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.23s]
[0m23:45:16.030876 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:45:16.032363 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:45:16.033721 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:45:16.034168 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:45:16.035264 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:45:16.034829 [info ] [Thread-2 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m23:45:16.036153 [info ] [Thread-3 (]: 6 of 8 START sql view model public.region_type_composition_with_macro .......... [RUN]
[0m23:45:16.036846 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.stg_housing_prices)
[0m23:45:16.037366 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition)
[0m23:45:16.037945 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition_with_macro)
[0m23:45:16.038427 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:45:16.038824 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:45:16.039250 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:45:16.044560 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:45:16.048027 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:45:16.052051 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:45:16.053477 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:45:16.053945 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:45:16.054315 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:45:16.058924 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:45:16.059453 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:45:16.063464 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:45:16.064341 [info ] [Thread-1 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:45:16.065195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.incremental_prices)
[0m23:45:16.065687 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:45:16.071588 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:45:16.072342 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:45:16.079612 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:45:16.080213 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: BEGIN
[0m23:45:16.080843 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:45:16.081491 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:45:16.082005 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:45:16.082447 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:45:16.099980 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m23:45:16.100678 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:45:16.106411 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m23:45:16.121984 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  total_locations as total_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:45:16.132784 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:45:16.133238 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:45:16.133858 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp234516116075"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:45:16.134430 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */

  create view "dwh"."public"."region_type_composition_with_macro__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        ELSE 'UNKNOWN'
    END = 'URBAN') AS urban_count,
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'RURAL') AS rural_count
  ,
    COUNT(*) AS total_count

  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  ROUND(urban_count * 1.0 / total_count, 2) AS pct_urban
FROM type_counts
  );
[0m23:45:16.134936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:16.135457 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:45:16.139165 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:45:16.139599 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:45:16.140020 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m23:45:16.143540 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:45:16.144288 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
alter table "dwh"."public"."region_type_composition_with_macro__dbt_tmp" rename to "region_type_composition_with_macro"
[0m23:45:16.144741 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:45:16.146102 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:45:16.146565 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:45:16.147005 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:45:16.148376 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:45:16.148829 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:45:16.149277 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:45:16.149798 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:45:16.152603 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:45:16.155827 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m23:45:16.156332 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m23:45:16.156930 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:45:16.160536 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition_with_macro__dbt_backup"
[0m23:45:16.161017 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m23:45:16.161641 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:45:16.162198 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
drop view if exists "dwh"."public"."region_type_composition_with_macro__dbt_backup" cascade
[0m23:45:16.162584 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:45:16.163947 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:45:16.164315 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:45:16.165015 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff034aad0>]}
[0m23:45:16.166372 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: Close
[0m23:45:16.167054 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:45:16.167818 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff034b9d0>]}
[0m23:45:16.168438 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:45:16.169356 [info ] [Thread-3 (]: 6 of 8 OK created sql view model public.region_type_composition_with_macro ..... [[32mCREATE VIEW[0m in 0.13s]
[0m23:45:16.170802 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:45:16.171467 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:45:16.172560 [info ] [Thread-4 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m23:45:16.173292 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m23:45:16.173814 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:45:16.183041 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:45:16.183754 [debug] [Thread-1 (]: SQL status: SELECT 10500 in 0.049 seconds
[0m23:45:16.199105 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:45:16.199712 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:45:16.200127 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:45:16.204390 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:45:16.204860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m23:45:16.205482 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:45:16.205887 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp234516116075'
        
      order by ordinal_position

  
[0m23:45:16.206486 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:45:16.206843 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m23:45:16.207213 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:45:16.211556 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:45:16.217587 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:45:16.218193 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:45:16.218650 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m23:45:16.219099 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:45:16.219584 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m23:45:16.221662 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:45:16.230043 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:45:16.230528 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:45:16.231013 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:45:16.234376 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:45:16.234931 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m23:45:16.235747 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:45:16.236912 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:45:16.237269 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:45:16.237708 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:45:16.246063 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:45:16.246576 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:45:16.247285 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:45:16.247667 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp234516116075"
    )


  
[0m23:45:16.253479 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m23:45:16.256202 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m23:45:16.256589 [debug] [Thread-1 (]: SQL status: INSERT 0 10500 in 0.009 seconds
[0m23:45:16.257176 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:45:16.258518 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:45:16.258986 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m23:45:16.259455 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:45:16.259950 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:45:16.260340 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:45:16.261734 [debug] [Thread-4 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m23:45:16.262373 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff0391350>]}
[0m23:45:16.262980 [info ] [Thread-4 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.09s]
[0m23:45:16.263577 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:45:16.271808 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m23:45:16.272737 [debug] [Thread-1 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:45:16.273307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551daea4-ccef-48e5-8c4a-739820ccf886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff032f2d0>]}
[0m23:45:16.273910 [info ] [Thread-1 (]: 7 of 8 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 10500[0m in 0.21s]
[0m23:45:16.274694 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:45:16.276834 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:16.277242 [debug] [MainThread]: On master: BEGIN
[0m23:45:16.277511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:16.284377 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:45:16.284799 [debug] [MainThread]: On master: COMMIT
[0m23:45:16.285079 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:16.285355 [debug] [MainThread]: On master: COMMIT
[0m23:45:16.285746 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:45:16.286046 [debug] [MainThread]: On master: Close
[0m23:45:16.286570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:16.286854 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:45:16.287105 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:45:16.287366 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition_with_macro' was properly closed.
[0m23:45:16.287611 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m23:45:16.288100 [info ] [MainThread]: 
[0m23:45:16.288471 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m23:45:16.290289 [debug] [MainThread]: Command end result
[0m23:45:16.326675 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:45:16.328225 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:45:16.334065 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:45:16.334361 [info ] [MainThread]: 
[0m23:45:16.334741 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:16.335109 [info ] [MainThread]: 
[0m23:45:16.335487 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m23:45:16.336623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7640157, "process_in_blocks": "0", "process_kernel_time": 0.140481, "process_mem_max_rss": "128460", "process_out_blocks": "3448", "process_user_time": 2.930033}
[0m23:45:16.337143 [debug] [MainThread]: Command `dbt run` succeeded at 23:45:16.337045 after 1.76 seconds
[0m23:45:16.337502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff43917d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff5585f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff4587310>]}
[0m23:45:16.337903 [debug] [MainThread]: Flushing usage events
[0m23:45:17.111495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:18.694245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74b839d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74c558990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74b875b10>]}


============================== 23:45:18.696886 | c147489b-75e9-4ae9-81f7-e274257d82d2 ==============================
[0m23:45:18.696886 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:45:18.697471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:18.850757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c147489b-75e9-4ae9-81f7-e274257d82d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74b899490>]}
[0m23:45:18.909052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c147489b-75e9-4ae9-81f7-e274257d82d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74e25b6d0>]}
[0m23:45:18.909777 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:45:18.990614 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:45:19.119344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:45:19.120104 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:45:19.171167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c147489b-75e9-4ae9-81f7-e274257d82d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74af90e90>]}
[0m23:45:19.271994 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:45:19.274435 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:45:19.296671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c147489b-75e9-4ae9-81f7-e274257d82d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd749b8fb50>]}
[0m23:45:19.297228 [info ] [MainThread]: Found 9 models, 33 data tests, 2 sources, 436 macros
[0m23:45:19.297620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c147489b-75e9-4ae9-81f7-e274257d82d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74abf8350>]}
[0m23:45:19.302828 [info ] [MainThread]: 
[0m23:45:19.303547 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:19.304155 [info ] [MainThread]: 
[0m23:45:19.305137 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:45:19.311748 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m23:45:19.353425 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:45:19.353789 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:45:19.354052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:19.361307 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:45:19.361805 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:45:19.362138 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:45:19.364543 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:45:19.365955 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:45:19.366413 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:45:19.373324 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:19.373629 [debug] [MainThread]: On master: BEGIN
[0m23:45:19.373878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:19.380417 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:45:19.380870 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:19.381331 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:45:19.385878 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m23:45:19.388680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c147489b-75e9-4ae9-81f7-e274257d82d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd749b98cd0>]}
[0m23:45:19.389093 [debug] [MainThread]: On master: ROLLBACK
[0m23:45:19.389555 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:19.389827 [debug] [MainThread]: On master: BEGIN
[0m23:45:19.390441 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:45:19.390812 [debug] [MainThread]: On master: COMMIT
[0m23:45:19.391084 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:19.391330 [debug] [MainThread]: On master: COMMIT
[0m23:45:19.391787 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:45:19.392083 [debug] [MainThread]: On master: Close
[0m23:45:19.395622 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:45:19.396086 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:45:19.396521 [info ] [Thread-1 (]: 1 of 33 START test accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [RUN]
[0m23:45:19.397071 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:45:19.397496 [info ] [Thread-2 (]: 2 of 33 START test accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [RUN]
[0m23:45:19.398103 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:45:19.398655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m23:45:19.399175 [info ] [Thread-3 (]: 3 of 33 START test not_null_mart_housing_prices_breakdown_avg_price ............ [RUN]
[0m23:45:19.399880 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e'
[0m23:45:19.400379 [info ] [Thread-4 (]: 4 of 33 START test not_null_mart_housing_prices_breakdown_n_sales .............. [RUN]
[0m23:45:19.401033 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:45:19.401871 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d'
[0m23:45:19.402399 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:45:19.402992 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7'
[0m23:45:19.419312 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:45:19.426009 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:45:19.434341 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:45:19.434914 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:45:19.444003 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:45:19.447998 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:45:19.454140 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:45:19.456428 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:45:19.457982 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:45:19.464262 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:45:19.497859 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:45:19.508464 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:45:19.509206 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:45:19.509817 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:45:19.511008 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:45:19.511572 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:45:19.514359 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:45:19.514817 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:45:19.515283 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: BEGIN
[0m23:45:19.515733 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: BEGIN
[0m23:45:19.516340 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: BEGIN
[0m23:45:19.516820 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:45:19.517248 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:45:19.517677 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:45:19.518099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:19.518525 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: BEGIN
[0m23:45:19.519582 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:45:19.525396 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:45:19.525889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:45:19.526414 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:45:19.526952 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m23:45:19.527380 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:45:19.527759 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:45:19.528307 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        month as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by month

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','7','8','9','10','11','12'
)



  
  
      
    ) dbt_internal_test
[0m23:45:19.528842 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:45:19.529392 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        day_of_week as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by day_of_week

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m23:45:19.529914 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:45:19.530478 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_price
from "dwh"."public"."mart_housing_prices_breakdown"
where avg_price is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.531054 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select n_sales
from "dwh"."public"."mart_housing_prices_breakdown"
where n_sales is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.536587 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:45:19.537135 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:45:19.537545 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:45:19.541800 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: ROLLBACK
[0m23:45:19.542236 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:45:19.543619 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: ROLLBACK
[0m23:45:19.544926 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: ROLLBACK
[0m23:45:19.546403 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: ROLLBACK
[0m23:45:19.546843 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: Close
[0m23:45:19.547413 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: Close
[0m23:45:19.547866 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: Close
[0m23:45:19.548592 [info ] [Thread-4 (]: 4 of 33 PASS not_null_mart_housing_prices_breakdown_n_sales .................... [[32mPASS[0m in 0.15s]
[0m23:45:19.549098 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: Close
[0m23:45:19.550037 [info ] [Thread-2 (]: 2 of 33 PASS accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [[32mPASS[0m in 0.15s]
[0m23:45:19.551293 [info ] [Thread-3 (]: 3 of 33 PASS not_null_mart_housing_prices_breakdown_avg_price .................. [[32mPASS[0m in 0.15s]
[0m23:45:19.552243 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:45:19.553092 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:45:19.553848 [info ] [Thread-1 (]: 1 of 33 PASS accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [[32mPASS[0m in 0.16s]
[0m23:45:19.554721 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:45:19.555436 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:45:19.556176 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:45:19.557110 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:45:19.557663 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:45:19.558236 [info ] [Thread-4 (]: 5 of 33 START test not_null_mart_housing_prices_breakdown_region ............... [RUN]
[0m23:45:19.558826 [info ] [Thread-2 (]: 6 of 33 START test not_null_region_type_composition_pct_urban .................. [RUN]
[0m23:45:19.559508 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:45:19.560148 [info ] [Thread-3 (]: 7 of 33 START test not_null_region_type_composition_region ..................... [RUN]
[0m23:45:19.560816 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m23:45:19.561371 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m23:45:19.561903 [info ] [Thread-1 (]: 8 of 33 START test not_null_region_type_composition_rural_count ................ [RUN]
[0m23:45:19.562664 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m23:45:19.563275 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:45:19.563717 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:45:19.564237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m23:45:19.564699 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:45:19.569514 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:45:19.573951 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:45:19.574519 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:45:19.580512 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:45:19.581317 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:45:19.628465 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:45:19.631436 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:45:19.632033 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:45:19.632444 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:45:19.633269 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:45:19.635805 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:45:19.638400 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:45:19.638876 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:45:19.641477 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:45:19.642433 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:45:19.642959 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:45:19.643416 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: BEGIN
[0m23:45:19.644009 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: BEGIN
[0m23:45:19.644525 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: BEGIN
[0m23:45:19.644946 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:45:19.645372 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:45:19.645775 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:45:19.646218 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:45:19.646636 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: BEGIN
[0m23:45:19.647722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:19.653487 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:45:19.654084 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:45:19.654622 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:45:19.655094 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:45:19.655492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:45:19.655946 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:45:19.656388 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:45:19.656848 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."mart_housing_prices_breakdown"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.657320 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:45:19.657792 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.658320 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.658906 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.661137 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:45:19.662634 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: ROLLBACK
[0m23:45:19.663168 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: Close
[0m23:45:19.663806 [info ] [Thread-4 (]: 5 of 33 PASS not_null_mart_housing_prices_breakdown_region ..................... [[32mPASS[0m in 0.10s]
[0m23:45:19.664340 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:45:19.665053 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:45:19.666704 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: ROLLBACK
[0m23:45:19.667404 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:45:19.668578 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: Close
[0m23:45:19.668180 [info ] [Thread-4 (]: 9 of 33 START test not_null_region_type_composition_total_count ................ [RUN]
[0m23:45:19.670293 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c, now test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7)
[0m23:45:19.669756 [info ] [Thread-3 (]: 7 of 33 PASS not_null_region_type_composition_region ........................... [[32mPASS[0m in 0.11s]
[0m23:45:19.671118 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:45:19.671664 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:45:19.672422 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:45:19.672908 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:45:19.677553 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:45:19.679278 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: ROLLBACK
[0m23:45:19.680084 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:45:19.682040 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: ROLLBACK
[0m23:45:19.682964 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:45:19.683488 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: Close
[0m23:45:19.684093 [info ] [Thread-3 (]: 10 of 33 START test not_null_region_type_composition_urban_count ............... [RUN]
[0m23:45:19.687761 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:45:19.688279 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: Close
[0m23:45:19.688999 [info ] [Thread-1 (]: 8 of 33 PASS not_null_region_type_composition_rural_count ...................... [[32mPASS[0m in 0.12s]
[0m23:45:19.689634 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m23:45:19.690997 [info ] [Thread-2 (]: 6 of 33 PASS not_null_region_type_composition_pct_urban ........................ [[32mPASS[0m in 0.13s]
[0m23:45:19.692302 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:45:19.692995 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:45:19.693662 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:45:19.694389 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:45:19.694933 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:45:19.695508 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: BEGIN
[0m23:45:19.700505 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:45:19.701239 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:45:19.702208 [info ] [Thread-1 (]: 11 of 33 START test not_null_region_type_composition_with_macro_pct_urban ...... [RUN]
[0m23:45:19.702964 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:45:19.703709 [info ] [Thread-2 (]: 12 of 33 START test not_null_region_type_composition_with_macro_region ......... [RUN]
[0m23:45:19.704665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91)
[0m23:45:19.705247 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:45:19.706084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192)
[0m23:45:19.706591 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:45:19.709960 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:45:19.710627 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:45:19.715541 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:45:19.720622 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:45:19.721522 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m23:45:19.722121 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:45:19.723062 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:45:19.723446 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:45:19.723918 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:45:19.724382 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: BEGIN
[0m23:45:19.729359 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:45:19.732165 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:45:19.732811 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_count
from "dwh"."public"."region_type_composition"
where total_count is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.733366 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:45:19.734347 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:45:19.734875 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:45:19.735629 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: BEGIN
[0m23:45:19.736228 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: BEGIN
[0m23:45:19.736737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:19.737188 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:45:19.742097 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:45:19.742542 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:45:19.742942 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:45:19.743366 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.745185 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: ROLLBACK
[0m23:45:19.745755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:45:19.746160 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:45:19.746746 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:45:19.747197 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: Close
[0m23:45:19.747583 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:45:19.748105 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition_with_macro"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.748839 [info ] [Thread-4 (]: 9 of 33 PASS not_null_region_type_composition_total_count ...................... [[32mPASS[0m in 0.08s]
[0m23:45:19.749372 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition_with_macro"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.750203 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:45:19.750888 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:45:19.751367 [info ] [Thread-4 (]: 13 of 33 START test not_null_region_type_composition_with_macro_rural_count .... [RUN]
[0m23:45:19.752104 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797)
[0m23:45:19.752658 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:45:19.757693 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:45:19.758299 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:45:19.758946 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:45:19.760840 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: ROLLBACK
[0m23:45:19.761342 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:45:19.762952 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: ROLLBACK
[0m23:45:19.766090 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:45:19.766689 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: Close
[0m23:45:19.767095 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:45:19.767663 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: Close
[0m23:45:19.769367 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: ROLLBACK
[0m23:45:19.770127 [info ] [Thread-2 (]: 12 of 33 PASS not_null_region_type_composition_with_macro_region ............... [[32mPASS[0m in 0.06s]
[0m23:45:19.770760 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:45:19.771675 [info ] [Thread-3 (]: 10 of 33 PASS not_null_region_type_composition_urban_count ..................... [[32mPASS[0m in 0.08s]
[0m23:45:19.772300 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: Close
[0m23:45:19.772905 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:45:19.773389 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: BEGIN
[0m23:45:19.773967 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:45:19.774731 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:45:19.775415 [info ] [Thread-1 (]: 11 of 33 PASS not_null_region_type_composition_with_macro_pct_urban ............ [[32mPASS[0m in 0.07s]
[0m23:45:19.776319 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:45:19.776888 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:45:19.777522 [info ] [Thread-2 (]: 14 of 33 START test not_null_region_type_composition_with_macro_total_locations  [RUN]
[0m23:45:19.778316 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:45:19.779124 [info ] [Thread-3 (]: 15 of 33 START test not_null_region_type_composition_with_macro_urban_count .... [RUN]
[0m23:45:19.779839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae)
[0m23:45:19.780544 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:45:19.781372 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224)
[0m23:45:19.781942 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:45:19.782418 [info ] [Thread-1 (]: 16 of 33 START test not_null_stg_housing_prices_date ........................... [RUN]
[0m23:45:19.782980 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:45:19.787683 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:45:19.788458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m23:45:19.789000 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m23:45:19.793543 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:45:19.794469 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:45:19.794960 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:45:19.795440 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:45:19.801653 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:45:19.804718 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:45:19.805550 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:45:19.806177 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition_with_macro"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.807134 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:45:19.809968 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:45:19.810446 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:45:19.813513 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:45:19.814205 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: BEGIN
[0m23:45:19.814945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:45:19.815565 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:45:19.816193 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:45:19.816635 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: BEGIN
[0m23:45:19.817131 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: BEGIN
[0m23:45:19.817626 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:45:19.818047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:19.822476 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:45:19.822932 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:45:19.823335 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_locations
from "dwh"."public"."region_type_composition_with_macro"
where total_locations is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.824391 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "total_locations" does not exist
LINE 16: select total_locations
                ^

[0m23:45:19.824895 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:45:19.825299 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: ROLLBACK
[0m23:45:19.825905 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:45:19.826487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:45:19.827038 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition_with_macro"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.827483 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:45:19.827950 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: Close
[0m23:45:19.828392 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:45:19.829953 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: ROLLBACK
[0m23:45:19.830590 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select date
from __dbt__cte__stg_housing_prices
where date is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.832386 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: Close
[0m23:45:19.833293 [info ] [Thread-4 (]: 13 of 33 PASS not_null_region_type_composition_with_macro_rural_count .......... [[32mPASS[0m in 0.08s]
[0m23:45:19.834046 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:45:19.834488 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:45:19.835309 [info ] [Thread-4 (]: 17 of 33 START test not_null_stg_housing_prices_day_of_week .................... [RUN]
[0m23:45:19.836327 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m23:45:19.837079 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:45:19.837689 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:45:19.839732 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: ROLLBACK
[0m23:45:19.846042 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:45:19.848490 [debug] [Thread-2 (]: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:45:19.849107 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.020 seconds
[0m23:45:19.849793 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: Close
[0m23:45:19.850347 [error] [Thread-2 (]: 14 of 33 ERROR not_null_region_type_composition_with_macro_total_locations ..... [[31mERROR[0m in 0.07s]
[0m23:45:19.852058 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: ROLLBACK
[0m23:45:19.852731 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:45:19.854263 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:45:19.853443 [info ] [Thread-1 (]: 16 of 33 PASS not_null_stg_housing_prices_date ................................. [[32mPASS[0m in 0.06s]
[0m23:45:19.859678 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:45:19.860433 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: Close
[0m23:45:19.861092 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:45:19.861762 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql.
[0m23:45:19.862468 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:45:19.863251 [info ] [Thread-2 (]: 18 of 33 START test not_null_stg_housing_prices_id ............................. [RUN]
[0m23:45:19.864028 [info ] [Thread-3 (]: 15 of 33 PASS not_null_region_type_composition_with_macro_urban_count .......... [[32mPASS[0m in 0.08s]
[0m23:45:19.864878 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:45:19.866314 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:45:19.867103 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m23:45:19.867829 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:45:19.868306 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: BEGIN
[0m23:45:19.869213 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:45:19.868791 [info ] [Thread-1 (]: 19 of 33 START test not_null_stg_housing_prices_month .......................... [RUN]
[0m23:45:19.869787 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:45:19.870350 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:45:19.876288 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:45:19.876750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m23:45:19.877244 [info ] [Thread-3 (]: 20 of 33 START test not_null_stg_housing_prices_price .......................... [RUN]
[0m23:45:19.878476 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:45:19.879364 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m23:45:19.880030 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:45:19.886045 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:45:19.886742 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:45:19.887223 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m23:45:19.890058 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:45:19.895711 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:45:19.896449 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:45:19.897232 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:45:19.898076 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select day_of_week
from __dbt__cte__stg_housing_prices
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.898636 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:45:19.899123 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:45:19.901907 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:45:19.905214 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:45:19.905742 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: BEGIN
[0m23:45:19.906671 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:45:19.907167 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:45:19.907586 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:45:19.908024 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: BEGIN
[0m23:45:19.908586 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:45:19.909321 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: BEGIN
[0m23:45:19.909759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:19.911258 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: ROLLBACK
[0m23:45:19.911739 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:45:19.912615 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: Close
[0m23:45:19.913321 [info ] [Thread-4 (]: 17 of 33 PASS not_null_stg_housing_prices_day_of_week .......................... [[32mPASS[0m in 0.08s]
[0m23:45:19.914100 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:45:19.914775 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:45:19.915492 [info ] [Thread-4 (]: 21 of 33 START test not_null_stg_housing_prices_region ......................... [RUN]
[0m23:45:19.916196 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m23:45:19.916755 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:45:19.917237 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:45:19.917770 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:45:19.924199 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:45:19.924930 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:45:19.925339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m23:45:19.925853 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select id
from __dbt__cte__stg_housing_prices
where id is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.926570 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:45:19.927207 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:45:19.927595 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:45:19.928228 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select price
from __dbt__cte__stg_housing_prices
where price is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.928840 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select month
from __dbt__cte__stg_housing_prices
where month is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.931803 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:45:19.932516 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:45:19.934951 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: ROLLBACK
[0m23:45:19.935795 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:45:19.936296 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: Close
[0m23:45:19.937774 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: ROLLBACK
[0m23:45:19.938361 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:45:19.939143 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:45:19.940167 [info ] [Thread-2 (]: 18 of 33 PASS not_null_stg_housing_prices_id ................................... [[32mPASS[0m in 0.07s]
[0m23:45:19.940836 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: Close
[0m23:45:19.941291 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: BEGIN
[0m23:45:19.943018 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: ROLLBACK
[0m23:45:19.943705 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:45:19.944300 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:45:19.945259 [info ] [Thread-3 (]: 20 of 33 PASS not_null_stg_housing_prices_price ................................ [[32mPASS[0m in 0.07s]
[0m23:45:19.946255 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:45:19.947067 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: Close
[0m23:45:19.948182 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:45:19.948778 [info ] [Thread-2 (]: 22 of 33 START test not_null_stg_housing_prices_year ........................... [RUN]
[0m23:45:19.949693 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:45:19.950504 [info ] [Thread-1 (]: 19 of 33 PASS not_null_stg_housing_prices_month ................................ [[32mPASS[0m in 0.07s]
[0m23:45:19.951502 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m23:45:19.952121 [info ] [Thread-3 (]: 23 of 33 START test not_null_stg_location_data_postcode ........................ [RUN]
[0m23:45:19.953015 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:45:19.953458 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:45:19.954039 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m23:45:19.954885 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:45:19.955448 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m23:45:19.961275 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:45:19.961748 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:45:19.962205 [info ] [Thread-1 (]: 24 of 33 START test not_null_stg_location_data_region .......................... [RUN]
[0m23:45:19.962863 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:45:19.967735 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:45:19.968331 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:45:19.968813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m23:45:19.969378 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select region
from __dbt__cte__stg_housing_prices
where region is null



  
  
      
    ) dbt_internal_test
[0m23:45:19.972616 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:45:19.973224 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:45:19.973650 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:45:19.980667 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:45:19.983984 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:45:19.984488 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:45:19.985169 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:45:19.985969 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:45:19.987498 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: ROLLBACK
[0m23:45:19.988098 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: BEGIN
[0m23:45:19.988582 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:45:19.991445 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:45:19.991983 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:45:19.992401 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: Close
[0m23:45:19.992820 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: BEGIN
[0m23:45:19.993939 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:45:19.995007 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:45:19.994619 [info ] [Thread-4 (]: 21 of 33 PASS not_null_stg_housing_prices_region ............................... [[32mPASS[0m in 0.08s]
[0m23:45:19.995656 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: BEGIN
[0m23:45:19.996691 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:45:19.997210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:19.997796 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:45:19.998742 [info ] [Thread-4 (]: 25 of 33 START test not_null_stg_location_data_type ............................ [RUN]
[0m23:45:19.999588 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m23:45:20.000345 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:45:20.005605 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:45:20.006652 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m23:45:20.007198 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m23:45:20.008049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:45:20.008513 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:45:20.008919 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:45:20.009395 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:45:20.009855 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:45:20.013413 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:45:20.014024 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select year
from __dbt__cte__stg_housing_prices
where year is null



  
  
      
    ) dbt_internal_test
[0m23:45:20.014599 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."stg_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:45:20.015145 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."stg_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:45:20.016237 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:45:20.016613 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: BEGIN
[0m23:45:20.016939 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:45:20.017465 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:45:20.019380 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: ROLLBACK
[0m23:45:20.020020 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: Close
[0m23:45:20.020548 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:45:20.021230 [info ] [Thread-3 (]: 23 of 33 PASS not_null_stg_location_data_postcode .............................. [[32mPASS[0m in 0.07s]
[0m23:45:20.022969 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: ROLLBACK
[0m23:45:20.023702 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:45:20.024742 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:45:20.026894 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: ROLLBACK
[0m23:45:20.027391 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: Close
[0m23:45:20.027820 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m23:45:20.028370 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:45:20.030095 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:45:20.030742 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: Close
[0m23:45:20.029407 [info ] [Thread-1 (]: 24 of 33 PASS not_null_stg_location_data_region ................................ [[32mPASS[0m in 0.06s]
[0m23:45:20.031656 [info ] [Thread-3 (]: 26 of 33 START test source_not_null_public_raw_housing_prices_date ............. [RUN]
[0m23:45:20.032248 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."stg_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:45:20.033069 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:45:20.033704 [info ] [Thread-2 (]: 22 of 33 PASS not_null_stg_housing_prices_year ................................. [[32mPASS[0m in 0.08s]
[0m23:45:20.034328 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m23:45:20.035018 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:45:20.035958 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:45:20.036694 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:45:20.037274 [info ] [Thread-1 (]: 27 of 33 START test source_not_null_public_raw_housing_prices_id ............... [RUN]
[0m23:45:20.037971 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:45:20.043442 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:45:20.044198 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:45:20.044717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m23:45:20.045308 [info ] [Thread-2 (]: 28 of 33 START test source_not_null_public_raw_housing_prices_price ............ [RUN]
[0m23:45:20.047213 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: ROLLBACK
[0m23:45:20.047689 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:45:20.048305 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:45:20.048873 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m23:45:20.051951 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:45:20.052419 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: Close
[0m23:45:20.056892 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:45:20.057430 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:45:20.058490 [info ] [Thread-4 (]: 25 of 33 PASS not_null_stg_location_data_type .................................. [[32mPASS[0m in 0.06s]
[0m23:45:20.059897 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:45:20.065157 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:45:20.066069 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:45:20.066773 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: BEGIN
[0m23:45:20.067285 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:45:20.068054 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:45:20.068907 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:45:20.072219 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:45:20.072855 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:45:20.073534 [info ] [Thread-4 (]: 29 of 33 START test source_not_null_public_raw_housing_prices_region ........... [RUN]
[0m23:45:20.077136 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:45:20.077846 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m23:45:20.078586 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:45:20.079390 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:45:20.080082 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:45:20.080512 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: BEGIN
[0m23:45:20.086653 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m23:45:20.088333 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:45:20.088862 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: BEGIN
[0m23:45:20.089309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:20.089754 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:45:20.090495 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:45:20.091401 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:45:20.092041 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "dwh"."public"."raw_housing_prices"
where date is null



  
  
      
    ) dbt_internal_test
[0m23:45:20.095250 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:45:20.096399 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:45:20.097113 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: BEGIN
[0m23:45:20.097768 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:45:20.098295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:45:20.098720 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:45:20.099392 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:45:20.100971 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: ROLLBACK
[0m23:45:20.101476 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:45:20.102076 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dwh"."public"."raw_housing_prices"
where id is null



  
  
      
    ) dbt_internal_test
[0m23:45:20.102957 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:45:20.103629 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: Close
[0m23:45:20.104074 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dwh"."public"."raw_housing_prices"
where price is null



  
  
      
    ) dbt_internal_test
[0m23:45:20.104923 [info ] [Thread-3 (]: 26 of 33 PASS source_not_null_public_raw_housing_prices_date ................... [[32mPASS[0m in 0.07s]
[0m23:45:20.105503 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:45:20.106494 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:45:20.106965 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:45:20.108540 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: ROLLBACK
[0m23:45:20.109043 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:45:20.109562 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:45:20.110098 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:45:20.111769 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: ROLLBACK
[0m23:45:20.112222 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: Close
[0m23:45:20.112680 [info ] [Thread-3 (]: 30 of 33 START test source_not_null_public_raw_location_data_postcode .......... [RUN]
[0m23:45:20.113231 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_housing_prices"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:45:20.114093 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: Close
[0m23:45:20.115672 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m23:45:20.115164 [info ] [Thread-1 (]: 27 of 33 PASS source_not_null_public_raw_housing_prices_id ..................... [[32mPASS[0m in 0.07s]
[0m23:45:20.116589 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:45:20.117306 [info ] [Thread-2 (]: 28 of 33 PASS source_not_null_public_raw_housing_prices_price .................. [[32mPASS[0m in 0.07s]
[0m23:45:20.118181 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:45:20.123349 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:45:20.123874 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:45:20.124702 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:45:20.125207 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:45:20.127203 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: ROLLBACK
[0m23:45:20.127694 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:45:20.128279 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:45:20.128838 [info ] [Thread-1 (]: 31 of 33 START test source_not_null_public_raw_location_data_region ............ [RUN]
[0m23:45:20.132148 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:45:20.132691 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: Close
[0m23:45:20.133292 [info ] [Thread-2 (]: 32 of 33 START test source_not_null_public_raw_location_data_type .............. [RUN]
[0m23:45:20.133885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m23:45:20.135677 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m23:45:20.134887 [info ] [Thread-4 (]: 29 of 33 PASS source_not_null_public_raw_housing_prices_region ................. [[32mPASS[0m in 0.06s]
[0m23:45:20.136597 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:45:20.137145 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:45:20.137616 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:45:20.138280 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:45:20.142960 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:45:20.143507 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: BEGIN
[0m23:45:20.148218 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:45:20.148797 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:45:20.149536 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:45:20.150221 [info ] [Thread-4 (]: 33 of 33 START test valid_values_stg_location_data_type__URBAN__RURAL .......... [RUN]
[0m23:45:20.150743 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:45:20.151510 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:45:20.152474 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91)
[0m23:45:20.155536 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:45:20.158777 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:45:20.159542 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:45:20.160064 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:45:20.161113 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:45:20.161654 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:45:20.167406 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:45:20.170590 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:45:20.171186 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: BEGIN
[0m23:45:20.171668 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: BEGIN
[0m23:45:20.172167 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."raw_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:45:20.172871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:20.173359 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:45:20.173785 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:45:20.177911 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:45:20.178417 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:45:20.179997 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: ROLLBACK
[0m23:45:20.180723 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:45:20.181297 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: Close
[0m23:45:20.182016 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: BEGIN
[0m23:45:20.183247 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:45:20.183802 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:45:20.184166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:45:20.182890 [info ] [Thread-3 (]: 30 of 33 PASS source_not_null_public_raw_location_data_postcode ................ [[32mPASS[0m in 0.07s]
[0m23:45:20.185025 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:45:20.185526 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:45:20.186206 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:45:20.186770 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."raw_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:45:20.187609 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:45:20.190065 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:45:20.190937 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:45:20.192506 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: ROLLBACK
[0m23:45:20.195176 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: ROLLBACK
[0m23:45:20.195853 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m23:45:20.196574 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:45:20.197036 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: Close
[0m23:45:20.197583 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    SELECT *
    FROM "dwh"."public"."stg_location_data"
    WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'UNKNOWN'

  
  
      
    ) dbt_internal_test
[0m23:45:20.198071 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: Close
[0m23:45:20.198984 [info ] [Thread-1 (]: 31 of 33 PASS source_not_null_public_raw_location_data_region .................. [[32mPASS[0m in 0.07s]
[0m23:45:20.200304 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:45:20.201341 [info ] [Thread-2 (]: 32 of 33 PASS source_not_null_public_raw_location_data_type .................... [[32mPASS[0m in 0.07s]
[0m23:45:20.202949 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:45:20.216694 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.018 seconds
[0m23:45:20.219052 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: ROLLBACK
[0m23:45:20.219892 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: Close
[0m23:45:20.220816 [error] [Thread-4 (]: 33 of 33 FAIL 3766 valid_values_stg_location_data_type__URBAN__RURAL ........... [[31mFAIL 3766[0m in 0.07s]
[0m23:45:20.221680 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:45:20.224288 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:20.224811 [debug] [MainThread]: On master: BEGIN
[0m23:45:20.225164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:20.233576 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:45:20.234068 [debug] [MainThread]: On master: COMMIT
[0m23:45:20.234445 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:20.234826 [debug] [MainThread]: On master: COMMIT
[0m23:45:20.235310 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:45:20.235739 [debug] [MainThread]: On master: Close
[0m23:45:20.236435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:20.236887 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e' was properly closed.
[0m23:45:20.237339 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522' was properly closed.
[0m23:45:20.237774 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c' was properly closed.
[0m23:45:20.238136 [debug] [MainThread]: Connection 'test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91' was properly closed.
[0m23:45:20.238571 [info ] [MainThread]: 
[0m23:45:20.238965 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m23:45:20.245168 [debug] [MainThread]: Command end result
[0m23:45:20.283370 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:45:20.285055 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:45:20.293290 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:45:20.293654 [info ] [MainThread]: 
[0m23:45:20.294041 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:45:20.294377 [info ] [MainThread]: 
[0m23:45:20.295031 [error] [MainThread]:   Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  column "total_locations" does not exist
  LINE 16: select total_locations
                  ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:45:20.295454 [info ] [MainThread]: 
[0m23:45:20.296087 [error] [MainThread]: [31mFailure in test valid_values_stg_location_data_type__URBAN__RURAL (models/airflow_dbt_training/silver/schema.yml)[0m
[0m23:45:20.296702 [error] [MainThread]:   Got 3766 results, configured to fail if != 0
[0m23:45:20.297157 [info ] [MainThread]: 
[0m23:45:20.297773 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/silver/schema.yml/valid_values_stg_location_data_type__URBAN__RURAL.sql
[0m23:45:20.298374 [info ] [MainThread]: 
[0m23:45:20.298873 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=2 SKIP=0 TOTAL=33
[0m23:45:20.300066 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.6573267, "process_in_blocks": "0", "process_kernel_time": 0.223859, "process_mem_max_rss": "123556", "process_out_blocks": "3064", "process_user_time": 2.822572}
[0m23:45:20.300564 [debug] [MainThread]: Command `dbt test` failed at 23:45:20.300449 after 1.66 seconds
[0m23:45:20.300950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74fb98450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74fb98d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74c942dd0>]}
[0m23:45:20.301438 [debug] [MainThread]: Flushing usage events
[0m23:45:20.854459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:46:37.543405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90858c1f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90858c20d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f908590f610>]}


============================== 23:46:37.546379 | df95a10a-5806-499b-9ac5-e60e66dbd890 ==============================
[0m23:46:37.546379 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:46:37.546960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:46:37.702465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90851847d0>]}
[0m23:46:37.758488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f908830f2d0>]}
[0m23:46:37.759226 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:46:37.841243 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:46:37.981676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:46:37.982404 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/gold/region_type_composition_with_macro.sql
[0m23:46:38.429026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f908353e5d0>]}
[0m23:46:38.527764 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:46:38.530368 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:46:38.542705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9083983d10>]}
[0m23:46:38.543185 [info ] [MainThread]: Found 9 models, 33 data tests, 2 sources, 436 macros
[0m23:46:38.543527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9085196e50>]}
[0m23:46:38.546911 [info ] [MainThread]: 
[0m23:46:38.547401 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:38.548066 [info ] [MainThread]: 
[0m23:46:38.549013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:46:38.555224 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:46:38.640346 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:46:38.640726 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:46:38.641004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:38.648770 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m23:46:38.650064 [debug] [ThreadPool]: On list_dwh: Close
[0m23:46:38.651835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:46:38.658047 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:46:38.658385 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:46:38.658646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:38.665327 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:46:38.665748 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:46:38.666101 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:46:38.668754 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:46:38.670291 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:46:38.670798 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:46:38.677945 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:38.678295 [debug] [MainThread]: On master: BEGIN
[0m23:46:38.678555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:38.685315 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:46:38.685696 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:38.686173 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:38.690875 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m23:46:38.693620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90839c7e10>]}
[0m23:46:38.694054 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:38.694567 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:38.694874 [debug] [MainThread]: On master: BEGIN
[0m23:46:38.695599 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:46:38.695995 [debug] [MainThread]: On master: COMMIT
[0m23:46:38.696263 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:38.696516 [debug] [MainThread]: On master: COMMIT
[0m23:46:38.696930 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:38.697218 [debug] [MainThread]: On master: Close
[0m23:46:38.700650 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:46:38.701078 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:46:38.701717 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m23:46:38.702563 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:46:38.703317 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m23:46:38.704394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:46:38.704955 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:46:38.705641 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m23:46:38.706702 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:46:38.707359 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:46:38.708457 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m23:46:38.709597 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:46:38.710229 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:46:38.716406 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:46:38.723118 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:46:38.723825 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:46:38.726600 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:46:38.727209 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:46:38.729802 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:46:38.734275 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:46:38.734735 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:46:38.735241 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:46:38.735932 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:46:38.741643 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:46:38.814060 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:46:38.815185 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:46:38.816077 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:46:38.819146 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:46:38.821041 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:46:38.821721 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:46:38.822297 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:46:38.822664 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:46:38.823148 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:46:38.823571 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:46:38.824006 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:46:38.824396 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:46:38.824826 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:46:38.825218 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:46:38.825631 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:46:38.826486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:38.832326 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m23:46:38.833058 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:46:38.833684 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:46:38.834196 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:38.834594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:38.835034 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:46:38.835492 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:46:38.835967 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:46:38.836416 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:46:38.836881 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:46:38.837493 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type,
    CASE
        WHEN LOWER("type") = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER("type") = LOWER('RURAL') THEN 'RURAL'
        ELSE 'RURAL'
    END as type_normalized
FROM source
  );
[0m23:46:38.838001 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:46:38.838440 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:46:38.845064 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:46:38.845670 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:46:38.847254 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:46:38.850807 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:46:38.851233 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m23:46:38.854410 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:46:38.854893 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:46:38.855365 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m23:46:38.858765 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:46:38.859208 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:46:38.859887 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:46:38.860432 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:38.861048 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:38.861610 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:38.862084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:38.865074 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:46:38.868368 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:46:38.872424 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:46:38.875476 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:46:38.875936 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:46:38.876407 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:46:38.876881 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:46:38.877340 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:46:38.878323 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:46:38.878765 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:38.879195 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:38.895338 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m23:46:38.902877 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:46:38.905985 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:46:38.907358 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:46:38.908688 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:46:38.909139 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:46:38.909590 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:46:38.910030 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:46:38.910479 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:46:38.910902 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:46:38.911344 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:46:38.911765 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:46:38.912208 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:46:38.915361 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m23:46:38.922116 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:46:38.922741 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m23:46:38.928334 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m23:46:38.927979 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:46:38.931219 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:46:38.931626 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m23:46:38.934225 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:46:38.934690 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:46:38.935350 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:46:38.937956 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:46:38.938594 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:46:38.939136 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:46:38.939784 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:46:38.940233 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:46:38.940806 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:46:38.942037 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:46:38.944385 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:46:38.944790 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:46:38.948098 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:46:38.948571 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9085915310>]}
[0m23:46:38.949111 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m23:46:38.949707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9083d9e850>]}
[0m23:46:38.950404 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.24s]
[0m23:46:38.950911 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.010 seconds
[0m23:46:38.952439 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:46:38.953228 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m23:46:38.954021 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:46:38.955619 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:46:38.956480 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:46:38.957145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9083441c10>]}
[0m23:46:38.958179 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9083d875d0>]}
[0m23:46:38.959146 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.25s]
[0m23:46:38.959976 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.24s]
[0m23:46:38.960696 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:46:38.961343 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:46:38.962312 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:46:38.963390 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.stg_housing_prices)
[0m23:46:38.963940 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:46:38.964328 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:46:38.964737 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:46:38.965364 [info ] [Thread-1 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m23:46:38.969379 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:46:38.970058 [info ] [Thread-4 (]: 6 of 8 START sql view model public.region_type_composition_with_macro .......... [RUN]
[0m23:46:38.970686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.region_type_composition)
[0m23:46:38.971487 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.region_type_composition_with_macro)
[0m23:46:38.972141 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:46:38.972820 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:46:38.973246 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:46:38.976857 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:46:38.981429 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:46:38.982225 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:46:38.983397 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:46:38.983804 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:46:38.984647 [info ] [Thread-2 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:46:38.988696 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:46:38.994500 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:46:38.995113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.incremental_prices)
[0m23:46:38.995941 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:46:39.010391 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:46:39.011110 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:46:39.011996 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:46:39.012662 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:46:39.013123 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:46:39.013596 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition_with_macro: BEGIN
[0m23:46:39.014059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:39.019840 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:39.063942 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:39.064841 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp234639046256"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:46:39.065592 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:39.066047 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m23:46:39.066498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m23:46:39.067106 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:46:39.067542 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:46:39.068089 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */

  create view "dwh"."public"."region_type_composition_with_macro__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        ELSE 'UNKNOWN'
    END = 'URBAN') AS urban_count,
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'RURAL') AS rural_count
  ,
    COUNT(*) AS total_count

  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  total_count AS total_locations
  ROUND(urban_count * 1.0 / total_count, 2) AS pct_urban
FROM type_counts
  );
[0m23:46:39.068639 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  total_locations as total_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:46:39.069491 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "ROUND"
LINE 33:   ROUND(urban_count * 1.0 / total_count, 2) AS pct_urban
           ^

[0m23:46:39.069865 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition_with_macro: ROLLBACK
[0m23:46:39.070500 [debug] [Thread-4 (]: On model.airflow_dbt_training.region_type_composition_with_macro: Close
[0m23:46:39.070881 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:46:39.074488 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:46:39.076142 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m23:46:39.077180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:39.078802 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:46:39.079275 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:46:39.079745 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:46:39.082127 [debug] [Thread-4 (]: Database Error in model region_type_composition_with_macro (models/airflow_dbt_training/gold/region_type_composition_with_macro.sql)
  syntax error at or near "ROUND"
  LINE 33:   ROUND(urban_count * 1.0 / total_count, 2) AS pct_urban
             ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/region_type_composition_with_macro.sql
[0m23:46:39.082684 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9082992dd0>]}
[0m23:46:39.083082 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:46:39.083768 [error] [Thread-4 (]: 6 of 8 ERROR creating sql view model public.region_type_composition_with_macro . [[31mERROR[0m in 0.11s]
[0m23:46:39.087024 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m23:46:39.087764 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:46:39.088572 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:46:39.089421 [debug] [Thread-7 (]: Marking all children of 'model.airflow_dbt_training.region_type_composition_with_macro' to be skipped because of status 'error'.  Reason: Database Error in model region_type_composition_with_macro (models/airflow_dbt_training/gold/region_type_composition_with_macro.sql)
  syntax error at or near "ROUND"
  LINE 33:   ROUND(urban_count * 1.0 / total_count, 2) AS pct_urban
             ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/region_type_composition_with_macro.sql.
[0m23:46:39.089896 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m23:46:39.091438 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:46:39.092898 [debug] [Thread-1 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:46:39.093516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9082a4cd50>]}
[0m23:46:39.094129 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.12s]
[0m23:46:39.094743 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:46:39.095512 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:46:39.096136 [info ] [Thread-3 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m23:46:39.096734 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m23:46:39.097209 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:46:39.105748 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:39.106420 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:46:39.110779 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:39.111273 [debug] [Thread-2 (]: SQL status: SELECT 10500 in 0.046 seconds
[0m23:46:39.127561 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:39.128091 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:46:39.128555 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:39.128922 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m23:46:39.129309 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m23:46:39.129690 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:39.130145 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:39.130815 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp234639046256'
        
      order by ordinal_position

  
[0m23:46:39.136519 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:46:39.142573 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:46:39.144335 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:39.144770 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:39.145253 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:46:39.145808 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m23:46:39.148352 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:46:39.151552 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:39.151961 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.006 seconds
[0m23:46:39.152398 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m23:46:39.160971 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:39.161566 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:46:39.161996 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:39.163341 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:46:39.163711 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:39.164049 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:46:39.164774 [debug] [Thread-2 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:46:39.172095 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m23:46:39.173959 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:46:39.176721 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m23:46:39.177483 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:39.178206 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:39.178695 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp234639046256"
    )


  
[0m23:46:39.179201 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m23:46:39.180022 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:46:39.181366 [debug] [Thread-3 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m23:46:39.181974 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9082a742d0>]}
[0m23:46:39.182590 [info ] [Thread-3 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.09s]
[0m23:46:39.183197 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:46:39.186302 [debug] [Thread-2 (]: SQL status: INSERT 0 10500 in 0.007 seconds
[0m23:46:39.188130 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:46:39.188641 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:39.189020 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:46:39.194006 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m23:46:39.195343 [debug] [Thread-2 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:46:39.196005 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df95a10a-5806-499b-9ac5-e60e66dbd890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9082980690>]}
[0m23:46:39.196676 [info ] [Thread-2 (]: 7 of 8 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 10500[0m in 0.20s]
[0m23:46:39.197252 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:46:39.199397 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:39.199942 [debug] [MainThread]: On master: BEGIN
[0m23:46:39.200287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:39.207222 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:46:39.207624 [debug] [MainThread]: On master: COMMIT
[0m23:46:39.207968 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:39.208255 [debug] [MainThread]: On master: COMMIT
[0m23:46:39.208664 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:39.208968 [debug] [MainThread]: On master: Close
[0m23:46:39.209416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:39.209671 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:46:39.209930 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:46:39.210169 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m23:46:39.210409 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition_with_macro' was properly closed.
[0m23:46:39.210846 [info ] [MainThread]: 
[0m23:46:39.211311 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m23:46:39.213703 [debug] [MainThread]: Command end result
[0m23:46:39.249161 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:46:39.250757 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:46:39.256670 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:46:39.256978 [info ] [MainThread]: 
[0m23:46:39.257331 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:46:39.257640 [info ] [MainThread]: 
[0m23:46:39.258227 [error] [MainThread]:   Database Error in model region_type_composition_with_macro (models/airflow_dbt_training/gold/region_type_composition_with_macro.sql)
  syntax error at or near "ROUND"
  LINE 33:   ROUND(urban_count * 1.0 / total_count, 2) AS pct_urban
             ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/region_type_composition_with_macro.sql
[0m23:46:39.258764 [info ] [MainThread]: 
[0m23:46:39.259099 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m23:46:39.260267 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7688845, "process_in_blocks": "0", "process_kernel_time": 0.14952, "process_mem_max_rss": "127412", "process_out_blocks": "3456", "process_user_time": 2.910668}
[0m23:46:39.260737 [debug] [MainThread]: Command `dbt run` failed at 23:46:39.260640 after 1.77 seconds
[0m23:46:39.261099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f908590fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9089c4c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90869d2a90>]}
[0m23:46:39.261489 [debug] [MainThread]: Flushing usage events
[0m23:46:39.983800 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:46:41.657231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fd001c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fcff6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fd001a50>]}


============================== 23:46:41.660162 | cc1e603b-2953-4b75-ad36-342c9fe32775 ==============================
[0m23:46:41.660162 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:46:41.660709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:46:41.812961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc1e603b-2953-4b75-ad36-342c9fe32775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fcff60d0>]}
[0m23:46:41.870249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc1e603b-2953-4b75-ad36-342c9fe32775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ffa4d410>]}
[0m23:46:41.871005 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:46:41.948215 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:46:42.075278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:42.075661 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:42.126324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc1e603b-2953-4b75-ad36-342c9fe32775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fcb85650>]}
[0m23:46:42.227153 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:46:42.229913 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:46:42.253025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc1e603b-2953-4b75-ad36-342c9fe32775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fb36b5d0>]}
[0m23:46:42.253524 [info ] [MainThread]: Found 9 models, 33 data tests, 2 sources, 436 macros
[0m23:46:42.253878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc1e603b-2953-4b75-ad36-342c9fe32775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fd054690>]}
[0m23:46:42.258593 [info ] [MainThread]: 
[0m23:46:42.259328 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:42.259978 [info ] [MainThread]: 
[0m23:46:42.261003 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:46:42.267945 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m23:46:42.309066 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:46:42.309435 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:46:42.309713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:42.316792 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:46:42.317158 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:46:42.317493 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:46:42.320016 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m23:46:42.321372 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:46:42.321848 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:46:42.328782 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:42.329115 [debug] [MainThread]: On master: BEGIN
[0m23:46:42.329367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:42.335785 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:46:42.336132 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:42.336610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:42.341094 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m23:46:42.343602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc1e603b-2953-4b75-ad36-342c9fe32775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fcb56bd0>]}
[0m23:46:42.344016 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:42.344486 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:42.344784 [debug] [MainThread]: On master: BEGIN
[0m23:46:42.345372 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:46:42.345667 [debug] [MainThread]: On master: COMMIT
[0m23:46:42.345938 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:42.346193 [debug] [MainThread]: On master: COMMIT
[0m23:46:42.346601 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:42.346889 [debug] [MainThread]: On master: Close
[0m23:46:42.350691 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:46:42.351146 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:46:42.351619 [info ] [Thread-1 (]: 1 of 33 START test accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [RUN]
[0m23:46:42.352188 [info ] [Thread-2 (]: 2 of 33 START test accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [RUN]
[0m23:46:42.352816 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:46:42.353332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m23:46:42.353792 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:46:42.354645 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e'
[0m23:46:42.355184 [info ] [Thread-3 (]: 3 of 33 START test not_null_mart_housing_prices_breakdown_avg_price ............ [RUN]
[0m23:46:42.355816 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:46:42.356341 [info ] [Thread-4 (]: 4 of 33 START test not_null_mart_housing_prices_breakdown_n_sales .............. [RUN]
[0m23:46:42.356888 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:46:42.357533 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d'
[0m23:46:42.363493 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7'
[0m23:46:42.386175 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:46:42.388450 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:46:42.388920 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:46:42.389356 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:46:42.394006 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:46:42.403020 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:46:42.407040 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:46:42.411275 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:46:42.412243 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:46:42.413359 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:46:42.413936 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:46:42.440603 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:46:42.449190 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:46:42.451264 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:46:42.454187 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:46:42.456738 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:46:42.458039 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:46:42.458782 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:46:42.459421 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: BEGIN
[0m23:46:42.459996 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: BEGIN
[0m23:46:42.460545 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:46:42.460954 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:46:42.461317 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:46:42.461735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:42.462168 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: BEGIN
[0m23:46:42.462587 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: BEGIN
[0m23:46:42.463466 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:46:42.464001 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:46:42.469743 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:42.470494 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:46:42.470929 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:46:42.471601 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:46:42.472146 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:46:42.472568 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:46:42.473038 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        month as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by month

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','7','8','9','10','11','12'
)



  
  
      
    ) dbt_internal_test
[0m23:46:42.473672 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        day_of_week as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by day_of_week

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m23:46:42.474190 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:46:42.474603 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:46:42.475365 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_price
from "dwh"."public"."mart_housing_prices_breakdown"
where avg_price is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.476033 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select n_sales
from "dwh"."public"."mart_housing_prices_breakdown"
where n_sales is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.481619 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:46:42.482404 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:46:42.486616 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: ROLLBACK
[0m23:46:42.487009 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:46:42.487541 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:46:42.489379 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: ROLLBACK
[0m23:46:42.490871 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: ROLLBACK
[0m23:46:42.491334 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: Close
[0m23:46:42.492694 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: ROLLBACK
[0m23:46:42.493272 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: Close
[0m23:46:42.493722 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: Close
[0m23:46:42.494534 [info ] [Thread-2 (]: 2 of 33 PASS accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [[32mPASS[0m in 0.14s]
[0m23:46:42.495526 [info ] [Thread-3 (]: 3 of 33 PASS not_null_mart_housing_prices_breakdown_avg_price .................. [[32mPASS[0m in 0.14s]
[0m23:46:42.496160 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: Close
[0m23:46:42.496926 [info ] [Thread-4 (]: 4 of 33 PASS not_null_mart_housing_prices_breakdown_n_sales .................... [[32mPASS[0m in 0.13s]
[0m23:46:42.497795 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:46:42.498533 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:46:42.499299 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:46:42.500111 [info ] [Thread-1 (]: 1 of 33 PASS accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [[32mPASS[0m in 0.15s]
[0m23:46:42.500882 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:46:42.501575 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:46:42.502165 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:46:42.503067 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:46:42.503666 [info ] [Thread-2 (]: 5 of 33 START test not_null_mart_housing_prices_breakdown_region ............... [RUN]
[0m23:46:42.504272 [info ] [Thread-3 (]: 6 of 33 START test not_null_region_type_composition_pct_urban .................. [RUN]
[0m23:46:42.504901 [info ] [Thread-4 (]: 7 of 33 START test not_null_region_type_composition_region ..................... [RUN]
[0m23:46:42.505671 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:46:42.506530 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m23:46:42.507161 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m23:46:42.507648 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m23:46:42.508195 [info ] [Thread-1 (]: 8 of 33 START test not_null_region_type_composition_rural_count ................ [RUN]
[0m23:46:42.508855 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:46:42.509514 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:46:42.510079 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:46:42.510616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m23:46:42.516722 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:46:42.523159 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:46:42.583252 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:46:42.583784 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:46:42.584738 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:46:42.585527 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:46:42.589777 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:46:42.593025 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:46:42.593475 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:46:42.596092 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:46:42.599666 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:46:42.600167 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:46:42.600584 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:46:42.601518 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: BEGIN
[0m23:46:42.602052 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:46:42.602499 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:46:42.605262 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:46:42.605748 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:42.606170 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: BEGIN
[0m23:46:42.606619 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: BEGIN
[0m23:46:42.607565 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:42.608039 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:46:42.608497 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:42.609329 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: BEGIN
[0m23:46:42.610092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:42.613812 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:42.614267 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:46:42.615140 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."mart_housing_prices_breakdown"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.616409 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:46:42.616903 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:42.617353 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:46:42.617775 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:42.618224 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:46:42.618677 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:46:42.619133 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.619611 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:46:42.620096 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.621708 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: ROLLBACK
[0m23:46:42.622352 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.623207 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: Close
[0m23:46:42.623936 [info ] [Thread-2 (]: 5 of 33 PASS not_null_mart_housing_prices_breakdown_region ..................... [[32mPASS[0m in 0.12s]
[0m23:46:42.624648 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:46:42.625202 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:46:42.625790 [info ] [Thread-2 (]: 9 of 33 START test not_null_region_type_composition_total_count ................ [RUN]
[0m23:46:42.626479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c, now test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7)
[0m23:46:42.627241 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:46:42.627861 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:46:42.632687 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:46:42.634614 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: ROLLBACK
[0m23:46:42.635588 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:46:42.636094 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: Close
[0m23:46:42.639199 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:46:42.640072 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:46:42.640649 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m23:46:42.642730 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: ROLLBACK
[0m23:46:42.643424 [info ] [Thread-4 (]: 7 of 33 PASS not_null_region_type_composition_region ........................... [[32mPASS[0m in 0.14s]
[0m23:46:42.644135 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:46:42.646036 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: ROLLBACK
[0m23:46:42.646895 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:46:42.647370 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: Close
[0m23:46:42.647795 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: BEGIN
[0m23:46:42.648511 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:46:42.649142 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: Close
[0m23:46:42.649899 [info ] [Thread-3 (]: 6 of 33 PASS not_null_region_type_composition_pct_urban ........................ [[32mPASS[0m in 0.14s]
[0m23:46:42.650394 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:42.650942 [info ] [Thread-4 (]: 10 of 33 START test not_null_region_type_composition_urban_count ............... [RUN]
[0m23:46:42.652465 [info ] [Thread-1 (]: 8 of 33 PASS not_null_region_type_composition_rural_count ...................... [[32mPASS[0m in 0.14s]
[0m23:46:42.653533 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:46:42.654755 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m23:46:42.655610 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:46:42.656178 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:46:42.656798 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:46:42.657450 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:46:42.658286 [info ] [Thread-3 (]: 11 of 33 START test not_null_region_type_composition_with_macro_pct_urban ...... [RUN]
[0m23:46:42.663492 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:46:42.664792 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m23:46:42.664315 [info ] [Thread-1 (]: 12 of 33 START test not_null_region_type_composition_with_macro_region ......... [RUN]
[0m23:46:42.665490 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91)
[0m23:46:42.666170 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:46:42.666941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192)
[0m23:46:42.667437 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:46:42.668005 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:46:42.668532 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_count
from "dwh"."public"."region_type_composition"
where total_count is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.669014 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:46:42.672135 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:46:42.676758 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:46:42.683366 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:46:42.684717 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:46:42.685456 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:46:42.686183 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:46:42.686575 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:46:42.687016 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: BEGIN
[0m23:46:42.688756 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: ROLLBACK
[0m23:46:42.691917 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:46:42.694751 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:46:42.695307 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:42.695927 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: Close
[0m23:46:42.697178 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:46:42.697654 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:46:42.698385 [info ] [Thread-2 (]: 9 of 33 PASS not_null_region_type_composition_total_count ...................... [[32mPASS[0m in 0.07s]
[0m23:46:42.699096 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: BEGIN
[0m23:46:42.699655 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: BEGIN
[0m23:46:42.700426 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:46:42.700929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:42.701399 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:42.702032 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:46:42.703580 [info ] [Thread-2 (]: 13 of 33 START test not_null_region_type_composition_with_macro_rural_count .... [RUN]
[0m23:46:42.704427 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:46:42.705204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797)
[0m23:46:42.705816 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:46:42.706527 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:46:42.707134 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.712205 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:46:42.713524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:46:42.714172 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:46:42.714763 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:46:42.715463 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition_with_macro"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.716037 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:46:42.716431 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:46:42.719707 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:46:42.720420 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.region_type_composition_with_macro" does not exist
LINE 17: from "dwh"."public"."region_type_composition_with_macro"
              ^

[0m23:46:42.720987 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition_with_macro"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.721734 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: ROLLBACK
[0m23:46:42.722299 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:46:42.722915 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: BEGIN
[0m23:46:42.723356 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.region_type_composition_with_macro" does not exist
LINE 17: from "dwh"."public"."region_type_composition_with_macro"
              ^

[0m23:46:42.723758 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:42.724356 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: Close
[0m23:46:42.724982 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: ROLLBACK
[0m23:46:42.725506 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:46:42.728893 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: ROLLBACK
[0m23:46:42.729647 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: Close
[0m23:46:42.730564 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: Close
[0m23:46:42.731587 [info ] [Thread-4 (]: 10 of 33 PASS not_null_region_type_composition_urban_count ..................... [[32mPASS[0m in 0.08s]
[0m23:46:42.734277 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:46:42.735041 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:46:42.735465 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m23:46:42.736187 [info ] [Thread-4 (]: 14 of 33 START test not_null_region_type_composition_with_macro_total_locations  [RUN]
[0m23:46:42.737842 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:46:42.739678 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae)
[0m23:46:42.741120 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition_with_macro"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.744236 [debug] [Thread-1 (]: Database Error in test not_null_region_type_composition_with_macro_region (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_region.sql
[0m23:46:42.745983 [debug] [Thread-3 (]: Database Error in test not_null_region_type_composition_with_macro_pct_urban (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_pct_urban.sql
[0m23:46:42.746541 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:46:42.747283 [error] [Thread-1 (]: 12 of 33 ERROR not_null_region_type_composition_with_macro_region .............. [[31mERROR[0m in 0.08s]
[0m23:46:42.748076 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.region_type_composition_with_macro" does not exist
LINE 17: from "dwh"."public"."region_type_composition_with_macro"
              ^

[0m23:46:42.748967 [error] [Thread-3 (]: 11 of 33 ERROR not_null_region_type_composition_with_macro_pct_urban ........... [[31mERROR[0m in 0.08s]
[0m23:46:42.754486 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:46:42.755504 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:46:42.756015 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: ROLLBACK
[0m23:46:42.756712 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:46:42.757599 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:46:42.758099 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:46:42.758797 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_with_macro_region (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_region.sql.
[0m23:46:42.759413 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:46:42.760005 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: Close
[0m23:46:42.760527 [info ] [Thread-1 (]: 15 of 33 START test not_null_region_type_composition_with_macro_urban_count .... [RUN]
[0m23:46:42.764039 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:46:42.765414 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_with_macro_pct_urban (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_pct_urban.sql.
[0m23:46:42.765953 [info ] [Thread-3 (]: 16 of 33 START test not_null_stg_housing_prices_date ........................... [RUN]
[0m23:46:42.766968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224)
[0m23:46:42.769967 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:46:42.771985 [debug] [Thread-2 (]: Database Error in test not_null_region_type_composition_with_macro_rural_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_rural_count.sql
[0m23:46:42.772608 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m23:46:42.773362 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:46:42.773950 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: BEGIN
[0m23:46:42.774575 [error] [Thread-2 (]: 13 of 33 ERROR not_null_region_type_composition_with_macro_rural_count ......... [[31mERROR[0m in 0.07s]
[0m23:46:42.775203 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:46:42.780497 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:46:42.781102 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:42.781823 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:46:42.787512 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:46:42.788734 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:46:42.789166 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:46:42.789781 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_with_macro_rural_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_rural_count.sql.
[0m23:46:42.790993 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:46:42.790461 [info ] [Thread-2 (]: 17 of 33 START test not_null_stg_housing_prices_day_of_week .................... [RUN]
[0m23:46:42.795158 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:46:42.798841 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:46:42.799427 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m23:46:42.799916 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m23:46:42.801151 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:46:42.801663 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:46:42.802107 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:46:42.802581 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:46:42.803046 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: BEGIN
[0m23:46:42.803546 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_locations
from "dwh"."public"."region_type_composition_with_macro"
where total_locations is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.804046 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: BEGIN
[0m23:46:42.809542 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:46:42.810102 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:42.810706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:42.813169 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.region_type_composition_with_macro" does not exist
LINE 17: from "dwh"."public"."region_type_composition_with_macro"
              ^

[0m23:46:42.814399 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:46:42.815092 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: ROLLBACK
[0m23:46:42.818444 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:46:42.819320 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: Close
[0m23:46:42.819876 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:46:42.822086 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: BEGIN
[0m23:46:42.822740 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:42.823304 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:46:42.823759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:46:42.825782 [debug] [Thread-4 (]: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:46:42.826313 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:46:42.826788 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:46:42.827498 [error] [Thread-4 (]: 14 of 33 ERROR not_null_region_type_composition_with_macro_total_locations ..... [[31mERROR[0m in 0.09s]
[0m23:46:42.828171 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select date
from __dbt__cte__stg_housing_prices
where date is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.828793 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition_with_macro"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.829522 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:46:42.830249 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:46:42.830906 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql.
[0m23:46:42.831401 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.region_type_composition_with_macro" does not exist
LINE 17: from "dwh"."public"."region_type_composition_with_macro"
              ^

[0m23:46:42.832327 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:46:42.831922 [info ] [Thread-4 (]: 18 of 33 START test not_null_stg_housing_prices_id ............................. [RUN]
[0m23:46:42.833213 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: ROLLBACK
[0m23:46:42.833800 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:46:42.834387 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m23:46:42.834950 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:46:42.835541 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select day_of_week
from __dbt__cte__stg_housing_prices
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.836218 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: Close
[0m23:46:42.836754 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:46:42.838415 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: ROLLBACK
[0m23:46:42.847292 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:46:42.848229 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:46:42.850016 [debug] [Thread-1 (]: Database Error in test not_null_region_type_composition_with_macro_urban_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_urban_count.sql
[0m23:46:42.850407 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: Close
[0m23:46:42.852528 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: ROLLBACK
[0m23:46:42.853028 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:46:42.853661 [error] [Thread-1 (]: 15 of 33 ERROR not_null_region_type_composition_with_macro_urban_count ......... [[31mERROR[0m in 0.09s]
[0m23:46:42.855034 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: Close
[0m23:46:42.854556 [info ] [Thread-3 (]: 16 of 33 PASS not_null_stg_housing_prices_date ................................. [[32mPASS[0m in 0.08s]
[0m23:46:42.858827 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:46:42.859653 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:46:42.860405 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:46:42.861176 [info ] [Thread-2 (]: 17 of 33 PASS not_null_stg_housing_prices_day_of_week .......................... [[32mPASS[0m in 0.06s]
[0m23:46:42.862041 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:46:42.862760 [debug] [Thread-7 (]: Marking all children of 'test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224' to be skipped because of status 'error'.  Reason: Database Error in test not_null_region_type_composition_with_macro_urban_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_urban_count.sql.
[0m23:46:42.863275 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:46:42.863777 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:46:42.864494 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:46:42.865003 [info ] [Thread-1 (]: 19 of 33 START test not_null_stg_housing_prices_month .......................... [RUN]
[0m23:46:42.865846 [info ] [Thread-3 (]: 20 of 33 START test not_null_stg_housing_prices_price .......................... [RUN]
[0m23:46:42.866490 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: BEGIN
[0m23:46:42.867106 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:46:42.867808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m23:46:42.868334 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m23:46:42.868782 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:42.869250 [info ] [Thread-2 (]: 21 of 33 START test not_null_stg_housing_prices_region ......................... [RUN]
[0m23:46:42.869882 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:46:42.870526 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:46:42.871408 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m23:46:42.878566 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:46:42.884554 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m23:46:42.885150 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:46:42.885651 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:46:42.886277 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:46:42.887014 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:46:42.892914 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:46:42.893470 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select id
from __dbt__cte__stg_housing_prices
where id is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.893983 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:46:42.897000 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:46:42.898007 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:46:42.900849 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:46:42.901459 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:46:42.904300 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:46:42.904973 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:46:42.906528 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: ROLLBACK
[0m23:46:42.906961 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:46:42.907570 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: BEGIN
[0m23:46:42.908179 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: BEGIN
[0m23:46:42.908574 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:46:42.909011 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: Close
[0m23:46:42.909387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:42.909813 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:42.910218 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: BEGIN
[0m23:46:42.911091 [info ] [Thread-4 (]: 18 of 33 PASS not_null_stg_housing_prices_id ................................... [[32mPASS[0m in 0.08s]
[0m23:46:42.911938 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:42.912903 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:46:42.913731 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:46:42.914405 [info ] [Thread-4 (]: 22 of 33 START test not_null_stg_housing_prices_year ........................... [RUN]
[0m23:46:42.915046 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m23:46:42.915529 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:46:42.921255 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:46:42.922702 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:46:42.923334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:46:42.923710 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m23:46:42.926762 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:46:42.927248 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m23:46:42.927744 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:46:42.928178 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:46:42.928798 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:46:42.929390 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select month
from __dbt__cte__stg_housing_prices
where month is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.929899 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:46:42.930650 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select price
from __dbt__cte__stg_housing_prices
where price is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.931376 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select region
from __dbt__cte__stg_housing_prices
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.932078 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: BEGIN
[0m23:46:42.932777 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:42.934288 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:46:42.935782 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: ROLLBACK
[0m23:46:42.936340 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:46:42.936806 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: Close
[0m23:46:42.938615 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: ROLLBACK
[0m23:46:42.939161 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:46:42.939985 [info ] [Thread-2 (]: 21 of 33 PASS not_null_stg_housing_prices_region ............................... [[32mPASS[0m in 0.07s]
[0m23:46:42.940692 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: Close
[0m23:46:42.942159 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: ROLLBACK
[0m23:46:42.942608 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m23:46:42.943336 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:46:42.944606 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: Close
[0m23:46:42.944170 [info ] [Thread-3 (]: 20 of 33 PASS not_null_stg_housing_prices_price ................................ [[32mPASS[0m in 0.08s]
[0m23:46:42.945470 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:46:42.946204 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:46:42.947204 [info ] [Thread-1 (]: 19 of 33 PASS not_null_stg_housing_prices_month ................................ [[32mPASS[0m in 0.08s]
[0m23:46:42.947918 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:46:42.948614 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select year
from __dbt__cte__stg_housing_prices
where year is null



  
  
      
    ) dbt_internal_test
[0m23:46:42.949358 [info ] [Thread-2 (]: 23 of 33 START test not_null_stg_location_data_postcode ........................ [RUN]
[0m23:46:42.950187 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:46:42.950753 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:46:42.951566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m23:46:42.952278 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:46:42.953376 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:46:42.952915 [info ] [Thread-3 (]: 24 of 33 START test not_null_stg_location_data_region .......................... [RUN]
[0m23:46:42.953942 [info ] [Thread-1 (]: 25 of 33 START test not_null_stg_location_data_type ............................ [RUN]
[0m23:46:42.959831 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:46:42.962140 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:46:42.962707 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m23:46:42.963227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m23:46:42.964838 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: ROLLBACK
[0m23:46:42.965557 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:46:42.966055 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:46:42.966510 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:46:42.971424 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:46:42.971906 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: Close
[0m23:46:42.976548 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:46:42.979560 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:46:42.980769 [info ] [Thread-4 (]: 22 of 33 PASS not_null_stg_housing_prices_year ................................. [[32mPASS[0m in 0.07s]
[0m23:46:42.981401 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:46:42.982336 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:46:42.982893 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:46:42.986152 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:46:42.986792 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:46:42.989824 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:46:42.990409 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:46:42.991295 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: BEGIN
[0m23:46:42.992083 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:46:42.992693 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:46:42.993162 [info ] [Thread-4 (]: 26 of 33 START test source_not_null_public_raw_housing_prices_date ............. [RUN]
[0m23:46:42.993978 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:42.994453 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: BEGIN
[0m23:46:42.994949 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: BEGIN
[0m23:46:42.995486 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m23:46:42.996168 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:42.996601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:42.997257 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:46:43.002979 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:46:43.004055 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:46:43.004779 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:46:43.007675 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:46:43.008508 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:46:43.009204 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:46:43.009601 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:46:43.010258 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."stg_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:46:43.010879 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:46:43.011407 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:46:43.011925 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:46:43.012517 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."stg_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:46:43.012981 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: BEGIN
[0m23:46:43.013460 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."stg_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:43.013912 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:46:43.014416 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:43.017017 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: ROLLBACK
[0m23:46:43.018022 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: Close
[0m23:46:43.019425 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:46:43.018934 [info ] [Thread-2 (]: 23 of 33 PASS not_null_stg_location_data_postcode .............................. [[32mPASS[0m in 0.07s]
[0m23:46:43.020202 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:46:43.021814 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: ROLLBACK
[0m23:46:43.022579 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:46:43.024194 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: ROLLBACK
[0m23:46:43.025196 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:46:43.025766 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: Close
[0m23:46:43.026184 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:46:43.027407 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: Close
[0m23:46:43.026885 [info ] [Thread-2 (]: 27 of 33 START test source_not_null_public_raw_housing_prices_id ............... [RUN]
[0m23:46:43.029426 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:46:43.028818 [info ] [Thread-1 (]: 25 of 33 PASS not_null_stg_location_data_type .................................. [[32mPASS[0m in 0.07s]
[0m23:46:43.030404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m23:46:43.031132 [info ] [Thread-3 (]: 24 of 33 PASS not_null_stg_location_data_region ................................ [[32mPASS[0m in 0.07s]
[0m23:46:43.031768 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "dwh"."public"."raw_housing_prices"
where date is null



  
  
      
    ) dbt_internal_test
[0m23:46:43.032460 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:46:43.032906 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:46:43.033561 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:46:43.034336 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:46:43.039308 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:46:43.039954 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:46:43.040608 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:46:43.041304 [info ] [Thread-1 (]: 28 of 33 START test source_not_null_public_raw_housing_prices_price ............ [RUN]
[0m23:46:43.043361 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: ROLLBACK
[0m23:46:43.044004 [info ] [Thread-3 (]: 29 of 33 START test source_not_null_public_raw_housing_prices_region ........... [RUN]
[0m23:46:43.044577 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:46:43.045060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m23:46:43.045864 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m23:46:43.046471 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: Close
[0m23:46:43.049757 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:46:43.050398 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:46:43.050880 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:46:43.051807 [info ] [Thread-4 (]: 26 of 33 PASS source_not_null_public_raw_housing_prices_date ................... [[32mPASS[0m in 0.06s]
[0m23:46:43.057406 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:46:43.063527 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:46:43.065120 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:46:43.065947 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:46:43.066574 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: BEGIN
[0m23:46:43.067401 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:46:43.067963 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:46:43.068418 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:46:43.068903 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:43.072056 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:46:43.075039 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:46:43.075539 [info ] [Thread-4 (]: 30 of 33 START test source_not_null_public_raw_location_data_postcode .......... [RUN]
[0m23:46:43.077206 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m23:46:43.078430 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:46:43.079143 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:46:43.079616 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:46:43.084479 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:46:43.085135 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: BEGIN
[0m23:46:43.085752 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: BEGIN
[0m23:46:43.086213 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m23:46:43.086823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:43.087311 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:43.087850 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:46:43.088443 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:46:43.089485 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dwh"."public"."raw_housing_prices"
where id is null



  
  
      
    ) dbt_internal_test
[0m23:46:43.092995 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:46:43.093795 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:46:43.094348 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: BEGIN
[0m23:46:43.094913 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:43.095375 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:43.097501 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: ROLLBACK
[0m23:46:43.098185 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:46:43.098761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:46:43.099310 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:46:43.099768 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: Close
[0m23:46:43.100251 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:46:43.100885 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_housing_prices"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:43.101685 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dwh"."public"."raw_housing_prices"
where price is null



  
  
      
    ) dbt_internal_test
[0m23:46:43.102397 [info ] [Thread-2 (]: 27 of 33 PASS source_not_null_public_raw_housing_prices_id ..................... [[32mPASS[0m in 0.07s]
[0m23:46:43.103484 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:46:43.104035 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:46:43.105194 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:46:43.104656 [info ] [Thread-2 (]: 31 of 33 START test source_not_null_public_raw_location_data_region ............ [RUN]
[0m23:46:43.105841 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:46:43.107945 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: ROLLBACK
[0m23:46:43.108552 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m23:46:43.109042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m23:46:43.110822 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: ROLLBACK
[0m23:46:43.111453 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:46:43.111925 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: Close
[0m23:46:43.112452 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:46:43.113120 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."raw_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:46:43.113647 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: Close
[0m23:46:43.118529 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:46:43.119260 [info ] [Thread-3 (]: 29 of 33 PASS source_not_null_public_raw_housing_prices_region ................. [[32mPASS[0m in 0.07s]
[0m23:46:43.120489 [info ] [Thread-1 (]: 28 of 33 PASS source_not_null_public_raw_housing_prices_price .................. [[32mPASS[0m in 0.08s]
[0m23:46:43.121783 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:46:43.122346 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:46:43.123019 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:46:43.123445 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:46:43.123957 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:46:43.125719 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: ROLLBACK
[0m23:46:43.126457 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:46:43.129869 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:46:43.130476 [info ] [Thread-3 (]: 32 of 33 START test source_not_null_public_raw_location_data_type .............. [RUN]
[0m23:46:43.131297 [info ] [Thread-1 (]: 33 of 33 START test valid_values_stg_location_data_type__URBAN__RURAL .......... [RUN]
[0m23:46:43.132134 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: Close
[0m23:46:43.133026 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m23:46:43.133735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91)
[0m23:46:43.134419 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:46:43.135034 [info ] [Thread-4 (]: 30 of 33 PASS source_not_null_public_raw_location_data_postcode ................ [[32mPASS[0m in 0.06s]
[0m23:46:43.135543 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:46:43.136061 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:46:43.136735 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: BEGIN
[0m23:46:43.137482 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:46:43.142643 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:46:43.152180 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:46:43.152782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:43.153986 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:46:43.154734 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:46:43.158711 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:46:43.161665 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:46:43.162803 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:46:43.163340 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:46:43.163835 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:46:43.164422 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:43.164961 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:46:43.165406 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: BEGIN
[0m23:46:43.165969 [debug] [Thread-1 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: BEGIN
[0m23:46:43.166397 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:43.166991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:43.167843 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:46:43.169833 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: ROLLBACK
[0m23:46:43.170419 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: Close
[0m23:46:43.171100 [info ] [Thread-2 (]: 31 of 33 PASS source_not_null_public_raw_location_data_region .................. [[32mPASS[0m in 0.06s]
[0m23:46:43.171763 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:46:43.174756 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:43.175245 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:43.175795 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:46:43.176263 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:46:43.176790 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."raw_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:46:43.177306 [debug] [Thread-1 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    SELECT *
    FROM "dwh"."public"."stg_location_data"
    WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'UNKNOWN'

  
  
      
    ) dbt_internal_test
[0m23:46:43.179172 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:43.180947 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: ROLLBACK
[0m23:46:43.181677 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: Close
[0m23:46:43.182376 [info ] [Thread-3 (]: 32 of 33 PASS source_not_null_public_raw_location_data_type .................... [[32mPASS[0m in 0.05s]
[0m23:46:43.183026 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:46:43.191967 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:46:43.193769 [debug] [Thread-1 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: ROLLBACK
[0m23:46:43.194448 [debug] [Thread-1 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: Close
[0m23:46:43.195107 [error] [Thread-1 (]: 33 of 33 FAIL 3766 valid_values_stg_location_data_type__URBAN__RURAL ........... [[31mFAIL 3766[0m in 0.06s]
[0m23:46:43.195751 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:46:43.198116 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:43.198643 [debug] [MainThread]: On master: BEGIN
[0m23:46:43.199041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:43.206291 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:46:43.206691 [debug] [MainThread]: On master: COMMIT
[0m23:46:43.207009 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:43.207269 [debug] [MainThread]: On master: COMMIT
[0m23:46:43.207678 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:43.208002 [debug] [MainThread]: On master: Close
[0m23:46:43.208437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:43.208691 [debug] [MainThread]: Connection 'test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91' was properly closed.
[0m23:46:43.208941 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e' was properly closed.
[0m23:46:43.209196 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522' was properly closed.
[0m23:46:43.209496 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c' was properly closed.
[0m23:46:43.209876 [info ] [MainThread]: 
[0m23:46:43.210257 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m23:46:43.216463 [debug] [MainThread]: Command end result
[0m23:46:43.266135 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:46:43.267767 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:46:43.276690 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:46:43.277250 [info ] [MainThread]: 
[0m23:46:43.277654 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m23:46:43.277999 [info ] [MainThread]: 
[0m23:46:43.278700 [error] [MainThread]:   Database Error in test not_null_region_type_composition_with_macro_region (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_region.sql
[0m23:46:43.279171 [info ] [MainThread]: 
[0m23:46:43.279775 [error] [MainThread]:   Database Error in test not_null_region_type_composition_with_macro_pct_urban (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_pct_urban.sql
[0m23:46:43.280388 [info ] [MainThread]: 
[0m23:46:43.280996 [error] [MainThread]:   Database Error in test not_null_region_type_composition_with_macro_rural_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_rural_count.sql
[0m23:46:43.281501 [info ] [MainThread]: 
[0m23:46:43.282555 [error] [MainThread]:   Database Error in test not_null_region_type_composition_with_macro_total_locations (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_total_locations.sql
[0m23:46:43.283168 [info ] [MainThread]: 
[0m23:46:43.283795 [error] [MainThread]:   Database Error in test not_null_region_type_composition_with_macro_urban_count (models/airflow_dbt_training/gold/schema.yml)
  relation "public.region_type_composition_with_macro" does not exist
  LINE 17: from "dwh"."public"."region_type_composition_with_macro"
                ^
  compiled code at target/run/airflow_dbt_training/models/airflow_dbt_training/gold/schema.yml/not_null_region_type_composition_with_macro_urban_count.sql
[0m23:46:43.284217 [info ] [MainThread]: 
[0m23:46:43.284701 [error] [MainThread]: [31mFailure in test valid_values_stg_location_data_type__URBAN__RURAL (models/airflow_dbt_training/silver/schema.yml)[0m
[0m23:46:43.285141 [error] [MainThread]:   Got 3766 results, configured to fail if != 0
[0m23:46:43.285503 [info ] [MainThread]: 
[0m23:46:43.286000 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/silver/schema.yml/valid_values_stg_location_data_type__URBAN__RURAL.sql
[0m23:46:43.286408 [info ] [MainThread]: 
[0m23:46:43.286781 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=6 SKIP=0 TOTAL=33
[0m23:46:43.287800 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.682387, "process_in_blocks": "0", "process_kernel_time": 0.309561, "process_mem_max_rss": "123324", "process_out_blocks": "3088", "process_user_time": 2.875927}
[0m23:46:43.288300 [debug] [MainThread]: Command `dbt test` failed at 23:46:43.288192 after 1.68 seconds
[0m23:46:43.288797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fd411910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fd054790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2fa29b590>]}
[0m23:46:43.289284 [debug] [MainThread]: Flushing usage events
[0m23:46:43.801136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:46:49.717510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfb46cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfc19c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfb6c7210>]}


============================== 23:46:49.720625 | 29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1 ==============================
[0m23:46:49.720625 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:46:49.721279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:46:49.880069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfa976710>]}
[0m23:46:49.939278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfdebda90>]}
[0m23:46:49.940051 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:46:50.020241 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:46:50.149425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:46:50.150202 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/gold/region_type_composition_with_macro.sql
[0m23:46:50.587483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfb591f90>]}
[0m23:46:50.689318 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:46:50.692045 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:46:50.704536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf95f4d10>]}
[0m23:46:50.705091 [info ] [MainThread]: Found 9 models, 33 data tests, 2 sources, 436 macros
[0m23:46:50.705432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf95cdc90>]}
[0m23:46:50.708005 [info ] [MainThread]: 
[0m23:46:50.708459 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:50.708818 [info ] [MainThread]: 
[0m23:46:50.709731 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:46:50.715797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh'
[0m23:46:50.803717 [debug] [ThreadPool]: Using postgres connection "list_dwh"
[0m23:46:50.804113 [debug] [ThreadPool]: On list_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:46:50.804399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:50.811890 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m23:46:50.813182 [debug] [ThreadPool]: On list_dwh: Close
[0m23:46:50.814951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dwh, now list_dwh_public)
[0m23:46:50.821193 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:46:50.821521 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:46:50.821784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:50.828053 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:46:50.828400 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:46:50.828722 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:46:50.831186 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m23:46:50.832565 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:46:50.832983 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:46:50.839710 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:50.840025 [debug] [MainThread]: On master: BEGIN
[0m23:46:50.840299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:50.846898 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:46:50.847401 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:50.847922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:50.852450 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m23:46:50.854925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf8f39210>]}
[0m23:46:50.855379 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:50.855839 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:50.856140 [debug] [MainThread]: On master: BEGIN
[0m23:46:50.856745 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:46:50.857046 [debug] [MainThread]: On master: COMMIT
[0m23:46:50.857330 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:50.857590 [debug] [MainThread]: On master: COMMIT
[0m23:46:50.858147 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:50.858442 [debug] [MainThread]: On master: Close
[0m23:46:50.861874 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.housing_prices
[0m23:46:50.862335 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.location_data
[0m23:46:50.863256 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.stg_example
[0m23:46:50.863816 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.stg_location_data
[0m23:46:50.862865 [info ] [Thread-1 (]: 1 of 8 START sql view model public.housing_prices .............................. [RUN]
[0m23:46:50.864357 [info ] [Thread-2 (]: 2 of 8 START sql view model public.location_data ............................... [RUN]
[0m23:46:50.865059 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_example ................................. [RUN]
[0m23:46:50.866696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now model.airflow_dbt_training.housing_prices)
[0m23:46:50.865915 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_location_data ........................... [RUN]
[0m23:46:50.867813 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.airflow_dbt_training.location_data'
[0m23:46:50.868639 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_example'
[0m23:46:50.869205 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.housing_prices
[0m23:46:50.869837 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.airflow_dbt_training.stg_location_data'
[0m23:46:50.870285 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.location_data
[0m23:46:50.870701 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.stg_example
[0m23:46:50.880440 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.housing_prices"
[0m23:46:50.881092 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.stg_location_data
[0m23:46:50.883404 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.location_data"
[0m23:46:50.885924 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_example"
[0m23:46:50.889837 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_location_data"
[0m23:46:50.891039 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.housing_prices
[0m23:46:50.891888 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.location_data
[0m23:46:50.892353 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.stg_example
[0m23:46:50.919304 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.stg_location_data
[0m23:46:50.949675 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.location_data"
[0m23:46:50.950267 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_example"
[0m23:46:50.951786 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.housing_prices"
[0m23:46:50.955494 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.stg_location_data"
[0m23:46:50.956636 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:46:50.957829 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:46:50.958495 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: BEGIN
[0m23:46:50.958896 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:46:50.959329 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:46:50.959757 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: BEGIN
[0m23:46:50.960188 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:46:50.960627 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: BEGIN
[0m23:46:50.961046 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: BEGIN
[0m23:46:50.961496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:50.962126 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:46:50.962552 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:46:50.968349 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:50.969255 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:46:50.969736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:50.970160 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:50.970581 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */

  create view "dwh"."public"."location_data__dbt_tmp"
    
    
  as (
    SELECT * FROM public.raw_location_data
  );
[0m23:46:50.970984 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:50.971419 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:46:50.971836 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:46:50.972365 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:46:50.972821 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */

  create view "dwh"."public"."housing_prices__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "dwh"."public"."raw_housing_prices"
  );
[0m23:46:50.973184 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:46:50.973687 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */

  create view "dwh"."public"."stg_example__dbt_tmp"
    
    
  as (
    with source_data as (
    select 1 as id, 'test' as name
    union all
    select 2 as id, 'example' as name
)

select *
from source_data
  );
[0m23:46:50.974275 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */

  create view "dwh"."public"."stg_location_data__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "dwh"."public"."raw_location_data"
)

SELECT
    postcode,
    UPPER(region) as region,
    -- INITCAP capitalizes the first letter of each word and makes the rest lowercase
    -- e.g. 'URBAN' -> 'Urban', 'rural' -> 'Rural'
    INITCAP(type) as type,
    CASE
        WHEN LOWER("type") = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER("type") = LOWER('RURAL') THEN 'RURAL'
        ELSE 'RURAL'
    END as type_normalized
FROM source
  );
[0m23:46:50.982050 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:46:50.982516 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:46:50.983131 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data" rename to "location_data__dbt_backup"
[0m23:46:50.986744 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:46:50.987214 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:46:50.987598 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:46:50.988116 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices" rename to "housing_prices__dbt_backup"
[0m23:46:50.988590 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:50.992016 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:46:50.995068 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:46:50.998243 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:46:50.998683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:46:50.999086 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data" rename to "stg_location_data__dbt_backup"
[0m23:46:50.999558 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example" rename to "stg_example__dbt_backup"
[0m23:46:51.000038 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
alter table "dwh"."public"."location_data__dbt_tmp" rename to "location_data"
[0m23:46:51.003088 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:46:51.003818 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
alter table "dwh"."public"."housing_prices__dbt_tmp" rename to "housing_prices"
[0m23:46:51.004245 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:51.004662 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:51.008969 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:46:51.009371 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:46:51.009747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:46:51.020595 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
alter table "dwh"."public"."stg_example__dbt_tmp" rename to "stg_example"
[0m23:46:51.028390 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:46:51.031741 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:46:51.033029 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:46:51.033579 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:46:51.034014 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:51.034427 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
alter table "dwh"."public"."stg_location_data__dbt_tmp" rename to "stg_location_data"
[0m23:46:51.034889 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:46:51.035327 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: COMMIT
[0m23:46:51.036597 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:46:51.037133 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: COMMIT
[0m23:46:51.037598 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:51.038139 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:46:51.039534 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:46:51.039986 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: COMMIT
[0m23:46:51.040443 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:46:51.040995 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: COMMIT
[0m23:46:51.041362 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:46:51.048485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m23:46:51.049043 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m23:46:51.051727 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."housing_prices__dbt_backup"
[0m23:46:51.048156 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."location_data__dbt_backup"
[0m23:46:51.052304 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m23:46:51.055277 [debug] [Thread-4 (]: Applying DROP to: "dwh"."public"."stg_location_data__dbt_backup"
[0m23:46:51.060802 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.housing_prices"
[0m23:46:51.061564 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.location_data"
[0m23:46:51.064201 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."stg_example__dbt_backup"
[0m23:46:51.064823 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.stg_location_data"
[0m23:46:51.065275 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.housing_prices"} */
drop view if exists "dwh"."public"."housing_prices__dbt_backup" cascade
[0m23:46:51.065769 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.location_data"} */
drop view if exists "dwh"."public"."location_data__dbt_backup" cascade
[0m23:46:51.066384 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.stg_example"
[0m23:46:51.066847 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_location_data"} */
drop view if exists "dwh"."public"."stg_location_data__dbt_backup" cascade
[0m23:46:51.067525 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.stg_example"} */
drop view if exists "dwh"."public"."stg_example__dbt_backup" cascade
[0m23:46:51.070859 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:46:51.073267 [debug] [Thread-2 (]: On model.airflow_dbt_training.location_data: Close
[0m23:46:51.073802 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m23:46:51.074189 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m23:46:51.076881 [debug] [Thread-3 (]: On model.airflow_dbt_training.stg_example: Close
[0m23:46:51.077396 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.009 seconds
[0m23:46:51.077758 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf846b750>]}
[0m23:46:51.079109 [debug] [Thread-1 (]: On model.airflow_dbt_training.housing_prices: Close
[0m23:46:51.079744 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf8560490>]}
[0m23:46:51.081061 [debug] [Thread-4 (]: On model.airflow_dbt_training.stg_location_data: Close
[0m23:46:51.081766 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.location_data .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m23:46:51.082688 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_example ............................ [[32mCREATE VIEW[0m in 0.21s]
[0m23:46:51.083446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf8440b10>]}
[0m23:46:51.084488 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf8589010>]}
[0m23:46:51.085399 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.location_data
[0m23:46:51.086185 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.stg_example
[0m23:46:51.086976 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.housing_prices ......................... [[32mCREATE VIEW[0m in 0.22s]
[0m23:46:51.087719 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_location_data ...................... [[32mCREATE VIEW[0m in 0.21s]
[0m23:46:51.089021 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.housing_prices
[0m23:46:51.089689 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.stg_location_data
[0m23:46:51.091095 [debug] [Thread-2 (]: Began running node model.airflow_dbt_training.region_type_composition
[0m23:46:51.091578 [debug] [Thread-3 (]: Began running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:46:51.092036 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.stg_housing_prices
[0m23:46:51.092601 [info ] [Thread-2 (]: 5 of 8 START sql view model public.region_type_composition ..................... [RUN]
[0m23:46:51.093326 [info ] [Thread-3 (]: 6 of 8 START sql view model public.region_type_composition_with_macro .......... [RUN]
[0m23:46:51.094029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.housing_prices, now model.airflow_dbt_training.stg_housing_prices)
[0m23:46:51.094573 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.location_data, now model.airflow_dbt_training.region_type_composition)
[0m23:46:51.095167 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_example, now model.airflow_dbt_training.region_type_composition_with_macro)
[0m23:46:51.095635 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.stg_housing_prices
[0m23:46:51.096080 [debug] [Thread-2 (]: Began compiling node model.airflow_dbt_training.region_type_composition
[0m23:46:51.096594 [debug] [Thread-3 (]: Began compiling node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:46:51.100959 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.stg_housing_prices"
[0m23:46:51.104322 [debug] [Thread-2 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition"
[0m23:46:51.108231 [debug] [Thread-3 (]: Writing injected SQL for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:46:51.109930 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.stg_housing_prices
[0m23:46:51.110638 [debug] [Thread-2 (]: Began executing node model.airflow_dbt_training.region_type_composition
[0m23:46:51.111584 [debug] [Thread-4 (]: Began running node model.airflow_dbt_training.incremental_prices
[0m23:46:51.115899 [debug] [Thread-2 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition"
[0m23:46:51.116382 [debug] [Thread-3 (]: Began executing node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:46:51.116999 [info ] [Thread-4 (]: 7 of 8 START sql incremental model public.incremental_prices ................... [RUN]
[0m23:46:51.123286 [debug] [Thread-3 (]: Writing runtime sql for node "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:46:51.123897 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_location_data, now model.airflow_dbt_training.incremental_prices)
[0m23:46:51.124380 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:46:51.125033 [debug] [Thread-4 (]: Began compiling node model.airflow_dbt_training.incremental_prices
[0m23:46:51.125547 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: BEGIN
[0m23:46:51.125999 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:46:51.136917 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:51.138724 [debug] [Thread-4 (]: Writing injected SQL for node "model.airflow_dbt_training.incremental_prices"
[0m23:46:51.139295 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: BEGIN
[0m23:46:51.140379 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:51.141035 [debug] [Thread-4 (]: Began executing node model.airflow_dbt_training.incremental_prices
[0m23:46:51.162204 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m23:46:51.168087 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m23:46:51.178355 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:46:51.189257 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:51.189743 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:46:51.190252 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */

  create view "dwh"."public"."region_type_composition__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    COUNT(*) FILTER (WHERE type = 'URBAN') AS urban_count,
    COUNT(*) FILTER (WHERE type = 'RURAL') AS rural_count,
    COUNT(*) AS total_locations
  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  total_locations as total_count,
  ROUND(urban_count * 1.0 / total_locations, 2) AS pct_urban
FROM type_counts
  );
[0m23:46:51.190803 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

    
  
    

  create temporary table "incremental_prices__dbt_tmp234651172688"
  
  
    as
  
  (
    
with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) SELECT *
FROM __dbt__cte__stg_housing_prices

WHERE updated_at > (SELECT updated_at FROM "dwh"."public"."incremental_prices" ORDER BY updated_at DESC LIMIT 1)

  );
  
  
[0m23:46:51.191393 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */

  create view "dwh"."public"."region_type_composition_with_macro__dbt_tmp"
    
    
  as (
    WITH type_counts AS (
  SELECT
    region,
    
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        ELSE 'UNKNOWN'
    END = 'URBAN') AS urban_count,
  
    COUNT(*) FILTER (WHERE CASE
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'RURAL') AS rural_count
  ,
    COUNT(*) AS total_count

  FROM "dwh"."public"."stg_location_data"
  GROUP BY region
)

SELECT
  region,
  urban_count,
  rural_count,
  total_count AS total_locations,
  ROUND(urban_count * 1.0 / total_count, 2) AS pct_urban
FROM type_counts
  );
[0m23:46:51.191998 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:51.193606 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:46:51.196982 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:46:51.197410 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:46:51.197825 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
alter table "dwh"."public"."region_type_composition__dbt_tmp" rename to "region_type_composition"
[0m23:46:51.200969 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:46:51.201645 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
alter table "dwh"."public"."region_type_composition_with_macro__dbt_tmp" rename to "region_type_composition_with_macro"
[0m23:46:51.202078 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:51.203384 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:46:51.203767 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:51.204169 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:46:51.205365 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:46:51.205807 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: COMMIT
[0m23:46:51.206255 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:46:51.206759 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: COMMIT
[0m23:46:51.209924 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m23:46:51.212585 [debug] [Thread-2 (]: Applying DROP to: "dwh"."public"."region_type_composition__dbt_backup"
[0m23:46:51.212998 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m23:46:51.213594 [debug] [Thread-2 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition"
[0m23:46:51.216203 [debug] [Thread-3 (]: Applying DROP to: "dwh"."public"."region_type_composition_with_macro__dbt_backup"
[0m23:46:51.216681 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition"} */
drop view if exists "dwh"."public"."region_type_composition__dbt_backup" cascade
[0m23:46:51.217329 [debug] [Thread-3 (]: Using postgres connection "model.airflow_dbt_training.region_type_composition_with_macro"
[0m23:46:51.217912 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.region_type_composition_with_macro"} */
drop view if exists "dwh"."public"."region_type_composition_with_macro__dbt_backup" cascade
[0m23:46:51.218359 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:46:51.219832 [debug] [Thread-2 (]: On model.airflow_dbt_training.region_type_composition: Close
[0m23:46:51.220261 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:46:51.220880 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf858d990>]}
[0m23:46:51.222244 [debug] [Thread-3 (]: On model.airflow_dbt_training.region_type_composition_with_macro: Close
[0m23:46:51.222955 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.region_type_composition ................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:46:51.223732 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf8558c90>]}
[0m23:46:51.224592 [debug] [Thread-2 (]: Finished running node model.airflow_dbt_training.region_type_composition
[0m23:46:51.225723 [info ] [Thread-3 (]: 6 of 8 OK created sql view model public.region_type_composition_with_macro ..... [[32mCREATE VIEW[0m in 0.13s]
[0m23:46:51.227300 [debug] [Thread-3 (]: Finished running node model.airflow_dbt_training.region_type_composition_with_macro
[0m23:46:51.228212 [debug] [Thread-1 (]: Began running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:46:51.229565 [info ] [Thread-1 (]: 8 of 8 START sql view model public.mart_housing_prices_breakdown ............... [RUN]
[0m23:46:51.230532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airflow_dbt_training.stg_housing_prices, now model.airflow_dbt_training.mart_housing_prices_breakdown)
[0m23:46:51.231177 [debug] [Thread-1 (]: Began compiling node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:46:51.239982 [debug] [Thread-1 (]: Writing injected SQL for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:51.240524 [debug] [Thread-4 (]: SQL status: SELECT 10500 in 0.049 seconds
[0m23:46:51.255524 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:51.256041 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: BEGIN
[0m23:46:51.256645 [debug] [Thread-1 (]: Began executing node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:46:51.257054 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m23:46:51.262326 [debug] [Thread-1 (]: Writing runtime sql for node "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:51.262879 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:51.263523 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices__dbt_tmp234651172688'
        
      order by ordinal_position

  
[0m23:46:51.264084 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:51.264448 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: BEGIN
[0m23:46:51.264774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:51.269201 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.005 seconds
[0m23:46:51.274950 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:51.275520 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:46:51.275955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:46:51.276459 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:51.276884 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */

  create view "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp"
    
    
  as (
    WITH  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), avg_prices AS (
  SELECT
    region,
    AVG(price) AS avg_price,
    COUNT(*) AS n_sales
  FROM __dbt__cte__stg_housing_prices
  GROUP BY region
)

SELECT
  p.region,
  p.avg_price,
  p.n_sales,
  r.urban_count,
  r.rural_count,
  r.pct_urban
FROM avg_prices p
LEFT JOIN "dwh"."public"."region_type_composition" r
  ON p.region = r.region
  );
[0m23:46:51.279028 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.003 seconds
[0m23:46:51.279450 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:46:51.287956 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:51.291387 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:51.291822 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
alter table "dwh"."public"."mart_housing_prices_breakdown__dbt_tmp" rename to "mart_housing_prices_breakdown"
[0m23:46:51.292353 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dwh".INFORMATION_SCHEMA.columns
      where table_name = 'incremental_prices'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m23:46:51.293302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:46:51.294497 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:46:51.294857 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:51.295258 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m23:46:51.295643 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: COMMIT
[0m23:46:51.304135 [debug] [Thread-4 (]: Writing runtime sql for node "model.airflow_dbt_training.incremental_prices"
[0m23:46:51.304934 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:51.305344 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.incremental_prices"} */

      insert into "dwh"."public"."incremental_prices" ("id", "date", "region", "price", "year", "month", "day_of_week", "updated_at")
    (
        select "id", "date", "region", "price", "year", "month", "day_of_week", "updated_at"
        from "incremental_prices__dbt_tmp234651172688"
    )


  
[0m23:46:51.307760 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:46:51.310460 [debug] [Thread-1 (]: Applying DROP to: "dwh"."public"."mart_housing_prices_breakdown__dbt_backup"
[0m23:46:51.311031 [debug] [Thread-1 (]: Using postgres connection "model.airflow_dbt_training.mart_housing_prices_breakdown"
[0m23:46:51.311397 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "model.airflow_dbt_training.mart_housing_prices_breakdown"} */
drop view if exists "dwh"."public"."mart_housing_prices_breakdown__dbt_backup" cascade
[0m23:46:51.311865 [debug] [Thread-4 (]: SQL status: INSERT 0 10500 in 0.006 seconds
[0m23:46:51.312253 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:46:51.313537 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:46:51.314940 [debug] [Thread-1 (]: On model.airflow_dbt_training.mart_housing_prices_breakdown: Close
[0m23:46:51.315405 [debug] [Thread-4 (]: Using postgres connection "model.airflow_dbt_training.incremental_prices"
[0m23:46:51.316104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf903cf90>]}
[0m23:46:51.316506 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: COMMIT
[0m23:46:51.317201 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.mart_housing_prices_breakdown .......... [[32mCREATE VIEW[0m in 0.09s]
[0m23:46:51.318018 [debug] [Thread-1 (]: Finished running node model.airflow_dbt_training.mart_housing_prices_breakdown
[0m23:46:51.321714 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m23:46:51.322766 [debug] [Thread-4 (]: On model.airflow_dbt_training.incremental_prices: Close
[0m23:46:51.323415 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ecc17f-ea31-49ce-82e3-7ed52bc6bdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf8538750>]}
[0m23:46:51.324094 [info ] [Thread-4 (]: 7 of 8 OK created sql incremental model public.incremental_prices .............. [[32mINSERT 0 10500[0m in 0.20s]
[0m23:46:51.324697 [debug] [Thread-4 (]: Finished running node model.airflow_dbt_training.incremental_prices
[0m23:46:51.326878 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:51.327353 [debug] [MainThread]: On master: BEGIN
[0m23:46:51.327734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:51.334864 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:46:51.335317 [debug] [MainThread]: On master: COMMIT
[0m23:46:51.335605 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:51.335893 [debug] [MainThread]: On master: COMMIT
[0m23:46:51.336321 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:51.336615 [debug] [MainThread]: On master: Close
[0m23:46:51.337043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:51.337312 [debug] [MainThread]: Connection 'model.airflow_dbt_training.mart_housing_prices_breakdown' was properly closed.
[0m23:46:51.337568 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition' was properly closed.
[0m23:46:51.337814 [debug] [MainThread]: Connection 'model.airflow_dbt_training.region_type_composition_with_macro' was properly closed.
[0m23:46:51.338093 [debug] [MainThread]: Connection 'model.airflow_dbt_training.incremental_prices' was properly closed.
[0m23:46:51.338471 [info ] [MainThread]: 
[0m23:46:51.338793 [info ] [MainThread]: Finished running 1 incremental model, 7 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m23:46:51.341116 [debug] [MainThread]: Command end result
[0m23:46:51.376846 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:46:51.378394 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:46:51.384752 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:46:51.385090 [info ] [MainThread]: 
[0m23:46:51.385457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:46:51.385795 [info ] [MainThread]: 
[0m23:46:51.386265 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m23:46:51.387442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7220583, "process_in_blocks": "0", "process_kernel_time": 0.191151, "process_mem_max_rss": "127216", "process_out_blocks": "3448", "process_user_time": 2.847151}
[0m23:46:51.387995 [debug] [MainThread]: Command `dbt run` succeeded at 23:46:51.387846 after 1.72 seconds
[0m23:46:51.388422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfb4a12d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfb7a4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfb7a4910>]}
[0m23:46:51.388798 [debug] [MainThread]: Flushing usage events
[0m23:46:52.066852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:46:53.607932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b15480450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b154763d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b15482e50>]}


============================== 23:46:53.610553 | a8aa5ef5-ee51-4bf4-aba0-ed38617680a3 ==============================
[0m23:46:53.610553 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:46:53.611147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:46:53.762256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8aa5ef5-ee51-4bf4-aba0-ed38617680a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b15476390>]}
[0m23:46:53.819552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8aa5ef5-ee51-4bf4-aba0-ed38617680a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b17ced890>]}
[0m23:46:53.820305 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:46:53.898514 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:46:54.024195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:54.024588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:54.075070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8aa5ef5-ee51-4bf4-aba0-ed38617680a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b14728650>]}
[0m23:46:54.174763 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:46:54.177397 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:46:54.198763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8aa5ef5-ee51-4bf4-aba0-ed38617680a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b13327850>]}
[0m23:46:54.199272 [info ] [MainThread]: Found 9 models, 33 data tests, 2 sources, 436 macros
[0m23:46:54.199618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8aa5ef5-ee51-4bf4-aba0-ed38617680a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b143ae9d0>]}
[0m23:46:54.204181 [info ] [MainThread]: 
[0m23:46:54.204784 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:54.205325 [info ] [MainThread]: 
[0m23:46:54.206675 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:46:54.213993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m23:46:54.254700 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:46:54.255060 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:46:54.255325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:54.262365 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:46:54.262717 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:46:54.263027 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:46:54.265402 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:46:54.266858 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:46:54.267306 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:46:54.274106 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:54.274423 [debug] [MainThread]: On master: BEGIN
[0m23:46:54.274675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:54.281296 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:46:54.281727 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:54.282170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:54.286796 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m23:46:54.289510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8aa5ef5-ee51-4bf4-aba0-ed38617680a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b133190d0>]}
[0m23:46:54.289931 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:54.290393 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:54.290664 [debug] [MainThread]: On master: BEGIN
[0m23:46:54.291267 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:46:54.291577 [debug] [MainThread]: On master: COMMIT
[0m23:46:54.291836 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:54.292082 [debug] [MainThread]: On master: COMMIT
[0m23:46:54.292530 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:54.292810 [debug] [MainThread]: On master: Close
[0m23:46:54.297017 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:46:54.297494 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:46:54.298103 [info ] [Thread-1 (]: 1 of 33 START test accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [RUN]
[0m23:46:54.298729 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:46:54.299177 [info ] [Thread-2 (]: 2 of 33 START test accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [RUN]
[0m23:46:54.299806 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:46:54.300389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m23:46:54.300955 [info ] [Thread-3 (]: 3 of 33 START test not_null_mart_housing_prices_breakdown_avg_price ............ [RUN]
[0m23:46:54.301698 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e'
[0m23:46:54.302227 [info ] [Thread-4 (]: 4 of 33 START test not_null_mart_housing_prices_breakdown_n_sales .............. [RUN]
[0m23:46:54.302829 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:46:54.303546 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d'
[0m23:46:54.304042 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:46:54.304612 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7'
[0m23:46:54.320691 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:46:54.327940 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:46:54.336255 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:46:54.336746 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:46:54.346064 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:46:54.350278 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:46:54.354416 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:46:54.355225 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:46:54.355972 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:46:54.356694 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:46:54.387571 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:46:54.388076 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:46:54.392751 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:46:54.395621 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:46:54.398369 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:46:54.399186 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:46:54.399673 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:46:54.400551 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:46:54.400989 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:46:54.401450 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: BEGIN
[0m23:46:54.401892 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: BEGIN
[0m23:46:54.402330 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: BEGIN
[0m23:46:54.402781 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: BEGIN
[0m23:46:54.403223 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:46:54.403642 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:46:54.404058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:54.404499 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:46:54.411480 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:54.411957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:54.412401 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:54.412819 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:46:54.413210 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m23:46:54.413652 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:46:54.414084 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:46:54.414641 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        month as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by month

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','7','8','9','10','11','12'
)



  
  
      
    ) dbt_internal_test
[0m23:46:54.415184 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:46:54.415719 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        day_of_week as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by day_of_week

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m23:46:54.416274 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select n_sales
from "dwh"."public"."mart_housing_prices_breakdown"
where n_sales is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.416880 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_price
from "dwh"."public"."mart_housing_prices_breakdown"
where avg_price is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.422304 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:46:54.422755 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:46:54.426895 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: ROLLBACK
[0m23:46:54.427366 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:46:54.427928 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:46:54.429303 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: ROLLBACK
[0m23:46:54.430752 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: ROLLBACK
[0m23:46:54.431178 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: Close
[0m23:46:54.432418 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: ROLLBACK
[0m23:46:54.433174 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: Close
[0m23:46:54.433757 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: Close
[0m23:46:54.434538 [info ] [Thread-4 (]: 4 of 33 PASS not_null_mart_housing_prices_breakdown_n_sales .................... [[32mPASS[0m in 0.13s]
[0m23:46:54.435001 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: Close
[0m23:46:54.435676 [info ] [Thread-3 (]: 3 of 33 PASS not_null_mart_housing_prices_breakdown_avg_price .................. [[32mPASS[0m in 0.13s]
[0m23:46:54.436708 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:46:54.437464 [info ] [Thread-2 (]: 2 of 33 PASS accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [[32mPASS[0m in 0.14s]
[0m23:46:54.438434 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:46:54.439254 [info ] [Thread-1 (]: 1 of 33 PASS accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [[32mPASS[0m in 0.14s]
[0m23:46:54.440184 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:46:54.441167 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:46:54.441730 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:46:54.442569 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:46:54.443085 [info ] [Thread-4 (]: 5 of 33 START test not_null_mart_housing_prices_breakdown_region ............... [RUN]
[0m23:46:54.443737 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:46:54.444318 [info ] [Thread-3 (]: 6 of 33 START test not_null_region_type_composition_pct_urban .................. [RUN]
[0m23:46:54.444886 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:46:54.445590 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m23:46:54.446326 [info ] [Thread-2 (]: 7 of 33 START test not_null_region_type_composition_region ..................... [RUN]
[0m23:46:54.447105 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m23:46:54.447614 [info ] [Thread-1 (]: 8 of 33 START test not_null_region_type_composition_rural_count ................ [RUN]
[0m23:46:54.448218 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:46:54.448799 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m23:46:54.449392 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:46:54.449878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m23:46:54.454704 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:46:54.455264 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:46:54.460292 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:46:54.460862 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:46:54.467287 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:46:54.468017 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:46:54.521089 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:46:54.521861 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:46:54.524592 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:46:54.525035 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:46:54.527688 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:46:54.528159 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:46:54.530862 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:46:54.531674 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:46:54.534200 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:46:54.534684 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:46:54.535286 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: BEGIN
[0m23:46:54.535943 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:46:54.536449 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: BEGIN
[0m23:46:54.536868 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:46:54.537303 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:54.537749 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: BEGIN
[0m23:46:54.538212 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:54.538653 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: BEGIN
[0m23:46:54.539305 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:54.539938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:54.545277 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:54.546037 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:46:54.546623 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:54.547318 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."mart_housing_prices_breakdown"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.547858 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:46:54.548275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:54.548653 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:46:54.549197 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:46:54.549637 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:46:54.550101 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.550615 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.551129 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.551559 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:46:54.553262 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: ROLLBACK
[0m23:46:54.553781 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: Close
[0m23:46:54.554407 [info ] [Thread-4 (]: 5 of 33 PASS not_null_mart_housing_prices_breakdown_region ..................... [[32mPASS[0m in 0.11s]
[0m23:46:54.555193 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:46:54.555821 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:46:54.556446 [info ] [Thread-4 (]: 9 of 33 START test not_null_region_type_composition_total_count ................ [RUN]
[0m23:46:54.556998 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c, now test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7)
[0m23:46:54.557493 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:46:54.558007 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:46:54.559678 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: ROLLBACK
[0m23:46:54.564661 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:46:54.565290 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:46:54.565741 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:46:54.568140 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: ROLLBACK
[0m23:46:54.568938 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:46:54.570357 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: ROLLBACK
[0m23:46:54.570770 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: Close
[0m23:46:54.573756 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:46:54.574278 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: Close
[0m23:46:54.575264 [info ] [Thread-2 (]: 7 of 33 PASS not_null_region_type_composition_region ........................... [[32mPASS[0m in 0.13s]
[0m23:46:54.575813 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: Close
[0m23:46:54.576922 [info ] [Thread-3 (]: 6 of 33 PASS not_null_region_type_composition_pct_urban ........................ [[32mPASS[0m in 0.13s]
[0m23:46:54.577637 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:46:54.578334 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:46:54.580350 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:46:54.579514 [info ] [Thread-1 (]: 8 of 33 PASS not_null_region_type_composition_rural_count ...................... [[32mPASS[0m in 0.13s]
[0m23:46:54.581098 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:46:54.581647 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: BEGIN
[0m23:46:54.582282 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:46:54.583152 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:46:54.583663 [info ] [Thread-2 (]: 10 of 33 START test not_null_region_type_composition_urban_count ............... [RUN]
[0m23:46:54.584184 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:54.584762 [info ] [Thread-3 (]: 11 of 33 START test not_null_region_type_composition_with_macro_pct_urban ...... [RUN]
[0m23:46:54.585535 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:46:54.586303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m23:46:54.587003 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91)
[0m23:46:54.587518 [info ] [Thread-1 (]: 12 of 33 START test not_null_region_type_composition_with_macro_region ......... [RUN]
[0m23:46:54.588189 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:46:54.588831 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:46:54.589440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192)
[0m23:46:54.594409 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:46:54.595529 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m23:46:54.600546 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:46:54.601076 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:46:54.601739 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:46:54.602297 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:46:54.607015 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:46:54.607629 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:46:54.608106 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_count
from "dwh"."public"."region_type_composition"
where total_count is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.611564 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:46:54.616302 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:46:54.616898 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:46:54.620163 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:46:54.620892 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:46:54.621531 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:46:54.621984 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: BEGIN
[0m23:46:54.622411 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:46:54.622856 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: BEGIN
[0m23:46:54.623286 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:54.623721 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: BEGIN
[0m23:46:54.624141 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:54.624839 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:46:54.625223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:54.626918 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: ROLLBACK
[0m23:46:54.627814 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: Close
[0m23:46:54.628546 [info ] [Thread-4 (]: 9 of 33 PASS not_null_region_type_composition_total_count ...................... [[32mPASS[0m in 0.07s]
[0m23:46:54.629279 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:46:54.629811 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:46:54.630431 [info ] [Thread-4 (]: 13 of 33 START test not_null_region_type_composition_with_macro_rural_count .... [RUN]
[0m23:46:54.631185 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797)
[0m23:46:54.631726 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:54.632214 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:46:54.632872 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:46:54.637934 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:46:54.638464 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m23:46:54.639124 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition_with_macro"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.640116 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:46:54.640823 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:46:54.641401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m23:46:54.642066 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.644901 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:46:54.645388 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:46:54.646265 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition_with_macro"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.647056 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:46:54.647568 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: BEGIN
[0m23:46:54.647987 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:54.651434 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:46:54.653289 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: ROLLBACK
[0m23:46:54.653958 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: Close
[0m23:46:54.655105 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m23:46:54.654705 [info ] [Thread-1 (]: 12 of 33 PASS not_null_region_type_composition_with_macro_region ............... [[32mPASS[0m in 0.07s]
[0m23:46:54.655765 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:46:54.656446 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:46:54.656834 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.015 seconds
[0m23:46:54.657335 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:46:54.657800 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition_with_macro"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.658593 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:46:54.660451 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: ROLLBACK
[0m23:46:54.662015 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: ROLLBACK
[0m23:46:54.662676 [info ] [Thread-1 (]: 14 of 33 START test not_null_region_type_composition_with_macro_total_locations  [RUN]
[0m23:46:54.663603 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: Close
[0m23:46:54.664146 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: Close
[0m23:46:54.664718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae)
[0m23:46:54.665744 [info ] [Thread-3 (]: 11 of 33 PASS not_null_region_type_composition_with_macro_pct_urban ............ [[32mPASS[0m in 0.08s]
[0m23:46:54.666750 [info ] [Thread-2 (]: 10 of 33 PASS not_null_region_type_composition_urban_count ..................... [[32mPASS[0m in 0.08s]
[0m23:46:54.667521 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:46:54.668231 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:46:54.668853 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:46:54.673692 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:46:54.674325 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:46:54.674935 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:46:54.675665 [info ] [Thread-3 (]: 15 of 33 START test not_null_region_type_composition_with_macro_urban_count .... [RUN]
[0m23:46:54.677094 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:46:54.676438 [info ] [Thread-2 (]: 16 of 33 START test not_null_stg_housing_prices_date ........................... [RUN]
[0m23:46:54.677891 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224)
[0m23:46:54.678442 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:46:54.681439 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:46:54.681989 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m23:46:54.682601 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:46:54.684197 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: ROLLBACK
[0m23:46:54.684958 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:46:54.685476 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:46:54.690209 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:46:54.695592 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:46:54.696190 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: Close
[0m23:46:54.696766 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: BEGIN
[0m23:46:54.697734 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:46:54.698311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:54.698904 [info ] [Thread-4 (]: 13 of 33 PASS not_null_region_type_composition_with_macro_rural_count .......... [[32mPASS[0m in 0.07s]
[0m23:46:54.702225 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:46:54.702772 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:46:54.703741 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:46:54.706850 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:46:54.707408 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:46:54.708005 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:46:54.708699 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: BEGIN
[0m23:46:54.709271 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:46:54.709740 [info ] [Thread-4 (]: 17 of 33 START test not_null_stg_housing_prices_day_of_week .................... [RUN]
[0m23:46:54.710348 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:54.710853 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:46:54.711389 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: BEGIN
[0m23:46:54.711901 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m23:46:54.712765 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:46:54.713375 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:54.713850 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:46:54.714396 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_locations
from "dwh"."public"."region_type_composition_with_macro"
where total_locations is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.721860 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:46:54.722790 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:46:54.723276 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:46:54.726234 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:46:54.726761 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m23:46:54.727246 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:46:54.727972 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:46:54.728686 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:46:54.729128 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition_with_macro"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.729639 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:46:54.730146 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select date
from __dbt__cte__stg_housing_prices
where date is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.732011 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: ROLLBACK
[0m23:46:54.732672 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: BEGIN
[0m23:46:54.733268 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:54.733644 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: Close
[0m23:46:54.734542 [info ] [Thread-1 (]: 14 of 33 PASS not_null_region_type_composition_with_macro_total_locations ...... [[32mPASS[0m in 0.07s]
[0m23:46:54.735242 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:46:54.735868 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:46:54.736430 [info ] [Thread-1 (]: 18 of 33 START test not_null_stg_housing_prices_id ............................. [RUN]
[0m23:46:54.737186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m23:46:54.737740 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:46:54.743620 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:46:54.745444 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: ROLLBACK
[0m23:46:54.748360 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:46:54.748984 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m23:46:54.749525 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:46:54.750204 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: Close
[0m23:46:54.750779 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:46:54.752366 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: ROLLBACK
[0m23:46:54.752811 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:46:54.753430 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select day_of_week
from __dbt__cte__stg_housing_prices
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.754081 [info ] [Thread-2 (]: 16 of 33 PASS not_null_stg_housing_prices_date ................................. [[32mPASS[0m in 0.07s]
[0m23:46:54.757666 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:46:54.758257 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: Close
[0m23:46:54.759002 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:46:54.759991 [info ] [Thread-3 (]: 15 of 33 PASS not_null_region_type_composition_with_macro_urban_count .......... [[32mPASS[0m in 0.08s]
[0m23:46:54.760598 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:46:54.761345 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:46:54.762326 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:46:54.762805 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: BEGIN
[0m23:46:54.763303 [info ] [Thread-2 (]: 19 of 33 START test not_null_stg_housing_prices_month .......................... [RUN]
[0m23:46:54.763991 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:46:54.764820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:54.765425 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m23:46:54.765930 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:46:54.766322 [info ] [Thread-3 (]: 20 of 33 START test not_null_stg_housing_prices_price .......................... [RUN]
[0m23:46:54.767271 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:46:54.769464 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: ROLLBACK
[0m23:46:54.770083 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m23:46:54.776375 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:46:54.776998 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:46:54.777459 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:46:54.777876 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: Close
[0m23:46:54.778494 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:46:54.784707 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:46:54.785204 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:46:54.785847 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select id
from __dbt__cte__stg_housing_prices
where id is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.786617 [info ] [Thread-4 (]: 17 of 33 PASS not_null_stg_housing_prices_day_of_week .......................... [[32mPASS[0m in 0.07s]
[0m23:46:54.790204 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:46:54.791312 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:46:54.791780 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:46:54.792549 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:46:54.793191 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:46:54.794018 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:46:54.796921 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:46:54.797613 [info ] [Thread-4 (]: 21 of 33 START test not_null_stg_housing_prices_region ......................... [RUN]
[0m23:46:54.799656 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: ROLLBACK
[0m23:46:54.800294 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: BEGIN
[0m23:46:54.801030 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m23:46:54.801646 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:46:54.802162 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:54.802577 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: Close
[0m23:46:54.802981 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:46:54.803459 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: BEGIN
[0m23:46:54.804657 [info ] [Thread-1 (]: 18 of 33 PASS not_null_stg_housing_prices_id ................................... [[32mPASS[0m in 0.07s]
[0m23:46:54.811491 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:46:54.812078 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:54.812969 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:46:54.813643 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:46:54.814514 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:46:54.815102 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:46:54.815899 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:46:54.819791 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:46:54.820413 [info ] [Thread-1 (]: 22 of 33 START test not_null_stg_housing_prices_year ........................... [RUN]
[0m23:46:54.821096 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select month
from __dbt__cte__stg_housing_prices
where month is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.822156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m23:46:54.823387 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:46:54.824081 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m23:46:54.824555 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:46:54.825016 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: BEGIN
[0m23:46:54.825451 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:46:54.831565 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:46:54.832101 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:54.832511 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:46:54.833052 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select price
from __dbt__cte__stg_housing_prices
where price is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.835730 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: ROLLBACK
[0m23:46:54.836274 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:46:54.839508 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:46:54.840223 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:46:54.841007 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: Close
[0m23:46:54.842867 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: ROLLBACK
[0m23:46:54.843507 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:46:54.843954 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:46:54.844726 [info ] [Thread-2 (]: 19 of 33 PASS not_null_stg_housing_prices_month ................................ [[32mPASS[0m in 0.08s]
[0m23:46:54.845221 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: Close
[0m23:46:54.845775 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: BEGIN
[0m23:46:54.846601 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:46:54.847482 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:46:54.848195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:54.848835 [info ] [Thread-3 (]: 20 of 33 PASS not_null_stg_housing_prices_price ................................ [[32mPASS[0m in 0.08s]
[0m23:46:54.849644 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select region
from __dbt__cte__stg_housing_prices
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.850430 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:46:54.851561 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:46:54.852422 [info ] [Thread-2 (]: 23 of 33 START test not_null_stg_location_data_postcode ........................ [RUN]
[0m23:46:54.853384 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:46:54.854208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m23:46:54.855373 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:46:54.854895 [info ] [Thread-3 (]: 24 of 33 START test not_null_stg_location_data_region .......................... [RUN]
[0m23:46:54.856325 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:46:54.858184 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: ROLLBACK
[0m23:46:54.859025 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m23:46:54.859632 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:46:54.864405 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:46:54.865291 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:46:54.865923 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:46:54.866347 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: Close
[0m23:46:54.872369 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:46:54.873717 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:46:54.874217 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select year
from __dbt__cte__stg_housing_prices
where year is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.877278 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:46:54.878017 [info ] [Thread-4 (]: 21 of 33 PASS not_null_stg_housing_prices_region ............................... [[32mPASS[0m in 0.08s]
[0m23:46:54.879257 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:46:54.879944 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:46:54.880548 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:46:54.883567 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:46:54.884132 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: BEGIN
[0m23:46:54.884685 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:46:54.885487 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:46:54.886167 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:54.886778 [info ] [Thread-4 (]: 25 of 33 START test not_null_stg_location_data_type ............................ [RUN]
[0m23:46:54.888795 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: ROLLBACK
[0m23:46:54.889437 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:46:54.890377 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m23:46:54.891046 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: BEGIN
[0m23:46:54.891598 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: Close
[0m23:46:54.892065 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:46:54.892569 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:54.897521 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:46:54.898272 [info ] [Thread-1 (]: 22 of 33 PASS not_null_stg_housing_prices_year ................................. [[32mPASS[0m in 0.08s]
[0m23:46:54.899441 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m23:46:54.900088 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:46:54.900784 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:46:54.901435 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:46:54.901947 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:46:54.902511 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."stg_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.905545 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:46:54.906322 [info ] [Thread-1 (]: 26 of 33 START test source_not_null_public_raw_housing_prices_date ............. [RUN]
[0m23:46:54.906964 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m23:46:54.907991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m23:46:54.908779 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:46:54.909533 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:46:54.910031 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:46:54.910407 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:46:54.910903 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."stg_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.911375 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: BEGIN
[0m23:46:54.913184 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: ROLLBACK
[0m23:46:54.917948 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:46:54.918674 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:54.919506 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: Close
[0m23:46:54.920615 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:46:54.921485 [info ] [Thread-2 (]: 23 of 33 PASS not_null_stg_location_data_postcode .............................. [[32mPASS[0m in 0.07s]
[0m23:46:54.924551 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:46:54.925227 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:46:54.925907 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:46:54.927935 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: ROLLBACK
[0m23:46:54.928767 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m23:46:54.929249 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:46:54.929685 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:46:54.930323 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:46:54.930799 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: Close
[0m23:46:54.931269 [info ] [Thread-2 (]: 27 of 33 START test source_not_null_public_raw_housing_prices_id ............... [RUN]
[0m23:46:54.931982 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: BEGIN
[0m23:46:54.932565 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."stg_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.933398 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m23:46:54.934042 [info ] [Thread-3 (]: 24 of 33 PASS not_null_stg_location_data_region ................................ [[32mPASS[0m in 0.07s]
[0m23:46:54.934627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:54.935343 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:46:54.935983 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:46:54.941521 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:46:54.942361 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:46:54.942863 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:46:54.944798 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:46:54.945519 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:46:54.947030 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: ROLLBACK
[0m23:46:54.944288 [info ] [Thread-3 (]: 28 of 33 START test source_not_null_public_raw_housing_prices_price ............ [RUN]
[0m23:46:54.950219 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:46:54.950817 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:46:54.951648 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m23:46:54.952150 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: Close
[0m23:46:54.952938 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "dwh"."public"."raw_housing_prices"
where date is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.953478 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:46:54.953920 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:46:54.954694 [info ] [Thread-4 (]: 25 of 33 PASS not_null_stg_location_data_type .................................. [[32mPASS[0m in 0.06s]
[0m23:46:54.959861 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:46:54.960512 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:46:54.961049 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: BEGIN
[0m23:46:54.961838 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:46:54.963712 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: ROLLBACK
[0m23:46:54.964343 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:54.964779 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:46:54.965326 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:46:54.966120 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: Close
[0m23:46:54.969235 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:46:54.969936 [info ] [Thread-4 (]: 29 of 33 START test source_not_null_public_raw_housing_prices_region ........... [RUN]
[0m23:46:54.970939 [info ] [Thread-1 (]: 26 of 33 PASS source_not_null_public_raw_housing_prices_date ................... [[32mPASS[0m in 0.06s]
[0m23:46:54.971775 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m23:46:54.972520 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:46:54.973183 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:46:54.973645 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m23:46:54.974153 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:46:54.974651 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: BEGIN
[0m23:46:54.975167 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:46:54.975732 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:46:54.983420 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:46:54.983949 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:54.984429 [info ] [Thread-1 (]: 30 of 33 START test source_not_null_public_raw_location_data_postcode .......... [RUN]
[0m23:46:54.985001 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dwh"."public"."raw_housing_prices"
where id is null



  
  
      
    ) dbt_internal_test
[0m23:46:54.986140 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:46:54.986772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m23:46:54.990096 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:46:54.990667 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:46:54.991111 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:46:54.993115 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: ROLLBACK
[0m23:46:54.994060 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:46:54.998722 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:46:54.999217 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m23:46:54.999858 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: BEGIN
[0m23:46:55.000323 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: Close
[0m23:46:55.000973 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:46:55.001518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:55.001994 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:46:55.002635 [info ] [Thread-2 (]: 27 of 33 PASS source_not_null_public_raw_housing_prices_id ..................... [[32mPASS[0m in 0.07s]
[0m23:46:55.003167 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dwh"."public"."raw_housing_prices"
where price is null



  
  
      
    ) dbt_internal_test
[0m23:46:55.006907 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:46:55.007643 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:46:55.008475 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:46:55.009055 [info ] [Thread-2 (]: 31 of 33 START test source_not_null_public_raw_location_data_region ............ [RUN]
[0m23:46:55.010068 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:46:55.010754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m23:46:55.011273 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:46:55.013194 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: ROLLBACK
[0m23:46:55.013881 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:46:55.014357 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:46:55.014850 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: BEGIN
[0m23:46:55.015423 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:46:55.015897 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: Close
[0m23:46:55.020851 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:46:55.021387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:55.021966 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_housing_prices"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:55.023096 [info ] [Thread-3 (]: 28 of 33 PASS source_not_null_public_raw_housing_prices_price .................. [[32mPASS[0m in 0.07s]
[0m23:46:55.024204 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:46:55.025048 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:46:55.028210 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:46:55.028785 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:46:55.029369 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:46:55.031605 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: ROLLBACK
[0m23:46:55.032156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:46:55.032782 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:46:55.033239 [info ] [Thread-3 (]: 32 of 33 START test source_not_null_public_raw_location_data_type .............. [RUN]
[0m23:46:55.033994 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:46:55.034688 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: Close
[0m23:46:55.035143 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: BEGIN
[0m23:46:55.035720 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m23:46:55.036264 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."raw_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:46:55.036914 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:46:55.037542 [info ] [Thread-4 (]: 29 of 33 PASS source_not_null_public_raw_housing_prices_region ................. [[32mPASS[0m in 0.07s]
[0m23:46:55.038187 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:46:55.039244 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:46:55.044351 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:46:55.044910 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:46:55.045449 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:46:55.046667 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:46:55.048362 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: ROLLBACK
[0m23:46:55.049029 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:46:55.049516 [info ] [Thread-4 (]: 33 of 33 START test valid_values_stg_location_data_type__URBAN__RURAL .......... [RUN]
[0m23:46:55.050067 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:46:55.053260 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:46:55.053831 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: Close
[0m23:46:55.054344 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91)
[0m23:46:55.054918 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:46:55.056015 [info ] [Thread-1 (]: 30 of 33 PASS source_not_null_public_raw_location_data_postcode ................ [[32mPASS[0m in 0.07s]
[0m23:46:55.056588 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:46:55.057098 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:46:55.057916 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:46:55.063694 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:46:55.067151 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:46:55.067727 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: BEGIN
[0m23:46:55.069513 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: ROLLBACK
[0m23:46:55.070072 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:46:55.070867 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:46:55.071511 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: Close
[0m23:46:55.074530 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:46:55.075378 [info ] [Thread-2 (]: 31 of 33 PASS source_not_null_public_raw_location_data_region .................. [[32mPASS[0m in 0.06s]
[0m23:46:55.076214 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:46:55.077262 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:46:55.077984 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: BEGIN
[0m23:46:55.078447 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:46:55.078885 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:46:55.079343 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:46:55.080052 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."raw_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:46:55.081636 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:46:55.083150 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: ROLLBACK
[0m23:46:55.083762 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: Close
[0m23:46:55.084435 [info ] [Thread-3 (]: 32 of 33 PASS source_not_null_public_raw_location_data_type .................... [[32mPASS[0m in 0.05s]
[0m23:46:55.085092 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:46:55.086288 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m23:46:55.086747 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"
[0m23:46:55.087183 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    SELECT *
    FROM "dwh"."public"."stg_location_data"
    WHERE CASE
        WHEN LOWER(type) = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER(type) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'UNKNOWN'

  
  
      
    ) dbt_internal_test
[0m23:46:55.101750 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m23:46:55.103373 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: ROLLBACK
[0m23:46:55.104007 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91: Close
[0m23:46:55.104733 [error] [Thread-4 (]: 33 of 33 FAIL 3766 valid_values_stg_location_data_type__URBAN__RURAL ........... [[31mFAIL 3766[0m in 0.05s]
[0m23:46:55.105438 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91
[0m23:46:55.107707 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:55.108165 [debug] [MainThread]: On master: BEGIN
[0m23:46:55.108469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:55.115453 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:46:55.115838 [debug] [MainThread]: On master: COMMIT
[0m23:46:55.116158 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:55.116418 [debug] [MainThread]: On master: COMMIT
[0m23:46:55.116812 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:55.117101 [debug] [MainThread]: On master: Close
[0m23:46:55.117515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:55.117768 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c' was properly closed.
[0m23:46:55.118040 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e' was properly closed.
[0m23:46:55.118298 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522' was properly closed.
[0m23:46:55.118546 [debug] [MainThread]: Connection 'test.airflow_dbt_training.valid_values_stg_location_data_type__URBAN__RURAL.ff7f172d91' was properly closed.
[0m23:46:55.118912 [info ] [MainThread]: 
[0m23:46:55.119324 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m23:46:55.125329 [debug] [MainThread]: Command end result
[0m23:46:55.162530 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:46:55.164122 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:46:55.174550 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:46:55.175193 [info ] [MainThread]: 
[0m23:46:55.175760 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:46:55.176268 [info ] [MainThread]: 
[0m23:46:55.176901 [error] [MainThread]: [31mFailure in test valid_values_stg_location_data_type__URBAN__RURAL (models/airflow_dbt_training/silver/schema.yml)[0m
[0m23:46:55.177517 [error] [MainThread]:   Got 3766 results, configured to fail if != 0
[0m23:46:55.178019 [info ] [MainThread]: 
[0m23:46:55.178588 [info ] [MainThread]:   compiled code at target/compiled/airflow_dbt_training/models/airflow_dbt_training/silver/schema.yml/valid_values_stg_location_data_type__URBAN__RURAL.sql
[0m23:46:55.179156 [info ] [MainThread]: 
[0m23:46:55.179664 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=1 SKIP=0 TOTAL=33
[0m23:46:55.181077 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.6230946, "process_in_blocks": "0", "process_kernel_time": 0.206169, "process_mem_max_rss": "125084", "process_out_blocks": "3064", "process_user_time": 2.778375}
[0m23:46:55.181822 [debug] [MainThread]: Command `dbt test` failed at 23:46:55.181644 after 1.62 seconds
[0m23:46:55.182404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b152d8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b152d98d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b10310710>]}
[0m23:46:55.183015 [debug] [MainThread]: Flushing usage events
[0m23:46:55.769756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:48:16.921223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6309bc5f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6309d1db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6309bba450>]}


============================== 23:48:16.924048 | b4052dd4-249f-4f4c-bbfd-58b001bb8920 ==============================
[0m23:48:16.924048 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:48:16.924782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:48:17.078419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4052dd4-249f-4f4c-bbfd-58b001bb8920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63095b7690>]}
[0m23:48:17.134833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4052dd4-249f-4f4c-bbfd-58b001bb8920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f630c42dcd0>]}
[0m23:48:17.135625 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:48:17.215362 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:48:17.342069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:48:17.342989 [debug] [MainThread]: Partial parsing: updated file: airflow_dbt_training://models/airflow_dbt_training/silver/schema.yml
[0m23:48:17.781349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4052dd4-249f-4f4c-bbfd-58b001bb8920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63081ac550>]}
[0m23:48:17.877530 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:48:17.880015 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:48:17.945878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4052dd4-249f-4f4c-bbfd-58b001bb8920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6308577290>]}
[0m23:48:17.946396 [info ] [MainThread]: Found 9 models, 34 data tests, 2 sources, 436 macros
[0m23:48:17.946744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4052dd4-249f-4f4c-bbfd-58b001bb8920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6307d93ed0>]}
[0m23:48:17.951238 [info ] [MainThread]: 
[0m23:48:17.951877 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:48:17.952414 [info ] [MainThread]: 
[0m23:48:17.953557 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:48:17.960601 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dwh_public'
[0m23:48:18.004275 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:48:18.004668 [debug] [ThreadPool]: On list_dwh_public: BEGIN
[0m23:48:18.005007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:18.014125 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m23:48:18.014531 [debug] [ThreadPool]: Using postgres connection "list_dwh_public"
[0m23:48:18.014903 [debug] [ThreadPool]: On list_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "list_dwh_public"} */
select
      'dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:48:18.017319 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m23:48:18.018721 [debug] [ThreadPool]: On list_dwh_public: ROLLBACK
[0m23:48:18.019188 [debug] [ThreadPool]: On list_dwh_public: Close
[0m23:48:18.026409 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:18.026748 [debug] [MainThread]: On master: BEGIN
[0m23:48:18.027022 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:48:18.033411 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:48:18.033749 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:18.034233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:48:18.038794 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m23:48:18.041526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4052dd4-249f-4f4c-bbfd-58b001bb8920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f630859bc10>]}
[0m23:48:18.041950 [debug] [MainThread]: On master: ROLLBACK
[0m23:48:18.042405 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:18.042684 [debug] [MainThread]: On master: BEGIN
[0m23:48:18.043289 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:48:18.043573 [debug] [MainThread]: On master: COMMIT
[0m23:48:18.043854 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:18.044118 [debug] [MainThread]: On master: COMMIT
[0m23:48:18.044552 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:48:18.044887 [debug] [MainThread]: On master: Close
[0m23:48:18.048312 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:48:18.048780 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:48:18.049228 [info ] [Thread-1 (]: 1 of 34 START test accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [RUN]
[0m23:48:18.049780 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:48:18.050592 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:48:18.051403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dwh_public, now test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b)
[0m23:48:18.050240 [info ] [Thread-2 (]: 2 of 34 START test accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [RUN]
[0m23:48:18.052108 [info ] [Thread-3 (]: 3 of 34 START test not_null_mart_housing_prices_breakdown_avg_price ............ [RUN]
[0m23:48:18.052677 [info ] [Thread-4 (]: 4 of 34 START test not_null_mart_housing_prices_breakdown_n_sales .............. [RUN]
[0m23:48:18.053291 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:48:18.054268 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e'
[0m23:48:18.055121 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d'
[0m23:48:18.055772 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7'
[0m23:48:18.066734 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:48:18.073882 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:48:18.074457 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:48:18.075076 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:48:18.083482 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:48:18.093151 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:48:18.097248 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:48:18.101027 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:48:18.102036 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:48:18.102473 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:48:18.103362 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:48:18.109141 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:48:18.139910 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:48:18.141439 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:48:18.145299 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:48:18.147832 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:48:18.148922 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:48:18.149426 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:48:18.150577 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:48:18.151004 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:48:18.151474 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: BEGIN
[0m23:48:18.151929 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: BEGIN
[0m23:48:18.152374 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: BEGIN
[0m23:48:18.152813 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: BEGIN
[0m23:48:18.153265 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:48:18.153703 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:48:18.154155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:18.154573 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:48:18.161711 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:48:18.162357 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:48:18.162771 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"
[0m23:48:18.163183 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:48:18.163652 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m23:48:18.164042 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"
[0m23:48:18.164652 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        month as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by month

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6','7','8','9','10','11','12'
)



  
  
      
    ) dbt_internal_test
[0m23:48:18.165239 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"
[0m23:48:18.165784 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"
[0m23:48:18.166265 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select n_sales
from "dwh"."public"."mart_housing_prices_breakdown"
where n_sales is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.166913 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with  __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
), all_values as (

    select
        day_of_week as value_field,
        count(*) as n_records

    from __dbt__cte__stg_housing_prices
    group by day_of_week

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m23:48:18.167485 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_price
from "dwh"."public"."mart_housing_prices_breakdown"
where avg_price is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.172813 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:48:18.173253 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:48:18.177370 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: ROLLBACK
[0m23:48:18.177876 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:48:18.178340 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:48:18.179696 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: ROLLBACK
[0m23:48:18.181296 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: ROLLBACK
[0m23:48:18.181719 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7: Close
[0m23:48:18.182960 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: ROLLBACK
[0m23:48:18.183658 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d: Close
[0m23:48:18.184250 [debug] [Thread-2 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e: Close
[0m23:48:18.184897 [info ] [Thread-4 (]: 4 of 34 PASS not_null_mart_housing_prices_breakdown_n_sales .................... [[32mPASS[0m in 0.13s]
[0m23:48:18.185540 [debug] [Thread-1 (]: On test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b: Close
[0m23:48:18.186307 [info ] [Thread-3 (]: 3 of 34 PASS not_null_mart_housing_prices_breakdown_avg_price .................. [[32mPASS[0m in 0.13s]
[0m23:48:18.187186 [info ] [Thread-2 (]: 2 of 34 PASS accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12  [[32mPASS[0m in 0.13s]
[0m23:48:18.188099 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7
[0m23:48:18.188861 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d
[0m23:48:18.189494 [info ] [Thread-1 (]: 1 of 34 PASS accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6  [[32mPASS[0m in 0.14s]
[0m23:48:18.190487 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e
[0m23:48:18.191212 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:48:18.191857 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:48:18.192605 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b
[0m23:48:18.193153 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:48:18.193720 [info ] [Thread-4 (]: 5 of 34 START test not_null_mart_housing_prices_breakdown_region ............... [RUN]
[0m23:48:18.194406 [info ] [Thread-3 (]: 6 of 34 START test not_null_region_type_composition_pct_urban .................. [RUN]
[0m23:48:18.195070 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:48:18.195667 [info ] [Thread-2 (]: 7 of 34 START test not_null_region_type_composition_region ..................... [RUN]
[0m23:48:18.196415 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_n_sales.e86732ebd7, now test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c)
[0m23:48:18.197096 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_avg_price.b9aedecf0d, now test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc)
[0m23:48:18.197608 [info ] [Thread-1 (]: 8 of 34 START test not_null_region_type_composition_rural_count ................ [RUN]
[0m23:48:18.198161 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_month__1__2__3__4__5__6__7__8__9__10__11__12.0247d48e7e, now test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e)
[0m23:48:18.198660 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:48:18.199144 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:48:18.199696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.accepted_values_stg_housing_prices_day_of_week__0__1__2__3__4__5__6.0a7796996b, now test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4)
[0m23:48:18.200315 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:48:18.205111 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:48:18.209627 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:48:18.210238 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:48:18.215180 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:48:18.219925 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:48:18.220755 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:48:18.221541 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:48:18.224749 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:48:18.225388 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:48:18.225737 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:48:18.228522 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:48:18.231267 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:48:18.233881 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:48:18.234355 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:48:18.235571 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:48:18.236202 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:48:18.236735 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:48:18.237173 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: BEGIN
[0m23:48:18.237599 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: BEGIN
[0m23:48:18.238061 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: BEGIN
[0m23:48:18.238494 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: BEGIN
[0m23:48:18.238924 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:48:18.239363 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:48:18.239781 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:48:18.240204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:18.247115 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:48:18.247761 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:48:18.248171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:48:18.248539 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:48:18.248992 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"
[0m23:48:18.249442 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"
[0m23:48:18.249885 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"
[0m23:48:18.250318 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"
[0m23:48:18.250801 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.251315 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.251841 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.252354 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."mart_housing_prices_breakdown"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.255223 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:48:18.256693 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: ROLLBACK
[0m23:48:18.257206 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c: Close
[0m23:48:18.257605 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:48:18.260135 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: ROLLBACK
[0m23:48:18.258320 [info ] [Thread-4 (]: 5 of 34 PASS not_null_mart_housing_prices_breakdown_region ..................... [[32mPASS[0m in 0.06s]
[0m23:48:18.260972 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e: Close
[0m23:48:18.261621 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c
[0m23:48:18.262231 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:48:18.263209 [info ] [Thread-2 (]: 7 of 34 PASS not_null_region_type_composition_region ........................... [[32mPASS[0m in 0.06s]
[0m23:48:18.263897 [info ] [Thread-4 (]: 9 of 34 START test not_null_region_type_composition_total_count ................ [RUN]
[0m23:48:18.264925 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e
[0m23:48:18.265518 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:48:18.266063 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m23:48:18.266560 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_mart_housing_prices_breakdown_region.1da05fe95c, now test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7)
[0m23:48:18.267139 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:48:18.268740 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: ROLLBACK
[0m23:48:18.270270 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: ROLLBACK
[0m23:48:18.270796 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:48:18.271281 [info ] [Thread-2 (]: 10 of 34 START test not_null_region_type_composition_urban_count ............... [RUN]
[0m23:48:18.276620 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:48:18.277129 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc: Close
[0m23:48:18.277626 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4: Close
[0m23:48:18.278119 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_region.20dd0de44e, now test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836)
[0m23:48:18.279338 [info ] [Thread-1 (]: 8 of 34 PASS not_null_region_type_composition_rural_count ...................... [[32mPASS[0m in 0.08s]
[0m23:48:18.280072 [info ] [Thread-3 (]: 6 of 34 PASS not_null_region_type_composition_pct_urban ........................ [[32mPASS[0m in 0.08s]
[0m23:48:18.280862 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:48:18.281415 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:48:18.282124 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4
[0m23:48:18.282748 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc
[0m23:48:18.289066 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:48:18.292057 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:48:18.292679 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:48:18.293380 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:48:18.294930 [info ] [Thread-1 (]: 11 of 34 START test not_null_region_type_composition_with_macro_pct_urban ...... [RUN]
[0m23:48:18.295498 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:48:18.296042 [info ] [Thread-3 (]: 12 of 34 START test not_null_region_type_composition_with_macro_region ......... [RUN]
[0m23:48:18.296891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_rural_count.9e39ae4fb4, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91)
[0m23:48:18.299892 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:48:18.300419 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:48:18.301014 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_pct_urban.b7a7a334bc, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192)
[0m23:48:18.301522 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:48:18.302148 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: BEGIN
[0m23:48:18.302736 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:48:18.303250 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:48:18.307905 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:48:18.308450 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:48:18.312598 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:48:18.313188 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: BEGIN
[0m23:48:18.314336 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:48:18.314826 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:48:18.317741 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:48:18.318414 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:48:18.321815 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:48:18.322799 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:48:18.323399 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m23:48:18.323892 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: BEGIN
[0m23:48:18.324483 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:48:18.324927 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"
[0m23:48:18.325486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:18.325922 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:48:18.326323 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: BEGIN
[0m23:48:18.326815 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_count
from "dwh"."public"."region_type_composition"
where total_count is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.327509 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"
[0m23:48:18.327939 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:48:18.328498 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.333580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:48:18.334024 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"
[0m23:48:18.334436 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pct_urban
from "dwh"."public"."region_type_composition_with_macro"
where pct_urban is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.335237 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:48:18.335613 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"
[0m23:48:18.336001 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:48:18.336475 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."region_type_composition_with_macro"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.338032 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: ROLLBACK
[0m23:48:18.338724 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7: Close
[0m23:48:18.339372 [info ] [Thread-4 (]: 9 of 34 PASS not_null_region_type_composition_total_count ...................... [[32mPASS[0m in 0.07s]
[0m23:48:18.340039 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7
[0m23:48:18.340604 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:48:18.341107 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:48:18.343037 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: ROLLBACK
[0m23:48:18.343620 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:48:18.344081 [info ] [Thread-4 (]: 13 of 34 START test not_null_region_type_composition_with_macro_rural_count .... [RUN]
[0m23:48:18.345866 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: ROLLBACK
[0m23:48:18.346305 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836: Close
[0m23:48:18.346797 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_total_count.c6531ae9c7, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797)
[0m23:48:18.347678 [info ] [Thread-2 (]: 10 of 34 PASS not_null_region_type_composition_urban_count ..................... [[32mPASS[0m in 0.07s]
[0m23:48:18.348227 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:48:18.348646 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192: Close
[0m23:48:18.349317 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836
[0m23:48:18.354326 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:48:18.355121 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m23:48:18.356460 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:48:18.355960 [info ] [Thread-3 (]: 12 of 34 PASS not_null_region_type_composition_with_macro_region ............... [[32mPASS[0m in 0.05s]
[0m23:48:18.358559 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: ROLLBACK
[0m23:48:18.359130 [info ] [Thread-2 (]: 14 of 34 START test not_null_region_type_composition_with_macro_total_locations  [RUN]
[0m23:48:18.360008 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192
[0m23:48:18.360654 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:48:18.361500 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_urban_count.24354ae836, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae)
[0m23:48:18.362005 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91: Close
[0m23:48:18.362508 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:48:18.365598 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:48:18.366141 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:48:18.367025 [info ] [Thread-3 (]: 15 of 34 START test not_null_region_type_composition_with_macro_urban_count .... [RUN]
[0m23:48:18.367880 [info ] [Thread-1 (]: 11 of 34 PASS not_null_region_type_composition_with_macro_pct_urban ............ [[32mPASS[0m in 0.07s]
[0m23:48:18.373057 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:48:18.373795 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_region.23b1135192, now test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224)
[0m23:48:18.374411 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:48:18.375071 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91
[0m23:48:18.375912 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:48:18.376380 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: BEGIN
[0m23:48:18.376773 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:48:18.377257 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:48:18.382002 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:48:18.382580 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:48:18.385547 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:48:18.386157 [info ] [Thread-1 (]: 16 of 34 START test not_null_stg_housing_prices_date ........................... [RUN]
[0m23:48:18.387667 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:48:18.388229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_pct_urban.c26f09fb91, now test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136)
[0m23:48:18.392980 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:48:18.393515 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:48:18.394046 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:48:18.394487 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:48:18.395145 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:48:18.395614 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: BEGIN
[0m23:48:18.401190 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:48:18.401694 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"
[0m23:48:18.402159 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: BEGIN
[0m23:48:18.402647 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:48:18.403462 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rural_count
from "dwh"."public"."region_type_composition_with_macro"
where rural_count is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.404110 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:48:18.404570 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:48:18.408119 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:48:18.408883 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:48:18.409498 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: BEGIN
[0m23:48:18.409928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:18.411861 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:48:18.412295 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:48:18.412719 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"
[0m23:48:18.413178 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"
[0m23:48:18.413718 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select urban_count
from "dwh"."public"."region_type_composition_with_macro"
where urban_count is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.414345 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_locations
from "dwh"."public"."region_type_composition_with_macro"
where total_locations is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.416765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:48:18.417222 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"
[0m23:48:18.417645 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select date
from __dbt__cte__stg_housing_prices
where date is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.422532 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:48:18.423194 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.018 seconds
[0m23:48:18.423596 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m23:48:18.425119 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: ROLLBACK
[0m23:48:18.426480 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: ROLLBACK
[0m23:48:18.427923 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: ROLLBACK
[0m23:48:18.428603 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae: Close
[0m23:48:18.429011 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136: Close
[0m23:48:18.429553 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797: Close
[0m23:48:18.430310 [info ] [Thread-2 (]: 14 of 34 PASS not_null_region_type_composition_with_macro_total_locations ...... [[32mPASS[0m in 0.07s]
[0m23:48:18.431256 [info ] [Thread-1 (]: 16 of 34 PASS not_null_stg_housing_prices_date ................................. [[32mPASS[0m in 0.04s]
[0m23:48:18.433267 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae
[0m23:48:18.433949 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m23:48:18.432396 [info ] [Thread-4 (]: 13 of 34 PASS not_null_region_type_composition_with_macro_rural_count .......... [[32mPASS[0m in 0.09s]
[0m23:48:18.434820 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136
[0m23:48:18.435609 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:48:18.437696 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: ROLLBACK
[0m23:48:18.438484 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797
[0m23:48:18.439100 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:48:18.439853 [info ] [Thread-2 (]: 17 of 34 START test not_null_stg_housing_prices_day_of_week .................... [RUN]
[0m23:48:18.440674 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:48:18.441306 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224: Close
[0m23:48:18.441905 [info ] [Thread-1 (]: 18 of 34 START test not_null_stg_housing_prices_id ............................. [RUN]
[0m23:48:18.442599 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_total_locations.191bdba7ae, now test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7)
[0m23:48:18.443141 [info ] [Thread-4 (]: 19 of 34 START test not_null_stg_housing_prices_month .......................... [RUN]
[0m23:48:18.444426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_date.db6e01b136, now test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40)
[0m23:48:18.443956 [info ] [Thread-3 (]: 15 of 34 PASS not_null_region_type_composition_with_macro_urban_count .......... [[32mPASS[0m in 0.07s]
[0m23:48:18.445242 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:48:18.445882 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_rural_count.80e4e8d797, now test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9)
[0m23:48:18.446399 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:48:18.447174 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224
[0m23:48:18.453043 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:48:18.453661 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:48:18.459890 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:48:18.460415 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:48:18.465984 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:48:18.466983 [info ] [Thread-3 (]: 20 of 34 START test not_null_stg_housing_prices_price .......................... [RUN]
[0m23:48:18.467648 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:48:18.468270 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:48:18.468801 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_region_type_composition_with_macro_urban_count.72d0305224, now test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075)
[0m23:48:18.469394 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:48:18.472301 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:48:18.475148 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:48:18.475723 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:48:18.478699 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:48:18.485160 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:48:18.485843 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:48:18.486388 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:48:18.486762 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: BEGIN
[0m23:48:18.487276 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: BEGIN
[0m23:48:18.487864 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:48:18.488491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:18.489028 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:48:18.489482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:48:18.489919 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: BEGIN
[0m23:48:18.492900 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:48:18.493653 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:48:18.494657 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:48:18.495187 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: BEGIN
[0m23:48:18.495559 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:48:18.496950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:48:18.497403 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"
[0m23:48:18.497821 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select id
from __dbt__cte__stg_housing_prices
where id is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.499673 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:48:18.501200 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: ROLLBACK
[0m23:48:18.501984 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m23:48:18.502524 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40: Close
[0m23:48:18.502901 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:48:18.503325 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"
[0m23:48:18.503742 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m23:48:18.504475 [info ] [Thread-1 (]: 18 of 34 PASS not_null_stg_housing_prices_id ................................... [[32mPASS[0m in 0.06s]
[0m23:48:18.505007 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"
[0m23:48:18.505680 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select day_of_week
from __dbt__cte__stg_housing_prices
where day_of_week is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.506275 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"
[0m23:48:18.506993 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40
[0m23:48:18.507550 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select month
from __dbt__cte__stg_housing_prices
where month is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.508503 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select price
from __dbt__cte__stg_housing_prices
where price is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.509377 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:48:18.510406 [info ] [Thread-1 (]: 21 of 34 START test not_null_stg_housing_prices_region ......................... [RUN]
[0m23:48:18.511104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_id.077d9c2e40, now test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0)
[0m23:48:18.511698 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:48:18.517719 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m23:48:18.520749 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:48:18.521340 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m23:48:18.521761 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m23:48:18.523268 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: ROLLBACK
[0m23:48:18.525314 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: ROLLBACK
[0m23:48:18.526007 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:48:18.527489 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: ROLLBACK
[0m23:48:18.530560 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:48:18.531235 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7: Close
[0m23:48:18.531701 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075: Close
[0m23:48:18.532544 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9: Close
[0m23:48:18.533398 [info ] [Thread-2 (]: 17 of 34 PASS not_null_stg_housing_prices_day_of_week .......................... [[32mPASS[0m in 0.09s]
[0m23:48:18.534353 [info ] [Thread-3 (]: 20 of 34 PASS not_null_stg_housing_prices_price ................................ [[32mPASS[0m in 0.07s]
[0m23:48:18.535102 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:48:18.536036 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7
[0m23:48:18.536731 [info ] [Thread-4 (]: 19 of 34 PASS not_null_stg_housing_prices_month ................................ [[32mPASS[0m in 0.09s]
[0m23:48:18.537572 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075
[0m23:48:18.538087 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: BEGIN
[0m23:48:18.538650 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:48:18.539539 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9
[0m23:48:18.540093 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:48:18.540600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:18.541086 [info ] [Thread-2 (]: 22 of 34 START test not_null_stg_housing_prices_year ........................... [RUN]
[0m23:48:18.541658 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:48:18.542251 [info ] [Thread-3 (]: 23 of 34 START test not_null_stg_location_data_postcode ........................ [RUN]
[0m23:48:18.543247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_day_of_week.679d1f8dd7, now test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115)
[0m23:48:18.543929 [info ] [Thread-4 (]: 24 of 34 START test not_null_stg_location_data_region .......................... [RUN]
[0m23:48:18.544528 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_price.755d345075, now test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41)
[0m23:48:18.545173 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:48:18.545831 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_month.b4794150c9, now test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46)
[0m23:48:18.546399 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:48:18.552534 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:48:18.552962 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:48:18.557822 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:48:18.558336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m23:48:18.562725 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:48:18.563761 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:48:18.564187 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"
[0m23:48:18.564768 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:48:18.567817 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:48:18.568431 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:48:18.568896 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select region
from __dbt__cte__stg_housing_prices
where region is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.571670 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:48:18.574473 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:48:18.575197 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:48:18.576191 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:48:18.576600 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:48:18.577055 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: BEGIN
[0m23:48:18.577471 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:48:18.577904 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: BEGIN
[0m23:48:18.579548 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: ROLLBACK
[0m23:48:18.580004 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:48:18.580475 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: BEGIN
[0m23:48:18.580893 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:48:18.581668 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:48:18.582037 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0: Close
[0m23:48:18.583277 [info ] [Thread-1 (]: 21 of 34 PASS not_null_stg_housing_prices_region ............................... [[32mPASS[0m in 0.07s]
[0m23:48:18.583907 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0
[0m23:48:18.584452 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:48:18.585203 [info ] [Thread-1 (]: 25 of 34 START test not_null_stg_location_data_type ............................ [RUN]
[0m23:48:18.585952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_region.96c71cc1a0, now test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49)
[0m23:48:18.586441 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:48:18.591205 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:48:18.592416 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m23:48:18.592995 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m23:48:18.593449 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:48:18.593977 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"
[0m23:48:18.594418 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:48:18.594981 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"
[0m23:48:18.595426 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"
[0m23:48:18.595929 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."stg_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.598996 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:48:18.599651 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



with __dbt__cte__stg_housing_prices as (
  -- or use 'view' if you want to inspect it

WITH source AS (
    SELECT * FROM "dwh"."public"."housing_prices"
)

SELECT
    id,
    date::DATE as date,
    region,
    price,
    EXTRACT(YEAR FROM date::DATE) as year,
    EXTRACT(MONTH FROM date::DATE) as month,
    EXTRACT(DOW FROM date::DATE) as day_of_week,
    CURRENT_TIMESTAMP as updated_at
FROM source
) select year
from __dbt__cte__stg_housing_prices
where year is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.600218 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."stg_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.601234 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:48:18.601612 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: BEGIN
[0m23:48:18.601951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:18.602442 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:48:18.604480 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: ROLLBACK
[0m23:48:18.605199 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41: Close
[0m23:48:18.605641 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:48:18.607127 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: ROLLBACK
[0m23:48:18.607813 [info ] [Thread-3 (]: 23 of 34 PASS not_null_stg_location_data_postcode .............................. [[32mPASS[0m in 0.06s]
[0m23:48:18.608304 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:48:18.609164 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41
[0m23:48:18.611078 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: ROLLBACK
[0m23:48:18.611708 [debug] [Thread-4 (]: On test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46: Close
[0m23:48:18.612186 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca
[0m23:48:18.612610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:48:18.613342 [debug] [Thread-2 (]: On test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115: Close
[0m23:48:18.613933 [info ] [Thread-4 (]: 24 of 34 PASS not_null_stg_location_data_region ................................ [[32mPASS[0m in 0.07s]
[0m23:48:18.614493 [info ] [Thread-3 (]: 26 of 34 START test not_null_stg_location_data_type_normalized ................. [RUN]
[0m23:48:18.615400 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"
[0m23:48:18.616436 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46
[0m23:48:18.617095 [info ] [Thread-2 (]: 22 of 34 PASS not_null_stg_housing_prices_year ................................. [[32mPASS[0m in 0.07s]
[0m23:48:18.617803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_postcode.2350e82d41, now test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca)
[0m23:48:18.618469 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."stg_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.619171 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:48:18.619902 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115
[0m23:48:18.620390 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca
[0m23:48:18.621067 [info ] [Thread-4 (]: 27 of 34 START test source_not_null_public_raw_housing_prices_date ............. [RUN]
[0m23:48:18.621879 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:48:18.626912 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca"
[0m23:48:18.627661 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m23:48:18.628168 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_region.bfbf1cce46, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a)
[0m23:48:18.628675 [info ] [Thread-2 (]: 28 of 34 START test source_not_null_public_raw_housing_prices_id ............... [RUN]
[0m23:48:18.630518 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: ROLLBACK
[0m23:48:18.631200 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:48:18.631679 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca
[0m23:48:18.632234 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_housing_prices_year.d067eee115, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120)
[0m23:48:18.638037 [debug] [Thread-1 (]: On test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49: Close
[0m23:48:18.637476 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:48:18.643097 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca"
[0m23:48:18.643643 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:48:18.644539 [info ] [Thread-1 (]: 25 of 34 PASS not_null_stg_location_data_type .................................. [[32mPASS[0m in 0.06s]
[0m23:48:18.645640 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:48:18.650471 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:48:18.651381 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49
[0m23:48:18.651923 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca"
[0m23:48:18.654986 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:48:18.655777 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:48:18.656514 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:48:18.656939 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca: BEGIN
[0m23:48:18.657659 [info ] [Thread-1 (]: 29 of 34 START test source_not_null_public_raw_housing_prices_price ............ [RUN]
[0m23:48:18.660947 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:48:18.661571 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:48:18.662015 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:48:18.662509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type.3c0dd45f49, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725)
[0m23:48:18.663090 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: BEGIN
[0m23:48:18.663721 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:48:18.664505 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:48:18.664982 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:48:18.665446 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: BEGIN
[0m23:48:18.670054 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:48:18.671119 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:48:18.671663 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:48:18.672403 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca"
[0m23:48:18.672873 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:48:18.673614 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type_normalized
from "dwh"."public"."stg_location_data"
where type_normalized is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.676997 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:48:18.678024 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m23:48:18.678666 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:48:18.679153 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"
[0m23:48:18.679695 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: BEGIN
[0m23:48:18.680115 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:48:18.680612 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from "dwh"."public"."raw_housing_prices"
where date is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.681078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:18.681552 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"
[0m23:48:18.682615 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "dwh"."public"."raw_housing_prices"
where id is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.683445 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:48:18.684905 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: ROLLBACK
[0m23:48:18.685445 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:48:18.685909 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m23:48:18.687170 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: ROLLBACK
[0m23:48:18.687652 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a: Close
[0m23:48:18.689317 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca: ROLLBACK
[0m23:48:18.690104 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120: Close
[0m23:48:18.690895 [info ] [Thread-4 (]: 27 of 34 PASS source_not_null_public_raw_housing_prices_date ................... [[32mPASS[0m in 0.06s]
[0m23:48:18.691450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:48:18.691879 [debug] [Thread-3 (]: On test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca: Close
[0m23:48:18.692593 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a
[0m23:48:18.693191 [info ] [Thread-2 (]: 28 of 34 PASS source_not_null_public_raw_housing_prices_id ..................... [[32mPASS[0m in 0.06s]
[0m23:48:18.693947 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"
[0m23:48:18.694713 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:48:18.695571 [info ] [Thread-3 (]: 26 of 34 PASS not_null_stg_location_data_type_normalized ....................... [[32mPASS[0m in 0.08s]
[0m23:48:18.696736 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120
[0m23:48:18.697334 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dwh"."public"."raw_housing_prices"
where price is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.697923 [info ] [Thread-4 (]: 30 of 34 START test source_not_null_public_raw_housing_prices_region ........... [RUN]
[0m23:48:18.698687 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca
[0m23:48:18.699222 [debug] [Thread-2 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:48:18.700175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_date.1d07f5921a, now test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d)
[0m23:48:18.700931 [debug] [Thread-3 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:48:18.702257 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:48:18.701804 [info ] [Thread-2 (]: 31 of 34 START test source_not_null_public_raw_location_data_postcode .......... [RUN]
[0m23:48:18.702900 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:48:18.703408 [info ] [Thread-3 (]: 32 of 34 START test source_not_null_public_raw_location_data_region ............ [RUN]
[0m23:48:18.705078 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: ROLLBACK
[0m23:48:18.705713 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_id.dbf9fea120, now test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c)
[0m23:48:18.710724 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:48:18.711311 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.not_null_stg_location_data_type_normalized.24993454ca, now test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e)
[0m23:48:18.712014 [debug] [Thread-2 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:48:18.712630 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725: Close
[0m23:48:18.713412 [debug] [Thread-3 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:48:18.717885 [debug] [Thread-2 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:48:18.718593 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:48:18.719463 [info ] [Thread-1 (]: 29 of 34 PASS source_not_null_public_raw_housing_prices_price .................. [[32mPASS[0m in 0.06s]
[0m23:48:18.723969 [debug] [Thread-3 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:48:18.727378 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:48:18.728183 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725
[0m23:48:18.728605 [debug] [Thread-2 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:48:18.729222 [debug] [Thread-3 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:48:18.729843 [debug] [Thread-1 (]: Began running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:48:18.733150 [debug] [Thread-2 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:48:18.733780 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:48:18.738590 [debug] [Thread-3 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:48:18.739290 [info ] [Thread-1 (]: 33 of 34 START test source_not_null_public_raw_location_data_type .............. [RUN]
[0m23:48:18.739992 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: BEGIN
[0m23:48:18.740903 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:48:18.741447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_price.5c5aec9725, now test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522)
[0m23:48:18.742024 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:48:18.742695 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:48:18.743233 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: BEGIN
[0m23:48:18.743733 [debug] [Thread-1 (]: Began compiling node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:48:18.744423 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: BEGIN
[0m23:48:18.744962 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:48:18.750293 [debug] [Thread-1 (]: Writing injected SQL for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:48:18.751081 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:48:18.751508 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m23:48:18.752665 [debug] [Thread-1 (]: Began executing node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:48:18.753169 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"
[0m23:48:18.756781 [debug] [Thread-1 (]: Writing runtime sql for node "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:48:18.757478 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_housing_prices"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.758487 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m23:48:18.759005 [debug] [Thread-2 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"
[0m23:48:18.759435 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select postcode
from "dwh"."public"."raw_location_data"
where postcode is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.760099 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:48:18.760897 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:48:18.761542 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m23:48:18.762048 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:48:18.762451 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: BEGIN
[0m23:48:18.763932 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: ROLLBACK
[0m23:48:18.764386 [debug] [Thread-3 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"
[0m23:48:18.765748 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: ROLLBACK
[0m23:48:18.766180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:18.766856 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "dwh"."public"."raw_location_data"
where region is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.767383 [debug] [Thread-4 (]: On test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d: Close
[0m23:48:18.768115 [debug] [Thread-2 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c: Close
[0m23:48:18.768911 [info ] [Thread-4 (]: 30 of 34 PASS source_not_null_public_raw_housing_prices_region ................. [[32mPASS[0m in 0.07s]
[0m23:48:18.770343 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d
[0m23:48:18.769665 [info ] [Thread-2 (]: 31 of 34 PASS source_not_null_public_raw_location_data_postcode ................ [[32mPASS[0m in 0.06s]
[0m23:48:18.771149 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:48:18.771650 [debug] [Thread-4 (]: Began running node test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68
[0m23:48:18.772456 [debug] [Thread-2 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c
[0m23:48:18.774576 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: ROLLBACK
[0m23:48:18.775299 [info ] [Thread-4 (]: 34 of 34 START test valid_values_stg_location_data_type_normalized__URBAN__RURAL  [RUN]
[0m23:48:18.776314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:48:18.776912 [debug] [Thread-3 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e: Close
[0m23:48:18.777421 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airflow_dbt_training.source_not_null_public_raw_housing_prices_region.3b24b3fc1d, now test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68)
[0m23:48:18.778028 [debug] [Thread-1 (]: Using postgres connection "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"
[0m23:48:18.778595 [debug] [Thread-4 (]: Began compiling node test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68
[0m23:48:18.779383 [info ] [Thread-3 (]: 32 of 34 PASS source_not_null_public_raw_location_data_region .................. [[32mPASS[0m in 0.07s]
[0m23:48:18.780289 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "dwh"."public"."raw_location_data"
where type is null



  
  
      
    ) dbt_internal_test
[0m23:48:18.785196 [debug] [Thread-4 (]: Writing injected SQL for node "test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68"
[0m23:48:18.785998 [debug] [Thread-3 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e
[0m23:48:18.787005 [debug] [Thread-4 (]: Began executing node test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68
[0m23:48:18.789860 [debug] [Thread-4 (]: Writing runtime sql for node "test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68"
[0m23:48:18.790343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:48:18.792016 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: ROLLBACK
[0m23:48:18.792715 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68"
[0m23:48:18.793149 [debug] [Thread-1 (]: On test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522: Close
[0m23:48:18.793668 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68: BEGIN
[0m23:48:18.794451 [info ] [Thread-1 (]: 33 of 34 PASS source_not_null_public_raw_location_data_type .................... [[32mPASS[0m in 0.05s]
[0m23:48:18.794945 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:48:18.795591 [debug] [Thread-1 (]: Finished running node test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522
[0m23:48:18.802829 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m23:48:18.803664 [debug] [Thread-4 (]: Using postgres connection "test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68"
[0m23:48:18.804153 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "default", "target_name": "dev", "node_id": "test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    SELECT *
    FROM "dwh"."public"."stg_location_data"
    WHERE CASE
        WHEN LOWER(type_normalized) = LOWER('URBAN') THEN 'URBAN'
        WHEN LOWER(type_normalized) = LOWER('RURAL') THEN 'RURAL'
        ELSE 'UNKNOWN'
    END = 'UNKNOWN'

  
  
      
    ) dbt_internal_test
[0m23:48:18.821183 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m23:48:18.822738 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68: ROLLBACK
[0m23:48:18.823313 [debug] [Thread-4 (]: On test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68: Close
[0m23:48:18.823948 [info ] [Thread-4 (]: 34 of 34 PASS valid_values_stg_location_data_type_normalized__URBAN__RURAL ..... [[32mPASS[0m in 0.05s]
[0m23:48:18.824534 [debug] [Thread-4 (]: Finished running node test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68
[0m23:48:18.826548 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:18.826888 [debug] [MainThread]: On master: BEGIN
[0m23:48:18.827213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:48:18.834735 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:48:18.835204 [debug] [MainThread]: On master: COMMIT
[0m23:48:18.835550 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:18.835815 [debug] [MainThread]: On master: COMMIT
[0m23:48:18.836240 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:48:18.836560 [debug] [MainThread]: On master: Close
[0m23:48:18.837011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:18.837273 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_type.e69d7e7522' was properly closed.
[0m23:48:18.837539 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_postcode.d9b783971c' was properly closed.
[0m23:48:18.837792 [debug] [MainThread]: Connection 'test.airflow_dbt_training.source_not_null_public_raw_location_data_region.108b6cd64e' was properly closed.
[0m23:48:18.838042 [debug] [MainThread]: Connection 'test.airflow_dbt_training.valid_values_stg_location_data_type_normalized__URBAN__RURAL.9bbc870c68' was properly closed.
[0m23:48:18.838399 [info ] [MainThread]: 
[0m23:48:18.838736 [info ] [MainThread]: Finished running 34 data tests in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m23:48:18.844993 [debug] [MainThread]: Command end result
[0m23:48:18.881458 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m23:48:18.883116 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m23:48:18.891045 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m23:48:18.891391 [info ] [MainThread]: 
[0m23:48:18.891787 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:18.892130 [info ] [MainThread]: 
[0m23:48:18.892607 [info ] [MainThread]: Done. PASS=34 WARN=0 ERROR=0 SKIP=0 TOTAL=34
[0m23:48:18.893724 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0233002, "process_in_blocks": "0", "process_kernel_time": 0.244243, "process_mem_max_rss": "130712", "process_out_blocks": "4104", "process_user_time": 3.126321}
[0m23:48:18.894322 [debug] [MainThread]: Command `dbt test` succeeded at 23:48:18.894214 after 2.02 seconds
[0m23:48:18.894735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6309a1c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6309a1d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6309a1c450>]}
[0m23:48:18.895159 [debug] [MainThread]: Flushing usage events
[0m23:48:19.528107 [debug] [MainThread]: An error was encountered while trying to flush usage events
